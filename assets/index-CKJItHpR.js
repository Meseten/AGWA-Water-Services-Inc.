var vC=Object.defineProperty;var wC=(n,e,t)=>e in n?vC(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Fb=(n,e,t)=>wC(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function Tm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Bg={exports:{}},yu={},$g={exports:{}},Ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vb;function bC(){if(Vb)return Ze;Vb=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),a=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.iterator;function x(q){return q===null||typeof q!="object"?null:(q=y&&q[y]||q["@@iterator"],typeof q=="function"?q:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function A(q,ne,V){this.props=q,this.context=ne,this.refs=S,this.updater=V||w}A.prototype.isReactComponent={},A.prototype.setState=function(q,ne){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,ne,"setState")},A.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function N(){}N.prototype=A.prototype;function z(q,ne,V){this.props=q,this.context=ne,this.refs=S,this.updater=V||w}var U=z.prototype=new N;U.constructor=z,E(U,A.prototype),U.isPureReactComponent=!0;var W=Array.isArray,$=Object.prototype.hasOwnProperty,F={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function k(q,ne,V){var de,xe={},be=null,Be=null;if(ne!=null)for(de in ne.ref!==void 0&&(Be=ne.ref),ne.key!==void 0&&(be=""+ne.key),ne)$.call(ne,de)&&!R.hasOwnProperty(de)&&(xe[de]=ne[de]);var He=arguments.length-2;if(He===1)xe.children=V;else if(1<He){for(var et=Array(He),wt=0;wt<He;wt++)et[wt]=arguments[wt+2];xe.children=et}if(q&&q.defaultProps)for(de in He=q.defaultProps,He)xe[de]===void 0&&(xe[de]=He[de]);return{$$typeof:n,type:q,key:be,ref:Be,props:xe,_owner:F.current}}function P(q,ne){return{$$typeof:n,type:q.type,key:ne,ref:q.ref,props:q.props,_owner:q._owner}}function T(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function D(q){var ne={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(V){return ne[V]})}var L=/\/+/g;function C(q,ne){return typeof q=="object"&&q!==null&&q.key!=null?D(""+q.key):ne.toString(36)}function G(q,ne,V,de,xe){var be=typeof q;(be==="undefined"||be==="boolean")&&(q=null);var Be=!1;if(q===null)Be=!0;else switch(be){case"string":case"number":Be=!0;break;case"object":switch(q.$$typeof){case n:case e:Be=!0}}if(Be)return Be=q,xe=xe(Be),q=de===""?"."+C(Be,0):de,W(xe)?(V="",q!=null&&(V=q.replace(L,"$&/")+"/"),G(xe,ne,V,"",function(wt){return wt})):xe!=null&&(T(xe)&&(xe=P(xe,V+(!xe.key||Be&&Be.key===xe.key?"":(""+xe.key).replace(L,"$&/")+"/")+q)),ne.push(xe)),1;if(Be=0,de=de===""?".":de+":",W(q))for(var He=0;He<q.length;He++){be=q[He];var et=de+C(be,He);Be+=G(be,ne,V,et,xe)}else if(et=x(q),typeof et=="function")for(q=et.call(q),He=0;!(be=q.next()).done;)be=be.value,et=de+C(be,He++),Be+=G(be,ne,V,et,xe);else if(be==="object")throw ne=String(q),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.");return Be}function K(q,ne,V){if(q==null)return q;var de=[],xe=0;return G(q,de,"","",function(be){return ne.call(V,be,xe++)}),de}function ce(q){if(q._status===-1){var ne=q._result;ne=ne(),ne.then(function(V){(q._status===0||q._status===-1)&&(q._status=1,q._result=V)},function(V){(q._status===0||q._status===-1)&&(q._status=2,q._result=V)}),q._status===-1&&(q._status=0,q._result=ne)}if(q._status===1)return q._result.default;throw q._result}var ue={current:null},Q={transition:null},Z={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:Q,ReactCurrentOwner:F};function M(){throw Error("act(...) is not supported in production builds of React.")}return Ze.Children={map:K,forEach:function(q,ne,V){K(q,function(){ne.apply(this,arguments)},V)},count:function(q){var ne=0;return K(q,function(){ne++}),ne},toArray:function(q){return K(q,function(ne){return ne})||[]},only:function(q){if(!T(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},Ze.Component=A,Ze.Fragment=t,Ze.Profiler=s,Ze.PureComponent=z,Ze.StrictMode=r,Ze.Suspense=d,Ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z,Ze.act=M,Ze.cloneElement=function(q,ne,V){if(q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+q+".");var de=E({},q.props),xe=q.key,be=q.ref,Be=q._owner;if(ne!=null){if(ne.ref!==void 0&&(be=ne.ref,Be=F.current),ne.key!==void 0&&(xe=""+ne.key),q.type&&q.type.defaultProps)var He=q.type.defaultProps;for(et in ne)$.call(ne,et)&&!R.hasOwnProperty(et)&&(de[et]=ne[et]===void 0&&He!==void 0?He[et]:ne[et])}var et=arguments.length-2;if(et===1)de.children=V;else if(1<et){He=Array(et);for(var wt=0;wt<et;wt++)He[wt]=arguments[wt+2];de.children=He}return{$$typeof:n,type:q.type,key:xe,ref:be,props:de,_owner:Be}},Ze.createContext=function(q){return q={$$typeof:a,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},q.Provider={$$typeof:o,_context:q},q.Consumer=q},Ze.createElement=k,Ze.createFactory=function(q){var ne=k.bind(null,q);return ne.type=q,ne},Ze.createRef=function(){return{current:null}},Ze.forwardRef=function(q){return{$$typeof:u,render:q}},Ze.isValidElement=T,Ze.lazy=function(q){return{$$typeof:g,_payload:{_status:-1,_result:q},_init:ce}},Ze.memo=function(q,ne){return{$$typeof:f,type:q,compare:ne===void 0?null:ne}},Ze.startTransition=function(q){var ne=Q.transition;Q.transition={};try{q()}finally{Q.transition=ne}},Ze.unstable_act=M,Ze.useCallback=function(q,ne){return ue.current.useCallback(q,ne)},Ze.useContext=function(q){return ue.current.useContext(q)},Ze.useDebugValue=function(){},Ze.useDeferredValue=function(q){return ue.current.useDeferredValue(q)},Ze.useEffect=function(q,ne){return ue.current.useEffect(q,ne)},Ze.useId=function(){return ue.current.useId()},Ze.useImperativeHandle=function(q,ne,V){return ue.current.useImperativeHandle(q,ne,V)},Ze.useInsertionEffect=function(q,ne){return ue.current.useInsertionEffect(q,ne)},Ze.useLayoutEffect=function(q,ne){return ue.current.useLayoutEffect(q,ne)},Ze.useMemo=function(q,ne){return ue.current.useMemo(q,ne)},Ze.useReducer=function(q,ne,V){return ue.current.useReducer(q,ne,V)},Ze.useRef=function(q){return ue.current.useRef(q)},Ze.useState=function(q){return ue.current.useState(q)},Ze.useSyncExternalStore=function(q,ne,V){return ue.current.useSyncExternalStore(q,ne,V)},Ze.useTransition=function(){return ue.current.useTransition()},Ze.version="18.3.1",Ze}var zb;function L0(){return zb||(zb=1,$g.exports=bC()),$g.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ub;function _C(){if(Ub)return yu;Ub=1;var n=L0(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(u,d,f){var g,y={},x=null,w=null;f!==void 0&&(x=""+f),d.key!==void 0&&(x=""+d.key),d.ref!==void 0&&(w=d.ref);for(g in d)r.call(d,g)&&!o.hasOwnProperty(g)&&(y[g]=d[g]);if(u&&u.defaultProps)for(g in d=u.defaultProps,d)y[g]===void 0&&(y[g]=d[g]);return{$$typeof:e,type:u,key:x,ref:w,props:y,_owner:s.current}}return yu.Fragment=t,yu.jsx=a,yu.jsxs=a,yu}var Bb;function SC(){return Bb||(Bb=1,Bg.exports=_C()),Bg.exports}var c=SC(),B=L0();const Do=Tm(B);var af={},qg={exports:{}},Ar={},Hg={exports:{}},Wg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $b;function IC(){return $b||($b=1,function(n){function e(Q,Z){var M=Q.length;Q.push(Z);e:for(;0<M;){var q=M-1>>>1,ne=Q[q];if(0<s(ne,Z))Q[q]=Z,Q[M]=ne,M=q;else break e}}function t(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var Z=Q[0],M=Q.pop();if(M!==Z){Q[0]=M;e:for(var q=0,ne=Q.length,V=ne>>>1;q<V;){var de=2*(q+1)-1,xe=Q[de],be=de+1,Be=Q[be];if(0>s(xe,M))be<ne&&0>s(Be,xe)?(Q[q]=Be,Q[be]=M,q=be):(Q[q]=xe,Q[de]=M,q=de);else if(be<ne&&0>s(Be,M))Q[q]=Be,Q[be]=M,q=be;else break e}}return Z}function s(Q,Z){var M=Q.sortIndex-Z.sortIndex;return M!==0?M:Q.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var a=Date,u=a.now();n.unstable_now=function(){return a.now()-u}}var d=[],f=[],g=1,y=null,x=3,w=!1,E=!1,S=!1,A=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(Q){for(var Z=t(f);Z!==null;){if(Z.callback===null)r(f);else if(Z.startTime<=Q)r(f),Z.sortIndex=Z.expirationTime,e(d,Z);else break;Z=t(f)}}function W(Q){if(S=!1,U(Q),!E)if(t(d)!==null)E=!0,ce($);else{var Z=t(f);Z!==null&&ue(W,Z.startTime-Q)}}function $(Q,Z){E=!1,S&&(S=!1,N(k),k=-1),w=!0;var M=x;try{for(U(Z),y=t(d);y!==null&&(!(y.expirationTime>Z)||Q&&!D());){var q=y.callback;if(typeof q=="function"){y.callback=null,x=y.priorityLevel;var ne=q(y.expirationTime<=Z);Z=n.unstable_now(),typeof ne=="function"?y.callback=ne:y===t(d)&&r(d),U(Z)}else r(d);y=t(d)}if(y!==null)var V=!0;else{var de=t(f);de!==null&&ue(W,de.startTime-Z),V=!1}return V}finally{y=null,x=M,w=!1}}var F=!1,R=null,k=-1,P=5,T=-1;function D(){return!(n.unstable_now()-T<P)}function L(){if(R!==null){var Q=n.unstable_now();T=Q;var Z=!0;try{Z=R(!0,Q)}finally{Z?C():(F=!1,R=null)}}else F=!1}var C;if(typeof z=="function")C=function(){z(L)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,K=G.port2;G.port1.onmessage=L,C=function(){K.postMessage(null)}}else C=function(){A(L,0)};function ce(Q){R=Q,F||(F=!0,C())}function ue(Q,Z){k=A(function(){Q(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_continueExecution=function(){E||w||(E=!0,ce($))},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(d)},n.unstable_next=function(Q){switch(x){case 1:case 2:case 3:var Z=3;break;default:Z=x}var M=x;x=Z;try{return Q()}finally{x=M}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Q,Z){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var M=x;x=Q;try{return Z()}finally{x=M}},n.unstable_scheduleCallback=function(Q,Z,M){var q=n.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?q+M:q):M=q,Q){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=M+ne,Q={id:g++,callback:Z,priorityLevel:Q,startTime:M,expirationTime:ne,sortIndex:-1},M>q?(Q.sortIndex=M,e(f,Q),t(d)===null&&Q===t(f)&&(S?(N(k),k=-1):S=!0,ue(W,M-q))):(Q.sortIndex=ne,e(d,Q),E||w||(E=!0,ce($))),Q},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(Q){var Z=x;return function(){var M=x;x=Z;try{return Q.apply(this,arguments)}finally{x=M}}}}(Wg)),Wg}var qb;function EC(){return qb||(qb=1,Hg.exports=IC()),Hg.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hb;function TC(){if(Hb)return Ar;Hb=1;var n=L0(),e=EC();function t(i){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function o(i,l){a(i,l),a(i+"Capture",l)}function a(i,l){for(s[i]=l,i=0;i<l.length;i++)r.add(l[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},y={};function x(i){return d.call(y,i)?!0:d.call(g,i)?!1:f.test(i)?y[i]=!0:(g[i]=!0,!1)}function w(i,l,h,p){if(h!==null&&h.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return p?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function E(i,l,h,p){if(l===null||typeof l>"u"||w(i,l,h,p))return!0;if(p)return!1;if(h!==null)switch(h.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function S(i,l,h,p,v,_,j){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=p,this.attributeNamespace=v,this.mustUseProperty=h,this.propertyName=i,this.type=l,this.sanitizeURL=_,this.removeEmptyString=j}var A={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){A[i]=new S(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var l=i[0];A[l]=new S(l,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){A[i]=new S(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){A[i]=new S(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){A[i]=new S(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){A[i]=new S(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){A[i]=new S(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){A[i]=new S(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){A[i]=new S(i,5,!1,i.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function z(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var l=i.replace(N,z);A[l]=new S(l,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var l=i.replace(N,z);A[l]=new S(l,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var l=i.replace(N,z);A[l]=new S(l,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){A[i]=new S(i,1,!1,i.toLowerCase(),null,!1,!1)}),A.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){A[i]=new S(i,1,!1,i.toLowerCase(),null,!0,!0)});function U(i,l,h,p){var v=A.hasOwnProperty(l)?A[l]:null;(v!==null?v.type!==0:p||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(E(l,h,v,p)&&(h=null),p||v===null?x(l)&&(h===null?i.removeAttribute(l):i.setAttribute(l,""+h)):v.mustUseProperty?i[v.propertyName]=h===null?v.type===3?!1:"":h:(l=v.attributeName,p=v.attributeNamespace,h===null?i.removeAttribute(l):(v=v.type,h=v===3||v===4&&h===!0?"":""+h,p?i.setAttributeNS(p,l,h):i.setAttribute(l,h))))}var W=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$=Symbol.for("react.element"),F=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),D=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),K=Symbol.for("react.memo"),ce=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),Q=Symbol.iterator;function Z(i){return i===null||typeof i!="object"?null:(i=Q&&i[Q]||i["@@iterator"],typeof i=="function"?i:null)}var M=Object.assign,q;function ne(i){if(q===void 0)try{throw Error()}catch(h){var l=h.stack.trim().match(/\n( *(at )?)/);q=l&&l[1]||""}return`
`+q+i}var V=!1;function de(i,l){if(!i||V)return"";V=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(ie){var p=ie}Reflect.construct(i,[],l)}else{try{l.call()}catch(ie){p=ie}i.call(l.prototype)}else{try{throw Error()}catch(ie){p=ie}i()}}catch(ie){if(ie&&p&&typeof ie.stack=="string"){for(var v=ie.stack.split(`
`),_=p.stack.split(`
`),j=v.length-1,H=_.length-1;1<=j&&0<=H&&v[j]!==_[H];)H--;for(;1<=j&&0<=H;j--,H--)if(v[j]!==_[H]){if(j!==1||H!==1)do if(j--,H--,0>H||v[j]!==_[H]){var Y=`
`+v[j].replace(" at new "," at ");return i.displayName&&Y.includes("<anonymous>")&&(Y=Y.replace("<anonymous>",i.displayName)),Y}while(1<=j&&0<=H);break}}}finally{V=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?ne(i):""}function xe(i){switch(i.tag){case 5:return ne(i.type);case 16:return ne("Lazy");case 13:return ne("Suspense");case 19:return ne("SuspenseList");case 0:case 2:case 15:return i=de(i.type,!1),i;case 11:return i=de(i.type.render,!1),i;case 1:return i=de(i.type,!0),i;default:return""}}function be(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case R:return"Fragment";case F:return"Portal";case P:return"Profiler";case k:return"StrictMode";case C:return"Suspense";case G:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case D:return(i.displayName||"Context")+".Consumer";case T:return(i._context.displayName||"Context")+".Provider";case L:var l=i.render;return i=i.displayName,i||(i=l.displayName||l.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case K:return l=i.displayName||null,l!==null?l:be(i.type)||"Memo";case ce:l=i._payload,i=i._init;try{return be(i(l))}catch{}}return null}function Be(i){var l=i.type;switch(i.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=l.render,i=i.displayName||i.name||"",l.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return be(l);case 8:return l===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function He(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function et(i){var l=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function wt(i){var l=et(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,l),p=""+i[l];if(!i.hasOwnProperty(l)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var v=h.get,_=h.set;return Object.defineProperty(i,l,{configurable:!0,get:function(){return v.call(this)},set:function(j){p=""+j,_.call(this,j)}}),Object.defineProperty(i,l,{enumerable:h.enumerable}),{getValue:function(){return p},setValue:function(j){p=""+j},stopTracking:function(){i._valueTracker=null,delete i[l]}}}}function Sn(i){i._valueTracker||(i._valueTracker=wt(i))}function Qn(i){if(!i)return!1;var l=i._valueTracker;if(!l)return!0;var h=l.getValue(),p="";return i&&(p=et(i)?i.checked?"true":"false":i.value),i=p,i!==h?(l.setValue(i),!0):!1}function Yn(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function In(i,l){var h=l.checked;return M({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function Mr(i,l){var h=l.defaultValue==null?"":l.defaultValue,p=l.checked!=null?l.checked:l.defaultChecked;h=He(l.value!=null?l.value:h),i._wrapperState={initialChecked:p,initialValue:h,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function Jr(i,l){l=l.checked,l!=null&&U(i,"checked",l,!1)}function Xn(i,l){Jr(i,l);var h=He(l.value),p=l.type;if(h!=null)p==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(p==="submit"||p==="reset"){i.removeAttribute("value");return}l.hasOwnProperty("value")?ur(i,l.type,h):l.hasOwnProperty("defaultValue")&&ur(i,l.type,He(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(i.defaultChecked=!!l.defaultChecked)}function ys(i,l,h){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var p=l.type;if(!(p!=="submit"&&p!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+i._wrapperState.initialValue,h||l===i.value||(i.value=l),i.defaultValue=l}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function ur(i,l,h){(l!=="number"||Yn(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var Jn=Array.isArray;function dr(i,l,h,p){if(i=i.options,l){l={};for(var v=0;v<h.length;v++)l["$"+h[v]]=!0;for(h=0;h<i.length;h++)v=l.hasOwnProperty("$"+i[h].value),i[h].selected!==v&&(i[h].selected=v),v&&p&&(i[h].defaultSelected=!0)}else{for(h=""+He(h),l=null,v=0;v<i.length;v++){if(i[v].value===h){i[v].selected=!0,p&&(i[v].defaultSelected=!0);return}l!==null||i[v].disabled||(l=i[v])}l!==null&&(l.selected=!0)}}function ai(i,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return M({},l,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Zr(i,l){var h=l.value;if(h==null){if(h=l.children,l=l.defaultValue,h!=null){if(l!=null)throw Error(t(92));if(Jn(h)){if(1<h.length)throw Error(t(93));h=h[0]}l=h}l==null&&(l=""),h=l}i._wrapperState={initialValue:He(h)}}function hr(i,l){var h=He(l.value),p=He(l.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),l.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),p!=null&&(i.defaultValue=""+p)}function fr(i){var l=i.textContent;l===i._wrapperState.initialValue&&l!==""&&l!==null&&(i.value=l)}function oe(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fe(i,l){return i==null||i==="http://www.w3.org/1999/xhtml"?oe(l):i==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Le,Qe=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,h,p,v){MSApp.execUnsafeLocalFunction(function(){return i(l,h,p,v)})}:i}(function(i,l){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=l;else{for(Le=Le||document.createElement("div"),Le.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=Le.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;l.firstChild;)i.appendChild(l.firstChild)}});function Xe(i,l){if(l){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=l;return}}i.textContent=l}var Bt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Jt=["Webkit","ms","Moz","O"];Object.keys(Bt).forEach(function(i){Jt.forEach(function(l){l=l+i.charAt(0).toUpperCase()+i.substring(1),Bt[l]=Bt[i]})});function Zt(i,l,h){return l==null||typeof l=="boolean"||l===""?"":h||typeof l!="number"||l===0||Bt.hasOwnProperty(i)&&Bt[i]?(""+l).trim():l+"px"}function Wt(i,l){i=i.style;for(var h in l)if(l.hasOwnProperty(h)){var p=h.indexOf("--")===0,v=Zt(h,l[h],p);h==="float"&&(h="cssFloat"),p?i.setProperty(h,v):i[h]=v}}var pn=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ft(i,l){if(l){if(pn[i]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function jn(i,l){if(i.indexOf("-")===-1)return typeof l.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var an=null;function xs(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var vs=null,mr=null,Dn=null;function Ki(i){if(i=nu(i)){if(typeof vs!="function")throw Error(t(280));var l=i.stateNode;l&&(l=bh(l),vs(i.stateNode,i.type,l))}}function es(i){mr?Dn?Dn.push(i):Dn=[i]:mr=i}function Rt(){if(mr){var i=mr,l=Dn;if(Dn=mr=null,Ki(i),l)for(i=0;i<l.length;i++)Ki(l[i])}}function pr(i,l){return i(l)}function Xo(){}var ts=!1;function li(i,l,h){if(ts)return i(l,h);ts=!0;try{return pr(i,l,h)}finally{ts=!1,(mr!==null||Dn!==null)&&(Xo(),Rt())}}function Pt(i,l){var h=i.stateNode;if(h===null)return null;var p=bh(h);if(p===null)return null;h=p[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(t(231,l,typeof h));return h}var ci=!1;if(u)try{var Lr={};Object.defineProperty(Lr,"passive",{get:function(){ci=!0}}),window.addEventListener("test",Lr,Lr),window.removeEventListener("test",Lr,Lr)}catch{ci=!1}function gn(i,l,h,p,v,_,j,H,Y){var ie=Array.prototype.slice.call(arguments,3);try{l.apply(h,ie)}catch(pe){this.onError(pe)}}var gr=!1,ui=null,yr=!1,di=null,Za={onError:function(i){gr=!0,ui=i}};function Mn(i,l,h,p,v,_,j,H,Y){gr=!1,ui=null,gn.apply(Za,arguments)}function Jo(i,l,h,p,v,_,j,H,Y){if(Mn.apply(this,arguments),gr){if(gr){var ie=ui;gr=!1,ui=null}else throw Error(t(198));yr||(yr=!0,di=ie)}}function xr(i){var l=i,h=i;if(i.alternate)for(;l.return;)l=l.return;else{i=l;do l=i,(l.flags&4098)!==0&&(h=l.return),i=l.return;while(i)}return l.tag===3?h:null}function Fs(i){if(i.tag===13){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function vr(i){if(xr(i)!==i)throw Error(t(188))}function el(i){var l=i.alternate;if(!l){if(l=xr(i),l===null)throw Error(t(188));return l!==i?null:i}for(var h=i,p=l;;){var v=h.return;if(v===null)break;var _=v.alternate;if(_===null){if(p=v.return,p!==null){h=p;continue}break}if(v.child===_.child){for(_=v.child;_;){if(_===h)return vr(v),i;if(_===p)return vr(v),l;_=_.sibling}throw Error(t(188))}if(h.return!==p.return)h=v,p=_;else{for(var j=!1,H=v.child;H;){if(H===h){j=!0,h=v,p=_;break}if(H===p){j=!0,p=v,h=_;break}H=H.sibling}if(!j){for(H=_.child;H;){if(H===h){j=!0,h=_,p=v;break}if(H===p){j=!0,p=_,h=v;break}H=H.sibling}if(!j)throw Error(t(189))}}if(h.alternate!==p)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?i:l}function je(i){return i=el(i),i!==null?X(i):null}function X(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var l=X(i);if(l!==null)return l;i=i.sibling}return null}var ge=e.unstable_scheduleCallback,ke=e.unstable_cancelCallback,gt=e.unstable_shouldYield,en=e.unstable_requestPaint,We=e.unstable_now,ln=e.unstable_getCurrentPriorityLevel,En=e.unstable_ImmediatePriority,wr=e.unstable_UserBlockingPriority,Ln=e.unstable_NormalPriority,$t=e.unstable_LowPriority,Zo=e.unstable_IdlePriority,Vs=null,Or=null;function Xd(i){if(Or&&typeof Or.onCommitFiberRoot=="function")try{Or.onCommitFiberRoot(Vs,i,void 0,(i.current.flags&128)===128)}catch{}}var Zn=Math.clz32?Math.clz32:Zd,zc=Math.log,Jd=Math.LN2;function Zd(i){return i>>>=0,i===0?32:31-(zc(i)/Jd|0)|0}var tl=64,nl=4194304;function Qi(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function ea(i,l){var h=i.pendingLanes;if(h===0)return 0;var p=0,v=i.suspendedLanes,_=i.pingedLanes,j=h&268435455;if(j!==0){var H=j&~v;H!==0?p=Qi(H):(_&=j,_!==0&&(p=Qi(_)))}else j=h&~v,j!==0?p=Qi(j):_!==0&&(p=Qi(_));if(p===0)return 0;if(l!==0&&l!==p&&(l&v)===0&&(v=p&-p,_=l&-l,v>=_||v===16&&(_&4194240)!==0))return l;if((p&4)!==0&&(p|=h&16),l=i.entangledLanes,l!==0)for(i=i.entanglements,l&=p;0<l;)h=31-Zn(l),v=1<<h,p|=i[h],l&=~v;return p}function xp(i,l){switch(i){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hi(i,l){for(var h=i.suspendedLanes,p=i.pingedLanes,v=i.expirationTimes,_=i.pendingLanes;0<_;){var j=31-Zn(_),H=1<<j,Y=v[j];Y===-1?((H&h)===0||(H&p)!==0)&&(v[j]=xp(H,l)):Y<=l&&(i.expiredLanes|=H),_&=~H}}function Fr(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function ta(){var i=tl;return tl<<=1,(tl&4194240)===0&&(tl=64),i}function Yi(i){for(var l=[],h=0;31>h;h++)l.push(i);return l}function Xi(i,l,h){i.pendingLanes|=l,l!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,l=31-Zn(l),i[l]=h}function _t(i,l){var h=i.pendingLanes&~l;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=l,i.mutableReadLanes&=l,i.entangledLanes&=l,l=i.entanglements;var p=i.eventTimes;for(i=i.expirationTimes;0<h;){var v=31-Zn(h),_=1<<v;l[v]=0,p[v]=-1,i[v]=-1,h&=~_}}function Ji(i,l){var h=i.entangledLanes|=l;for(i=i.entanglements;h;){var p=31-Zn(h),v=1<<p;v&l|i[p]&l&&(i[p]|=l),h&=~v}}var it=0;function Zi(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var eh,rl,th,nh,rh,Uc=!1,zs=[],Tn=null,ws=null,bs=null,eo=new Map,ns=new Map,Us=[],vp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sh(i,l){switch(i){case"focusin":case"focusout":Tn=null;break;case"dragenter":case"dragleave":ws=null;break;case"mouseover":case"mouseout":bs=null;break;case"pointerover":case"pointerout":eo.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":ns.delete(l.pointerId)}}function br(i,l,h,p,v,_){return i===null||i.nativeEvent!==_?(i={blockedOn:l,domEventName:h,eventSystemFlags:p,nativeEvent:_,targetContainers:[v]},l!==null&&(l=nu(l),l!==null&&rl(l)),i):(i.eventSystemFlags|=p,l=i.targetContainers,v!==null&&l.indexOf(v)===-1&&l.push(v),i)}function wp(i,l,h,p,v){switch(l){case"focusin":return Tn=br(Tn,i,l,h,p,v),!0;case"dragenter":return ws=br(ws,i,l,h,p,v),!0;case"mouseover":return bs=br(bs,i,l,h,p,v),!0;case"pointerover":var _=v.pointerId;return eo.set(_,br(eo.get(_)||null,i,l,h,p,v)),!0;case"gotpointercapture":return _=v.pointerId,ns.set(_,br(ns.get(_)||null,i,l,h,p,v)),!0}return!1}function ih(i){var l=oa(i.target);if(l!==null){var h=xr(l);if(h!==null){if(l=h.tag,l===13){if(l=Fs(h),l!==null){i.blockedOn=l,rh(i.priority,function(){th(h)});return}}else if(l===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function fi(i){if(i.blockedOn!==null)return!1;for(var l=i.targetContainers;0<l.length;){var h=sl(i.domEventName,i.eventSystemFlags,l[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var p=new h.constructor(h.type,h);an=p,h.target.dispatchEvent(p),an=null}else return l=nu(h),l!==null&&rl(l),i.blockedOn=h,!1;l.shift()}return!0}function na(i,l,h){fi(i)&&h.delete(l)}function oh(){Uc=!1,Tn!==null&&fi(Tn)&&(Tn=null),ws!==null&&fi(ws)&&(ws=null),bs!==null&&fi(bs)&&(bs=null),eo.forEach(na),ns.forEach(na)}function _s(i,l){i.blockedOn===l&&(i.blockedOn=null,Uc||(Uc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,oh)))}function Ss(i){function l(v){return _s(v,i)}if(0<zs.length){_s(zs[0],i);for(var h=1;h<zs.length;h++){var p=zs[h];p.blockedOn===i&&(p.blockedOn=null)}}for(Tn!==null&&_s(Tn,i),ws!==null&&_s(ws,i),bs!==null&&_s(bs,i),eo.forEach(l),ns.forEach(l),h=0;h<Us.length;h++)p=Us[h],p.blockedOn===i&&(p.blockedOn=null);for(;0<Us.length&&(h=Us[0],h.blockedOn===null);)ih(h),h.blockedOn===null&&Us.shift()}var mi=W.ReactCurrentBatchConfig,to=!0;function jt(i,l,h,p){var v=it,_=mi.transition;mi.transition=null;try{it=1,Bc(i,l,h,p)}finally{it=v,mi.transition=_}}function bp(i,l,h,p){var v=it,_=mi.transition;mi.transition=null;try{it=4,Bc(i,l,h,p)}finally{it=v,mi.transition=_}}function Bc(i,l,h,p){if(to){var v=sl(i,l,h,p);if(v===null)Pp(i,l,p,ra,h),sh(i,p);else if(wp(v,i,l,h,p))p.stopPropagation();else if(sh(i,p),l&4&&-1<vp.indexOf(i)){for(;v!==null;){var _=nu(v);if(_!==null&&eh(_),_=sl(i,l,h,p),_===null&&Pp(i,l,p,ra,h),_===v)break;v=_}v!==null&&p.stopPropagation()}else Pp(i,l,p,null,h)}}var ra=null;function sl(i,l,h,p){if(ra=null,i=xs(p),i=oa(i),i!==null)if(l=xr(i),l===null)i=null;else if(h=l.tag,h===13){if(i=Fs(l),i!==null)return i;i=null}else if(h===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;i=null}else l!==i&&(i=null);return ra=i,null}function $c(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ln()){case En:return 1;case wr:return 4;case Ln:case $t:return 16;case Zo:return 536870912;default:return 16}default:return 16}}var Vr=null,il=null,_r=null;function qc(){if(_r)return _r;var i,l=il,h=l.length,p,v="value"in Vr?Vr.value:Vr.textContent,_=v.length;for(i=0;i<h&&l[i]===v[i];i++);var j=h-i;for(p=1;p<=j&&l[h-p]===v[_-p];p++);return _r=v.slice(i,1<p?1-p:void 0)}function ol(i){var l=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&l===13&&(i=13)):i=l,i===10&&(i=13),32<=i||i===13?i:0}function Bs(){return!0}function Hc(){return!1}function kn(i){function l(h,p,v,_,j){this._reactName=h,this._targetInst=v,this.type=p,this.nativeEvent=_,this.target=j,this.currentTarget=null;for(var H in i)i.hasOwnProperty(H)&&(h=i[H],this[H]=h?h(_):_[H]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?Bs:Hc,this.isPropagationStopped=Hc,this}return M(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Bs)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Bs)},persist:function(){},isPersistent:Bs}),l}var Is={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},al=kn(Is),$s=M({},Is,{view:0,detail:0}),_p=kn($s),ll,pi,no,sa=M({},$s,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qs,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==no&&(no&&i.type==="mousemove"?(ll=i.screenX-no.screenX,pi=i.screenY-no.screenY):pi=ll=0,no=i),ll)},movementY:function(i){return"movementY"in i?i.movementY:pi}}),cl=kn(sa),Wc=M({},sa,{dataTransfer:0}),ah=kn(Wc),ul=M({},$s,{relatedTarget:0}),dl=kn(ul),lh=M({},Is,{animationName:0,elapsedTime:0,pseudoElement:0}),gi=kn(lh),ch=M({},Is,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),uh=kn(ch),dh=M({},Is,{data:0}),Gc=kn(dh),hl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},er={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fh(i){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(i):(i=hh[i])?!!l[i]:!1}function qs(){return fh}var m=M({},$s,{key:function(i){if(i.key){var l=hl[i.key]||i.key;if(l!=="Unidentified")return l}return i.type==="keypress"?(i=ol(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?er[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qs,charCode:function(i){return i.type==="keypress"?ol(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?ol(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),b=kn(m),I=M({},sa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),O=kn(I),te=M({},$s,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qs}),ae=kn(te),Ie=M({},Is,{propertyName:0,elapsedTime:0,pseudoElement:0}),yt=kn(Ie),cn=M({},sa,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),lt=kn(cn),yn=[9,13,27,32],tn=u&&"CompositionEvent"in window,rs=null;u&&"documentMode"in document&&(rs=document.documentMode);var zr=u&&"TextEvent"in window&&!rs,ia=u&&(!tn||rs&&8<rs&&11>=rs),fl=" ",Pv=!1;function jv(i,l){switch(i){case"keyup":return yn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dv(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ml=!1;function g2(i,l){switch(i){case"compositionend":return Dv(l);case"keypress":return l.which!==32?null:(Pv=!0,fl);case"textInput":return i=l.data,i===fl&&Pv?null:i;default:return null}}function y2(i,l){if(ml)return i==="compositionend"||!tn&&jv(i,l)?(i=qc(),_r=il=Vr=null,ml=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return ia&&l.locale!=="ko"?null:l.data;default:return null}}var x2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mv(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l==="input"?!!x2[i.type]:l==="textarea"}function Lv(i,l,h,p){es(p),l=xh(l,"onChange"),0<l.length&&(h=new al("onChange","change",null,h,p),i.push({event:h,listeners:l}))}var Kc=null,Qc=null;function v2(i){ew(i,0)}function mh(i){var l=vl(i);if(Qn(l))return i}function w2(i,l){if(i==="change")return l}var Ov=!1;if(u){var Sp;if(u){var Ip="oninput"in document;if(!Ip){var Fv=document.createElement("div");Fv.setAttribute("oninput","return;"),Ip=typeof Fv.oninput=="function"}Sp=Ip}else Sp=!1;Ov=Sp&&(!document.documentMode||9<document.documentMode)}function Vv(){Kc&&(Kc.detachEvent("onpropertychange",zv),Qc=Kc=null)}function zv(i){if(i.propertyName==="value"&&mh(Qc)){var l=[];Lv(l,Qc,i,xs(i)),li(v2,l)}}function b2(i,l,h){i==="focusin"?(Vv(),Kc=l,Qc=h,Kc.attachEvent("onpropertychange",zv)):i==="focusout"&&Vv()}function _2(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return mh(Qc)}function S2(i,l){if(i==="click")return mh(l)}function I2(i,l){if(i==="input"||i==="change")return mh(l)}function E2(i,l){return i===l&&(i!==0||1/i===1/l)||i!==i&&l!==l}var Es=typeof Object.is=="function"?Object.is:E2;function Yc(i,l){if(Es(i,l))return!0;if(typeof i!="object"||i===null||typeof l!="object"||l===null)return!1;var h=Object.keys(i),p=Object.keys(l);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var v=h[p];if(!d.call(l,v)||!Es(i[v],l[v]))return!1}return!0}function Uv(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Bv(i,l){var h=Uv(i);i=0;for(var p;h;){if(h.nodeType===3){if(p=i+h.textContent.length,i<=l&&p>=l)return{node:h,offset:l-i};i=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Uv(h)}}function $v(i,l){return i&&l?i===l?!0:i&&i.nodeType===3?!1:l&&l.nodeType===3?$v(i,l.parentNode):"contains"in i?i.contains(l):i.compareDocumentPosition?!!(i.compareDocumentPosition(l)&16):!1:!1}function qv(){for(var i=window,l=Yn();l instanceof i.HTMLIFrameElement;){try{var h=typeof l.contentWindow.location.href=="string"}catch{h=!1}if(h)i=l.contentWindow;else break;l=Yn(i.document)}return l}function Ep(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l&&(l==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||l==="textarea"||i.contentEditable==="true")}function T2(i){var l=qv(),h=i.focusedElem,p=i.selectionRange;if(l!==h&&h&&h.ownerDocument&&$v(h.ownerDocument.documentElement,h)){if(p!==null&&Ep(h)){if(l=p.start,i=p.end,i===void 0&&(i=l),"selectionStart"in h)h.selectionStart=l,h.selectionEnd=Math.min(i,h.value.length);else if(i=(l=h.ownerDocument||document)&&l.defaultView||window,i.getSelection){i=i.getSelection();var v=h.textContent.length,_=Math.min(p.start,v);p=p.end===void 0?_:Math.min(p.end,v),!i.extend&&_>p&&(v=p,p=_,_=v),v=Bv(h,_);var j=Bv(h,p);v&&j&&(i.rangeCount!==1||i.anchorNode!==v.node||i.anchorOffset!==v.offset||i.focusNode!==j.node||i.focusOffset!==j.offset)&&(l=l.createRange(),l.setStart(v.node,v.offset),i.removeAllRanges(),_>p?(i.addRange(l),i.extend(j.node,j.offset)):(l.setEnd(j.node,j.offset),i.addRange(l)))}}for(l=[],i=h;i=i.parentNode;)i.nodeType===1&&l.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<l.length;h++)i=l[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var k2=u&&"documentMode"in document&&11>=document.documentMode,pl=null,Tp=null,Xc=null,kp=!1;function Hv(i,l,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;kp||pl==null||pl!==Yn(p)||(p=pl,"selectionStart"in p&&Ep(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Xc&&Yc(Xc,p)||(Xc=p,p=xh(Tp,"onSelect"),0<p.length&&(l=new al("onSelect","select",null,l,h),i.push({event:l,listeners:p}),l.target=pl)))}function ph(i,l){var h={};return h[i.toLowerCase()]=l.toLowerCase(),h["Webkit"+i]="webkit"+l,h["Moz"+i]="moz"+l,h}var gl={animationend:ph("Animation","AnimationEnd"),animationiteration:ph("Animation","AnimationIteration"),animationstart:ph("Animation","AnimationStart"),transitionend:ph("Transition","TransitionEnd")},Ap={},Wv={};u&&(Wv=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function gh(i){if(Ap[i])return Ap[i];if(!gl[i])return i;var l=gl[i],h;for(h in l)if(l.hasOwnProperty(h)&&h in Wv)return Ap[i]=l[h];return i}var Gv=gh("animationend"),Kv=gh("animationiteration"),Qv=gh("animationstart"),Yv=gh("transitionend"),Xv=new Map,Jv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ro(i,l){Xv.set(i,l),o(l,[i])}for(var Cp=0;Cp<Jv.length;Cp++){var Np=Jv[Cp],A2=Np.toLowerCase(),C2=Np[0].toUpperCase()+Np.slice(1);ro(A2,"on"+C2)}ro(Gv,"onAnimationEnd"),ro(Kv,"onAnimationIteration"),ro(Qv,"onAnimationStart"),ro("dblclick","onDoubleClick"),ro("focusin","onFocus"),ro("focusout","onBlur"),ro(Yv,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),N2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jc));function Zv(i,l,h){var p=i.type||"unknown-event";i.currentTarget=h,Jo(p,l,void 0,i),i.currentTarget=null}function ew(i,l){l=(l&4)!==0;for(var h=0;h<i.length;h++){var p=i[h],v=p.event;p=p.listeners;e:{var _=void 0;if(l)for(var j=p.length-1;0<=j;j--){var H=p[j],Y=H.instance,ie=H.currentTarget;if(H=H.listener,Y!==_&&v.isPropagationStopped())break e;Zv(v,H,ie),_=Y}else for(j=0;j<p.length;j++){if(H=p[j],Y=H.instance,ie=H.currentTarget,H=H.listener,Y!==_&&v.isPropagationStopped())break e;Zv(v,H,ie),_=Y}}}if(yr)throw i=di,yr=!1,di=null,i}function At(i,l){var h=l[Fp];h===void 0&&(h=l[Fp]=new Set);var p=i+"__bubble";h.has(p)||(tw(l,i,2,!1),h.add(p))}function Rp(i,l,h){var p=0;l&&(p|=4),tw(h,i,p,l)}var yh="_reactListening"+Math.random().toString(36).slice(2);function Zc(i){if(!i[yh]){i[yh]=!0,r.forEach(function(h){h!=="selectionchange"&&(N2.has(h)||Rp(h,!1,i),Rp(h,!0,i))});var l=i.nodeType===9?i:i.ownerDocument;l===null||l[yh]||(l[yh]=!0,Rp("selectionchange",!1,l))}}function tw(i,l,h,p){switch($c(l)){case 1:var v=jt;break;case 4:v=bp;break;default:v=Bc}h=v.bind(null,l,h,i),v=void 0,!ci||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(v=!0),p?v!==void 0?i.addEventListener(l,h,{capture:!0,passive:v}):i.addEventListener(l,h,!0):v!==void 0?i.addEventListener(l,h,{passive:v}):i.addEventListener(l,h,!1)}function Pp(i,l,h,p,v){var _=p;if((l&1)===0&&(l&2)===0&&p!==null)e:for(;;){if(p===null)return;var j=p.tag;if(j===3||j===4){var H=p.stateNode.containerInfo;if(H===v||H.nodeType===8&&H.parentNode===v)break;if(j===4)for(j=p.return;j!==null;){var Y=j.tag;if((Y===3||Y===4)&&(Y=j.stateNode.containerInfo,Y===v||Y.nodeType===8&&Y.parentNode===v))return;j=j.return}for(;H!==null;){if(j=oa(H),j===null)return;if(Y=j.tag,Y===5||Y===6){p=_=j;continue e}H=H.parentNode}}p=p.return}li(function(){var ie=_,pe=xs(h),ye=[];e:{var he=Xv.get(i);if(he!==void 0){var Te=al,Ne=i;switch(i){case"keypress":if(ol(h)===0)break e;case"keydown":case"keyup":Te=b;break;case"focusin":Ne="focus",Te=dl;break;case"focusout":Ne="blur",Te=dl;break;case"beforeblur":case"afterblur":Te=dl;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=cl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=ah;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=ae;break;case Gv:case Kv:case Qv:Te=gi;break;case Yv:Te=yt;break;case"scroll":Te=_p;break;case"wheel":Te=lt;break;case"copy":case"cut":case"paste":Te=uh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=O}var Pe=(l&4)!==0,Gt=!Pe&&i==="scroll",re=Pe?he!==null?he+"Capture":null:he;Pe=[];for(var J=ie,se;J!==null;){se=J;var we=se.stateNode;if(se.tag===5&&we!==null&&(se=we,re!==null&&(we=Pt(J,re),we!=null&&Pe.push(eu(J,we,se)))),Gt)break;J=J.return}0<Pe.length&&(he=new Te(he,Ne,null,h,pe),ye.push({event:he,listeners:Pe}))}}if((l&7)===0){e:{if(he=i==="mouseover"||i==="pointerover",Te=i==="mouseout"||i==="pointerout",he&&h!==an&&(Ne=h.relatedTarget||h.fromElement)&&(oa(Ne)||Ne[yi]))break e;if((Te||he)&&(he=pe.window===pe?pe:(he=pe.ownerDocument)?he.defaultView||he.parentWindow:window,Te?(Ne=h.relatedTarget||h.toElement,Te=ie,Ne=Ne?oa(Ne):null,Ne!==null&&(Gt=xr(Ne),Ne!==Gt||Ne.tag!==5&&Ne.tag!==6)&&(Ne=null)):(Te=null,Ne=ie),Te!==Ne)){if(Pe=cl,we="onMouseLeave",re="onMouseEnter",J="mouse",(i==="pointerout"||i==="pointerover")&&(Pe=O,we="onPointerLeave",re="onPointerEnter",J="pointer"),Gt=Te==null?he:vl(Te),se=Ne==null?he:vl(Ne),he=new Pe(we,J+"leave",Te,h,pe),he.target=Gt,he.relatedTarget=se,we=null,oa(pe)===ie&&(Pe=new Pe(re,J+"enter",Ne,h,pe),Pe.target=se,Pe.relatedTarget=Gt,we=Pe),Gt=we,Te&&Ne)t:{for(Pe=Te,re=Ne,J=0,se=Pe;se;se=yl(se))J++;for(se=0,we=re;we;we=yl(we))se++;for(;0<J-se;)Pe=yl(Pe),J--;for(;0<se-J;)re=yl(re),se--;for(;J--;){if(Pe===re||re!==null&&Pe===re.alternate)break t;Pe=yl(Pe),re=yl(re)}Pe=null}else Pe=null;Te!==null&&nw(ye,he,Te,Pe,!1),Ne!==null&&Gt!==null&&nw(ye,Gt,Ne,Pe,!0)}}e:{if(he=ie?vl(ie):window,Te=he.nodeName&&he.nodeName.toLowerCase(),Te==="select"||Te==="input"&&he.type==="file")var De=w2;else if(Mv(he))if(Ov)De=I2;else{De=_2;var Ve=b2}else(Te=he.nodeName)&&Te.toLowerCase()==="input"&&(he.type==="checkbox"||he.type==="radio")&&(De=S2);if(De&&(De=De(i,ie))){Lv(ye,De,h,pe);break e}Ve&&Ve(i,he,ie),i==="focusout"&&(Ve=he._wrapperState)&&Ve.controlled&&he.type==="number"&&ur(he,"number",he.value)}switch(Ve=ie?vl(ie):window,i){case"focusin":(Mv(Ve)||Ve.contentEditable==="true")&&(pl=Ve,Tp=ie,Xc=null);break;case"focusout":Xc=Tp=pl=null;break;case"mousedown":kp=!0;break;case"contextmenu":case"mouseup":case"dragend":kp=!1,Hv(ye,h,pe);break;case"selectionchange":if(k2)break;case"keydown":case"keyup":Hv(ye,h,pe)}var ze;if(tn)e:{switch(i){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else ml?jv(i,h)&&(qe="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(qe="onCompositionStart");qe&&(ia&&h.locale!=="ko"&&(ml||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&ml&&(ze=qc()):(Vr=pe,il="value"in Vr?Vr.value:Vr.textContent,ml=!0)),Ve=xh(ie,qe),0<Ve.length&&(qe=new Gc(qe,i,null,h,pe),ye.push({event:qe,listeners:Ve}),ze?qe.data=ze:(ze=Dv(h),ze!==null&&(qe.data=ze)))),(ze=zr?g2(i,h):y2(i,h))&&(ie=xh(ie,"onBeforeInput"),0<ie.length&&(pe=new Gc("onBeforeInput","beforeinput",null,h,pe),ye.push({event:pe,listeners:ie}),pe.data=ze))}ew(ye,l)})}function eu(i,l,h){return{instance:i,listener:l,currentTarget:h}}function xh(i,l){for(var h=l+"Capture",p=[];i!==null;){var v=i,_=v.stateNode;v.tag===5&&_!==null&&(v=_,_=Pt(i,h),_!=null&&p.unshift(eu(i,_,v)),_=Pt(i,l),_!=null&&p.push(eu(i,_,v))),i=i.return}return p}function yl(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function nw(i,l,h,p,v){for(var _=l._reactName,j=[];h!==null&&h!==p;){var H=h,Y=H.alternate,ie=H.stateNode;if(Y!==null&&Y===p)break;H.tag===5&&ie!==null&&(H=ie,v?(Y=Pt(h,_),Y!=null&&j.unshift(eu(h,Y,H))):v||(Y=Pt(h,_),Y!=null&&j.push(eu(h,Y,H)))),h=h.return}j.length!==0&&i.push({event:l,listeners:j})}var R2=/\r\n?/g,P2=/\u0000|\uFFFD/g;function rw(i){return(typeof i=="string"?i:""+i).replace(R2,`
`).replace(P2,"")}function vh(i,l,h){if(l=rw(l),rw(i)!==l&&h)throw Error(t(425))}function wh(){}var jp=null,Dp=null;function Mp(i,l){return i==="textarea"||i==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Lp=typeof setTimeout=="function"?setTimeout:void 0,j2=typeof clearTimeout=="function"?clearTimeout:void 0,sw=typeof Promise=="function"?Promise:void 0,D2=typeof queueMicrotask=="function"?queueMicrotask:typeof sw<"u"?function(i){return sw.resolve(null).then(i).catch(M2)}:Lp;function M2(i){setTimeout(function(){throw i})}function Op(i,l){var h=l,p=0;do{var v=h.nextSibling;if(i.removeChild(h),v&&v.nodeType===8)if(h=v.data,h==="/$"){if(p===0){i.removeChild(v),Ss(l);return}p--}else h!=="$"&&h!=="$?"&&h!=="$!"||p++;h=v}while(h);Ss(l)}function so(i){for(;i!=null;i=i.nextSibling){var l=i.nodeType;if(l===1||l===3)break;if(l===8){if(l=i.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return i}function iw(i){i=i.previousSibling;for(var l=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(l===0)return i;l--}else h==="/$"&&l++}i=i.previousSibling}return null}var xl=Math.random().toString(36).slice(2),Hs="__reactFiber$"+xl,tu="__reactProps$"+xl,yi="__reactContainer$"+xl,Fp="__reactEvents$"+xl,L2="__reactListeners$"+xl,O2="__reactHandles$"+xl;function oa(i){var l=i[Hs];if(l)return l;for(var h=i.parentNode;h;){if(l=h[yi]||h[Hs]){if(h=l.alternate,l.child!==null||h!==null&&h.child!==null)for(i=iw(i);i!==null;){if(h=i[Hs])return h;i=iw(i)}return l}i=h,h=i.parentNode}return null}function nu(i){return i=i[Hs]||i[yi],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function vl(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function bh(i){return i[tu]||null}var Vp=[],wl=-1;function io(i){return{current:i}}function Ct(i){0>wl||(i.current=Vp[wl],Vp[wl]=null,wl--)}function Et(i,l){wl++,Vp[wl]=i.current,i.current=l}var oo={},On=io(oo),Sr=io(!1),aa=oo;function bl(i,l){var h=i.type.contextTypes;if(!h)return oo;var p=i.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===l)return p.__reactInternalMemoizedMaskedChildContext;var v={},_;for(_ in h)v[_]=l[_];return p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=l,i.__reactInternalMemoizedMaskedChildContext=v),v}function Ir(i){return i=i.childContextTypes,i!=null}function _h(){Ct(Sr),Ct(On)}function ow(i,l,h){if(On.current!==oo)throw Error(t(168));Et(On,l),Et(Sr,h)}function aw(i,l,h){var p=i.stateNode;if(l=l.childContextTypes,typeof p.getChildContext!="function")return h;p=p.getChildContext();for(var v in p)if(!(v in l))throw Error(t(108,Be(i)||"Unknown",v));return M({},h,p)}function Sh(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||oo,aa=On.current,Et(On,i),Et(Sr,Sr.current),!0}function lw(i,l,h){var p=i.stateNode;if(!p)throw Error(t(169));h?(i=aw(i,l,aa),p.__reactInternalMemoizedMergedChildContext=i,Ct(Sr),Ct(On),Et(On,i)):Ct(Sr),Et(Sr,h)}var xi=null,Ih=!1,zp=!1;function cw(i){xi===null?xi=[i]:xi.push(i)}function F2(i){Ih=!0,cw(i)}function ao(){if(!zp&&xi!==null){zp=!0;var i=0,l=it;try{var h=xi;for(it=1;i<h.length;i++){var p=h[i];do p=p(!0);while(p!==null)}xi=null,Ih=!1}catch(v){throw xi!==null&&(xi=xi.slice(i+1)),ge(En,ao),v}finally{it=l,zp=!1}}return null}var _l=[],Sl=0,Eh=null,Th=0,ss=[],is=0,la=null,vi=1,wi="";function ca(i,l){_l[Sl++]=Th,_l[Sl++]=Eh,Eh=i,Th=l}function uw(i,l,h){ss[is++]=vi,ss[is++]=wi,ss[is++]=la,la=i;var p=vi;i=wi;var v=32-Zn(p)-1;p&=~(1<<v),h+=1;var _=32-Zn(l)+v;if(30<_){var j=v-v%5;_=(p&(1<<j)-1).toString(32),p>>=j,v-=j,vi=1<<32-Zn(l)+v|h<<v|p,wi=_+i}else vi=1<<_|h<<v|p,wi=i}function Up(i){i.return!==null&&(ca(i,1),uw(i,1,0))}function Bp(i){for(;i===Eh;)Eh=_l[--Sl],_l[Sl]=null,Th=_l[--Sl],_l[Sl]=null;for(;i===la;)la=ss[--is],ss[is]=null,wi=ss[--is],ss[is]=null,vi=ss[--is],ss[is]=null}var Ur=null,Br=null,Dt=!1,Ts=null;function dw(i,l){var h=cs(5,null,null,0);h.elementType="DELETED",h.stateNode=l,h.return=i,l=i.deletions,l===null?(i.deletions=[h],i.flags|=16):l.push(h)}function hw(i,l){switch(i.tag){case 5:var h=i.type;return l=l.nodeType!==1||h.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(i.stateNode=l,Ur=i,Br=so(l.firstChild),!0):!1;case 6:return l=i.pendingProps===""||l.nodeType!==3?null:l,l!==null?(i.stateNode=l,Ur=i,Br=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(h=la!==null?{id:vi,overflow:wi}:null,i.memoizedState={dehydrated:l,treeContext:h,retryLane:1073741824},h=cs(18,null,null,0),h.stateNode=l,h.return=i,i.child=h,Ur=i,Br=null,!0):!1;default:return!1}}function $p(i){return(i.mode&1)!==0&&(i.flags&128)===0}function qp(i){if(Dt){var l=Br;if(l){var h=l;if(!hw(i,l)){if($p(i))throw Error(t(418));l=so(h.nextSibling);var p=Ur;l&&hw(i,l)?dw(p,h):(i.flags=i.flags&-4097|2,Dt=!1,Ur=i)}}else{if($p(i))throw Error(t(418));i.flags=i.flags&-4097|2,Dt=!1,Ur=i}}}function fw(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Ur=i}function kh(i){if(i!==Ur)return!1;if(!Dt)return fw(i),Dt=!0,!1;var l;if((l=i.tag!==3)&&!(l=i.tag!==5)&&(l=i.type,l=l!=="head"&&l!=="body"&&!Mp(i.type,i.memoizedProps)),l&&(l=Br)){if($p(i))throw mw(),Error(t(418));for(;l;)dw(i,l),l=so(l.nextSibling)}if(fw(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,l=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(l===0){Br=so(i.nextSibling);break e}l--}else h!=="$"&&h!=="$!"&&h!=="$?"||l++}i=i.nextSibling}Br=null}}else Br=Ur?so(i.stateNode.nextSibling):null;return!0}function mw(){for(var i=Br;i;)i=so(i.nextSibling)}function Il(){Br=Ur=null,Dt=!1}function Hp(i){Ts===null?Ts=[i]:Ts.push(i)}var V2=W.ReactCurrentBatchConfig;function ru(i,l,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var p=h.stateNode}if(!p)throw Error(t(147,i));var v=p,_=""+i;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===_?l.ref:(l=function(j){var H=v.refs;j===null?delete H[_]:H[_]=j},l._stringRef=_,l)}if(typeof i!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,i))}return i}function Ah(i,l){throw i=Object.prototype.toString.call(l),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":i))}function pw(i){var l=i._init;return l(i._payload)}function gw(i){function l(re,J){if(i){var se=re.deletions;se===null?(re.deletions=[J],re.flags|=16):se.push(J)}}function h(re,J){if(!i)return null;for(;J!==null;)l(re,J),J=J.sibling;return null}function p(re,J){for(re=new Map;J!==null;)J.key!==null?re.set(J.key,J):re.set(J.index,J),J=J.sibling;return re}function v(re,J){return re=go(re,J),re.index=0,re.sibling=null,re}function _(re,J,se){return re.index=se,i?(se=re.alternate,se!==null?(se=se.index,se<J?(re.flags|=2,J):se):(re.flags|=2,J)):(re.flags|=1048576,J)}function j(re){return i&&re.alternate===null&&(re.flags|=2),re}function H(re,J,se,we){return J===null||J.tag!==6?(J=Lg(se,re.mode,we),J.return=re,J):(J=v(J,se),J.return=re,J)}function Y(re,J,se,we){var De=se.type;return De===R?pe(re,J,se.props.children,we,se.key):J!==null&&(J.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===ce&&pw(De)===J.type)?(we=v(J,se.props),we.ref=ru(re,J,se),we.return=re,we):(we=Jh(se.type,se.key,se.props,null,re.mode,we),we.ref=ru(re,J,se),we.return=re,we)}function ie(re,J,se,we){return J===null||J.tag!==4||J.stateNode.containerInfo!==se.containerInfo||J.stateNode.implementation!==se.implementation?(J=Og(se,re.mode,we),J.return=re,J):(J=v(J,se.children||[]),J.return=re,J)}function pe(re,J,se,we,De){return J===null||J.tag!==7?(J=ya(se,re.mode,we,De),J.return=re,J):(J=v(J,se),J.return=re,J)}function ye(re,J,se){if(typeof J=="string"&&J!==""||typeof J=="number")return J=Lg(""+J,re.mode,se),J.return=re,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case $:return se=Jh(J.type,J.key,J.props,null,re.mode,se),se.ref=ru(re,null,J),se.return=re,se;case F:return J=Og(J,re.mode,se),J.return=re,J;case ce:var we=J._init;return ye(re,we(J._payload),se)}if(Jn(J)||Z(J))return J=ya(J,re.mode,se,null),J.return=re,J;Ah(re,J)}return null}function he(re,J,se,we){var De=J!==null?J.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return De!==null?null:H(re,J,""+se,we);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case $:return se.key===De?Y(re,J,se,we):null;case F:return se.key===De?ie(re,J,se,we):null;case ce:return De=se._init,he(re,J,De(se._payload),we)}if(Jn(se)||Z(se))return De!==null?null:pe(re,J,se,we,null);Ah(re,se)}return null}function Te(re,J,se,we,De){if(typeof we=="string"&&we!==""||typeof we=="number")return re=re.get(se)||null,H(J,re,""+we,De);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case $:return re=re.get(we.key===null?se:we.key)||null,Y(J,re,we,De);case F:return re=re.get(we.key===null?se:we.key)||null,ie(J,re,we,De);case ce:var Ve=we._init;return Te(re,J,se,Ve(we._payload),De)}if(Jn(we)||Z(we))return re=re.get(se)||null,pe(J,re,we,De,null);Ah(J,we)}return null}function Ne(re,J,se,we){for(var De=null,Ve=null,ze=J,qe=J=0,wn=null;ze!==null&&qe<se.length;qe++){ze.index>qe?(wn=ze,ze=null):wn=ze.sibling;var ht=he(re,ze,se[qe],we);if(ht===null){ze===null&&(ze=wn);break}i&&ze&&ht.alternate===null&&l(re,ze),J=_(ht,J,qe),Ve===null?De=ht:Ve.sibling=ht,Ve=ht,ze=wn}if(qe===se.length)return h(re,ze),Dt&&ca(re,qe),De;if(ze===null){for(;qe<se.length;qe++)ze=ye(re,se[qe],we),ze!==null&&(J=_(ze,J,qe),Ve===null?De=ze:Ve.sibling=ze,Ve=ze);return Dt&&ca(re,qe),De}for(ze=p(re,ze);qe<se.length;qe++)wn=Te(ze,re,qe,se[qe],we),wn!==null&&(i&&wn.alternate!==null&&ze.delete(wn.key===null?qe:wn.key),J=_(wn,J,qe),Ve===null?De=wn:Ve.sibling=wn,Ve=wn);return i&&ze.forEach(function(yo){return l(re,yo)}),Dt&&ca(re,qe),De}function Pe(re,J,se,we){var De=Z(se);if(typeof De!="function")throw Error(t(150));if(se=De.call(se),se==null)throw Error(t(151));for(var Ve=De=null,ze=J,qe=J=0,wn=null,ht=se.next();ze!==null&&!ht.done;qe++,ht=se.next()){ze.index>qe?(wn=ze,ze=null):wn=ze.sibling;var yo=he(re,ze,ht.value,we);if(yo===null){ze===null&&(ze=wn);break}i&&ze&&yo.alternate===null&&l(re,ze),J=_(yo,J,qe),Ve===null?De=yo:Ve.sibling=yo,Ve=yo,ze=wn}if(ht.done)return h(re,ze),Dt&&ca(re,qe),De;if(ze===null){for(;!ht.done;qe++,ht=se.next())ht=ye(re,ht.value,we),ht!==null&&(J=_(ht,J,qe),Ve===null?De=ht:Ve.sibling=ht,Ve=ht);return Dt&&ca(re,qe),De}for(ze=p(re,ze);!ht.done;qe++,ht=se.next())ht=Te(ze,re,qe,ht.value,we),ht!==null&&(i&&ht.alternate!==null&&ze.delete(ht.key===null?qe:ht.key),J=_(ht,J,qe),Ve===null?De=ht:Ve.sibling=ht,Ve=ht);return i&&ze.forEach(function(xC){return l(re,xC)}),Dt&&ca(re,qe),De}function Gt(re,J,se,we){if(typeof se=="object"&&se!==null&&se.type===R&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case $:e:{for(var De=se.key,Ve=J;Ve!==null;){if(Ve.key===De){if(De=se.type,De===R){if(Ve.tag===7){h(re,Ve.sibling),J=v(Ve,se.props.children),J.return=re,re=J;break e}}else if(Ve.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===ce&&pw(De)===Ve.type){h(re,Ve.sibling),J=v(Ve,se.props),J.ref=ru(re,Ve,se),J.return=re,re=J;break e}h(re,Ve);break}else l(re,Ve);Ve=Ve.sibling}se.type===R?(J=ya(se.props.children,re.mode,we,se.key),J.return=re,re=J):(we=Jh(se.type,se.key,se.props,null,re.mode,we),we.ref=ru(re,J,se),we.return=re,re=we)}return j(re);case F:e:{for(Ve=se.key;J!==null;){if(J.key===Ve)if(J.tag===4&&J.stateNode.containerInfo===se.containerInfo&&J.stateNode.implementation===se.implementation){h(re,J.sibling),J=v(J,se.children||[]),J.return=re,re=J;break e}else{h(re,J);break}else l(re,J);J=J.sibling}J=Og(se,re.mode,we),J.return=re,re=J}return j(re);case ce:return Ve=se._init,Gt(re,J,Ve(se._payload),we)}if(Jn(se))return Ne(re,J,se,we);if(Z(se))return Pe(re,J,se,we);Ah(re,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,J!==null&&J.tag===6?(h(re,J.sibling),J=v(J,se),J.return=re,re=J):(h(re,J),J=Lg(se,re.mode,we),J.return=re,re=J),j(re)):h(re,J)}return Gt}var El=gw(!0),yw=gw(!1),Ch=io(null),Nh=null,Tl=null,Wp=null;function Gp(){Wp=Tl=Nh=null}function Kp(i){var l=Ch.current;Ct(Ch),i._currentValue=l}function Qp(i,l,h){for(;i!==null;){var p=i.alternate;if((i.childLanes&l)!==l?(i.childLanes|=l,p!==null&&(p.childLanes|=l)):p!==null&&(p.childLanes&l)!==l&&(p.childLanes|=l),i===h)break;i=i.return}}function kl(i,l){Nh=i,Wp=Tl=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&l)!==0&&(Er=!0),i.firstContext=null)}function os(i){var l=i._currentValue;if(Wp!==i)if(i={context:i,memoizedValue:l,next:null},Tl===null){if(Nh===null)throw Error(t(308));Tl=i,Nh.dependencies={lanes:0,firstContext:i}}else Tl=Tl.next=i;return l}var ua=null;function Yp(i){ua===null?ua=[i]:ua.push(i)}function xw(i,l,h,p){var v=l.interleaved;return v===null?(h.next=h,Yp(l)):(h.next=v.next,v.next=h),l.interleaved=h,bi(i,p)}function bi(i,l){i.lanes|=l;var h=i.alternate;for(h!==null&&(h.lanes|=l),h=i,i=i.return;i!==null;)i.childLanes|=l,h=i.alternate,h!==null&&(h.childLanes|=l),h=i,i=i.return;return h.tag===3?h.stateNode:null}var lo=!1;function Xp(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vw(i,l){i=i.updateQueue,l.updateQueue===i&&(l.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function _i(i,l){return{eventTime:i,lane:l,tag:0,payload:null,callback:null,next:null}}function co(i,l,h){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(dt&2)!==0){var v=p.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),p.pending=l,bi(i,h)}return v=p.interleaved,v===null?(l.next=l,Yp(p)):(l.next=v.next,v.next=l),p.interleaved=l,bi(i,h)}function Rh(i,l,h){if(l=l.updateQueue,l!==null&&(l=l.shared,(h&4194240)!==0)){var p=l.lanes;p&=i.pendingLanes,h|=p,l.lanes=h,Ji(i,h)}}function ww(i,l){var h=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var v=null,_=null;if(h=h.firstBaseUpdate,h!==null){do{var j={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};_===null?v=_=j:_=_.next=j,h=h.next}while(h!==null);_===null?v=_=l:_=_.next=l}else v=_=l;h={baseState:p.baseState,firstBaseUpdate:v,lastBaseUpdate:_,shared:p.shared,effects:p.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=l:i.next=l,h.lastBaseUpdate=l}function Ph(i,l,h,p){var v=i.updateQueue;lo=!1;var _=v.firstBaseUpdate,j=v.lastBaseUpdate,H=v.shared.pending;if(H!==null){v.shared.pending=null;var Y=H,ie=Y.next;Y.next=null,j===null?_=ie:j.next=ie,j=Y;var pe=i.alternate;pe!==null&&(pe=pe.updateQueue,H=pe.lastBaseUpdate,H!==j&&(H===null?pe.firstBaseUpdate=ie:H.next=ie,pe.lastBaseUpdate=Y))}if(_!==null){var ye=v.baseState;j=0,pe=ie=Y=null,H=_;do{var he=H.lane,Te=H.eventTime;if((p&he)===he){pe!==null&&(pe=pe.next={eventTime:Te,lane:0,tag:H.tag,payload:H.payload,callback:H.callback,next:null});e:{var Ne=i,Pe=H;switch(he=l,Te=h,Pe.tag){case 1:if(Ne=Pe.payload,typeof Ne=="function"){ye=Ne.call(Te,ye,he);break e}ye=Ne;break e;case 3:Ne.flags=Ne.flags&-65537|128;case 0:if(Ne=Pe.payload,he=typeof Ne=="function"?Ne.call(Te,ye,he):Ne,he==null)break e;ye=M({},ye,he);break e;case 2:lo=!0}}H.callback!==null&&H.lane!==0&&(i.flags|=64,he=v.effects,he===null?v.effects=[H]:he.push(H))}else Te={eventTime:Te,lane:he,tag:H.tag,payload:H.payload,callback:H.callback,next:null},pe===null?(ie=pe=Te,Y=ye):pe=pe.next=Te,j|=he;if(H=H.next,H===null){if(H=v.shared.pending,H===null)break;he=H,H=he.next,he.next=null,v.lastBaseUpdate=he,v.shared.pending=null}}while(!0);if(pe===null&&(Y=ye),v.baseState=Y,v.firstBaseUpdate=ie,v.lastBaseUpdate=pe,l=v.shared.interleaved,l!==null){v=l;do j|=v.lane,v=v.next;while(v!==l)}else _===null&&(v.shared.lanes=0);fa|=j,i.lanes=j,i.memoizedState=ye}}function bw(i,l,h){if(i=l.effects,l.effects=null,i!==null)for(l=0;l<i.length;l++){var p=i[l],v=p.callback;if(v!==null){if(p.callback=null,p=h,typeof v!="function")throw Error(t(191,v));v.call(p)}}}var su={},Ws=io(su),iu=io(su),ou=io(su);function da(i){if(i===su)throw Error(t(174));return i}function Jp(i,l){switch(Et(ou,l),Et(iu,i),Et(Ws,su),i=l.nodeType,i){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:fe(null,"");break;default:i=i===8?l.parentNode:l,l=i.namespaceURI||null,i=i.tagName,l=fe(l,i)}Ct(Ws),Et(Ws,l)}function Al(){Ct(Ws),Ct(iu),Ct(ou)}function _w(i){da(ou.current);var l=da(Ws.current),h=fe(l,i.type);l!==h&&(Et(iu,i),Et(Ws,h))}function Zp(i){iu.current===i&&(Ct(Ws),Ct(iu))}var Vt=io(0);function jh(i){for(var l=i;l!==null;){if(l.tag===13){var h=l.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var eg=[];function tg(){for(var i=0;i<eg.length;i++)eg[i]._workInProgressVersionPrimary=null;eg.length=0}var Dh=W.ReactCurrentDispatcher,ng=W.ReactCurrentBatchConfig,ha=0,zt=null,un=null,xn=null,Mh=!1,au=!1,lu=0,z2=0;function Fn(){throw Error(t(321))}function rg(i,l){if(l===null)return!1;for(var h=0;h<l.length&&h<i.length;h++)if(!Es(i[h],l[h]))return!1;return!0}function sg(i,l,h,p,v,_){if(ha=_,zt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Dh.current=i===null||i.memoizedState===null?q2:H2,i=h(p,v),au){_=0;do{if(au=!1,lu=0,25<=_)throw Error(t(301));_+=1,xn=un=null,l.updateQueue=null,Dh.current=W2,i=h(p,v)}while(au)}if(Dh.current=Fh,l=un!==null&&un.next!==null,ha=0,xn=un=zt=null,Mh=!1,l)throw Error(t(300));return i}function ig(){var i=lu!==0;return lu=0,i}function Gs(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?zt.memoizedState=xn=i:xn=xn.next=i,xn}function as(){if(un===null){var i=zt.alternate;i=i!==null?i.memoizedState:null}else i=un.next;var l=xn===null?zt.memoizedState:xn.next;if(l!==null)xn=l,un=i;else{if(i===null)throw Error(t(310));un=i,i={memoizedState:un.memoizedState,baseState:un.baseState,baseQueue:un.baseQueue,queue:un.queue,next:null},xn===null?zt.memoizedState=xn=i:xn=xn.next=i}return xn}function cu(i,l){return typeof l=="function"?l(i):l}function og(i){var l=as(),h=l.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=i;var p=un,v=p.baseQueue,_=h.pending;if(_!==null){if(v!==null){var j=v.next;v.next=_.next,_.next=j}p.baseQueue=v=_,h.pending=null}if(v!==null){_=v.next,p=p.baseState;var H=j=null,Y=null,ie=_;do{var pe=ie.lane;if((ha&pe)===pe)Y!==null&&(Y=Y.next={lane:0,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),p=ie.hasEagerState?ie.eagerState:i(p,ie.action);else{var ye={lane:pe,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null};Y===null?(H=Y=ye,j=p):Y=Y.next=ye,zt.lanes|=pe,fa|=pe}ie=ie.next}while(ie!==null&&ie!==_);Y===null?j=p:Y.next=H,Es(p,l.memoizedState)||(Er=!0),l.memoizedState=p,l.baseState=j,l.baseQueue=Y,h.lastRenderedState=p}if(i=h.interleaved,i!==null){v=i;do _=v.lane,zt.lanes|=_,fa|=_,v=v.next;while(v!==i)}else v===null&&(h.lanes=0);return[l.memoizedState,h.dispatch]}function ag(i){var l=as(),h=l.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=i;var p=h.dispatch,v=h.pending,_=l.memoizedState;if(v!==null){h.pending=null;var j=v=v.next;do _=i(_,j.action),j=j.next;while(j!==v);Es(_,l.memoizedState)||(Er=!0),l.memoizedState=_,l.baseQueue===null&&(l.baseState=_),h.lastRenderedState=_}return[_,p]}function Sw(){}function Iw(i,l){var h=zt,p=as(),v=l(),_=!Es(p.memoizedState,v);if(_&&(p.memoizedState=v,Er=!0),p=p.queue,lg(kw.bind(null,h,p,i),[i]),p.getSnapshot!==l||_||xn!==null&&xn.memoizedState.tag&1){if(h.flags|=2048,uu(9,Tw.bind(null,h,p,v,l),void 0,null),vn===null)throw Error(t(349));(ha&30)!==0||Ew(h,l,v)}return v}function Ew(i,l,h){i.flags|=16384,i={getSnapshot:l,value:h},l=zt.updateQueue,l===null?(l={lastEffect:null,stores:null},zt.updateQueue=l,l.stores=[i]):(h=l.stores,h===null?l.stores=[i]:h.push(i))}function Tw(i,l,h,p){l.value=h,l.getSnapshot=p,Aw(l)&&Cw(i)}function kw(i,l,h){return h(function(){Aw(l)&&Cw(i)})}function Aw(i){var l=i.getSnapshot;i=i.value;try{var h=l();return!Es(i,h)}catch{return!0}}function Cw(i){var l=bi(i,1);l!==null&&Ns(l,i,1,-1)}function Nw(i){var l=Gs();return typeof i=="function"&&(i=i()),l.memoizedState=l.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cu,lastRenderedState:i},l.queue=i,i=i.dispatch=$2.bind(null,zt,i),[l.memoizedState,i]}function uu(i,l,h,p){return i={tag:i,create:l,destroy:h,deps:p,next:null},l=zt.updateQueue,l===null?(l={lastEffect:null,stores:null},zt.updateQueue=l,l.lastEffect=i.next=i):(h=l.lastEffect,h===null?l.lastEffect=i.next=i:(p=h.next,h.next=i,i.next=p,l.lastEffect=i)),i}function Rw(){return as().memoizedState}function Lh(i,l,h,p){var v=Gs();zt.flags|=i,v.memoizedState=uu(1|l,h,void 0,p===void 0?null:p)}function Oh(i,l,h,p){var v=as();p=p===void 0?null:p;var _=void 0;if(un!==null){var j=un.memoizedState;if(_=j.destroy,p!==null&&rg(p,j.deps)){v.memoizedState=uu(l,h,_,p);return}}zt.flags|=i,v.memoizedState=uu(1|l,h,_,p)}function Pw(i,l){return Lh(8390656,8,i,l)}function lg(i,l){return Oh(2048,8,i,l)}function jw(i,l){return Oh(4,2,i,l)}function Dw(i,l){return Oh(4,4,i,l)}function Mw(i,l){if(typeof l=="function")return i=i(),l(i),function(){l(null)};if(l!=null)return i=i(),l.current=i,function(){l.current=null}}function Lw(i,l,h){return h=h!=null?h.concat([i]):null,Oh(4,4,Mw.bind(null,l,i),h)}function cg(){}function Ow(i,l){var h=as();l=l===void 0?null:l;var p=h.memoizedState;return p!==null&&l!==null&&rg(l,p[1])?p[0]:(h.memoizedState=[i,l],i)}function Fw(i,l){var h=as();l=l===void 0?null:l;var p=h.memoizedState;return p!==null&&l!==null&&rg(l,p[1])?p[0]:(i=i(),h.memoizedState=[i,l],i)}function Vw(i,l,h){return(ha&21)===0?(i.baseState&&(i.baseState=!1,Er=!0),i.memoizedState=h):(Es(h,l)||(h=ta(),zt.lanes|=h,fa|=h,i.baseState=!0),l)}function U2(i,l){var h=it;it=h!==0&&4>h?h:4,i(!0);var p=ng.transition;ng.transition={};try{i(!1),l()}finally{it=h,ng.transition=p}}function zw(){return as().memoizedState}function B2(i,l,h){var p=mo(i);if(h={lane:p,action:h,hasEagerState:!1,eagerState:null,next:null},Uw(i))Bw(l,h);else if(h=xw(i,l,h,p),h!==null){var v=nr();Ns(h,i,p,v),$w(h,l,p)}}function $2(i,l,h){var p=mo(i),v={lane:p,action:h,hasEagerState:!1,eagerState:null,next:null};if(Uw(i))Bw(l,v);else{var _=i.alternate;if(i.lanes===0&&(_===null||_.lanes===0)&&(_=l.lastRenderedReducer,_!==null))try{var j=l.lastRenderedState,H=_(j,h);if(v.hasEagerState=!0,v.eagerState=H,Es(H,j)){var Y=l.interleaved;Y===null?(v.next=v,Yp(l)):(v.next=Y.next,Y.next=v),l.interleaved=v;return}}catch{}finally{}h=xw(i,l,v,p),h!==null&&(v=nr(),Ns(h,i,p,v),$w(h,l,p))}}function Uw(i){var l=i.alternate;return i===zt||l!==null&&l===zt}function Bw(i,l){au=Mh=!0;var h=i.pending;h===null?l.next=l:(l.next=h.next,h.next=l),i.pending=l}function $w(i,l,h){if((h&4194240)!==0){var p=l.lanes;p&=i.pendingLanes,h|=p,l.lanes=h,Ji(i,h)}}var Fh={readContext:os,useCallback:Fn,useContext:Fn,useEffect:Fn,useImperativeHandle:Fn,useInsertionEffect:Fn,useLayoutEffect:Fn,useMemo:Fn,useReducer:Fn,useRef:Fn,useState:Fn,useDebugValue:Fn,useDeferredValue:Fn,useTransition:Fn,useMutableSource:Fn,useSyncExternalStore:Fn,useId:Fn,unstable_isNewReconciler:!1},q2={readContext:os,useCallback:function(i,l){return Gs().memoizedState=[i,l===void 0?null:l],i},useContext:os,useEffect:Pw,useImperativeHandle:function(i,l,h){return h=h!=null?h.concat([i]):null,Lh(4194308,4,Mw.bind(null,l,i),h)},useLayoutEffect:function(i,l){return Lh(4194308,4,i,l)},useInsertionEffect:function(i,l){return Lh(4,2,i,l)},useMemo:function(i,l){var h=Gs();return l=l===void 0?null:l,i=i(),h.memoizedState=[i,l],i},useReducer:function(i,l,h){var p=Gs();return l=h!==void 0?h(l):l,p.memoizedState=p.baseState=l,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:l},p.queue=i,i=i.dispatch=B2.bind(null,zt,i),[p.memoizedState,i]},useRef:function(i){var l=Gs();return i={current:i},l.memoizedState=i},useState:Nw,useDebugValue:cg,useDeferredValue:function(i){return Gs().memoizedState=i},useTransition:function(){var i=Nw(!1),l=i[0];return i=U2.bind(null,i[1]),Gs().memoizedState=i,[l,i]},useMutableSource:function(){},useSyncExternalStore:function(i,l,h){var p=zt,v=Gs();if(Dt){if(h===void 0)throw Error(t(407));h=h()}else{if(h=l(),vn===null)throw Error(t(349));(ha&30)!==0||Ew(p,l,h)}v.memoizedState=h;var _={value:h,getSnapshot:l};return v.queue=_,Pw(kw.bind(null,p,_,i),[i]),p.flags|=2048,uu(9,Tw.bind(null,p,_,h,l),void 0,null),h},useId:function(){var i=Gs(),l=vn.identifierPrefix;if(Dt){var h=wi,p=vi;h=(p&~(1<<32-Zn(p)-1)).toString(32)+h,l=":"+l+"R"+h,h=lu++,0<h&&(l+="H"+h.toString(32)),l+=":"}else h=z2++,l=":"+l+"r"+h.toString(32)+":";return i.memoizedState=l},unstable_isNewReconciler:!1},H2={readContext:os,useCallback:Ow,useContext:os,useEffect:lg,useImperativeHandle:Lw,useInsertionEffect:jw,useLayoutEffect:Dw,useMemo:Fw,useReducer:og,useRef:Rw,useState:function(){return og(cu)},useDebugValue:cg,useDeferredValue:function(i){var l=as();return Vw(l,un.memoizedState,i)},useTransition:function(){var i=og(cu)[0],l=as().memoizedState;return[i,l]},useMutableSource:Sw,useSyncExternalStore:Iw,useId:zw,unstable_isNewReconciler:!1},W2={readContext:os,useCallback:Ow,useContext:os,useEffect:lg,useImperativeHandle:Lw,useInsertionEffect:jw,useLayoutEffect:Dw,useMemo:Fw,useReducer:ag,useRef:Rw,useState:function(){return ag(cu)},useDebugValue:cg,useDeferredValue:function(i){var l=as();return un===null?l.memoizedState=i:Vw(l,un.memoizedState,i)},useTransition:function(){var i=ag(cu)[0],l=as().memoizedState;return[i,l]},useMutableSource:Sw,useSyncExternalStore:Iw,useId:zw,unstable_isNewReconciler:!1};function ks(i,l){if(i&&i.defaultProps){l=M({},l),i=i.defaultProps;for(var h in i)l[h]===void 0&&(l[h]=i[h]);return l}return l}function ug(i,l,h,p){l=i.memoizedState,h=h(p,l),h=h==null?l:M({},l,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var Vh={isMounted:function(i){return(i=i._reactInternals)?xr(i)===i:!1},enqueueSetState:function(i,l,h){i=i._reactInternals;var p=nr(),v=mo(i),_=_i(p,v);_.payload=l,h!=null&&(_.callback=h),l=co(i,_,v),l!==null&&(Ns(l,i,v,p),Rh(l,i,v))},enqueueReplaceState:function(i,l,h){i=i._reactInternals;var p=nr(),v=mo(i),_=_i(p,v);_.tag=1,_.payload=l,h!=null&&(_.callback=h),l=co(i,_,v),l!==null&&(Ns(l,i,v,p),Rh(l,i,v))},enqueueForceUpdate:function(i,l){i=i._reactInternals;var h=nr(),p=mo(i),v=_i(h,p);v.tag=2,l!=null&&(v.callback=l),l=co(i,v,p),l!==null&&(Ns(l,i,p,h),Rh(l,i,p))}};function qw(i,l,h,p,v,_,j){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,_,j):l.prototype&&l.prototype.isPureReactComponent?!Yc(h,p)||!Yc(v,_):!0}function Hw(i,l,h){var p=!1,v=oo,_=l.contextType;return typeof _=="object"&&_!==null?_=os(_):(v=Ir(l)?aa:On.current,p=l.contextTypes,_=(p=p!=null)?bl(i,v):oo),l=new l(h,_),i.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Vh,i.stateNode=l,l._reactInternals=i,p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=v,i.__reactInternalMemoizedMaskedChildContext=_),l}function Ww(i,l,h,p){i=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(h,p),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(h,p),l.state!==i&&Vh.enqueueReplaceState(l,l.state,null)}function dg(i,l,h,p){var v=i.stateNode;v.props=h,v.state=i.memoizedState,v.refs={},Xp(i);var _=l.contextType;typeof _=="object"&&_!==null?v.context=os(_):(_=Ir(l)?aa:On.current,v.context=bl(i,_)),v.state=i.memoizedState,_=l.getDerivedStateFromProps,typeof _=="function"&&(ug(i,l,_,h),v.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(l=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),l!==v.state&&Vh.enqueueReplaceState(v,v.state,null),Ph(i,h,v,p),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308)}function Cl(i,l){try{var h="",p=l;do h+=xe(p),p=p.return;while(p);var v=h}catch(_){v=`
Error generating stack: `+_.message+`
`+_.stack}return{value:i,source:l,stack:v,digest:null}}function hg(i,l,h){return{value:i,source:null,stack:h??null,digest:l??null}}function fg(i,l){try{console.error(l.value)}catch(h){setTimeout(function(){throw h})}}var G2=typeof WeakMap=="function"?WeakMap:Map;function Gw(i,l,h){h=_i(-1,h),h.tag=3,h.payload={element:null};var p=l.value;return h.callback=function(){Wh||(Wh=!0,Ag=p),fg(i,l)},h}function Kw(i,l,h){h=_i(-1,h),h.tag=3;var p=i.type.getDerivedStateFromError;if(typeof p=="function"){var v=l.value;h.payload=function(){return p(v)},h.callback=function(){fg(i,l)}}var _=i.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(h.callback=function(){fg(i,l),typeof p!="function"&&(ho===null?ho=new Set([this]):ho.add(this));var j=l.stack;this.componentDidCatch(l.value,{componentStack:j!==null?j:""})}),h}function Qw(i,l,h){var p=i.pingCache;if(p===null){p=i.pingCache=new G2;var v=new Set;p.set(l,v)}else v=p.get(l),v===void 0&&(v=new Set,p.set(l,v));v.has(h)||(v.add(h),i=aC.bind(null,i,l,h),l.then(i,i))}function Yw(i){do{var l;if((l=i.tag===13)&&(l=i.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return i;i=i.return}while(i!==null);return null}function Xw(i,l,h,p,v){return(i.mode&1)===0?(i===l?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(l=_i(-1,1),l.tag=2,co(h,l,1))),h.lanes|=1),i):(i.flags|=65536,i.lanes=v,i)}var K2=W.ReactCurrentOwner,Er=!1;function tr(i,l,h,p){l.child=i===null?yw(l,null,h,p):El(l,i.child,h,p)}function Jw(i,l,h,p,v){h=h.render;var _=l.ref;return kl(l,v),p=sg(i,l,h,p,_,v),h=ig(),i!==null&&!Er?(l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~v,Si(i,l,v)):(Dt&&h&&Up(l),l.flags|=1,tr(i,l,p,v),l.child)}function Zw(i,l,h,p,v){if(i===null){var _=h.type;return typeof _=="function"&&!Mg(_)&&_.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(l.tag=15,l.type=_,eb(i,l,_,p,v)):(i=Jh(h.type,null,p,l,l.mode,v),i.ref=l.ref,i.return=l,l.child=i)}if(_=i.child,(i.lanes&v)===0){var j=_.memoizedProps;if(h=h.compare,h=h!==null?h:Yc,h(j,p)&&i.ref===l.ref)return Si(i,l,v)}return l.flags|=1,i=go(_,p),i.ref=l.ref,i.return=l,l.child=i}function eb(i,l,h,p,v){if(i!==null){var _=i.memoizedProps;if(Yc(_,p)&&i.ref===l.ref)if(Er=!1,l.pendingProps=p=_,(i.lanes&v)!==0)(i.flags&131072)!==0&&(Er=!0);else return l.lanes=i.lanes,Si(i,l,v)}return mg(i,l,h,p,v)}function tb(i,l,h){var p=l.pendingProps,v=p.children,_=i!==null?i.memoizedState:null;if(p.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Et(Rl,$r),$r|=h;else{if((h&1073741824)===0)return i=_!==null?_.baseLanes|h:h,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:i,cachePool:null,transitions:null},l.updateQueue=null,Et(Rl,$r),$r|=i,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=_!==null?_.baseLanes:h,Et(Rl,$r),$r|=p}else _!==null?(p=_.baseLanes|h,l.memoizedState=null):p=h,Et(Rl,$r),$r|=p;return tr(i,l,v,h),l.child}function nb(i,l){var h=l.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(l.flags|=512,l.flags|=2097152)}function mg(i,l,h,p,v){var _=Ir(h)?aa:On.current;return _=bl(l,_),kl(l,v),h=sg(i,l,h,p,_,v),p=ig(),i!==null&&!Er?(l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~v,Si(i,l,v)):(Dt&&p&&Up(l),l.flags|=1,tr(i,l,h,v),l.child)}function rb(i,l,h,p,v){if(Ir(h)){var _=!0;Sh(l)}else _=!1;if(kl(l,v),l.stateNode===null)Uh(i,l),Hw(l,h,p),dg(l,h,p,v),p=!0;else if(i===null){var j=l.stateNode,H=l.memoizedProps;j.props=H;var Y=j.context,ie=h.contextType;typeof ie=="object"&&ie!==null?ie=os(ie):(ie=Ir(h)?aa:On.current,ie=bl(l,ie));var pe=h.getDerivedStateFromProps,ye=typeof pe=="function"||typeof j.getSnapshotBeforeUpdate=="function";ye||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(H!==p||Y!==ie)&&Ww(l,j,p,ie),lo=!1;var he=l.memoizedState;j.state=he,Ph(l,p,j,v),Y=l.memoizedState,H!==p||he!==Y||Sr.current||lo?(typeof pe=="function"&&(ug(l,h,pe,p),Y=l.memoizedState),(H=lo||qw(l,h,H,p,he,Y,ie))?(ye||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(l.flags|=4194308)):(typeof j.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=p,l.memoizedState=Y),j.props=p,j.state=Y,j.context=ie,p=H):(typeof j.componentDidMount=="function"&&(l.flags|=4194308),p=!1)}else{j=l.stateNode,vw(i,l),H=l.memoizedProps,ie=l.type===l.elementType?H:ks(l.type,H),j.props=ie,ye=l.pendingProps,he=j.context,Y=h.contextType,typeof Y=="object"&&Y!==null?Y=os(Y):(Y=Ir(h)?aa:On.current,Y=bl(l,Y));var Te=h.getDerivedStateFromProps;(pe=typeof Te=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(H!==ye||he!==Y)&&Ww(l,j,p,Y),lo=!1,he=l.memoizedState,j.state=he,Ph(l,p,j,v);var Ne=l.memoizedState;H!==ye||he!==Ne||Sr.current||lo?(typeof Te=="function"&&(ug(l,h,Te,p),Ne=l.memoizedState),(ie=lo||qw(l,h,ie,p,he,Ne,Y)||!1)?(pe||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(p,Ne,Y),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(p,Ne,Y)),typeof j.componentDidUpdate=="function"&&(l.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof j.componentDidUpdate!="function"||H===i.memoizedProps&&he===i.memoizedState||(l.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||H===i.memoizedProps&&he===i.memoizedState||(l.flags|=1024),l.memoizedProps=p,l.memoizedState=Ne),j.props=p,j.state=Ne,j.context=Y,p=ie):(typeof j.componentDidUpdate!="function"||H===i.memoizedProps&&he===i.memoizedState||(l.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||H===i.memoizedProps&&he===i.memoizedState||(l.flags|=1024),p=!1)}return pg(i,l,h,p,_,v)}function pg(i,l,h,p,v,_){nb(i,l);var j=(l.flags&128)!==0;if(!p&&!j)return v&&lw(l,h,!1),Si(i,l,_);p=l.stateNode,K2.current=l;var H=j&&typeof h.getDerivedStateFromError!="function"?null:p.render();return l.flags|=1,i!==null&&j?(l.child=El(l,i.child,null,_),l.child=El(l,null,H,_)):tr(i,l,H,_),l.memoizedState=p.state,v&&lw(l,h,!0),l.child}function sb(i){var l=i.stateNode;l.pendingContext?ow(i,l.pendingContext,l.pendingContext!==l.context):l.context&&ow(i,l.context,!1),Jp(i,l.containerInfo)}function ib(i,l,h,p,v){return Il(),Hp(v),l.flags|=256,tr(i,l,h,p),l.child}var gg={dehydrated:null,treeContext:null,retryLane:0};function yg(i){return{baseLanes:i,cachePool:null,transitions:null}}function ob(i,l,h){var p=l.pendingProps,v=Vt.current,_=!1,j=(l.flags&128)!==0,H;if((H=j)||(H=i!==null&&i.memoizedState===null?!1:(v&2)!==0),H?(_=!0,l.flags&=-129):(i===null||i.memoizedState!==null)&&(v|=1),Et(Vt,v&1),i===null)return qp(l),i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((l.mode&1)===0?l.lanes=1:i.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(j=p.children,i=p.fallback,_?(p=l.mode,_=l.child,j={mode:"hidden",children:j},(p&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=j):_=Zh(j,p,0,null),i=ya(i,p,h,null),_.return=l,i.return=l,_.sibling=i,l.child=_,l.child.memoizedState=yg(h),l.memoizedState=gg,i):xg(l,j));if(v=i.memoizedState,v!==null&&(H=v.dehydrated,H!==null))return Q2(i,l,j,p,H,v,h);if(_){_=p.fallback,j=l.mode,v=i.child,H=v.sibling;var Y={mode:"hidden",children:p.children};return(j&1)===0&&l.child!==v?(p=l.child,p.childLanes=0,p.pendingProps=Y,l.deletions=null):(p=go(v,Y),p.subtreeFlags=v.subtreeFlags&14680064),H!==null?_=go(H,_):(_=ya(_,j,h,null),_.flags|=2),_.return=l,p.return=l,p.sibling=_,l.child=p,p=_,_=l.child,j=i.child.memoizedState,j=j===null?yg(h):{baseLanes:j.baseLanes|h,cachePool:null,transitions:j.transitions},_.memoizedState=j,_.childLanes=i.childLanes&~h,l.memoizedState=gg,p}return _=i.child,i=_.sibling,p=go(_,{mode:"visible",children:p.children}),(l.mode&1)===0&&(p.lanes=h),p.return=l,p.sibling=null,i!==null&&(h=l.deletions,h===null?(l.deletions=[i],l.flags|=16):h.push(i)),l.child=p,l.memoizedState=null,p}function xg(i,l){return l=Zh({mode:"visible",children:l},i.mode,0,null),l.return=i,i.child=l}function zh(i,l,h,p){return p!==null&&Hp(p),El(l,i.child,null,h),i=xg(l,l.pendingProps.children),i.flags|=2,l.memoizedState=null,i}function Q2(i,l,h,p,v,_,j){if(h)return l.flags&256?(l.flags&=-257,p=hg(Error(t(422))),zh(i,l,j,p)):l.memoizedState!==null?(l.child=i.child,l.flags|=128,null):(_=p.fallback,v=l.mode,p=Zh({mode:"visible",children:p.children},v,0,null),_=ya(_,v,j,null),_.flags|=2,p.return=l,_.return=l,p.sibling=_,l.child=p,(l.mode&1)!==0&&El(l,i.child,null,j),l.child.memoizedState=yg(j),l.memoizedState=gg,_);if((l.mode&1)===0)return zh(i,l,j,null);if(v.data==="$!"){if(p=v.nextSibling&&v.nextSibling.dataset,p)var H=p.dgst;return p=H,_=Error(t(419)),p=hg(_,p,void 0),zh(i,l,j,p)}if(H=(j&i.childLanes)!==0,Er||H){if(p=vn,p!==null){switch(j&-j){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(p.suspendedLanes|j))!==0?0:v,v!==0&&v!==_.retryLane&&(_.retryLane=v,bi(i,v),Ns(p,i,v,-1))}return Dg(),p=hg(Error(t(421))),zh(i,l,j,p)}return v.data==="$?"?(l.flags|=128,l.child=i.child,l=lC.bind(null,i),v._reactRetry=l,null):(i=_.treeContext,Br=so(v.nextSibling),Ur=l,Dt=!0,Ts=null,i!==null&&(ss[is++]=vi,ss[is++]=wi,ss[is++]=la,vi=i.id,wi=i.overflow,la=l),l=xg(l,p.children),l.flags|=4096,l)}function ab(i,l,h){i.lanes|=l;var p=i.alternate;p!==null&&(p.lanes|=l),Qp(i.return,l,h)}function vg(i,l,h,p,v){var _=i.memoizedState;_===null?i.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:v}:(_.isBackwards=l,_.rendering=null,_.renderingStartTime=0,_.last=p,_.tail=h,_.tailMode=v)}function lb(i,l,h){var p=l.pendingProps,v=p.revealOrder,_=p.tail;if(tr(i,l,p.children,h),p=Vt.current,(p&2)!==0)p=p&1|2,l.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=l.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&ab(i,h,l);else if(i.tag===19)ab(i,h,l);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break e;for(;i.sibling===null;){if(i.return===null||i.return===l)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}if(Et(Vt,p),(l.mode&1)===0)l.memoizedState=null;else switch(v){case"forwards":for(h=l.child,v=null;h!==null;)i=h.alternate,i!==null&&jh(i)===null&&(v=h),h=h.sibling;h=v,h===null?(v=l.child,l.child=null):(v=h.sibling,h.sibling=null),vg(l,!1,v,h,_);break;case"backwards":for(h=null,v=l.child,l.child=null;v!==null;){if(i=v.alternate,i!==null&&jh(i)===null){l.child=v;break}i=v.sibling,v.sibling=h,h=v,v=i}vg(l,!0,h,null,_);break;case"together":vg(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Uh(i,l){(l.mode&1)===0&&i!==null&&(i.alternate=null,l.alternate=null,l.flags|=2)}function Si(i,l,h){if(i!==null&&(l.dependencies=i.dependencies),fa|=l.lanes,(h&l.childLanes)===0)return null;if(i!==null&&l.child!==i.child)throw Error(t(153));if(l.child!==null){for(i=l.child,h=go(i,i.pendingProps),l.child=h,h.return=l;i.sibling!==null;)i=i.sibling,h=h.sibling=go(i,i.pendingProps),h.return=l;h.sibling=null}return l.child}function Y2(i,l,h){switch(l.tag){case 3:sb(l),Il();break;case 5:_w(l);break;case 1:Ir(l.type)&&Sh(l);break;case 4:Jp(l,l.stateNode.containerInfo);break;case 10:var p=l.type._context,v=l.memoizedProps.value;Et(Ch,p._currentValue),p._currentValue=v;break;case 13:if(p=l.memoizedState,p!==null)return p.dehydrated!==null?(Et(Vt,Vt.current&1),l.flags|=128,null):(h&l.child.childLanes)!==0?ob(i,l,h):(Et(Vt,Vt.current&1),i=Si(i,l,h),i!==null?i.sibling:null);Et(Vt,Vt.current&1);break;case 19:if(p=(h&l.childLanes)!==0,(i.flags&128)!==0){if(p)return lb(i,l,h);l.flags|=128}if(v=l.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Et(Vt,Vt.current),p)break;return null;case 22:case 23:return l.lanes=0,tb(i,l,h)}return Si(i,l,h)}var cb,wg,ub,db;cb=function(i,l){for(var h=l.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},wg=function(){},ub=function(i,l,h,p){var v=i.memoizedProps;if(v!==p){i=l.stateNode,da(Ws.current);var _=null;switch(h){case"input":v=In(i,v),p=In(i,p),_=[];break;case"select":v=M({},v,{value:void 0}),p=M({},p,{value:void 0}),_=[];break;case"textarea":v=ai(i,v),p=ai(i,p),_=[];break;default:typeof v.onClick!="function"&&typeof p.onClick=="function"&&(i.onclick=wh)}Ft(h,p);var j;h=null;for(ie in v)if(!p.hasOwnProperty(ie)&&v.hasOwnProperty(ie)&&v[ie]!=null)if(ie==="style"){var H=v[ie];for(j in H)H.hasOwnProperty(j)&&(h||(h={}),h[j]="")}else ie!=="dangerouslySetInnerHTML"&&ie!=="children"&&ie!=="suppressContentEditableWarning"&&ie!=="suppressHydrationWarning"&&ie!=="autoFocus"&&(s.hasOwnProperty(ie)?_||(_=[]):(_=_||[]).push(ie,null));for(ie in p){var Y=p[ie];if(H=v!=null?v[ie]:void 0,p.hasOwnProperty(ie)&&Y!==H&&(Y!=null||H!=null))if(ie==="style")if(H){for(j in H)!H.hasOwnProperty(j)||Y&&Y.hasOwnProperty(j)||(h||(h={}),h[j]="");for(j in Y)Y.hasOwnProperty(j)&&H[j]!==Y[j]&&(h||(h={}),h[j]=Y[j])}else h||(_||(_=[]),_.push(ie,h)),h=Y;else ie==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,H=H?H.__html:void 0,Y!=null&&H!==Y&&(_=_||[]).push(ie,Y)):ie==="children"?typeof Y!="string"&&typeof Y!="number"||(_=_||[]).push(ie,""+Y):ie!=="suppressContentEditableWarning"&&ie!=="suppressHydrationWarning"&&(s.hasOwnProperty(ie)?(Y!=null&&ie==="onScroll"&&At("scroll",i),_||H===Y||(_=[])):(_=_||[]).push(ie,Y))}h&&(_=_||[]).push("style",h);var ie=_;(l.updateQueue=ie)&&(l.flags|=4)}},db=function(i,l,h,p){h!==p&&(l.flags|=4)};function du(i,l){if(!Dt)switch(i.tailMode){case"hidden":l=i.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?l||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Vn(i){var l=i.alternate!==null&&i.alternate.child===i.child,h=0,p=0;if(l)for(var v=i.child;v!==null;)h|=v.lanes|v.childLanes,p|=v.subtreeFlags&14680064,p|=v.flags&14680064,v.return=i,v=v.sibling;else for(v=i.child;v!==null;)h|=v.lanes|v.childLanes,p|=v.subtreeFlags,p|=v.flags,v.return=i,v=v.sibling;return i.subtreeFlags|=p,i.childLanes=h,l}function X2(i,l,h){var p=l.pendingProps;switch(Bp(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vn(l),null;case 1:return Ir(l.type)&&_h(),Vn(l),null;case 3:return p=l.stateNode,Al(),Ct(Sr),Ct(On),tg(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(i===null||i.child===null)&&(kh(l)?l.flags|=4:i===null||i.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Ts!==null&&(Rg(Ts),Ts=null))),wg(i,l),Vn(l),null;case 5:Zp(l);var v=da(ou.current);if(h=l.type,i!==null&&l.stateNode!=null)ub(i,l,h,p,v),i.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!p){if(l.stateNode===null)throw Error(t(166));return Vn(l),null}if(i=da(Ws.current),kh(l)){p=l.stateNode,h=l.type;var _=l.memoizedProps;switch(p[Hs]=l,p[tu]=_,i=(l.mode&1)!==0,h){case"dialog":At("cancel",p),At("close",p);break;case"iframe":case"object":case"embed":At("load",p);break;case"video":case"audio":for(v=0;v<Jc.length;v++)At(Jc[v],p);break;case"source":At("error",p);break;case"img":case"image":case"link":At("error",p),At("load",p);break;case"details":At("toggle",p);break;case"input":Mr(p,_),At("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!_.multiple},At("invalid",p);break;case"textarea":Zr(p,_),At("invalid",p)}Ft(h,_),v=null;for(var j in _)if(_.hasOwnProperty(j)){var H=_[j];j==="children"?typeof H=="string"?p.textContent!==H&&(_.suppressHydrationWarning!==!0&&vh(p.textContent,H,i),v=["children",H]):typeof H=="number"&&p.textContent!==""+H&&(_.suppressHydrationWarning!==!0&&vh(p.textContent,H,i),v=["children",""+H]):s.hasOwnProperty(j)&&H!=null&&j==="onScroll"&&At("scroll",p)}switch(h){case"input":Sn(p),ys(p,_,!0);break;case"textarea":Sn(p),fr(p);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(p.onclick=wh)}p=v,l.updateQueue=p,p!==null&&(l.flags|=4)}else{j=v.nodeType===9?v:v.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=oe(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=j.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof p.is=="string"?i=j.createElement(h,{is:p.is}):(i=j.createElement(h),h==="select"&&(j=i,p.multiple?j.multiple=!0:p.size&&(j.size=p.size))):i=j.createElementNS(i,h),i[Hs]=l,i[tu]=p,cb(i,l,!1,!1),l.stateNode=i;e:{switch(j=jn(h,p),h){case"dialog":At("cancel",i),At("close",i),v=p;break;case"iframe":case"object":case"embed":At("load",i),v=p;break;case"video":case"audio":for(v=0;v<Jc.length;v++)At(Jc[v],i);v=p;break;case"source":At("error",i),v=p;break;case"img":case"image":case"link":At("error",i),At("load",i),v=p;break;case"details":At("toggle",i),v=p;break;case"input":Mr(i,p),v=In(i,p),At("invalid",i);break;case"option":v=p;break;case"select":i._wrapperState={wasMultiple:!!p.multiple},v=M({},p,{value:void 0}),At("invalid",i);break;case"textarea":Zr(i,p),v=ai(i,p),At("invalid",i);break;default:v=p}Ft(h,v),H=v;for(_ in H)if(H.hasOwnProperty(_)){var Y=H[_];_==="style"?Wt(i,Y):_==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,Y!=null&&Qe(i,Y)):_==="children"?typeof Y=="string"?(h!=="textarea"||Y!=="")&&Xe(i,Y):typeof Y=="number"&&Xe(i,""+Y):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(s.hasOwnProperty(_)?Y!=null&&_==="onScroll"&&At("scroll",i):Y!=null&&U(i,_,Y,j))}switch(h){case"input":Sn(i),ys(i,p,!1);break;case"textarea":Sn(i),fr(i);break;case"option":p.value!=null&&i.setAttribute("value",""+He(p.value));break;case"select":i.multiple=!!p.multiple,_=p.value,_!=null?dr(i,!!p.multiple,_,!1):p.defaultValue!=null&&dr(i,!!p.multiple,p.defaultValue,!0);break;default:typeof v.onClick=="function"&&(i.onclick=wh)}switch(h){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Vn(l),null;case 6:if(i&&l.stateNode!=null)db(i,l,i.memoizedProps,p);else{if(typeof p!="string"&&l.stateNode===null)throw Error(t(166));if(h=da(ou.current),da(Ws.current),kh(l)){if(p=l.stateNode,h=l.memoizedProps,p[Hs]=l,(_=p.nodeValue!==h)&&(i=Ur,i!==null))switch(i.tag){case 3:vh(p.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&vh(p.nodeValue,h,(i.mode&1)!==0)}_&&(l.flags|=4)}else p=(h.nodeType===9?h:h.ownerDocument).createTextNode(p),p[Hs]=l,l.stateNode=p}return Vn(l),null;case 13:if(Ct(Vt),p=l.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Dt&&Br!==null&&(l.mode&1)!==0&&(l.flags&128)===0)mw(),Il(),l.flags|=98560,_=!1;else if(_=kh(l),p!==null&&p.dehydrated!==null){if(i===null){if(!_)throw Error(t(318));if(_=l.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[Hs]=l}else Il(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Vn(l),_=!1}else Ts!==null&&(Rg(Ts),Ts=null),_=!0;if(!_)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=h,l):(p=p!==null,p!==(i!==null&&i.memoizedState!==null)&&p&&(l.child.flags|=8192,(l.mode&1)!==0&&(i===null||(Vt.current&1)!==0?dn===0&&(dn=3):Dg())),l.updateQueue!==null&&(l.flags|=4),Vn(l),null);case 4:return Al(),wg(i,l),i===null&&Zc(l.stateNode.containerInfo),Vn(l),null;case 10:return Kp(l.type._context),Vn(l),null;case 17:return Ir(l.type)&&_h(),Vn(l),null;case 19:if(Ct(Vt),_=l.memoizedState,_===null)return Vn(l),null;if(p=(l.flags&128)!==0,j=_.rendering,j===null)if(p)du(_,!1);else{if(dn!==0||i!==null&&(i.flags&128)!==0)for(i=l.child;i!==null;){if(j=jh(i),j!==null){for(l.flags|=128,du(_,!1),p=j.updateQueue,p!==null&&(l.updateQueue=p,l.flags|=4),l.subtreeFlags=0,p=h,h=l.child;h!==null;)_=h,i=p,_.flags&=14680066,j=_.alternate,j===null?(_.childLanes=0,_.lanes=i,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=j.childLanes,_.lanes=j.lanes,_.child=j.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=j.memoizedProps,_.memoizedState=j.memoizedState,_.updateQueue=j.updateQueue,_.type=j.type,i=j.dependencies,_.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return Et(Vt,Vt.current&1|2),l.child}i=i.sibling}_.tail!==null&&We()>Pl&&(l.flags|=128,p=!0,du(_,!1),l.lanes=4194304)}else{if(!p)if(i=jh(j),i!==null){if(l.flags|=128,p=!0,h=i.updateQueue,h!==null&&(l.updateQueue=h,l.flags|=4),du(_,!0),_.tail===null&&_.tailMode==="hidden"&&!j.alternate&&!Dt)return Vn(l),null}else 2*We()-_.renderingStartTime>Pl&&h!==1073741824&&(l.flags|=128,p=!0,du(_,!1),l.lanes=4194304);_.isBackwards?(j.sibling=l.child,l.child=j):(h=_.last,h!==null?h.sibling=j:l.child=j,_.last=j)}return _.tail!==null?(l=_.tail,_.rendering=l,_.tail=l.sibling,_.renderingStartTime=We(),l.sibling=null,h=Vt.current,Et(Vt,p?h&1|2:h&1),l):(Vn(l),null);case 22:case 23:return jg(),p=l.memoizedState!==null,i!==null&&i.memoizedState!==null!==p&&(l.flags|=8192),p&&(l.mode&1)!==0?($r&1073741824)!==0&&(Vn(l),l.subtreeFlags&6&&(l.flags|=8192)):Vn(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function J2(i,l){switch(Bp(l),l.tag){case 1:return Ir(l.type)&&_h(),i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 3:return Al(),Ct(Sr),Ct(On),tg(),i=l.flags,(i&65536)!==0&&(i&128)===0?(l.flags=i&-65537|128,l):null;case 5:return Zp(l),null;case 13:if(Ct(Vt),i=l.memoizedState,i!==null&&i.dehydrated!==null){if(l.alternate===null)throw Error(t(340));Il()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 19:return Ct(Vt),null;case 4:return Al(),null;case 10:return Kp(l.type._context),null;case 22:case 23:return jg(),null;case 24:return null;default:return null}}var Bh=!1,zn=!1,Z2=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function Nl(i,l){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(p){qt(i,l,p)}else h.current=null}function bg(i,l,h){try{h()}catch(p){qt(i,l,p)}}var hb=!1;function eC(i,l){if(jp=to,i=qv(),Ep(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var v=p.anchorOffset,_=p.focusNode;p=p.focusOffset;try{h.nodeType,_.nodeType}catch{h=null;break e}var j=0,H=-1,Y=-1,ie=0,pe=0,ye=i,he=null;t:for(;;){for(var Te;ye!==h||v!==0&&ye.nodeType!==3||(H=j+v),ye!==_||p!==0&&ye.nodeType!==3||(Y=j+p),ye.nodeType===3&&(j+=ye.nodeValue.length),(Te=ye.firstChild)!==null;)he=ye,ye=Te;for(;;){if(ye===i)break t;if(he===h&&++ie===v&&(H=j),he===_&&++pe===p&&(Y=j),(Te=ye.nextSibling)!==null)break;ye=he,he=ye.parentNode}ye=Te}h=H===-1||Y===-1?null:{start:H,end:Y}}else h=null}h=h||{start:0,end:0}}else h=null;for(Dp={focusedElem:i,selectionRange:h},to=!1,Ae=l;Ae!==null;)if(l=Ae,i=l.child,(l.subtreeFlags&1028)!==0&&i!==null)i.return=l,Ae=i;else for(;Ae!==null;){l=Ae;try{var Ne=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(Ne!==null){var Pe=Ne.memoizedProps,Gt=Ne.memoizedState,re=l.stateNode,J=re.getSnapshotBeforeUpdate(l.elementType===l.type?Pe:ks(l.type,Pe),Gt);re.__reactInternalSnapshotBeforeUpdate=J}break;case 3:var se=l.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(we){qt(l,l.return,we)}if(i=l.sibling,i!==null){i.return=l.return,Ae=i;break}Ae=l.return}return Ne=hb,hb=!1,Ne}function hu(i,l,h){var p=l.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var v=p=p.next;do{if((v.tag&i)===i){var _=v.destroy;v.destroy=void 0,_!==void 0&&bg(l,h,_)}v=v.next}while(v!==p)}}function $h(i,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var h=l=l.next;do{if((h.tag&i)===i){var p=h.create;h.destroy=p()}h=h.next}while(h!==l)}}function _g(i){var l=i.ref;if(l!==null){var h=i.stateNode;switch(i.tag){case 5:i=h;break;default:i=h}typeof l=="function"?l(i):l.current=i}}function fb(i){var l=i.alternate;l!==null&&(i.alternate=null,fb(l)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(l=i.stateNode,l!==null&&(delete l[Hs],delete l[tu],delete l[Fp],delete l[L2],delete l[O2])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function mb(i){return i.tag===5||i.tag===3||i.tag===4}function pb(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||mb(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Sg(i,l,h){var p=i.tag;if(p===5||p===6)i=i.stateNode,l?h.nodeType===8?h.parentNode.insertBefore(i,l):h.insertBefore(i,l):(h.nodeType===8?(l=h.parentNode,l.insertBefore(i,h)):(l=h,l.appendChild(i)),h=h._reactRootContainer,h!=null||l.onclick!==null||(l.onclick=wh));else if(p!==4&&(i=i.child,i!==null))for(Sg(i,l,h),i=i.sibling;i!==null;)Sg(i,l,h),i=i.sibling}function Ig(i,l,h){var p=i.tag;if(p===5||p===6)i=i.stateNode,l?h.insertBefore(i,l):h.appendChild(i);else if(p!==4&&(i=i.child,i!==null))for(Ig(i,l,h),i=i.sibling;i!==null;)Ig(i,l,h),i=i.sibling}var An=null,As=!1;function uo(i,l,h){for(h=h.child;h!==null;)gb(i,l,h),h=h.sibling}function gb(i,l,h){if(Or&&typeof Or.onCommitFiberUnmount=="function")try{Or.onCommitFiberUnmount(Vs,h)}catch{}switch(h.tag){case 5:zn||Nl(h,l);case 6:var p=An,v=As;An=null,uo(i,l,h),An=p,As=v,An!==null&&(As?(i=An,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):An.removeChild(h.stateNode));break;case 18:An!==null&&(As?(i=An,h=h.stateNode,i.nodeType===8?Op(i.parentNode,h):i.nodeType===1&&Op(i,h),Ss(i)):Op(An,h.stateNode));break;case 4:p=An,v=As,An=h.stateNode.containerInfo,As=!0,uo(i,l,h),An=p,As=v;break;case 0:case 11:case 14:case 15:if(!zn&&(p=h.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){v=p=p.next;do{var _=v,j=_.destroy;_=_.tag,j!==void 0&&((_&2)!==0||(_&4)!==0)&&bg(h,l,j),v=v.next}while(v!==p)}uo(i,l,h);break;case 1:if(!zn&&(Nl(h,l),p=h.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=h.memoizedProps,p.state=h.memoizedState,p.componentWillUnmount()}catch(H){qt(h,l,H)}uo(i,l,h);break;case 21:uo(i,l,h);break;case 22:h.mode&1?(zn=(p=zn)||h.memoizedState!==null,uo(i,l,h),zn=p):uo(i,l,h);break;default:uo(i,l,h)}}function yb(i){var l=i.updateQueue;if(l!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new Z2),l.forEach(function(p){var v=cC.bind(null,i,p);h.has(p)||(h.add(p),p.then(v,v))})}}function Cs(i,l){var h=l.deletions;if(h!==null)for(var p=0;p<h.length;p++){var v=h[p];try{var _=i,j=l,H=j;e:for(;H!==null;){switch(H.tag){case 5:An=H.stateNode,As=!1;break e;case 3:An=H.stateNode.containerInfo,As=!0;break e;case 4:An=H.stateNode.containerInfo,As=!0;break e}H=H.return}if(An===null)throw Error(t(160));gb(_,j,v),An=null,As=!1;var Y=v.alternate;Y!==null&&(Y.return=null),v.return=null}catch(ie){qt(v,l,ie)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)xb(l,i),l=l.sibling}function xb(i,l){var h=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Cs(l,i),Ks(i),p&4){try{hu(3,i,i.return),$h(3,i)}catch(Pe){qt(i,i.return,Pe)}try{hu(5,i,i.return)}catch(Pe){qt(i,i.return,Pe)}}break;case 1:Cs(l,i),Ks(i),p&512&&h!==null&&Nl(h,h.return);break;case 5:if(Cs(l,i),Ks(i),p&512&&h!==null&&Nl(h,h.return),i.flags&32){var v=i.stateNode;try{Xe(v,"")}catch(Pe){qt(i,i.return,Pe)}}if(p&4&&(v=i.stateNode,v!=null)){var _=i.memoizedProps,j=h!==null?h.memoizedProps:_,H=i.type,Y=i.updateQueue;if(i.updateQueue=null,Y!==null)try{H==="input"&&_.type==="radio"&&_.name!=null&&Jr(v,_),jn(H,j);var ie=jn(H,_);for(j=0;j<Y.length;j+=2){var pe=Y[j],ye=Y[j+1];pe==="style"?Wt(v,ye):pe==="dangerouslySetInnerHTML"?Qe(v,ye):pe==="children"?Xe(v,ye):U(v,pe,ye,ie)}switch(H){case"input":Xn(v,_);break;case"textarea":hr(v,_);break;case"select":var he=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!_.multiple;var Te=_.value;Te!=null?dr(v,!!_.multiple,Te,!1):he!==!!_.multiple&&(_.defaultValue!=null?dr(v,!!_.multiple,_.defaultValue,!0):dr(v,!!_.multiple,_.multiple?[]:"",!1))}v[tu]=_}catch(Pe){qt(i,i.return,Pe)}}break;case 6:if(Cs(l,i),Ks(i),p&4){if(i.stateNode===null)throw Error(t(162));v=i.stateNode,_=i.memoizedProps;try{v.nodeValue=_}catch(Pe){qt(i,i.return,Pe)}}break;case 3:if(Cs(l,i),Ks(i),p&4&&h!==null&&h.memoizedState.isDehydrated)try{Ss(l.containerInfo)}catch(Pe){qt(i,i.return,Pe)}break;case 4:Cs(l,i),Ks(i);break;case 13:Cs(l,i),Ks(i),v=i.child,v.flags&8192&&(_=v.memoizedState!==null,v.stateNode.isHidden=_,!_||v.alternate!==null&&v.alternate.memoizedState!==null||(kg=We())),p&4&&yb(i);break;case 22:if(pe=h!==null&&h.memoizedState!==null,i.mode&1?(zn=(ie=zn)||pe,Cs(l,i),zn=ie):Cs(l,i),Ks(i),p&8192){if(ie=i.memoizedState!==null,(i.stateNode.isHidden=ie)&&!pe&&(i.mode&1)!==0)for(Ae=i,pe=i.child;pe!==null;){for(ye=Ae=pe;Ae!==null;){switch(he=Ae,Te=he.child,he.tag){case 0:case 11:case 14:case 15:hu(4,he,he.return);break;case 1:Nl(he,he.return);var Ne=he.stateNode;if(typeof Ne.componentWillUnmount=="function"){p=he,h=he.return;try{l=p,Ne.props=l.memoizedProps,Ne.state=l.memoizedState,Ne.componentWillUnmount()}catch(Pe){qt(p,h,Pe)}}break;case 5:Nl(he,he.return);break;case 22:if(he.memoizedState!==null){bb(ye);continue}}Te!==null?(Te.return=he,Ae=Te):bb(ye)}pe=pe.sibling}e:for(pe=null,ye=i;;){if(ye.tag===5){if(pe===null){pe=ye;try{v=ye.stateNode,ie?(_=v.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(H=ye.stateNode,Y=ye.memoizedProps.style,j=Y!=null&&Y.hasOwnProperty("display")?Y.display:null,H.style.display=Zt("display",j))}catch(Pe){qt(i,i.return,Pe)}}}else if(ye.tag===6){if(pe===null)try{ye.stateNode.nodeValue=ie?"":ye.memoizedProps}catch(Pe){qt(i,i.return,Pe)}}else if((ye.tag!==22&&ye.tag!==23||ye.memoizedState===null||ye===i)&&ye.child!==null){ye.child.return=ye,ye=ye.child;continue}if(ye===i)break e;for(;ye.sibling===null;){if(ye.return===null||ye.return===i)break e;pe===ye&&(pe=null),ye=ye.return}pe===ye&&(pe=null),ye.sibling.return=ye.return,ye=ye.sibling}}break;case 19:Cs(l,i),Ks(i),p&4&&yb(i);break;case 21:break;default:Cs(l,i),Ks(i)}}function Ks(i){var l=i.flags;if(l&2){try{e:{for(var h=i.return;h!==null;){if(mb(h)){var p=h;break e}h=h.return}throw Error(t(160))}switch(p.tag){case 5:var v=p.stateNode;p.flags&32&&(Xe(v,""),p.flags&=-33);var _=pb(i);Ig(i,_,v);break;case 3:case 4:var j=p.stateNode.containerInfo,H=pb(i);Sg(i,H,j);break;default:throw Error(t(161))}}catch(Y){qt(i,i.return,Y)}i.flags&=-3}l&4096&&(i.flags&=-4097)}function tC(i,l,h){Ae=i,vb(i)}function vb(i,l,h){for(var p=(i.mode&1)!==0;Ae!==null;){var v=Ae,_=v.child;if(v.tag===22&&p){var j=v.memoizedState!==null||Bh;if(!j){var H=v.alternate,Y=H!==null&&H.memoizedState!==null||zn;H=Bh;var ie=zn;if(Bh=j,(zn=Y)&&!ie)for(Ae=v;Ae!==null;)j=Ae,Y=j.child,j.tag===22&&j.memoizedState!==null?_b(v):Y!==null?(Y.return=j,Ae=Y):_b(v);for(;_!==null;)Ae=_,vb(_),_=_.sibling;Ae=v,Bh=H,zn=ie}wb(i)}else(v.subtreeFlags&8772)!==0&&_!==null?(_.return=v,Ae=_):wb(i)}}function wb(i){for(;Ae!==null;){var l=Ae;if((l.flags&8772)!==0){var h=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:zn||$h(5,l);break;case 1:var p=l.stateNode;if(l.flags&4&&!zn)if(h===null)p.componentDidMount();else{var v=l.elementType===l.type?h.memoizedProps:ks(l.type,h.memoizedProps);p.componentDidUpdate(v,h.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var _=l.updateQueue;_!==null&&bw(l,_,p);break;case 3:var j=l.updateQueue;if(j!==null){if(h=null,l.child!==null)switch(l.child.tag){case 5:h=l.child.stateNode;break;case 1:h=l.child.stateNode}bw(l,j,h)}break;case 5:var H=l.stateNode;if(h===null&&l.flags&4){h=H;var Y=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":Y.autoFocus&&h.focus();break;case"img":Y.src&&(h.src=Y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var ie=l.alternate;if(ie!==null){var pe=ie.memoizedState;if(pe!==null){var ye=pe.dehydrated;ye!==null&&Ss(ye)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}zn||l.flags&512&&_g(l)}catch(he){qt(l,l.return,he)}}if(l===i){Ae=null;break}if(h=l.sibling,h!==null){h.return=l.return,Ae=h;break}Ae=l.return}}function bb(i){for(;Ae!==null;){var l=Ae;if(l===i){Ae=null;break}var h=l.sibling;if(h!==null){h.return=l.return,Ae=h;break}Ae=l.return}}function _b(i){for(;Ae!==null;){var l=Ae;try{switch(l.tag){case 0:case 11:case 15:var h=l.return;try{$h(4,l)}catch(Y){qt(l,h,Y)}break;case 1:var p=l.stateNode;if(typeof p.componentDidMount=="function"){var v=l.return;try{p.componentDidMount()}catch(Y){qt(l,v,Y)}}var _=l.return;try{_g(l)}catch(Y){qt(l,_,Y)}break;case 5:var j=l.return;try{_g(l)}catch(Y){qt(l,j,Y)}}}catch(Y){qt(l,l.return,Y)}if(l===i){Ae=null;break}var H=l.sibling;if(H!==null){H.return=l.return,Ae=H;break}Ae=l.return}}var nC=Math.ceil,qh=W.ReactCurrentDispatcher,Eg=W.ReactCurrentOwner,ls=W.ReactCurrentBatchConfig,dt=0,vn=null,nn=null,Cn=0,$r=0,Rl=io(0),dn=0,fu=null,fa=0,Hh=0,Tg=0,mu=null,Tr=null,kg=0,Pl=1/0,Ii=null,Wh=!1,Ag=null,ho=null,Gh=!1,fo=null,Kh=0,pu=0,Cg=null,Qh=-1,Yh=0;function nr(){return(dt&6)!==0?We():Qh!==-1?Qh:Qh=We()}function mo(i){return(i.mode&1)===0?1:(dt&2)!==0&&Cn!==0?Cn&-Cn:V2.transition!==null?(Yh===0&&(Yh=ta()),Yh):(i=it,i!==0||(i=window.event,i=i===void 0?16:$c(i.type)),i)}function Ns(i,l,h,p){if(50<pu)throw pu=0,Cg=null,Error(t(185));Xi(i,h,p),((dt&2)===0||i!==vn)&&(i===vn&&((dt&2)===0&&(Hh|=h),dn===4&&po(i,Cn)),kr(i,p),h===1&&dt===0&&(l.mode&1)===0&&(Pl=We()+500,Ih&&ao()))}function kr(i,l){var h=i.callbackNode;hi(i,l);var p=ea(i,i===vn?Cn:0);if(p===0)h!==null&&ke(h),i.callbackNode=null,i.callbackPriority=0;else if(l=p&-p,i.callbackPriority!==l){if(h!=null&&ke(h),l===1)i.tag===0?F2(Ib.bind(null,i)):cw(Ib.bind(null,i)),D2(function(){(dt&6)===0&&ao()}),h=null;else{switch(Zi(p)){case 1:h=En;break;case 4:h=wr;break;case 16:h=Ln;break;case 536870912:h=Zo;break;default:h=Ln}h=Pb(h,Sb.bind(null,i))}i.callbackPriority=l,i.callbackNode=h}}function Sb(i,l){if(Qh=-1,Yh=0,(dt&6)!==0)throw Error(t(327));var h=i.callbackNode;if(jl()&&i.callbackNode!==h)return null;var p=ea(i,i===vn?Cn:0);if(p===0)return null;if((p&30)!==0||(p&i.expiredLanes)!==0||l)l=Xh(i,p);else{l=p;var v=dt;dt|=2;var _=Tb();(vn!==i||Cn!==l)&&(Ii=null,Pl=We()+500,pa(i,l));do try{iC();break}catch(H){Eb(i,H)}while(!0);Gp(),qh.current=_,dt=v,nn!==null?l=0:(vn=null,Cn=0,l=dn)}if(l!==0){if(l===2&&(v=Fr(i),v!==0&&(p=v,l=Ng(i,v))),l===1)throw h=fu,pa(i,0),po(i,p),kr(i,We()),h;if(l===6)po(i,p);else{if(v=i.current.alternate,(p&30)===0&&!rC(v)&&(l=Xh(i,p),l===2&&(_=Fr(i),_!==0&&(p=_,l=Ng(i,_))),l===1))throw h=fu,pa(i,0),po(i,p),kr(i,We()),h;switch(i.finishedWork=v,i.finishedLanes=p,l){case 0:case 1:throw Error(t(345));case 2:ga(i,Tr,Ii);break;case 3:if(po(i,p),(p&130023424)===p&&(l=kg+500-We(),10<l)){if(ea(i,0)!==0)break;if(v=i.suspendedLanes,(v&p)!==p){nr(),i.pingedLanes|=i.suspendedLanes&v;break}i.timeoutHandle=Lp(ga.bind(null,i,Tr,Ii),l);break}ga(i,Tr,Ii);break;case 4:if(po(i,p),(p&4194240)===p)break;for(l=i.eventTimes,v=-1;0<p;){var j=31-Zn(p);_=1<<j,j=l[j],j>v&&(v=j),p&=~_}if(p=v,p=We()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*nC(p/1960))-p,10<p){i.timeoutHandle=Lp(ga.bind(null,i,Tr,Ii),p);break}ga(i,Tr,Ii);break;case 5:ga(i,Tr,Ii);break;default:throw Error(t(329))}}}return kr(i,We()),i.callbackNode===h?Sb.bind(null,i):null}function Ng(i,l){var h=mu;return i.current.memoizedState.isDehydrated&&(pa(i,l).flags|=256),i=Xh(i,l),i!==2&&(l=Tr,Tr=h,l!==null&&Rg(l)),i}function Rg(i){Tr===null?Tr=i:Tr.push.apply(Tr,i)}function rC(i){for(var l=i;;){if(l.flags&16384){var h=l.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var p=0;p<h.length;p++){var v=h[p],_=v.getSnapshot;v=v.value;try{if(!Es(_(),v))return!1}catch{return!1}}}if(h=l.child,l.subtreeFlags&16384&&h!==null)h.return=l,l=h;else{if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function po(i,l){for(l&=~Tg,l&=~Hh,i.suspendedLanes|=l,i.pingedLanes&=~l,i=i.expirationTimes;0<l;){var h=31-Zn(l),p=1<<h;i[h]=-1,l&=~p}}function Ib(i){if((dt&6)!==0)throw Error(t(327));jl();var l=ea(i,0);if((l&1)===0)return kr(i,We()),null;var h=Xh(i,l);if(i.tag!==0&&h===2){var p=Fr(i);p!==0&&(l=p,h=Ng(i,p))}if(h===1)throw h=fu,pa(i,0),po(i,l),kr(i,We()),h;if(h===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=l,ga(i,Tr,Ii),kr(i,We()),null}function Pg(i,l){var h=dt;dt|=1;try{return i(l)}finally{dt=h,dt===0&&(Pl=We()+500,Ih&&ao())}}function ma(i){fo!==null&&fo.tag===0&&(dt&6)===0&&jl();var l=dt;dt|=1;var h=ls.transition,p=it;try{if(ls.transition=null,it=1,i)return i()}finally{it=p,ls.transition=h,dt=l,(dt&6)===0&&ao()}}function jg(){$r=Rl.current,Ct(Rl)}function pa(i,l){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,j2(h)),nn!==null)for(h=nn.return;h!==null;){var p=h;switch(Bp(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&_h();break;case 3:Al(),Ct(Sr),Ct(On),tg();break;case 5:Zp(p);break;case 4:Al();break;case 13:Ct(Vt);break;case 19:Ct(Vt);break;case 10:Kp(p.type._context);break;case 22:case 23:jg()}h=h.return}if(vn=i,nn=i=go(i.current,null),Cn=$r=l,dn=0,fu=null,Tg=Hh=fa=0,Tr=mu=null,ua!==null){for(l=0;l<ua.length;l++)if(h=ua[l],p=h.interleaved,p!==null){h.interleaved=null;var v=p.next,_=h.pending;if(_!==null){var j=_.next;_.next=v,p.next=j}h.pending=p}ua=null}return i}function Eb(i,l){do{var h=nn;try{if(Gp(),Dh.current=Fh,Mh){for(var p=zt.memoizedState;p!==null;){var v=p.queue;v!==null&&(v.pending=null),p=p.next}Mh=!1}if(ha=0,xn=un=zt=null,au=!1,lu=0,Eg.current=null,h===null||h.return===null){dn=1,fu=l,nn=null;break}e:{var _=i,j=h.return,H=h,Y=l;if(l=Cn,H.flags|=32768,Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var ie=Y,pe=H,ye=pe.tag;if((pe.mode&1)===0&&(ye===0||ye===11||ye===15)){var he=pe.alternate;he?(pe.updateQueue=he.updateQueue,pe.memoizedState=he.memoizedState,pe.lanes=he.lanes):(pe.updateQueue=null,pe.memoizedState=null)}var Te=Yw(j);if(Te!==null){Te.flags&=-257,Xw(Te,j,H,_,l),Te.mode&1&&Qw(_,ie,l),l=Te,Y=ie;var Ne=l.updateQueue;if(Ne===null){var Pe=new Set;Pe.add(Y),l.updateQueue=Pe}else Ne.add(Y);break e}else{if((l&1)===0){Qw(_,ie,l),Dg();break e}Y=Error(t(426))}}else if(Dt&&H.mode&1){var Gt=Yw(j);if(Gt!==null){(Gt.flags&65536)===0&&(Gt.flags|=256),Xw(Gt,j,H,_,l),Hp(Cl(Y,H));break e}}_=Y=Cl(Y,H),dn!==4&&(dn=2),mu===null?mu=[_]:mu.push(_),_=j;do{switch(_.tag){case 3:_.flags|=65536,l&=-l,_.lanes|=l;var re=Gw(_,Y,l);ww(_,re);break e;case 1:H=Y;var J=_.type,se=_.stateNode;if((_.flags&128)===0&&(typeof J.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(ho===null||!ho.has(se)))){_.flags|=65536,l&=-l,_.lanes|=l;var we=Kw(_,H,l);ww(_,we);break e}}_=_.return}while(_!==null)}Ab(h)}catch(De){l=De,nn===h&&h!==null&&(nn=h=h.return);continue}break}while(!0)}function Tb(){var i=qh.current;return qh.current=Fh,i===null?Fh:i}function Dg(){(dn===0||dn===3||dn===2)&&(dn=4),vn===null||(fa&268435455)===0&&(Hh&268435455)===0||po(vn,Cn)}function Xh(i,l){var h=dt;dt|=2;var p=Tb();(vn!==i||Cn!==l)&&(Ii=null,pa(i,l));do try{sC();break}catch(v){Eb(i,v)}while(!0);if(Gp(),dt=h,qh.current=p,nn!==null)throw Error(t(261));return vn=null,Cn=0,dn}function sC(){for(;nn!==null;)kb(nn)}function iC(){for(;nn!==null&&!gt();)kb(nn)}function kb(i){var l=Rb(i.alternate,i,$r);i.memoizedProps=i.pendingProps,l===null?Ab(i):nn=l,Eg.current=null}function Ab(i){var l=i;do{var h=l.alternate;if(i=l.return,(l.flags&32768)===0){if(h=X2(h,l,$r),h!==null){nn=h;return}}else{if(h=J2(h,l),h!==null){h.flags&=32767,nn=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{dn=6,nn=null;return}}if(l=l.sibling,l!==null){nn=l;return}nn=l=i}while(l!==null);dn===0&&(dn=5)}function ga(i,l,h){var p=it,v=ls.transition;try{ls.transition=null,it=1,oC(i,l,h,p)}finally{ls.transition=v,it=p}return null}function oC(i,l,h,p){do jl();while(fo!==null);if((dt&6)!==0)throw Error(t(327));h=i.finishedWork;var v=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var _=h.lanes|h.childLanes;if(_t(i,_),i===vn&&(nn=vn=null,Cn=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||Gh||(Gh=!0,Pb(Ln,function(){return jl(),null})),_=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||_){_=ls.transition,ls.transition=null;var j=it;it=1;var H=dt;dt|=4,Eg.current=null,eC(i,h),xb(h,i),T2(Dp),to=!!jp,Dp=jp=null,i.current=h,tC(h),en(),dt=H,it=j,ls.transition=_}else i.current=h;if(Gh&&(Gh=!1,fo=i,Kh=v),_=i.pendingLanes,_===0&&(ho=null),Xd(h.stateNode),kr(i,We()),l!==null)for(p=i.onRecoverableError,h=0;h<l.length;h++)v=l[h],p(v.value,{componentStack:v.stack,digest:v.digest});if(Wh)throw Wh=!1,i=Ag,Ag=null,i;return(Kh&1)!==0&&i.tag!==0&&jl(),_=i.pendingLanes,(_&1)!==0?i===Cg?pu++:(pu=0,Cg=i):pu=0,ao(),null}function jl(){if(fo!==null){var i=Zi(Kh),l=ls.transition,h=it;try{if(ls.transition=null,it=16>i?16:i,fo===null)var p=!1;else{if(i=fo,fo=null,Kh=0,(dt&6)!==0)throw Error(t(331));var v=dt;for(dt|=4,Ae=i.current;Ae!==null;){var _=Ae,j=_.child;if((Ae.flags&16)!==0){var H=_.deletions;if(H!==null){for(var Y=0;Y<H.length;Y++){var ie=H[Y];for(Ae=ie;Ae!==null;){var pe=Ae;switch(pe.tag){case 0:case 11:case 15:hu(8,pe,_)}var ye=pe.child;if(ye!==null)ye.return=pe,Ae=ye;else for(;Ae!==null;){pe=Ae;var he=pe.sibling,Te=pe.return;if(fb(pe),pe===ie){Ae=null;break}if(he!==null){he.return=Te,Ae=he;break}Ae=Te}}}var Ne=_.alternate;if(Ne!==null){var Pe=Ne.child;if(Pe!==null){Ne.child=null;do{var Gt=Pe.sibling;Pe.sibling=null,Pe=Gt}while(Pe!==null)}}Ae=_}}if((_.subtreeFlags&2064)!==0&&j!==null)j.return=_,Ae=j;else e:for(;Ae!==null;){if(_=Ae,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:hu(9,_,_.return)}var re=_.sibling;if(re!==null){re.return=_.return,Ae=re;break e}Ae=_.return}}var J=i.current;for(Ae=J;Ae!==null;){j=Ae;var se=j.child;if((j.subtreeFlags&2064)!==0&&se!==null)se.return=j,Ae=se;else e:for(j=J;Ae!==null;){if(H=Ae,(H.flags&2048)!==0)try{switch(H.tag){case 0:case 11:case 15:$h(9,H)}}catch(De){qt(H,H.return,De)}if(H===j){Ae=null;break e}var we=H.sibling;if(we!==null){we.return=H.return,Ae=we;break e}Ae=H.return}}if(dt=v,ao(),Or&&typeof Or.onPostCommitFiberRoot=="function")try{Or.onPostCommitFiberRoot(Vs,i)}catch{}p=!0}return p}finally{it=h,ls.transition=l}}return!1}function Cb(i,l,h){l=Cl(h,l),l=Gw(i,l,1),i=co(i,l,1),l=nr(),i!==null&&(Xi(i,1,l),kr(i,l))}function qt(i,l,h){if(i.tag===3)Cb(i,i,h);else for(;l!==null;){if(l.tag===3){Cb(l,i,h);break}else if(l.tag===1){var p=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(ho===null||!ho.has(p))){i=Cl(h,i),i=Kw(l,i,1),l=co(l,i,1),i=nr(),l!==null&&(Xi(l,1,i),kr(l,i));break}}l=l.return}}function aC(i,l,h){var p=i.pingCache;p!==null&&p.delete(l),l=nr(),i.pingedLanes|=i.suspendedLanes&h,vn===i&&(Cn&h)===h&&(dn===4||dn===3&&(Cn&130023424)===Cn&&500>We()-kg?pa(i,0):Tg|=h),kr(i,l)}function Nb(i,l){l===0&&((i.mode&1)===0?l=1:(l=nl,nl<<=1,(nl&130023424)===0&&(nl=4194304)));var h=nr();i=bi(i,l),i!==null&&(Xi(i,l,h),kr(i,h))}function lC(i){var l=i.memoizedState,h=0;l!==null&&(h=l.retryLane),Nb(i,h)}function cC(i,l){var h=0;switch(i.tag){case 13:var p=i.stateNode,v=i.memoizedState;v!==null&&(h=v.retryLane);break;case 19:p=i.stateNode;break;default:throw Error(t(314))}p!==null&&p.delete(l),Nb(i,h)}var Rb;Rb=function(i,l,h){if(i!==null)if(i.memoizedProps!==l.pendingProps||Sr.current)Er=!0;else{if((i.lanes&h)===0&&(l.flags&128)===0)return Er=!1,Y2(i,l,h);Er=(i.flags&131072)!==0}else Er=!1,Dt&&(l.flags&1048576)!==0&&uw(l,Th,l.index);switch(l.lanes=0,l.tag){case 2:var p=l.type;Uh(i,l),i=l.pendingProps;var v=bl(l,On.current);kl(l,h),v=sg(null,l,p,i,v,h);var _=ig();return l.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Ir(p)?(_=!0,Sh(l)):_=!1,l.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Xp(l),v.updater=Vh,l.stateNode=v,v._reactInternals=l,dg(l,p,i,h),l=pg(null,l,p,!0,_,h)):(l.tag=0,Dt&&_&&Up(l),tr(null,l,v,h),l=l.child),l;case 16:p=l.elementType;e:{switch(Uh(i,l),i=l.pendingProps,v=p._init,p=v(p._payload),l.type=p,v=l.tag=dC(p),i=ks(p,i),v){case 0:l=mg(null,l,p,i,h);break e;case 1:l=rb(null,l,p,i,h);break e;case 11:l=Jw(null,l,p,i,h);break e;case 14:l=Zw(null,l,p,ks(p.type,i),h);break e}throw Error(t(306,p,""))}return l;case 0:return p=l.type,v=l.pendingProps,v=l.elementType===p?v:ks(p,v),mg(i,l,p,v,h);case 1:return p=l.type,v=l.pendingProps,v=l.elementType===p?v:ks(p,v),rb(i,l,p,v,h);case 3:e:{if(sb(l),i===null)throw Error(t(387));p=l.pendingProps,_=l.memoizedState,v=_.element,vw(i,l),Ph(l,p,null,h);var j=l.memoizedState;if(p=j.element,_.isDehydrated)if(_={element:p,isDehydrated:!1,cache:j.cache,pendingSuspenseBoundaries:j.pendingSuspenseBoundaries,transitions:j.transitions},l.updateQueue.baseState=_,l.memoizedState=_,l.flags&256){v=Cl(Error(t(423)),l),l=ib(i,l,p,h,v);break e}else if(p!==v){v=Cl(Error(t(424)),l),l=ib(i,l,p,h,v);break e}else for(Br=so(l.stateNode.containerInfo.firstChild),Ur=l,Dt=!0,Ts=null,h=yw(l,null,p,h),l.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Il(),p===v){l=Si(i,l,h);break e}tr(i,l,p,h)}l=l.child}return l;case 5:return _w(l),i===null&&qp(l),p=l.type,v=l.pendingProps,_=i!==null?i.memoizedProps:null,j=v.children,Mp(p,v)?j=null:_!==null&&Mp(p,_)&&(l.flags|=32),nb(i,l),tr(i,l,j,h),l.child;case 6:return i===null&&qp(l),null;case 13:return ob(i,l,h);case 4:return Jp(l,l.stateNode.containerInfo),p=l.pendingProps,i===null?l.child=El(l,null,p,h):tr(i,l,p,h),l.child;case 11:return p=l.type,v=l.pendingProps,v=l.elementType===p?v:ks(p,v),Jw(i,l,p,v,h);case 7:return tr(i,l,l.pendingProps,h),l.child;case 8:return tr(i,l,l.pendingProps.children,h),l.child;case 12:return tr(i,l,l.pendingProps.children,h),l.child;case 10:e:{if(p=l.type._context,v=l.pendingProps,_=l.memoizedProps,j=v.value,Et(Ch,p._currentValue),p._currentValue=j,_!==null)if(Es(_.value,j)){if(_.children===v.children&&!Sr.current){l=Si(i,l,h);break e}}else for(_=l.child,_!==null&&(_.return=l);_!==null;){var H=_.dependencies;if(H!==null){j=_.child;for(var Y=H.firstContext;Y!==null;){if(Y.context===p){if(_.tag===1){Y=_i(-1,h&-h),Y.tag=2;var ie=_.updateQueue;if(ie!==null){ie=ie.shared;var pe=ie.pending;pe===null?Y.next=Y:(Y.next=pe.next,pe.next=Y),ie.pending=Y}}_.lanes|=h,Y=_.alternate,Y!==null&&(Y.lanes|=h),Qp(_.return,h,l),H.lanes|=h;break}Y=Y.next}}else if(_.tag===10)j=_.type===l.type?null:_.child;else if(_.tag===18){if(j=_.return,j===null)throw Error(t(341));j.lanes|=h,H=j.alternate,H!==null&&(H.lanes|=h),Qp(j,h,l),j=_.sibling}else j=_.child;if(j!==null)j.return=_;else for(j=_;j!==null;){if(j===l){j=null;break}if(_=j.sibling,_!==null){_.return=j.return,j=_;break}j=j.return}_=j}tr(i,l,v.children,h),l=l.child}return l;case 9:return v=l.type,p=l.pendingProps.children,kl(l,h),v=os(v),p=p(v),l.flags|=1,tr(i,l,p,h),l.child;case 14:return p=l.type,v=ks(p,l.pendingProps),v=ks(p.type,v),Zw(i,l,p,v,h);case 15:return eb(i,l,l.type,l.pendingProps,h);case 17:return p=l.type,v=l.pendingProps,v=l.elementType===p?v:ks(p,v),Uh(i,l),l.tag=1,Ir(p)?(i=!0,Sh(l)):i=!1,kl(l,h),Hw(l,p,v),dg(l,p,v,h),pg(null,l,p,!0,i,h);case 19:return lb(i,l,h);case 22:return tb(i,l,h)}throw Error(t(156,l.tag))};function Pb(i,l){return ge(i,l)}function uC(i,l,h,p){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cs(i,l,h,p){return new uC(i,l,h,p)}function Mg(i){return i=i.prototype,!(!i||!i.isReactComponent)}function dC(i){if(typeof i=="function")return Mg(i)?1:0;if(i!=null){if(i=i.$$typeof,i===L)return 11;if(i===K)return 14}return 2}function go(i,l){var h=i.alternate;return h===null?(h=cs(i.tag,l,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=l,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,l=i.dependencies,h.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function Jh(i,l,h,p,v,_){var j=2;if(p=i,typeof i=="function")Mg(i)&&(j=1);else if(typeof i=="string")j=5;else e:switch(i){case R:return ya(h.children,v,_,l);case k:j=8,v|=8;break;case P:return i=cs(12,h,l,v|2),i.elementType=P,i.lanes=_,i;case C:return i=cs(13,h,l,v),i.elementType=C,i.lanes=_,i;case G:return i=cs(19,h,l,v),i.elementType=G,i.lanes=_,i;case ue:return Zh(h,v,_,l);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case T:j=10;break e;case D:j=9;break e;case L:j=11;break e;case K:j=14;break e;case ce:j=16,p=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return l=cs(j,h,l,v),l.elementType=i,l.type=p,l.lanes=_,l}function ya(i,l,h,p){return i=cs(7,i,p,l),i.lanes=h,i}function Zh(i,l,h,p){return i=cs(22,i,p,l),i.elementType=ue,i.lanes=h,i.stateNode={isHidden:!1},i}function Lg(i,l,h){return i=cs(6,i,null,l),i.lanes=h,i}function Og(i,l,h){return l=cs(4,i.children!==null?i.children:[],i.key,l),l.lanes=h,l.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},l}function hC(i,l,h,p,v){this.tag=l,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yi(0),this.expirationTimes=Yi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yi(0),this.identifierPrefix=p,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function Fg(i,l,h,p,v,_,j,H,Y){return i=new hC(i,l,h,H,Y),l===1?(l=1,_===!0&&(l|=8)):l=0,_=cs(3,null,null,l),i.current=_,_.stateNode=i,_.memoizedState={element:p,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xp(_),i}function fC(i,l,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:p==null?null:""+p,children:i,containerInfo:l,implementation:h}}function jb(i){if(!i)return oo;i=i._reactInternals;e:{if(xr(i)!==i||i.tag!==1)throw Error(t(170));var l=i;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Ir(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(i.tag===1){var h=i.type;if(Ir(h))return aw(i,h,l)}return l}function Db(i,l,h,p,v,_,j,H,Y){return i=Fg(h,p,!0,i,v,_,j,H,Y),i.context=jb(null),h=i.current,p=nr(),v=mo(h),_=_i(p,v),_.callback=l??null,co(h,_,v),i.current.lanes=v,Xi(i,v,p),kr(i,p),i}function ef(i,l,h,p){var v=l.current,_=nr(),j=mo(v);return h=jb(h),l.context===null?l.context=h:l.pendingContext=h,l=_i(_,j),l.payload={element:i},p=p===void 0?null:p,p!==null&&(l.callback=p),i=co(v,l,j),i!==null&&(Ns(i,v,j,_),Rh(i,v,j)),j}function tf(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Mb(i,l){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<l?h:l}}function Vg(i,l){Mb(i,l),(i=i.alternate)&&Mb(i,l)}function mC(){return null}var Lb=typeof reportError=="function"?reportError:function(i){console.error(i)};function zg(i){this._internalRoot=i}nf.prototype.render=zg.prototype.render=function(i){var l=this._internalRoot;if(l===null)throw Error(t(409));ef(i,l,null,null)},nf.prototype.unmount=zg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var l=i.containerInfo;ma(function(){ef(null,i,null,null)}),l[yi]=null}};function nf(i){this._internalRoot=i}nf.prototype.unstable_scheduleHydration=function(i){if(i){var l=nh();i={blockedOn:null,target:i,priority:l};for(var h=0;h<Us.length&&l!==0&&l<Us[h].priority;h++);Us.splice(h,0,i),h===0&&ih(i)}};function Ug(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function rf(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Ob(){}function pC(i,l,h,p,v){if(v){if(typeof p=="function"){var _=p;p=function(){var ie=tf(j);_.call(ie)}}var j=Db(l,p,i,0,null,!1,!1,"",Ob);return i._reactRootContainer=j,i[yi]=j.current,Zc(i.nodeType===8?i.parentNode:i),ma(),j}for(;v=i.lastChild;)i.removeChild(v);if(typeof p=="function"){var H=p;p=function(){var ie=tf(Y);H.call(ie)}}var Y=Fg(i,0,!1,null,null,!1,!1,"",Ob);return i._reactRootContainer=Y,i[yi]=Y.current,Zc(i.nodeType===8?i.parentNode:i),ma(function(){ef(l,Y,h,p)}),Y}function sf(i,l,h,p,v){var _=h._reactRootContainer;if(_){var j=_;if(typeof v=="function"){var H=v;v=function(){var Y=tf(j);H.call(Y)}}ef(l,j,i,v)}else j=pC(h,l,i,v,p);return tf(j)}eh=function(i){switch(i.tag){case 3:var l=i.stateNode;if(l.current.memoizedState.isDehydrated){var h=Qi(l.pendingLanes);h!==0&&(Ji(l,h|1),kr(l,We()),(dt&6)===0&&(Pl=We()+500,ao()))}break;case 13:ma(function(){var p=bi(i,1);if(p!==null){var v=nr();Ns(p,i,1,v)}}),Vg(i,1)}},rl=function(i){if(i.tag===13){var l=bi(i,134217728);if(l!==null){var h=nr();Ns(l,i,134217728,h)}Vg(i,134217728)}},th=function(i){if(i.tag===13){var l=mo(i),h=bi(i,l);if(h!==null){var p=nr();Ns(h,i,l,p)}Vg(i,l)}},nh=function(){return it},rh=function(i,l){var h=it;try{return it=i,l()}finally{it=h}},vs=function(i,l,h){switch(l){case"input":if(Xn(i,h),l=h.name,h.type==="radio"&&l!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<h.length;l++){var p=h[l];if(p!==i&&p.form===i.form){var v=bh(p);if(!v)throw Error(t(90));Qn(p),Xn(p,v)}}}break;case"textarea":hr(i,h);break;case"select":l=h.value,l!=null&&dr(i,!!h.multiple,l,!1)}},pr=Pg,Xo=ma;var gC={usingClientEntryPoint:!1,Events:[nu,vl,bh,es,Rt,Pg]},gu={findFiberByHostInstance:oa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yC={bundleType:gu.bundleType,version:gu.version,rendererPackageName:gu.rendererPackageName,rendererConfig:gu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:W.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=je(i),i===null?null:i.stateNode},findFiberByHostInstance:gu.findFiberByHostInstance||mC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var of=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!of.isDisabled&&of.supportsFiber)try{Vs=of.inject(yC),Or=of}catch{}}return Ar.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gC,Ar.createPortal=function(i,l){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ug(l))throw Error(t(200));return fC(i,l,null,h)},Ar.createRoot=function(i,l){if(!Ug(i))throw Error(t(299));var h=!1,p="",v=Lb;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onRecoverableError!==void 0&&(v=l.onRecoverableError)),l=Fg(i,1,!1,null,null,h,!1,p,v),i[yi]=l.current,Zc(i.nodeType===8?i.parentNode:i),new zg(l)},Ar.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var l=i._reactInternals;if(l===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=je(l),i=i===null?null:i.stateNode,i},Ar.flushSync=function(i){return ma(i)},Ar.hydrate=function(i,l,h){if(!rf(l))throw Error(t(200));return sf(null,i,l,!0,h)},Ar.hydrateRoot=function(i,l,h){if(!Ug(i))throw Error(t(405));var p=h!=null&&h.hydratedSources||null,v=!1,_="",j=Lb;if(h!=null&&(h.unstable_strictMode===!0&&(v=!0),h.identifierPrefix!==void 0&&(_=h.identifierPrefix),h.onRecoverableError!==void 0&&(j=h.onRecoverableError)),l=Db(l,null,i,1,h??null,v,!1,_,j),i[yi]=l.current,Zc(i),p)for(i=0;i<p.length;i++)h=p[i],v=h._getVersion,v=v(h._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[h,v]:l.mutableSourceEagerHydrationData.push(h,v);return new nf(l)},Ar.render=function(i,l,h){if(!rf(l))throw Error(t(200));return sf(null,i,l,!1,h)},Ar.unmountComponentAtNode=function(i){if(!rf(i))throw Error(t(40));return i._reactRootContainer?(ma(function(){sf(null,null,i,!1,function(){i._reactRootContainer=null,i[yi]=null})}),!0):!1},Ar.unstable_batchedUpdates=Pg,Ar.unstable_renderSubtreeIntoContainer=function(i,l,h,p){if(!rf(h))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return sf(i,l,h,!1,p)},Ar.version="18.3.1-next-f1338f8080-20240426",Ar}var Wb;function kC(){if(Wb)return qg.exports;Wb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qg.exports=TC(),qg.exports}var Gb;function AC(){if(Gb)return af;Gb=1;var n=kC();return af.createRoot=n.createRoot,af.hydrateRoot=n.hydrateRoot,af}var CC=AC();const NC=Tm(CC),RC=()=>{};var Kb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},PC=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],a=n[t++],u=n[t++],d=((s&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{const o=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|a&63)}}return e.join("")},lI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const o=n[s],a=s+1<n.length,u=a?n[s+1]:0,d=s+2<n.length,f=d?n[s+2]:0,g=o>>2,y=(o&3)<<4|u>>4;let x=(u&15)<<2|f>>6,w=f&63;d||(w=64,a||(x=64)),r.push(t[g],t[y],t[x],t[w])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(aI(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):PC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],u=s<n.length?t[n.charAt(s)]:0;++s;const f=s<n.length?t[n.charAt(s)]:64;++s;const y=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||u==null||f==null||y==null)throw new jC;const x=o<<2|u>>4;if(r.push(x),f!==64){const w=u<<4&240|f>>2;if(r.push(w),y!==64){const E=f<<6&192|y;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class jC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const DC=function(n){const e=aI(n);return lI.encodeByteArray(e,!0)},Uf=function(n){return DC(n).replace(/\./g,"")},cI=function(n){try{return lI.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC=()=>uI().__FIREBASE_DEFAULTS__,LC=()=>{if(typeof process>"u"||typeof Kb>"u")return;const n=Kb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},OC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&cI(n[1]);return e&&JSON.parse(e)},km=()=>{try{return RC()||MC()||LC()||OC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},dI=n=>{var e,t;return(t=(e=km())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},hI=n=>{const e=dI(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},fI=()=>{var n;return(n=km())===null||n===void 0?void 0:n.config},mI=n=>{var e;return(e=km())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ga(n){return n.endsWith(".cloudworkstations.dev")}async function O0(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Uf(JSON.stringify(t)),Uf(JSON.stringify(a)),""].join(".")}const $u={};function zC(){const n={prod:[],emulator:[]};for(const e of Object.keys($u))$u[e]?n.emulator.push(e):n.prod.push(e);return n}function UC(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Qb=!1;function F0(n,e){if(typeof window>"u"||typeof document>"u"||!Ga(window.location.host)||$u[n]===e||$u[n]||Qb)return;$u[n]=e;function t(x){return`__firebase__banner__${x}`}const r="__firebase__banner",o=zC().prod.length>0;function a(){const x=document.getElementById(r);x&&x.remove()}function u(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function d(x,w){x.setAttribute("width","24"),x.setAttribute("id",w),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function f(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{Qb=!0,a()},x}function g(x,w){x.setAttribute("id",w),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function y(){const x=UC(r),w=t("text"),E=document.getElementById(w)||document.createElement("span"),S=t("learnmore"),A=document.getElementById(S)||document.createElement("a"),N=t("preprendIcon"),z=document.getElementById(N)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const U=x.element;u(U),g(A,S);const W=f();d(z,N),U.append(z,E,A,W),document.body.appendChild(U)}o?(E.innerText="Preview backend disconnected.",z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function BC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fn())}function pI(){var n;const e=(n=km())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $C(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function qC(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function HC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function WC(){const n=fn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function gI(){return!pI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function yI(){return!pI()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function xI(){try{return typeof indexedDB=="object"}catch{return!1}}function GC(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC="FirebaseError";class zi extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=KC,Object.setPrototypeOf(this,zi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,kd.prototype.create)}}class kd{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],a=o?QC(o,r):"Error",u=`${this.serviceName}: ${a} (${s}).`;return new zi(s,u,r)}}function QC(n,e){return n.replace(YC,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const YC=/\{\$([^}]+)}/g;function XC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Mo(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const o=n[s],a=e[s];if(Yb(o)&&Yb(a)){if(!Mo(o,a))return!1}else if(o!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Yb(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Lu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,o]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function Ou(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function JC(n,e){const t=new ZC(n,e);return t.subscribe.bind(t)}class ZC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");eN(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Gg),s.error===void 0&&(s.error=Gg),s.complete===void 0&&(s.complete=Gg);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function eN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Gg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(n){return n&&n._delegate?n._delegate:n}class Lo{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new FC;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(rN(e))try{this.getOrInitializeService({instanceIdentifier:wa})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=wa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=wa){return this.instances.has(e)}getOptions(e=wa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[o,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(s,o);const a=this.instances.get(s);return a&&e(a,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:nN(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=wa){return this.component?this.component.multipleInstances?e:wa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function nN(n){return n===wa?void 0:n}function rN(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new tN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(rt||(rt={}));const iN={debug:rt.DEBUG,verbose:rt.VERBOSE,info:rt.INFO,warn:rt.WARN,error:rt.ERROR,silent:rt.SILENT},oN=rt.INFO,aN={[rt.DEBUG]:"log",[rt.VERBOSE]:"log",[rt.INFO]:"info",[rt.WARN]:"warn",[rt.ERROR]:"error"},lN=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=aN[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class V0{constructor(e){this.name=e,this._logLevel=oN,this._logHandler=lN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in rt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?iN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,rt.DEBUG,...e),this._logHandler(this,rt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,rt.VERBOSE,...e),this._logHandler(this,rt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,rt.INFO,...e),this._logHandler(this,rt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,rt.WARN,...e),this._logHandler(this,rt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,rt.ERROR,...e),this._logHandler(this,rt.ERROR,...e)}}const cN=(n,e)=>e.some(t=>n instanceof t);let Xb,Jb;function uN(){return Xb||(Xb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function dN(){return Jb||(Jb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const vI=new WeakMap,Vy=new WeakMap,wI=new WeakMap,Kg=new WeakMap,z0=new WeakMap;function hN(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(Co(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&vI.set(t,n)}).catch(()=>{}),z0.set(e,n),e}function fN(n){if(Vy.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});Vy.set(n,e)}let zy={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Vy.get(n);if(e==="objectStoreNames")return n.objectStoreNames||wI.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Co(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function mN(n){zy=n(zy)}function pN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Qg(this),e,...t);return wI.set(r,e.sort?e.sort():[e]),Co(r)}:dN().includes(n)?function(...e){return n.apply(Qg(this),e),Co(vI.get(this))}:function(...e){return Co(n.apply(Qg(this),e))}}function gN(n){return typeof n=="function"?pN(n):(n instanceof IDBTransaction&&fN(n),cN(n,uN())?new Proxy(n,zy):n)}function Co(n){if(n instanceof IDBRequest)return hN(n);if(Kg.has(n))return Kg.get(n);const e=gN(n);return e!==n&&(Kg.set(n,e),z0.set(e,n)),e}const Qg=n=>z0.get(n);function yN(n,e,{blocked:t,upgrade:r,blocking:s,terminated:o}={}){const a=indexedDB.open(n,e),u=Co(a);return r&&a.addEventListener("upgradeneeded",d=>{r(Co(a.result),d.oldVersion,d.newVersion,Co(a.transaction),d)}),t&&a.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),u.then(d=>{o&&d.addEventListener("close",()=>o()),s&&d.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),u}const xN=["get","getKey","getAll","getAllKeys","count"],vN=["put","add","delete","clear"],Yg=new Map;function Zb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Yg.get(e))return Yg.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=vN.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||xN.includes(t)))return;const o=async function(a,...u){const d=this.transaction(a,s?"readwrite":"readonly");let f=d.store;return r&&(f=f.index(u.shift())),(await Promise.all([f[t](...u),s&&d.done]))[0]};return Yg.set(e,o),o}mN(n=>({...n,get:(e,t,r)=>Zb(e,t)||n.get(e,t,r),has:(e,t)=>!!Zb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(bN(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function bN(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Uy="@firebase/app",e1="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri=new V0("@firebase/app"),_N="@firebase/app-compat",SN="@firebase/analytics-compat",IN="@firebase/analytics",EN="@firebase/app-check-compat",TN="@firebase/app-check",kN="@firebase/auth",AN="@firebase/auth-compat",CN="@firebase/database",NN="@firebase/data-connect",RN="@firebase/database-compat",PN="@firebase/functions",jN="@firebase/functions-compat",DN="@firebase/installations",MN="@firebase/installations-compat",LN="@firebase/messaging",ON="@firebase/messaging-compat",FN="@firebase/performance",VN="@firebase/performance-compat",zN="@firebase/remote-config",UN="@firebase/remote-config-compat",BN="@firebase/storage",$N="@firebase/storage-compat",qN="@firebase/firestore",HN="@firebase/ai",WN="@firebase/firestore-compat",GN="firebase",KN="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const By="[DEFAULT]",QN={[Uy]:"fire-core",[_N]:"fire-core-compat",[IN]:"fire-analytics",[SN]:"fire-analytics-compat",[TN]:"fire-app-check",[EN]:"fire-app-check-compat",[kN]:"fire-auth",[AN]:"fire-auth-compat",[CN]:"fire-rtdb",[NN]:"fire-data-connect",[RN]:"fire-rtdb-compat",[PN]:"fire-fn",[jN]:"fire-fn-compat",[DN]:"fire-iid",[MN]:"fire-iid-compat",[LN]:"fire-fcm",[ON]:"fire-fcm-compat",[FN]:"fire-perf",[VN]:"fire-perf-compat",[zN]:"fire-rc",[UN]:"fire-rc-compat",[BN]:"fire-gcs",[$N]:"fire-gcs-compat",[qN]:"fire-fst",[WN]:"fire-fst-compat",[HN]:"fire-vertex","fire-js":"fire-js",[GN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rd=new Map,YN=new Map,$y=new Map;function t1(n,e){try{n.container.addComponent(e)}catch(t){Ri.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Pa(n){const e=n.name;if($y.has(e))return Ri.debug(`There were multiple attempts to register component ${e}.`),!1;$y.set(e,n);for(const t of rd.values())t1(t,n);for(const t of YN.values())t1(t,n);return!0}function Am(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function sr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},No=new kd("app","Firebase",XN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Lo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw No.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tc=KN;function bI(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:By,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw No.create("bad-app-name",{appName:String(s)});if(t||(t=fI()),!t)throw No.create("no-options");const o=rd.get(s);if(o){if(Mo(t,o.options)&&Mo(r,o.config))return o;throw No.create("duplicate-app",{appName:s})}const a=new sN(s);for(const d of $y.values())a.addComponent(d);const u=new JN(t,r,a);return rd.set(s,u),u}function Cm(n=By){const e=rd.get(n);if(!e&&n===By&&fI())return bI();if(!e)throw No.create("no-app",{appName:n});return e}function ZN(){return Array.from(rd.values())}function ei(n,e,t){var r;let s=(r=QN[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const u=[`Unable to register library "${s}" with version "${e}":`];o&&u.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ri.warn(u.join(" "));return}Pa(new Lo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eR="firebase-heartbeat-database",tR=1,sd="firebase-heartbeat-store";let Xg=null;function _I(){return Xg||(Xg=yN(eR,tR,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(sd)}catch(t){console.warn(t)}}}}).catch(n=>{throw No.create("idb-open",{originalErrorMessage:n.message})})),Xg}async function nR(n){try{const t=(await _I()).transaction(sd),r=await t.objectStore(sd).get(SI(n));return await t.done,r}catch(e){if(e instanceof zi)Ri.warn(e.message);else{const t=No.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ri.warn(t.message)}}}async function n1(n,e){try{const r=(await _I()).transaction(sd,"readwrite");await r.objectStore(sd).put(e,SI(n)),await r.done}catch(t){if(t instanceof zi)Ri.warn(t.message);else{const r=No.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ri.warn(r.message)}}}function SI(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=1024,sR=30;class iR{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new aR(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=r1();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>sR){const a=lR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Ri.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=r1(),{heartbeatsToSend:r,unsentEntries:s}=oR(this._heartbeatsCache.heartbeats),o=Uf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return Ri.warn(t),""}}}function r1(){return new Date().toISOString().substring(0,10)}function oR(n,e=rR){const t=[];let r=n.slice();for(const s of n){const o=t.find(a=>a.agent===s.agent);if(o){if(o.dates.push(s.date),s1(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),s1(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class aR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xI()?GC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await nR(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return n1(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return n1(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function s1(n){return Uf(JSON.stringify({version:2,heartbeats:n})).length}function lR(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cR(n){Pa(new Lo("platform-logger",e=>new wN(e),"PRIVATE")),Pa(new Lo("heartbeat",e=>new iR(e),"PRIVATE")),ei(Uy,e1,n),ei(Uy,e1,"esm2017"),ei("fire-js","")}cR("");function U0(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function II(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const uR=II,EI=new kd("auth","Firebase",II());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bf=new V0("@firebase/auth");function dR(n,...e){Bf.logLevel<=rt.WARN&&Bf.warn(`Auth (${Tc}): ${n}`,...e)}function Sf(n,...e){Bf.logLevel<=rt.ERROR&&Bf.error(`Auth (${Tc}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hs(n,...e){throw $0(n,...e)}function Ms(n,...e){return $0(n,...e)}function B0(n,e,t){const r=Object.assign(Object.assign({},uR()),{[e]:t});return new kd("auth","Firebase",r).create(e,{appName:n.name})}function ti(n){return B0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hR(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&hs(n,"argument-error"),B0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function $0(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return EI.create(n,...e)}function Oe(n,e,...t){if(!n)throw $0(e,...t)}function Ai(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Sf(e),new Error(e)}function Pi(n,e){n||Ai(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $f(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function fR(){return i1()==="http:"||i1()==="https:"}function i1(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(fR()||qC()||"connection"in navigator)?navigator.onLine:!0}function pR(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(e,t){this.shortDelay=e,this.longDelay=t,Pi(t>e,"Short delay should be less than long delay!"),this.isMobile=BC()||HC()}get(){return mR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(n,e){Pi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ai("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ai("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ai("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yR=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],xR=new Cd(3e4,6e4);function Ui(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Bi(n,e,t,r,s={}){return kI(n,s,async()=>{let o={},a={};r&&(e==="GET"?a=r:o={body:JSON.stringify(r)});const u=Ad(Object.assign({key:n.config.apiKey},a)).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);const f=Object.assign({method:e,headers:d},o);return $C()||(f.referrerPolicy="no-referrer"),n.emulatorConfig&&Ga(n.emulatorConfig.host)&&(f.credentials="include"),TI.fetch()(await AI(n,n.config.apiHost,t,u),f)})}async function kI(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},gR),e);try{const s=new wR(n),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw lf(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const u=o.ok?a.errorMessage:a.error.message,[d,f]=u.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw lf(n,"credential-already-in-use",a);if(d==="EMAIL_EXISTS")throw lf(n,"email-already-in-use",a);if(d==="USER_DISABLED")throw lf(n,"user-disabled",a);const g=r[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw B0(n,g,f);hs(n,g)}}catch(s){if(s instanceof zi)throw s;hs(n,"network-request-failed",{message:String(s)})}}async function Nd(n,e,t,r,s={}){const o=await Bi(n,e,t,r,s);return"mfaPendingCredential"in o&&hs(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function AI(n,e,t,r){const s=`${e}${t}?${r}`,o=n,a=o.config.emulator?q0(n.config,s):`${n.config.apiScheme}://${s}`;return yR.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}function vR(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class wR{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ms(this.auth,"network-request-failed")),xR.get())})}}function lf(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Ms(n,e,r);return s.customData._tokenResponse=t,s}function o1(n){return n!==void 0&&n.enterprise!==void 0}class bR{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return vR(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function _R(n,e){return Bi(n,"GET","/v2/recaptchaConfig",Ui(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SR(n,e){return Bi(n,"POST","/v1/accounts:delete",e)}async function qf(n,e){return Bi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function IR(n,e=!1){const t=Lt(n),r=await t.getIdToken(e),s=H0(r);Oe(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,a=o==null?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:qu(Jg(s.auth_time)),issuedAtTime:qu(Jg(s.iat)),expirationTime:qu(Jg(s.exp)),signInProvider:a||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Jg(n){return Number(n)*1e3}function H0(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Sf("JWT malformed, contained fewer than 3 sections"),null;try{const s=cI(t);return s?JSON.parse(s):(Sf("Failed to decode base64 JWT payload"),null)}catch(s){return Sf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function a1(n){const e=H0(n);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function id(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof zi&&ER(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function ER({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=qu(this.lastLoginAt),this.creationTime=qu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hf(n){var e;const t=n.auth,r=await n.getIdToken(),s=await id(n,qf(t,{idToken:r}));Oe(s==null?void 0:s.users.length,t,"internal-error");const o=s.users[0];n._notifyReloadListener(o);const a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?CI(o.providerUserInfo):[],u=AR(n.providerData,a),d=n.isAnonymous,f=!(n.email&&o.passwordHash)&&!(u!=null&&u.length),g=d?f:!1,y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new qy(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(n,y)}async function kR(n){const e=Lt(n);await Hf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function AR(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function CI(n){return n.map(e=>{var{providerId:t}=e,r=U0(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CR(n,e){const t=await kI(n,{},async()=>{const r=Ad({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=n.config,a=await AI(n,s,"/v1/token",`key=${o}`),u=await n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:u,body:r};return n.emulatorConfig&&Ga(n.emulatorConfig.host)&&(d.credentials="include"),TI.fetch()(a,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function NR(n,e){return Bi(n,"POST","/v2/accounts:revokeToken",Ui(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):a1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");const t=a1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:o}=await CR(e,t);this.updateTokensAndExpiration(r,s,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:o}=t,a=new Yl;return r&&(Oe(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(Oe(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),o&&(Oe(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yl,this.toJSON())}_performRefresh(){return Ai("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xo(n,e){Oe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ds{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,o=U0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new TR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new qy(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await id(this,this.stsTokenManager.getToken(this.auth,e));return Oe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return IR(this,e)}reload(){return kR(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ds(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Hf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(sr(this.auth.app))return Promise.reject(ti(this.auth));const e=await this.getIdToken();return await id(this,SR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,o,a,u,d,f,g;const y=(r=t.displayName)!==null&&r!==void 0?r:void 0,x=(s=t.email)!==null&&s!==void 0?s:void 0,w=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,E=(a=t.photoURL)!==null&&a!==void 0?a:void 0,S=(u=t.tenantId)!==null&&u!==void 0?u:void 0,A=(d=t._redirectEventId)!==null&&d!==void 0?d:void 0,N=(f=t.createdAt)!==null&&f!==void 0?f:void 0,z=(g=t.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:U,emailVerified:W,isAnonymous:$,providerData:F,stsTokenManager:R}=t;Oe(U&&R,e,"internal-error");const k=Yl.fromJSON(this.name,R);Oe(typeof U=="string",e,"internal-error"),xo(y,e.name),xo(x,e.name),Oe(typeof W=="boolean",e,"internal-error"),Oe(typeof $=="boolean",e,"internal-error"),xo(w,e.name),xo(E,e.name),xo(S,e.name),xo(A,e.name),xo(N,e.name),xo(z,e.name);const P=new Ds({uid:U,auth:e,email:x,emailVerified:W,displayName:y,isAnonymous:$,photoURL:E,phoneNumber:w,tenantId:S,stsTokenManager:k,createdAt:N,lastLoginAt:z});return F&&Array.isArray(F)&&(P.providerData=F.map(T=>Object.assign({},T))),A&&(P._redirectEventId=A),P}static async _fromIdTokenResponse(e,t,r=!1){const s=new Yl;s.updateFromServerResponse(t);const o=new Ds({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Hf(o),o}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];Oe(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?CI(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),u=new Yl;u.updateFromIdToken(r);const d=new Ds({uid:s.localId,auth:e,stsTokenManager:u,isAnonymous:a}),f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new qy(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(d,f),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1=new Map;function Ci(n){Pi(n instanceof Function,"Expected a class definition");let e=l1.get(n);return e?(Pi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,l1.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}NI.type="NONE";const c1=NI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function If(n,e,t){return`firebase:${n}:${e}:${t}`}class Xl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:o}=this.auth;this.fullUserKey=If(this.userKey,s.apiKey,o),this.fullPersistenceKey=If("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await qf(this.auth,{idToken:e}).catch(()=>{});return t?Ds._fromGetAccountInfoResponse(this.auth,t,e):null}return Ds._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Xl(Ci(c1),e,r);const s=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let o=s[0]||Ci(c1);const a=If(r,e.config.apiKey,e.name);let u=null;for(const f of t)try{const g=await f._get(a);if(g){let y;if(typeof g=="string"){const x=await qf(e,{idToken:g}).catch(()=>{});if(!x)break;y=await Ds._fromGetAccountInfoResponse(e,x,g)}else y=Ds._fromJSON(e,g);f!==o&&(u=y),o=f;break}}catch{}const d=s.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new Xl(o,e,r):(o=d[0],u&&await o._set(a,u.toJSON()),await Promise.all(t.map(async f=>{if(f!==o)try{await f._remove(a)}catch{}})),new Xl(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u1(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(DI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(RI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(LI(e))return"Blackberry";if(OI(e))return"Webos";if(PI(e))return"Safari";if((e.includes("chrome/")||jI(e))&&!e.includes("edge/"))return"Chrome";if(MI(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function RI(n=fn()){return/firefox\//i.test(n)}function PI(n=fn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function jI(n=fn()){return/crios\//i.test(n)}function DI(n=fn()){return/iemobile/i.test(n)}function MI(n=fn()){return/android/i.test(n)}function LI(n=fn()){return/blackberry/i.test(n)}function OI(n=fn()){return/webos/i.test(n)}function W0(n=fn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function RR(n=fn()){var e;return W0(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function PR(){return WC()&&document.documentMode===10}function FI(n=fn()){return W0(n)||MI(n)||OI(n)||LI(n)||/windows phone/i.test(n)||DI(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VI(n,e=[]){let t;switch(n){case"Browser":t=u1(fn());break;case"Worker":t=`${u1(fn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Tc}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=o=>new Promise((a,u)=>{try{const d=e(o);a(d)}catch(d){u(d)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DR(n,e={}){return Bi(n,"GET","/v2/passwordPolicy",Ui(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR=6;class LR{constructor(e){var t,r,s,o;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:MR,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,o,a,u;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(t=d.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),d.isValid&&(d.isValid=(r=d.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),d.isValid&&(d.isValid=(s=d.containsLowercaseLetter)!==null&&s!==void 0?s:!0),d.isValid&&(d.isValid=(o=d.containsUppercaseLetter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(a=d.containsNumericCharacter)!==null&&a!==void 0?a:!0),d.isValid&&(d.isValid=(u=d.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),d}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new d1(this),this.idTokenSubscription=new d1(this),this.beforeStateQueue=new jR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=EI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ci(t)),this._initializationPromise=this.queue(async()=>{var r,s,o;if(!this._deleted&&(this.persistenceManager=await Xl.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await qf(this,{idToken:e}),r=await Ds._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(sr(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=s==null?void 0:s._redirectEventId,d=await this.tryRedirectSignIn(e);(!a||a===u)&&(d!=null&&d.user)&&(s=d.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Hf(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=pR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(sr(this.app))return Promise.reject(ti(this));const t=e?Lt(e):null;return t&&Oe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return sr(this.app)?Promise.reject(ti(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return sr(this.app)?Promise.reject(ti(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ci(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await DR(this),t=new LR(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new kd("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await NR(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ci(e)||this._popupRedirectResolver;Oe(t,this,"argument-error"),this.redirectPersistenceManager=await Xl.create(this,[Ci(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let a=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,r,s);return()=>{a=!0,d()}}else{const d=e.addObserver(t);return()=>{a=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=VI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;if(sr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&dR(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function ii(n){return Lt(n)}class d1{constructor(e){this.auth=e,this.observer=null,this.addObserver=JC(t=>this.observer=t)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function FR(n){Nm=n}function zI(n){return Nm.loadJS(n)}function VR(){return Nm.recaptchaEnterpriseScript}function zR(){return Nm.gapiScript}function UR(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class BR{constructor(){this.enterprise=new $R}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class $R{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const qR="recaptcha-enterprise",UI="NO_RECAPTCHA";class HR{constructor(e){this.type=qR,this.auth=ii(e)}async verify(e="verify",t=!1){async function r(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(a,u)=>{_R(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const f=new bR(d);return o.tenantId==null?o._agentRecaptchaConfig=f:o._tenantRecaptchaConfigs[o.tenantId]=f,a(f.siteKey)}}).catch(d=>{u(d)})})}function s(o,a,u){const d=window.grecaptcha;o1(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:e}).then(f=>{a(f)}).catch(()=>{a(UI)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new BR().execute("siteKey",{action:"verify"}):new Promise((o,a)=>{r(this.auth).then(u=>{if(!t&&o1(window.grecaptcha))s(u,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let d=VR();d.length!==0&&(d+=u),zI(d).then(()=>{s(u,o,a)}).catch(f=>{a(f)})}}).catch(u=>{a(u)})})}}async function h1(n,e,t,r=!1,s=!1){const o=new HR(n);let a;if(s)a=UI;else try{a=await o.verify(t)}catch{a=await o.verify(t,!0)}const u=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const d=u.phoneEnrollmentInfo.phoneNumber,f=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:f,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const d=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return r?Object.assign(u,{captchaResp:a}):Object.assign(u,{captchaResponse:a}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function od(n,e,t,r,s){var o;if(!((o=n._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await h1(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await h1(n,e,t,t==="getOobCode");return r(n,u)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WR(n,e){const t=Am(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),o=t.getOptions();if(Mo(o,e??{}))return s;hs(s,"already-initialized")}return t.initialize({options:e})}function GR(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Ci);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function KR(n,e,t){const r=ii(n);Oe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,o=BI(e),{host:a,port:u}=QR(e),d=u===null?"":`:${u}`,f={url:`${o}//${a}${d}/`},g=Object.freeze({host:a,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Oe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Oe(Mo(f,r.config.emulator)&&Mo(g,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=f,r.emulatorConfig=g,r.settings.appVerificationDisabledForTesting=!0,Ga(a)?(O0(`${o}//${a}${d}`),F0("Auth",!0)):YR()}function BI(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function QR(n){const e=BI(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const o=s[1];return{host:o,port:f1(r.substr(o.length+1))}}else{const[o,a]=r.split(":");return{host:o,port:f1(a)}}}function f1(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function YR(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ai("not implemented")}_getIdTokenResponse(e){return Ai("not implemented")}_linkToIdToken(e,t){return Ai("not implemented")}_getReauthenticationResolver(e){return Ai("not implemented")}}async function XR(n,e){return Bi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JR(n,e){return Nd(n,"POST","/v1/accounts:signInWithPassword",Ui(n,e))}async function $I(n,e){return Bi(n,"POST","/v1/accounts:sendOobCode",Ui(n,e))}async function ZR(n,e){return $I(n,e)}async function eP(n,e){return $I(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tP(n,e){return Nd(n,"POST","/v1/accounts:signInWithEmailLink",Ui(n,e))}async function nP(n,e){return Nd(n,"POST","/v1/accounts:signInWithEmailLink",Ui(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad extends G0{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new ad(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new ad(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return od(e,t,"signInWithPassword",JR);case"emailLink":return tP(e,{email:this._email,oobCode:this._password});default:hs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return od(e,r,"signUpPassword",XR);case"emailLink":return nP(e,{idToken:t,email:this._email,oobCode:this._password});default:hs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jl(n,e){return Nd(n,"POST","/v1/accounts:signInWithIdp",Ui(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP="http://localhost";class ja extends G0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ja(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):hs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,o=U0(t,["providerId","signInMethod"]);if(!r||!s)return null;const a=new ja(r,s);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Jl(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Jl(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Jl(e,t)}buildRequest(){const e={requestUri:rP,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ad(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sP(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function iP(n){const e=Lu(Ou(n)).link,t=e?Lu(Ou(e)).deep_link_id:null,r=Lu(Ou(n)).deep_link_id;return(r?Lu(Ou(r)).link:null)||r||t||e||n}class Rm{constructor(e){var t,r,s,o,a,u;const d=Lu(Ou(e)),f=(t=d.apiKey)!==null&&t!==void 0?t:null,g=(r=d.oobCode)!==null&&r!==void 0?r:null,y=sP((s=d.mode)!==null&&s!==void 0?s:null);Oe(f&&g&&y,"argument-error"),this.apiKey=f,this.operation=y,this.code=g,this.continueUrl=(o=d.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=d.lang)!==null&&a!==void 0?a:null,this.tenantId=(u=d.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const t=iP(e);try{return new Rm(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(){this.providerId=Ka.PROVIDER_ID}static credential(e,t){return ad._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Rm.parseLink(t);return Oe(r,"argument-error"),ad._fromEmailAndCode(e,r.code,r.tenantId)}}Ka.PROVIDER_ID="password";Ka.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ka.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd extends K0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So extends Rd{constructor(){super("facebook.com")}static credential(e){return ja._fromParams({providerId:So.PROVIDER_ID,signInMethod:So.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return So.credentialFromTaggedObject(e)}static credentialFromError(e){return So.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return So.credential(e.oauthAccessToken)}catch{return null}}}So.FACEBOOK_SIGN_IN_METHOD="facebook.com";So.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti extends Rd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ja._fromParams({providerId:Ti.PROVIDER_ID,signInMethod:Ti.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ti.credentialFromTaggedObject(e)}static credentialFromError(e){return Ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ti.credential(t,r)}catch{return null}}}Ti.GOOGLE_SIGN_IN_METHOD="google.com";Ti.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io extends Rd{constructor(){super("github.com")}static credential(e){return ja._fromParams({providerId:Io.PROVIDER_ID,signInMethod:Io.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Io.credentialFromTaggedObject(e)}static credentialFromError(e){return Io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Io.credential(e.oauthAccessToken)}catch{return null}}}Io.GITHUB_SIGN_IN_METHOD="github.com";Io.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo extends Rd{constructor(){super("twitter.com")}static credential(e,t){return ja._fromParams({providerId:Eo.PROVIDER_ID,signInMethod:Eo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Eo.credentialFromTaggedObject(e)}static credentialFromError(e){return Eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Eo.credential(t,r)}catch{return null}}}Eo.TWITTER_SIGN_IN_METHOD="twitter.com";Eo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oP(n,e){return Nd(n,"POST","/v1/accounts:signUp",Ui(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const o=await Ds._fromIdTokenResponse(e,r,s),a=m1(r);return new Da({user:o,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=m1(r);return new Da({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function m1(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf extends zi{constructor(e,t,r,s){var o;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Wf.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Wf(e,t,r,s)}}function qI(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Wf._fromErrorAndOperation(n,o,e,r):o})}async function aP(n,e,t=!1){const r=await id(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Da._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lP(n,e,t=!1){const{auth:r}=n;if(sr(r.app))return Promise.reject(ti(r));const s="reauthenticate";try{const o=await id(n,qI(r,s,e,n),t);Oe(o.idToken,r,"internal-error");const a=H0(o.idToken);Oe(a,r,"internal-error");const{sub:u}=a;return Oe(n.uid===u,r,"user-mismatch"),Da._forOperation(n,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&hs(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HI(n,e,t=!1){if(sr(n.app))return Promise.reject(ti(n));const r="signIn",s=await qI(n,r,e),o=await Da._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(o.user),o}async function WI(n,e){return HI(ii(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cP(n,e,t){var r;Oe(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),Oe(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),Oe(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(Oe(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(Oe(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GI(n){const e=ii(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function uP(n,e,t){const r=ii(n);await od(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",ZR)}async function dP(n,e,t){if(sr(n.app))return Promise.reject(ti(n));const r=ii(n),a=await od(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",oP).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&GI(n),d}),u=await Da._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(u.user),u}function hP(n,e,t){return sr(n.app)?Promise.reject(ti(n)):WI(Lt(n),Ka.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&GI(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fP(n,e,t){const r=ii(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(a,u){Oe(u.handleCodeInApp,r,"argument-error"),u&&cP(r,a,u)}o(s,t),await od(r,s,"getOobCode",eP)}function KI(n,e){const t=Rm.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function mP(n,e,t){if(sr(n.app))return Promise.reject(ti(n));const r=Lt(n),s=Ka.credentialWithLink(e,t||$f());return Oe(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),WI(r,s)}function pP(n,e,t,r){return Lt(n).onIdTokenChanged(e,t,r)}function gP(n,e,t){return Lt(n).beforeAuthStateChanged(e,t)}function yP(n,e,t,r){return Lt(n).onAuthStateChanged(e,t,r)}function xP(n){return Lt(n).signOut()}const Gf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Gf,"1"),this.storage.removeItem(Gf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vP=1e3,wP=10;class YI extends QI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=FI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,u,d)=>{this.notifyListeners(a,d)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},o=this.storage.getItem(r);PR()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,wP):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},vP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}YI.type="LOCAL";const bP=YI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI extends QI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}XI.type="SESSION";const JI=XI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _P(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Pm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:o}=t.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const u=Array.from(a).map(async f=>f(t.origin,o)),d=await _P(u);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Pm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,a;return new Promise((u,d)=>{const f=Q0("",20);s.port1.start();const g=setTimeout(()=>{d(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(y){const x=y;if(x.data.eventId===f)switch(x.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(x.data.response);break;default:clearTimeout(g),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(){return window}function IP(n){ni().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZI(){return typeof ni().WorkerGlobalScope<"u"&&typeof ni().importScripts=="function"}async function EP(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function TP(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function kP(){return ZI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eE="firebaseLocalStorageDb",AP=1,Kf="firebaseLocalStorage",tE="fbase_key";class Pd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function jm(n,e){return n.transaction([Kf],e?"readwrite":"readonly").objectStore(Kf)}function CP(){const n=indexedDB.deleteDatabase(eE);return new Pd(n).toPromise()}function Hy(){const n=indexedDB.open(eE,AP);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Kf,{keyPath:tE})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Kf)?e(r):(r.close(),await CP(),e(await Hy()))})})}async function p1(n,e,t){const r=jm(n,!0).put({[tE]:e,value:t});return new Pd(r).toPromise()}async function NP(n,e){const t=jm(n,!1).get(e),r=await new Pd(t).toPromise();return r===void 0?null:r.value}function g1(n,e){const t=jm(n,!0).delete(e);return new Pd(t).toPromise()}const RP=800,PP=3;class nE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Hy(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>PP)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ZI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Pm._getInstance(kP()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await EP(),!this.activeServiceWorker)return;this.sender=new SP(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||TP()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Hy();return await p1(e,Gf,"1"),await g1(e,Gf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>p1(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>NP(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>g1(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=jm(s,!1).getAll();return new Pd(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),RP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}nE.type="LOCAL";const jP=nE;new Cd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(n,e){return e?Ci(e):(Oe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0 extends G0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function DP(n){return HI(n.auth,new Y0(n),n.bypassAuthState)}function MP(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),lP(t,new Y0(n),n.bypassAuthState)}async function LP(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),aP(t,new Y0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{constructor(e,t,r,s,o=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:o,error:a,type:u}=e;if(a){this.reject(a);return}const d={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(d))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return DP;case"linkViaPopup":case"linkViaRedirect":return LP;case"reauthViaPopup":case"reauthViaRedirect":return MP;default:hs(this.auth,"internal-error")}}resolve(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OP=new Cd(2e3,1e4);async function FP(n,e,t){if(sr(n.app))return Promise.reject(Ms(n,"operation-not-supported-in-this-environment"));const r=ii(n);hR(n,e,K0);const s=rE(r,t);return new ka(r,"signInViaPopup",e,s).executeNotNull()}class ka extends sE{constructor(e,t,r,s,o){super(e,t,s,o),this.provider=r,this.authWindow=null,this.pollId=null,ka.currentPopupAction&&ka.currentPopupAction.cancel(),ka.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Oe(e,this.auth,"internal-error"),e}async onExecution(){Pi(this.filter.length===1,"Popup operations only handle one event");const e=Q0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ms(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ms(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ka.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ms(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,OP.get())};e()}}ka.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP="pendingRedirect",Ef=new Map;class zP extends sE{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Ef.get(this.auth._key());if(!e){try{const r=await UP(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ef.set(this.auth._key(),e)}return this.bypassAuthState||Ef.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function UP(n,e){const t=qP(e),r=$P(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function BP(n,e){Ef.set(n._key(),e)}function $P(n){return Ci(n._redirectPersistence)}function qP(n){return If(VP,n.config.apiKey,n.name)}async function HP(n,e,t=!1){if(sr(n.app))return Promise.reject(ti(n));const r=ii(n),s=rE(r,e),a=await new zP(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WP=10*60*1e3;class GP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KP(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!iE(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Ms(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WP&&this.cachedEventUids.clear(),this.cachedEventUids.has(y1(e))}saveEventToCache(e){this.cachedEventUids.add(y1(e)),this.lastProcessedEventTime=Date.now()}}function y1(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function iE({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function KP(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return iE(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QP(n,e={}){return Bi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,XP=/^https?/;async function JP(n){if(n.config.emulator)return;const{authorizedDomains:e}=await QP(n);for(const t of e)try{if(ZP(t))return}catch{}hs(n,"unauthorized-domain")}function ZP(n){const e=$f(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!XP.test(t))return!1;if(YP.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej=new Cd(3e4,6e4);function x1(){const n=ni().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function tj(n){return new Promise((e,t)=>{var r,s,o;function a(){x1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{x1(),t(Ms(n,"network-request-failed"))},timeout:ej.get()})}if(!((s=(r=ni().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((o=ni().gapi)===null||o===void 0)&&o.load)a();else{const u=UR("iframefcb");return ni()[u]=()=>{gapi.load?a():t(Ms(n,"network-request-failed"))},zI(`${zR()}?onload=${u}`).catch(d=>t(d))}}).catch(e=>{throw Tf=null,e})}let Tf=null;function nj(n){return Tf=Tf||tj(n),Tf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rj=new Cd(5e3,15e3),sj="__/auth/iframe",ij="emulator/auth/iframe",oj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},aj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lj(n){const e=n.config;Oe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?q0(e,ij):`https://${n.config.authDomain}/${sj}`,r={apiKey:e.apiKey,appName:n.name,v:Tc},s=aj.get(n.config.apiHost);s&&(r.eid=s);const o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${Ad(r).slice(1)}`}async function cj(n){const e=await nj(n),t=ni().gapi;return Oe(t,n,"internal-error"),e.open({where:document.body,url:lj(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:oj,dontclear:!0},r=>new Promise(async(s,o)=>{await r.restyle({setHideOnLeave:!1});const a=Ms(n,"network-request-failed"),u=ni().setTimeout(()=>{o(a)},rj.get());function d(){ni().clearTimeout(u),s(r)}r.ping(d).then(d,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},dj=500,hj=600,fj="_blank",mj="http://localhost";class v1{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function pj(n,e,t,r=dj,s=hj){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const d=Object.assign(Object.assign({},uj),{width:r.toString(),height:s.toString(),top:o,left:a}),f=fn().toLowerCase();t&&(u=jI(f)?fj:t),RI(f)&&(e=e||mj,d.scrollbars="yes");const g=Object.entries(d).reduce((x,[w,E])=>`${x}${w}=${E},`,"");if(RR(f)&&u!=="_self")return gj(e||"",u),new v1(null);const y=window.open(e||"",u,g);Oe(y,n,"popup-blocked");try{y.focus()}catch{}return new v1(y)}function gj(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yj="__/auth/handler",xj="emulator/auth/handler",vj=encodeURIComponent("fac");async function w1(n,e,t,r,s,o){Oe(n.config.authDomain,n,"auth-domain-config-required"),Oe(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Tc,eventId:s};if(e instanceof K0){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",XC(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,y]of Object.entries({}))a[g]=y}if(e instanceof Rd){const g=e.getScopes().filter(y=>y!=="");g.length>0&&(a.scopes=g.join(","))}n.tenantId&&(a.tid=n.tenantId);const u=a;for(const g of Object.keys(u))u[g]===void 0&&delete u[g];const d=await n._getAppCheckToken(),f=d?`#${vj}=${encodeURIComponent(d)}`:"";return`${wj(n)}?${Ad(u).slice(1)}${f}`}function wj({config:n}){return n.emulator?q0(n,xj):`https://${n.authDomain}/${yj}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zg="webStorageSupport";class bj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=JI,this._completeRedirectFn=HP,this._overrideRedirectResult=BP}async _openPopup(e,t,r,s){var o;Pi((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const a=await w1(e,t,r,$f(),s);return pj(e,a,Q0())}async _openRedirect(e,t,r,s){await this._originValidation(e);const o=await w1(e,t,r,$f(),s);return IP(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(Pi(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await cj(e),r=new GP(e);return t.register("authEvent",s=>(Oe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Zg,{type:Zg},s=>{var o;const a=(o=s==null?void 0:s[0])===null||o===void 0?void 0:o[Zg];a!==void 0&&t(!!a),hs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=JP(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return FI()||PI()||W0()}}const _j=bj;var b1="@firebase/auth",_1="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ij(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ej(n){Pa(new Lo("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;Oe(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const d={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:VI(n)},f=new OR(r,s,o,d);return GR(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Pa(new Lo("auth-internal",e=>{const t=ii(e.getProvider("auth").getImmediate());return(r=>new Sj(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ei(b1,_1,Ij(n)),ei(b1,_1,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tj=5*60,kj=mI("authIdTokenMaxAge")||Tj;let S1=null;const Aj=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>kj)return;const s=t==null?void 0:t.token;S1!==s&&(S1=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Cj(n=Cm()){const e=Am(n,"auth");if(e.isInitialized())return e.getImmediate();const t=WR(n,{popupRedirectResolver:_j,persistence:[jP,bP,JI]}),r=mI("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const a=Aj(o.toString());gP(t,a,()=>a(t.currentUser)),pP(t,u=>a(u))}}const s=dI("auth");return s&&KR(t,`http://${s}`),t}function Nj(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}FR({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const o=Ms("internal-error");o.customData=s,t(o)},r.type="text/javascript",r.charset="UTF-8",Nj().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Ej("Browser");var I1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ro,oE;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,k){function P(){}P.prototype=k.prototype,R.D=k.prototype,R.prototype=new P,R.prototype.constructor=R,R.C=function(T,D,L){for(var C=Array(arguments.length-2),G=2;G<arguments.length;G++)C[G-2]=arguments[G];return k.prototype[D].apply(T,C)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(R,k,P){P||(P=0);var T=Array(16);if(typeof k=="string")for(var D=0;16>D;++D)T[D]=k.charCodeAt(P++)|k.charCodeAt(P++)<<8|k.charCodeAt(P++)<<16|k.charCodeAt(P++)<<24;else for(D=0;16>D;++D)T[D]=k[P++]|k[P++]<<8|k[P++]<<16|k[P++]<<24;k=R.g[0],P=R.g[1],D=R.g[2];var L=R.g[3],C=k+(L^P&(D^L))+T[0]+3614090360&4294967295;k=P+(C<<7&4294967295|C>>>25),C=L+(D^k&(P^D))+T[1]+3905402710&4294967295,L=k+(C<<12&4294967295|C>>>20),C=D+(P^L&(k^P))+T[2]+606105819&4294967295,D=L+(C<<17&4294967295|C>>>15),C=P+(k^D&(L^k))+T[3]+3250441966&4294967295,P=D+(C<<22&4294967295|C>>>10),C=k+(L^P&(D^L))+T[4]+4118548399&4294967295,k=P+(C<<7&4294967295|C>>>25),C=L+(D^k&(P^D))+T[5]+1200080426&4294967295,L=k+(C<<12&4294967295|C>>>20),C=D+(P^L&(k^P))+T[6]+2821735955&4294967295,D=L+(C<<17&4294967295|C>>>15),C=P+(k^D&(L^k))+T[7]+4249261313&4294967295,P=D+(C<<22&4294967295|C>>>10),C=k+(L^P&(D^L))+T[8]+1770035416&4294967295,k=P+(C<<7&4294967295|C>>>25),C=L+(D^k&(P^D))+T[9]+2336552879&4294967295,L=k+(C<<12&4294967295|C>>>20),C=D+(P^L&(k^P))+T[10]+4294925233&4294967295,D=L+(C<<17&4294967295|C>>>15),C=P+(k^D&(L^k))+T[11]+2304563134&4294967295,P=D+(C<<22&4294967295|C>>>10),C=k+(L^P&(D^L))+T[12]+1804603682&4294967295,k=P+(C<<7&4294967295|C>>>25),C=L+(D^k&(P^D))+T[13]+4254626195&4294967295,L=k+(C<<12&4294967295|C>>>20),C=D+(P^L&(k^P))+T[14]+2792965006&4294967295,D=L+(C<<17&4294967295|C>>>15),C=P+(k^D&(L^k))+T[15]+1236535329&4294967295,P=D+(C<<22&4294967295|C>>>10),C=k+(D^L&(P^D))+T[1]+4129170786&4294967295,k=P+(C<<5&4294967295|C>>>27),C=L+(P^D&(k^P))+T[6]+3225465664&4294967295,L=k+(C<<9&4294967295|C>>>23),C=D+(k^P&(L^k))+T[11]+643717713&4294967295,D=L+(C<<14&4294967295|C>>>18),C=P+(L^k&(D^L))+T[0]+3921069994&4294967295,P=D+(C<<20&4294967295|C>>>12),C=k+(D^L&(P^D))+T[5]+3593408605&4294967295,k=P+(C<<5&4294967295|C>>>27),C=L+(P^D&(k^P))+T[10]+38016083&4294967295,L=k+(C<<9&4294967295|C>>>23),C=D+(k^P&(L^k))+T[15]+3634488961&4294967295,D=L+(C<<14&4294967295|C>>>18),C=P+(L^k&(D^L))+T[4]+3889429448&4294967295,P=D+(C<<20&4294967295|C>>>12),C=k+(D^L&(P^D))+T[9]+568446438&4294967295,k=P+(C<<5&4294967295|C>>>27),C=L+(P^D&(k^P))+T[14]+3275163606&4294967295,L=k+(C<<9&4294967295|C>>>23),C=D+(k^P&(L^k))+T[3]+4107603335&4294967295,D=L+(C<<14&4294967295|C>>>18),C=P+(L^k&(D^L))+T[8]+1163531501&4294967295,P=D+(C<<20&4294967295|C>>>12),C=k+(D^L&(P^D))+T[13]+2850285829&4294967295,k=P+(C<<5&4294967295|C>>>27),C=L+(P^D&(k^P))+T[2]+4243563512&4294967295,L=k+(C<<9&4294967295|C>>>23),C=D+(k^P&(L^k))+T[7]+1735328473&4294967295,D=L+(C<<14&4294967295|C>>>18),C=P+(L^k&(D^L))+T[12]+2368359562&4294967295,P=D+(C<<20&4294967295|C>>>12),C=k+(P^D^L)+T[5]+4294588738&4294967295,k=P+(C<<4&4294967295|C>>>28),C=L+(k^P^D)+T[8]+2272392833&4294967295,L=k+(C<<11&4294967295|C>>>21),C=D+(L^k^P)+T[11]+1839030562&4294967295,D=L+(C<<16&4294967295|C>>>16),C=P+(D^L^k)+T[14]+4259657740&4294967295,P=D+(C<<23&4294967295|C>>>9),C=k+(P^D^L)+T[1]+2763975236&4294967295,k=P+(C<<4&4294967295|C>>>28),C=L+(k^P^D)+T[4]+1272893353&4294967295,L=k+(C<<11&4294967295|C>>>21),C=D+(L^k^P)+T[7]+4139469664&4294967295,D=L+(C<<16&4294967295|C>>>16),C=P+(D^L^k)+T[10]+3200236656&4294967295,P=D+(C<<23&4294967295|C>>>9),C=k+(P^D^L)+T[13]+681279174&4294967295,k=P+(C<<4&4294967295|C>>>28),C=L+(k^P^D)+T[0]+3936430074&4294967295,L=k+(C<<11&4294967295|C>>>21),C=D+(L^k^P)+T[3]+3572445317&4294967295,D=L+(C<<16&4294967295|C>>>16),C=P+(D^L^k)+T[6]+76029189&4294967295,P=D+(C<<23&4294967295|C>>>9),C=k+(P^D^L)+T[9]+3654602809&4294967295,k=P+(C<<4&4294967295|C>>>28),C=L+(k^P^D)+T[12]+3873151461&4294967295,L=k+(C<<11&4294967295|C>>>21),C=D+(L^k^P)+T[15]+530742520&4294967295,D=L+(C<<16&4294967295|C>>>16),C=P+(D^L^k)+T[2]+3299628645&4294967295,P=D+(C<<23&4294967295|C>>>9),C=k+(D^(P|~L))+T[0]+4096336452&4294967295,k=P+(C<<6&4294967295|C>>>26),C=L+(P^(k|~D))+T[7]+1126891415&4294967295,L=k+(C<<10&4294967295|C>>>22),C=D+(k^(L|~P))+T[14]+2878612391&4294967295,D=L+(C<<15&4294967295|C>>>17),C=P+(L^(D|~k))+T[5]+4237533241&4294967295,P=D+(C<<21&4294967295|C>>>11),C=k+(D^(P|~L))+T[12]+1700485571&4294967295,k=P+(C<<6&4294967295|C>>>26),C=L+(P^(k|~D))+T[3]+2399980690&4294967295,L=k+(C<<10&4294967295|C>>>22),C=D+(k^(L|~P))+T[10]+4293915773&4294967295,D=L+(C<<15&4294967295|C>>>17),C=P+(L^(D|~k))+T[1]+2240044497&4294967295,P=D+(C<<21&4294967295|C>>>11),C=k+(D^(P|~L))+T[8]+1873313359&4294967295,k=P+(C<<6&4294967295|C>>>26),C=L+(P^(k|~D))+T[15]+4264355552&4294967295,L=k+(C<<10&4294967295|C>>>22),C=D+(k^(L|~P))+T[6]+2734768916&4294967295,D=L+(C<<15&4294967295|C>>>17),C=P+(L^(D|~k))+T[13]+1309151649&4294967295,P=D+(C<<21&4294967295|C>>>11),C=k+(D^(P|~L))+T[4]+4149444226&4294967295,k=P+(C<<6&4294967295|C>>>26),C=L+(P^(k|~D))+T[11]+3174756917&4294967295,L=k+(C<<10&4294967295|C>>>22),C=D+(k^(L|~P))+T[2]+718787259&4294967295,D=L+(C<<15&4294967295|C>>>17),C=P+(L^(D|~k))+T[9]+3951481745&4294967295,R.g[0]=R.g[0]+k&4294967295,R.g[1]=R.g[1]+(D+(C<<21&4294967295|C>>>11))&4294967295,R.g[2]=R.g[2]+D&4294967295,R.g[3]=R.g[3]+L&4294967295}r.prototype.u=function(R,k){k===void 0&&(k=R.length);for(var P=k-this.blockSize,T=this.B,D=this.h,L=0;L<k;){if(D==0)for(;L<=P;)s(this,R,L),L+=this.blockSize;if(typeof R=="string"){for(;L<k;)if(T[D++]=R.charCodeAt(L++),D==this.blockSize){s(this,T),D=0;break}}else for(;L<k;)if(T[D++]=R[L++],D==this.blockSize){s(this,T),D=0;break}}this.h=D,this.o+=k},r.prototype.v=function(){var R=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);R[0]=128;for(var k=1;k<R.length-8;++k)R[k]=0;var P=8*this.o;for(k=R.length-8;k<R.length;++k)R[k]=P&255,P/=256;for(this.u(R),R=Array(16),k=P=0;4>k;++k)for(var T=0;32>T;T+=8)R[P++]=this.g[k]>>>T&255;return R};function o(R,k){var P=u;return Object.prototype.hasOwnProperty.call(P,R)?P[R]:P[R]=k(R)}function a(R,k){this.h=k;for(var P=[],T=!0,D=R.length-1;0<=D;D--){var L=R[D]|0;T&&L==k||(P[D]=L,T=!1)}this.g=P}var u={};function d(R){return-128<=R&&128>R?o(R,function(k){return new a([k|0],0>k?-1:0)}):new a([R|0],0>R?-1:0)}function f(R){if(isNaN(R)||!isFinite(R))return y;if(0>R)return A(f(-R));for(var k=[],P=1,T=0;R>=P;T++)k[T]=R/P|0,P*=4294967296;return new a(k,0)}function g(R,k){if(R.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(R.charAt(0)=="-")return A(g(R.substring(1),k));if(0<=R.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=f(Math.pow(k,8)),T=y,D=0;D<R.length;D+=8){var L=Math.min(8,R.length-D),C=parseInt(R.substring(D,D+L),k);8>L?(L=f(Math.pow(k,L)),T=T.j(L).add(f(C))):(T=T.j(P),T=T.add(f(C)))}return T}var y=d(0),x=d(1),w=d(16777216);n=a.prototype,n.m=function(){if(S(this))return-A(this).m();for(var R=0,k=1,P=0;P<this.g.length;P++){var T=this.i(P);R+=(0<=T?T:4294967296+T)*k,k*=4294967296}return R},n.toString=function(R){if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(E(this))return"0";if(S(this))return"-"+A(this).toString(R);for(var k=f(Math.pow(R,6)),P=this,T="";;){var D=W(P,k).g;P=N(P,D.j(k));var L=((0<P.g.length?P.g[0]:P.h)>>>0).toString(R);if(P=D,E(P))return L+T;for(;6>L.length;)L="0"+L;T=L+T}},n.i=function(R){return 0>R?0:R<this.g.length?this.g[R]:this.h};function E(R){if(R.h!=0)return!1;for(var k=0;k<R.g.length;k++)if(R.g[k]!=0)return!1;return!0}function S(R){return R.h==-1}n.l=function(R){return R=N(this,R),S(R)?-1:E(R)?0:1};function A(R){for(var k=R.g.length,P=[],T=0;T<k;T++)P[T]=~R.g[T];return new a(P,~R.h).add(x)}n.abs=function(){return S(this)?A(this):this},n.add=function(R){for(var k=Math.max(this.g.length,R.g.length),P=[],T=0,D=0;D<=k;D++){var L=T+(this.i(D)&65535)+(R.i(D)&65535),C=(L>>>16)+(this.i(D)>>>16)+(R.i(D)>>>16);T=C>>>16,L&=65535,C&=65535,P[D]=C<<16|L}return new a(P,P[P.length-1]&-2147483648?-1:0)};function N(R,k){return R.add(A(k))}n.j=function(R){if(E(this)||E(R))return y;if(S(this))return S(R)?A(this).j(A(R)):A(A(this).j(R));if(S(R))return A(this.j(A(R)));if(0>this.l(w)&&0>R.l(w))return f(this.m()*R.m());for(var k=this.g.length+R.g.length,P=[],T=0;T<2*k;T++)P[T]=0;for(T=0;T<this.g.length;T++)for(var D=0;D<R.g.length;D++){var L=this.i(T)>>>16,C=this.i(T)&65535,G=R.i(D)>>>16,K=R.i(D)&65535;P[2*T+2*D]+=C*K,z(P,2*T+2*D),P[2*T+2*D+1]+=L*K,z(P,2*T+2*D+1),P[2*T+2*D+1]+=C*G,z(P,2*T+2*D+1),P[2*T+2*D+2]+=L*G,z(P,2*T+2*D+2)}for(T=0;T<k;T++)P[T]=P[2*T+1]<<16|P[2*T];for(T=k;T<2*k;T++)P[T]=0;return new a(P,0)};function z(R,k){for(;(R[k]&65535)!=R[k];)R[k+1]+=R[k]>>>16,R[k]&=65535,k++}function U(R,k){this.g=R,this.h=k}function W(R,k){if(E(k))throw Error("division by zero");if(E(R))return new U(y,y);if(S(R))return k=W(A(R),k),new U(A(k.g),A(k.h));if(S(k))return k=W(R,A(k)),new U(A(k.g),k.h);if(30<R.g.length){if(S(R)||S(k))throw Error("slowDivide_ only works with positive integers.");for(var P=x,T=k;0>=T.l(R);)P=$(P),T=$(T);var D=F(P,1),L=F(T,1);for(T=F(T,2),P=F(P,2);!E(T);){var C=L.add(T);0>=C.l(R)&&(D=D.add(P),L=C),T=F(T,1),P=F(P,1)}return k=N(R,D.j(k)),new U(D,k)}for(D=y;0<=R.l(k);){for(P=Math.max(1,Math.floor(R.m()/k.m())),T=Math.ceil(Math.log(P)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),L=f(P),C=L.j(k);S(C)||0<C.l(R);)P-=T,L=f(P),C=L.j(k);E(L)&&(L=x),D=D.add(L),R=N(R,C)}return new U(D,R)}n.A=function(R){return W(this,R).h},n.and=function(R){for(var k=Math.max(this.g.length,R.g.length),P=[],T=0;T<k;T++)P[T]=this.i(T)&R.i(T);return new a(P,this.h&R.h)},n.or=function(R){for(var k=Math.max(this.g.length,R.g.length),P=[],T=0;T<k;T++)P[T]=this.i(T)|R.i(T);return new a(P,this.h|R.h)},n.xor=function(R){for(var k=Math.max(this.g.length,R.g.length),P=[],T=0;T<k;T++)P[T]=this.i(T)^R.i(T);return new a(P,this.h^R.h)};function $(R){for(var k=R.g.length+1,P=[],T=0;T<k;T++)P[T]=R.i(T)<<1|R.i(T-1)>>>31;return new a(P,R.h)}function F(R,k){var P=k>>5;k%=32;for(var T=R.g.length-P,D=[],L=0;L<T;L++)D[L]=0<k?R.i(L+P)>>>k|R.i(L+P+1)<<32-k:R.i(L+P);return new a(D,R.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,oE=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=f,a.fromString=g,Ro=a}).apply(typeof I1<"u"?I1:typeof self<"u"?self:typeof window<"u"?window:{});var cf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var aE,Fu,lE,kf,Wy,cE,uE,dE;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,b,I){return m==Array.prototype||m==Object.prototype||(m[b]=I.value),m};function t(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof cf=="object"&&cf];for(var b=0;b<m.length;++b){var I=m[b];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var r=t(this);function s(m,b){if(b)e:{var I=r;m=m.split(".");for(var O=0;O<m.length-1;O++){var te=m[O];if(!(te in I))break e;I=I[te]}m=m[m.length-1],O=I[m],b=b(O),b!=O&&b!=null&&e(I,m,{configurable:!0,writable:!0,value:b})}}function o(m,b){m instanceof String&&(m+="");var I=0,O=!1,te={next:function(){if(!O&&I<m.length){var ae=I++;return{value:b(ae,m[ae]),done:!1}}return O=!0,{done:!0,value:void 0}}};return te[Symbol.iterator]=function(){return te},te}s("Array.prototype.values",function(m){return m||function(){return o(this,function(b,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},u=this||self;function d(m){var b=typeof m;return b=b!="object"?b:m?Array.isArray(m)?"array":b:"null",b=="array"||b=="object"&&typeof m.length=="number"}function f(m){var b=typeof m;return b=="object"&&m!=null||b=="function"}function g(m,b,I){return m.call.apply(m.bind,arguments)}function y(m,b,I){if(!m)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var te=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(te,O),m.apply(b,te)}}return function(){return m.apply(b,arguments)}}function x(m,b,I){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:y,x.apply(null,arguments)}function w(m,b){var I=Array.prototype.slice.call(arguments,1);return function(){var O=I.slice();return O.push.apply(O,arguments),m.apply(this,O)}}function E(m,b){function I(){}I.prototype=b.prototype,m.aa=b.prototype,m.prototype=new I,m.prototype.constructor=m,m.Qb=function(O,te,ae){for(var Ie=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)Ie[yt-2]=arguments[yt];return b.prototype[te].apply(O,Ie)}}function S(m){const b=m.length;if(0<b){const I=Array(b);for(let O=0;O<b;O++)I[O]=m[O];return I}return[]}function A(m,b){for(let I=1;I<arguments.length;I++){const O=arguments[I];if(d(O)){const te=m.length||0,ae=O.length||0;m.length=te+ae;for(let Ie=0;Ie<ae;Ie++)m[te+Ie]=O[Ie]}else m.push(O)}}class N{constructor(b,I){this.i=b,this.j=I,this.h=0,this.g=null}get(){let b;return 0<this.h?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function z(m){return/^[\s\xa0]*$/.test(m)}function U(){var m=u.navigator;return m&&(m=m.userAgent)?m:""}function W(m){return W[" "](m),m}W[" "]=function(){};var $=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function F(m,b,I){for(const O in m)b.call(I,m[O],O,m)}function R(m,b){for(const I in m)b.call(void 0,m[I],I,m)}function k(m){const b={};for(const I in m)b[I]=m[I];return b}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(m,b){let I,O;for(let te=1;te<arguments.length;te++){O=arguments[te];for(I in O)m[I]=O[I];for(let ae=0;ae<P.length;ae++)I=P[ae],Object.prototype.hasOwnProperty.call(O,I)&&(m[I]=O[I])}}function D(m){var b=1;m=m.split(":");const I=[];for(;0<b&&m.length;)I.push(m.shift()),b--;return m.length&&I.push(m.join(":")),I}function L(m){u.setTimeout(()=>{throw m},0)}function C(){var m=Z;let b=null;return m.g&&(b=m.g,m.g=m.g.next,m.g||(m.h=null),b.next=null),b}class G{constructor(){this.h=this.g=null}add(b,I){const O=K.get();O.set(b,I),this.h?this.h.next=O:this.g=O,this.h=O}}var K=new N(()=>new ce,m=>m.reset());class ce{constructor(){this.next=this.g=this.h=null}set(b,I){this.h=b,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,Q=!1,Z=new G,M=()=>{const m=u.Promise.resolve(void 0);ue=()=>{m.then(q)}};var q=()=>{for(var m;m=C();){try{m.h.call(m.g)}catch(I){L(I)}var b=K;b.j(m),100>b.h&&(b.h++,m.next=b.g,b.g=m)}Q=!1};function ne(){this.s=this.s,this.C=this.C}ne.prototype.s=!1,ne.prototype.ma=function(){this.s||(this.s=!0,this.N())},ne.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(m,b){this.type=m,this.g=this.target=b,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var de=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var m=!1,b=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const I=()=>{};u.addEventListener("test",I,b),u.removeEventListener("test",I,b)}catch{}return m}();function xe(m,b){if(V.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var I=this.type=m.type,O=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=b,b=m.relatedTarget){if($){e:{try{W(b.nodeName);var te=!0;break e}catch{}te=!1}te||(b=null)}}else I=="mouseover"?b=m.fromElement:I=="mouseout"&&(b=m.toElement);this.relatedTarget=b,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:be[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&xe.aa.h.call(this)}}E(xe,V);var be={2:"touch",3:"pen",4:"mouse"};xe.prototype.h=function(){xe.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var Be="closure_listenable_"+(1e6*Math.random()|0),He=0;function et(m,b,I,O,te){this.listener=m,this.proxy=null,this.src=b,this.type=I,this.capture=!!O,this.ha=te,this.key=++He,this.da=this.fa=!1}function wt(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function Sn(m){this.src=m,this.g={},this.h=0}Sn.prototype.add=function(m,b,I,O,te){var ae=m.toString();m=this.g[ae],m||(m=this.g[ae]=[],this.h++);var Ie=Yn(m,b,O,te);return-1<Ie?(b=m[Ie],I||(b.fa=!1)):(b=new et(b,this.src,ae,!!O,te),b.fa=I,m.push(b)),b};function Qn(m,b){var I=b.type;if(I in m.g){var O=m.g[I],te=Array.prototype.indexOf.call(O,b,void 0),ae;(ae=0<=te)&&Array.prototype.splice.call(O,te,1),ae&&(wt(b),m.g[I].length==0&&(delete m.g[I],m.h--))}}function Yn(m,b,I,O){for(var te=0;te<m.length;++te){var ae=m[te];if(!ae.da&&ae.listener==b&&ae.capture==!!I&&ae.ha==O)return te}return-1}var In="closure_lm_"+(1e6*Math.random()|0),Mr={};function Jr(m,b,I,O,te){if(Array.isArray(b)){for(var ae=0;ae<b.length;ae++)Jr(m,b[ae],I,O,te);return null}return I=fr(I),m&&m[Be]?m.K(b,I,f(O)?!!O.capture:!1,te):Xn(m,b,I,!1,O,te)}function Xn(m,b,I,O,te,ae){if(!b)throw Error("Invalid event type");var Ie=f(te)?!!te.capture:!!te,yt=Zr(m);if(yt||(m[In]=yt=new Sn(m)),I=yt.add(b,I,O,Ie,ae),I.proxy)return I;if(O=ys(),I.proxy=O,O.src=m,O.listener=I,m.addEventListener)de||(te=Ie),te===void 0&&(te=!1),m.addEventListener(b.toString(),O,te);else if(m.attachEvent)m.attachEvent(dr(b.toString()),O);else if(m.addListener&&m.removeListener)m.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return I}function ys(){function m(I){return b.call(m.src,m.listener,I)}const b=ai;return m}function ur(m,b,I,O,te){if(Array.isArray(b))for(var ae=0;ae<b.length;ae++)ur(m,b[ae],I,O,te);else O=f(O)?!!O.capture:!!O,I=fr(I),m&&m[Be]?(m=m.i,b=String(b).toString(),b in m.g&&(ae=m.g[b],I=Yn(ae,I,O,te),-1<I&&(wt(ae[I]),Array.prototype.splice.call(ae,I,1),ae.length==0&&(delete m.g[b],m.h--)))):m&&(m=Zr(m))&&(b=m.g[b.toString()],m=-1,b&&(m=Yn(b,I,O,te)),(I=-1<m?b[m]:null)&&Jn(I))}function Jn(m){if(typeof m!="number"&&m&&!m.da){var b=m.src;if(b&&b[Be])Qn(b.i,m);else{var I=m.type,O=m.proxy;b.removeEventListener?b.removeEventListener(I,O,m.capture):b.detachEvent?b.detachEvent(dr(I),O):b.addListener&&b.removeListener&&b.removeListener(O),(I=Zr(b))?(Qn(I,m),I.h==0&&(I.src=null,b[In]=null)):wt(m)}}}function dr(m){return m in Mr?Mr[m]:Mr[m]="on"+m}function ai(m,b){if(m.da)m=!0;else{b=new xe(b,this);var I=m.listener,O=m.ha||m.src;m.fa&&Jn(m),m=I.call(O,b)}return m}function Zr(m){return m=m[In],m instanceof Sn?m:null}var hr="__closure_events_fn_"+(1e9*Math.random()>>>0);function fr(m){return typeof m=="function"?m:(m[hr]||(m[hr]=function(b){return m.handleEvent(b)}),m[hr])}function oe(){ne.call(this),this.i=new Sn(this),this.M=this,this.F=null}E(oe,ne),oe.prototype[Be]=!0,oe.prototype.removeEventListener=function(m,b,I,O){ur(this,m,b,I,O)};function fe(m,b){var I,O=m.F;if(O)for(I=[];O;O=O.F)I.push(O);if(m=m.M,O=b.type||b,typeof b=="string")b=new V(b,m);else if(b instanceof V)b.target=b.target||m;else{var te=b;b=new V(O,m),T(b,te)}if(te=!0,I)for(var ae=I.length-1;0<=ae;ae--){var Ie=b.g=I[ae];te=Le(Ie,O,!0,b)&&te}if(Ie=b.g=m,te=Le(Ie,O,!0,b)&&te,te=Le(Ie,O,!1,b)&&te,I)for(ae=0;ae<I.length;ae++)Ie=b.g=I[ae],te=Le(Ie,O,!1,b)&&te}oe.prototype.N=function(){if(oe.aa.N.call(this),this.i){var m=this.i,b;for(b in m.g){for(var I=m.g[b],O=0;O<I.length;O++)wt(I[O]);delete m.g[b],m.h--}}this.F=null},oe.prototype.K=function(m,b,I,O){return this.i.add(String(m),b,!1,I,O)},oe.prototype.L=function(m,b,I,O){return this.i.add(String(m),b,!0,I,O)};function Le(m,b,I,O){if(b=m.i.g[String(b)],!b)return!0;b=b.concat();for(var te=!0,ae=0;ae<b.length;++ae){var Ie=b[ae];if(Ie&&!Ie.da&&Ie.capture==I){var yt=Ie.listener,cn=Ie.ha||Ie.src;Ie.fa&&Qn(m.i,Ie),te=yt.call(cn,O)!==!1&&te}}return te&&!O.defaultPrevented}function Qe(m,b,I){if(typeof m=="function")I&&(m=x(m,I));else if(m&&typeof m.handleEvent=="function")m=x(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:u.setTimeout(m,b||0)}function Xe(m){m.g=Qe(()=>{m.g=null,m.i&&(m.i=!1,Xe(m))},m.l);const b=m.h;m.h=null,m.m.apply(null,b)}class Bt extends ne{constructor(b,I){super(),this.m=b,this.l=I,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Xe(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Jt(m){ne.call(this),this.h=m,this.g={}}E(Jt,ne);var Zt=[];function Wt(m){F(m.g,function(b,I){this.g.hasOwnProperty(I)&&Jn(b)},m),m.g={}}Jt.prototype.N=function(){Jt.aa.N.call(this),Wt(this)},Jt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pn=u.JSON.stringify,Ft=u.JSON.parse,jn=class{stringify(m){return u.JSON.stringify(m,void 0)}parse(m){return u.JSON.parse(m,void 0)}};function an(){}an.prototype.h=null;function xs(m){return m.h||(m.h=m.i())}function vs(){}var mr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Dn(){V.call(this,"d")}E(Dn,V);function Ki(){V.call(this,"c")}E(Ki,V);var es={},Rt=null;function pr(){return Rt=Rt||new oe}es.La="serverreachability";function Xo(m){V.call(this,es.La,m)}E(Xo,V);function ts(m){const b=pr();fe(b,new Xo(b))}es.STAT_EVENT="statevent";function li(m,b){V.call(this,es.STAT_EVENT,m),this.stat=b}E(li,V);function Pt(m){const b=pr();fe(b,new li(b,m))}es.Ma="timingevent";function ci(m,b){V.call(this,es.Ma,m),this.size=b}E(ci,V);function Lr(m,b){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){m()},b)}function gn(){this.g=!0}gn.prototype.xa=function(){this.g=!1};function gr(m,b,I,O,te,ae){m.info(function(){if(m.g)if(ae)for(var Ie="",yt=ae.split("&"),cn=0;cn<yt.length;cn++){var lt=yt[cn].split("=");if(1<lt.length){var yn=lt[0];lt=lt[1];var tn=yn.split("_");Ie=2<=tn.length&&tn[1]=="type"?Ie+(yn+"="+lt+"&"):Ie+(yn+"=redacted&")}}else Ie=null;else Ie=ae;return"XMLHTTP REQ ("+O+") [attempt "+te+"]: "+b+`
`+I+`
`+Ie})}function ui(m,b,I,O,te,ae,Ie){m.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+te+"]: "+b+`
`+I+`
`+ae+" "+Ie})}function yr(m,b,I,O){m.info(function(){return"XMLHTTP TEXT ("+b+"): "+Za(m,I)+(O?" "+O:"")})}function di(m,b){m.info(function(){return"TIMEOUT: "+b})}gn.prototype.info=function(){};function Za(m,b){if(!m.g)return b;if(!b)return null;try{var I=JSON.parse(b);if(I){for(m=0;m<I.length;m++)if(Array.isArray(I[m])){var O=I[m];if(!(2>O.length)){var te=O[1];if(Array.isArray(te)&&!(1>te.length)){var ae=te[0];if(ae!="noop"&&ae!="stop"&&ae!="close")for(var Ie=1;Ie<te.length;Ie++)te[Ie]=""}}}}return pn(I)}catch{return b}}var Mn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Jo={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xr;function Fs(){}E(Fs,an),Fs.prototype.g=function(){return new XMLHttpRequest},Fs.prototype.i=function(){return{}},xr=new Fs;function vr(m,b,I,O){this.j=m,this.i=b,this.l=I,this.R=O||1,this.U=new Jt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new el}function el(){this.i=null,this.g="",this.h=!1}var je={},X={};function ge(m,b,I){m.L=1,m.v=Ji(Fr(b)),m.m=I,m.P=!0,ke(m,null)}function ke(m,b){m.F=Date.now(),We(m),m.A=Fr(m.v);var I=m.A,O=m.R;Array.isArray(O)||(O=[String(O)]),eo(I.i,"t",O),m.C=0,I=m.j.J,m.h=new el,m.g=dh(m.j,I?b:null,!m.m),0<m.O&&(m.M=new Bt(x(m.Y,m,m.g),m.O)),b=m.U,I=m.g,O=m.ca;var te="readystatechange";Array.isArray(te)||(te&&(Zt[0]=te.toString()),te=Zt);for(var ae=0;ae<te.length;ae++){var Ie=Jr(I,te[ae],O||b.handleEvent,!1,b.h||b);if(!Ie)break;b.g[Ie.key]=Ie}b=m.H?k(m.H):{},m.m?(m.u||(m.u="POST"),b["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,b)):(m.u="GET",m.g.ea(m.A,m.u,null,b)),ts(),gr(m.i,m.u,m.A,m.l,m.R,m.m)}vr.prototype.ca=function(m){m=m.target;const b=this.M;b&&_r(m)==3?b.j():this.Y(m)},vr.prototype.Y=function(m){try{if(m==this.g)e:{const tn=_r(this.g);var b=this.g.Ba();const rs=this.g.Z();if(!(3>tn)&&(tn!=3||this.g&&(this.h.h||this.g.oa()||qc(this.g)))){this.J||tn!=4||b==7||(b==8||0>=rs?ts(3):ts(2)),En(this);var I=this.g.Z();this.X=I;t:if(gt(this)){var O=qc(this.g);m="";var te=O.length,ae=_r(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ln(this),wr(this);var Ie="";break t}this.h.i=new u.TextDecoder}for(b=0;b<te;b++)this.h.h=!0,m+=this.h.i.decode(O[b],{stream:!(ae&&b==te-1)});O.length=0,this.h.g+=m,this.C=0,Ie=this.h.g}else Ie=this.g.oa();if(this.o=I==200,ui(this.i,this.u,this.A,this.l,this.R,tn,I),this.o){if(this.T&&!this.K){t:{if(this.g){var yt,cn=this.g;if((yt=cn.g?cn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(yt)){var lt=yt;break t}}lt=null}if(I=lt)yr(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$t(this,I);else{this.o=!1,this.s=3,Pt(12),Ln(this),wr(this);break e}}if(this.P){I=!0;let zr;for(;!this.J&&this.C<Ie.length;)if(zr=en(this,Ie),zr==X){tn==4&&(this.s=4,Pt(14),I=!1),yr(this.i,this.l,null,"[Incomplete Response]");break}else if(zr==je){this.s=4,Pt(15),yr(this.i,this.l,Ie,"[Invalid Chunk]"),I=!1;break}else yr(this.i,this.l,zr,null),$t(this,zr);if(gt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tn!=4||Ie.length!=0||this.h.h||(this.s=1,Pt(16),I=!1),this.o=this.o&&I,!I)yr(this.i,this.l,Ie,"[Invalid Chunked Response]"),Ln(this),wr(this);else if(0<Ie.length&&!this.W){this.W=!0;var yn=this.j;yn.g==this&&yn.ba&&!yn.M&&(yn.j.info("Great, no buffering proxy detected. Bytes received: "+Ie.length),Wc(yn),yn.M=!0,Pt(11))}}else yr(this.i,this.l,Ie,null),$t(this,Ie);tn==4&&Ln(this),this.o&&!this.J&&(tn==4?dl(this.j,this):(this.o=!1,We(this)))}else ol(this.g),I==400&&0<Ie.indexOf("Unknown SID")?(this.s=3,Pt(12)):(this.s=0,Pt(13)),Ln(this),wr(this)}}}catch{}finally{}};function gt(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function en(m,b){var I=m.C,O=b.indexOf(`
`,I);return O==-1?X:(I=Number(b.substring(I,O)),isNaN(I)?je:(O+=1,O+I>b.length?X:(b=b.slice(O,O+I),m.C=O+I,b)))}vr.prototype.cancel=function(){this.J=!0,Ln(this)};function We(m){m.S=Date.now()+m.I,ln(m,m.I)}function ln(m,b){if(m.B!=null)throw Error("WatchDog timer not null");m.B=Lr(x(m.ba,m),b)}function En(m){m.B&&(u.clearTimeout(m.B),m.B=null)}vr.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(di(this.i,this.A),this.L!=2&&(ts(),Pt(17)),Ln(this),this.s=2,wr(this)):ln(this,this.S-m)};function wr(m){m.j.G==0||m.J||dl(m.j,m)}function Ln(m){En(m);var b=m.M;b&&typeof b.ma=="function"&&b.ma(),m.M=null,Wt(m.U),m.g&&(b=m.g,m.g=null,b.abort(),b.ma())}function $t(m,b){try{var I=m.j;if(I.G!=0&&(I.g==m||Zn(I.h,m))){if(!m.K&&Zn(I.h,m)&&I.G==3){try{var O=I.Da.g.parse(b)}catch{O=null}if(Array.isArray(O)&&O.length==3){var te=O;if(te[0]==0){e:if(!I.u){if(I.g)if(I.g.F+3e3<m.F)ul(I),Is(I);else break e;cl(I),Pt(18)}}else I.za=te[1],0<I.za-I.T&&37500>te[2]&&I.F&&I.v==0&&!I.C&&(I.C=Lr(x(I.Za,I),6e3));if(1>=Xd(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else gi(I,11)}else if((m.K||I.g==m)&&ul(I),!z(b))for(te=I.Da.g.parse(b),b=0;b<te.length;b++){let lt=te[b];if(I.T=lt[0],lt=lt[1],I.G==2)if(lt[0]=="c"){I.K=lt[1],I.ia=lt[2];const yn=lt[3];yn!=null&&(I.la=yn,I.j.info("VER="+I.la));const tn=lt[4];tn!=null&&(I.Aa=tn,I.j.info("SVER="+I.Aa));const rs=lt[5];rs!=null&&typeof rs=="number"&&0<rs&&(O=1.5*rs,I.L=O,I.j.info("backChannelRequestTimeoutMs_="+O)),O=I;const zr=m.g;if(zr){const ia=zr.g?zr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ia){var ae=O.h;ae.g||ia.indexOf("spdy")==-1&&ia.indexOf("quic")==-1&&ia.indexOf("h2")==-1||(ae.j=ae.l,ae.g=new Set,ae.h&&(zc(ae,ae.h),ae.h=null))}if(O.D){const fl=zr.g?zr.g.getResponseHeader("X-HTTP-Session-Id"):null;fl&&(O.ya=fl,_t(O.I,O.D,fl))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-m.F,I.j.info("Handshake RTT: "+I.R+"ms")),O=I;var Ie=m;if(O.qa=uh(O,O.J?O.ia:null,O.W),Ie.K){Jd(O.h,Ie);var yt=Ie,cn=O.L;cn&&(yt.I=cn),yt.B&&(En(yt),We(yt)),O.g=Ie}else sa(O);0<I.i.length&&$s(I)}else lt[0]!="stop"&&lt[0]!="close"||gi(I,7);else I.G==3&&(lt[0]=="stop"||lt[0]=="close"?lt[0]=="stop"?gi(I,7):kn(I):lt[0]!="noop"&&I.l&&I.l.ta(lt),I.v=0)}}ts(4)}catch{}}var Zo=class{constructor(m,b){this.g=m,this.map=b}};function Vs(m){this.l=m||10,u.PerformanceNavigationTiming?(m=u.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Or(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function Xd(m){return m.h?1:m.g?m.g.size:0}function Zn(m,b){return m.h?m.h==b:m.g?m.g.has(b):!1}function zc(m,b){m.g?m.g.add(b):m.h=b}function Jd(m,b){m.h&&m.h==b?m.h=null:m.g&&m.g.has(b)&&m.g.delete(b)}Vs.prototype.cancel=function(){if(this.i=Zd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Zd(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let b=m.i;for(const I of m.g.values())b=b.concat(I.D);return b}return S(m.i)}function tl(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(d(m)){for(var b=[],I=m.length,O=0;O<I;O++)b.push(m[O]);return b}b=[],I=0;for(O in m)b[I++]=m[O];return b}function nl(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(d(m)||typeof m=="string"){var b=[];m=m.length;for(var I=0;I<m;I++)b.push(I);return b}b=[],I=0;for(const O in m)b[I++]=O;return b}}}function Qi(m,b){if(m.forEach&&typeof m.forEach=="function")m.forEach(b,void 0);else if(d(m)||typeof m=="string")Array.prototype.forEach.call(m,b,void 0);else for(var I=nl(m),O=tl(m),te=O.length,ae=0;ae<te;ae++)b.call(void 0,O[ae],I&&I[ae],m)}var ea=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xp(m,b){if(m){m=m.split("&");for(var I=0;I<m.length;I++){var O=m[I].indexOf("="),te=null;if(0<=O){var ae=m[I].substring(0,O);te=m[I].substring(O+1)}else ae=m[I];b(ae,te?decodeURIComponent(te.replace(/\+/g," ")):"")}}}function hi(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof hi){this.h=m.h,ta(this,m.j),this.o=m.o,this.g=m.g,Yi(this,m.s),this.l=m.l;var b=m.i,I=new zs;I.i=b.i,b.g&&(I.g=new Map(b.g),I.h=b.h),Xi(this,I),this.m=m.m}else m&&(b=String(m).match(ea))?(this.h=!1,ta(this,b[1]||"",!0),this.o=it(b[2]||""),this.g=it(b[3]||"",!0),Yi(this,b[4]),this.l=it(b[5]||"",!0),Xi(this,b[6]||"",!0),this.m=it(b[7]||"")):(this.h=!1,this.i=new zs(null,this.h))}hi.prototype.toString=function(){var m=[],b=this.j;b&&m.push(Zi(b,rl,!0),":");var I=this.g;return(I||b=="file")&&(m.push("//"),(b=this.o)&&m.push(Zi(b,rl,!0),"@"),m.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&m.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&m.push("/"),m.push(Zi(I,I.charAt(0)=="/"?nh:th,!0))),(I=this.i.toString())&&m.push("?",I),(I=this.m)&&m.push("#",Zi(I,Uc)),m.join("")};function Fr(m){return new hi(m)}function ta(m,b,I){m.j=I?it(b,!0):b,m.j&&(m.j=m.j.replace(/:$/,""))}function Yi(m,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);m.s=b}else m.s=null}function Xi(m,b,I){b instanceof zs?(m.i=b,Us(m.i,m.h)):(I||(b=Zi(b,rh)),m.i=new zs(b,m.h))}function _t(m,b,I){m.i.set(b,I)}function Ji(m){return _t(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function it(m,b){return m?b?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Zi(m,b,I){return typeof m=="string"?(m=encodeURI(m).replace(b,eh),I&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function eh(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var rl=/[#\/\?@]/g,th=/[#\?:]/g,nh=/[#\?]/g,rh=/[#\?@]/g,Uc=/#/g;function zs(m,b){this.h=this.g=null,this.i=m||null,this.j=!!b}function Tn(m){m.g||(m.g=new Map,m.h=0,m.i&&xp(m.i,function(b,I){m.add(decodeURIComponent(b.replace(/\+/g," ")),I)}))}n=zs.prototype,n.add=function(m,b){Tn(this),this.i=null,m=ns(this,m);var I=this.g.get(m);return I||this.g.set(m,I=[]),I.push(b),this.h+=1,this};function ws(m,b){Tn(m),b=ns(m,b),m.g.has(b)&&(m.i=null,m.h-=m.g.get(b).length,m.g.delete(b))}function bs(m,b){return Tn(m),b=ns(m,b),m.g.has(b)}n.forEach=function(m,b){Tn(this),this.g.forEach(function(I,O){I.forEach(function(te){m.call(b,te,O,this)},this)},this)},n.na=function(){Tn(this);const m=Array.from(this.g.values()),b=Array.from(this.g.keys()),I=[];for(let O=0;O<b.length;O++){const te=m[O];for(let ae=0;ae<te.length;ae++)I.push(b[O])}return I},n.V=function(m){Tn(this);let b=[];if(typeof m=="string")bs(this,m)&&(b=b.concat(this.g.get(ns(this,m))));else{m=Array.from(this.g.values());for(let I=0;I<m.length;I++)b=b.concat(m[I])}return b},n.set=function(m,b){return Tn(this),this.i=null,m=ns(this,m),bs(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[b]),this.h+=1,this},n.get=function(m,b){return m?(m=this.V(m),0<m.length?String(m[0]):b):b};function eo(m,b,I){ws(m,b),0<I.length&&(m.i=null,m.g.set(ns(m,b),S(I)),m.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],b=Array.from(this.g.keys());for(var I=0;I<b.length;I++){var O=b[I];const ae=encodeURIComponent(String(O)),Ie=this.V(O);for(O=0;O<Ie.length;O++){var te=ae;Ie[O]!==""&&(te+="="+encodeURIComponent(String(Ie[O]))),m.push(te)}}return this.i=m.join("&")};function ns(m,b){return b=String(b),m.j&&(b=b.toLowerCase()),b}function Us(m,b){b&&!m.j&&(Tn(m),m.i=null,m.g.forEach(function(I,O){var te=O.toLowerCase();O!=te&&(ws(this,O),eo(this,te,I))},m)),m.j=b}function vp(m,b){const I=new gn;if(u.Image){const O=new Image;O.onload=w(br,I,"TestLoadImage: loaded",!0,b,O),O.onerror=w(br,I,"TestLoadImage: error",!1,b,O),O.onabort=w(br,I,"TestLoadImage: abort",!1,b,O),O.ontimeout=w(br,I,"TestLoadImage: timeout",!1,b,O),u.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=m}else b(!1)}function sh(m,b){const I=new gn,O=new AbortController,te=setTimeout(()=>{O.abort(),br(I,"TestPingServer: timeout",!1,b)},1e4);fetch(m,{signal:O.signal}).then(ae=>{clearTimeout(te),ae.ok?br(I,"TestPingServer: ok",!0,b):br(I,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(te),br(I,"TestPingServer: error",!1,b)})}function br(m,b,I,O,te){try{te&&(te.onload=null,te.onerror=null,te.onabort=null,te.ontimeout=null),O(I)}catch{}}function wp(){this.g=new jn}function ih(m,b,I){const O=I||"";try{Qi(m,function(te,ae){let Ie=te;f(te)&&(Ie=pn(te)),b.push(O+ae+"="+encodeURIComponent(Ie))})}catch(te){throw b.push(O+"type="+encodeURIComponent("_badmap")),te}}function fi(m){this.l=m.Ub||null,this.j=m.eb||!1}E(fi,an),fi.prototype.g=function(){return new na(this.l,this.j)},fi.prototype.i=function(m){return function(){return m}}({});function na(m,b){oe.call(this),this.D=m,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(na,oe),n=na.prototype,n.open=function(m,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=b,this.readyState=1,Ss(this)},n.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const b={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(b.body=m),(this.D||u).fetch(new Request(this.A,b)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,_s(this)),this.readyState=0},n.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Ss(this)),this.g&&(this.readyState=3,Ss(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;oh(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function oh(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}n.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var b=m.value?m.value:new Uint8Array(0);(b=this.v.decode(b,{stream:!m.done}))&&(this.response=this.responseText+=b)}m.done?_s(this):Ss(this),this.readyState==3&&oh(this)}},n.Ra=function(m){this.g&&(this.response=this.responseText=m,_s(this))},n.Qa=function(m){this.g&&(this.response=m,_s(this))},n.ga=function(){this.g&&_s(this)};function _s(m){m.readyState=4,m.l=null,m.j=null,m.v=null,Ss(m)}n.setRequestHeader=function(m,b){this.u.append(m,b)},n.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],b=this.h.entries();for(var I=b.next();!I.done;)I=I.value,m.push(I[0]+": "+I[1]),I=b.next();return m.join(`\r
`)};function Ss(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(na.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function mi(m){let b="";return F(m,function(I,O){b+=O,b+=":",b+=I,b+=`\r
`}),b}function to(m,b,I){e:{for(O in I){var O=!1;break e}O=!0}O||(I=mi(I),typeof m=="string"?I!=null&&encodeURIComponent(String(I)):_t(m,b,I))}function jt(m){oe.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(jt,oe);var bp=/^https?$/i,Bc=["POST","PUT"];n=jt.prototype,n.Ha=function(m){this.J=m},n.ea=function(m,b,I,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);b=b?b.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xr.g(),this.v=this.o?xs(this.o):xs(xr),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(b,String(m),!0),this.B=!1}catch(ae){ra(this,ae);return}if(m=I||"",I=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var te in O)I.set(te,O[te]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const ae of O.keys())I.set(ae,O.get(ae));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(I.keys()).find(ae=>ae.toLowerCase()=="content-type"),te=u.FormData&&m instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Bc,b,void 0))||O||te||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ae,Ie]of I)this.g.setRequestHeader(ae,Ie);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{il(this),this.u=!0,this.g.send(m),this.u=!1}catch(ae){ra(this,ae)}};function ra(m,b){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=b,m.m=5,sl(m),Vr(m)}function sl(m){m.A||(m.A=!0,fe(m,"complete"),fe(m,"error"))}n.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,fe(this,"complete"),fe(this,"abort"),Vr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Vr(this,!0)),jt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?$c(this):this.bb())},n.bb=function(){$c(this)};function $c(m){if(m.h&&typeof a<"u"&&(!m.v[1]||_r(m)!=4||m.Z()!=2)){if(m.u&&_r(m)==4)Qe(m.Ea,0,m);else if(fe(m,"readystatechange"),_r(m)==4){m.h=!1;try{const Ie=m.Z();e:switch(Ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var I;if(!(I=b)){var O;if(O=Ie===0){var te=String(m.D).match(ea)[1]||null;!te&&u.self&&u.self.location&&(te=u.self.location.protocol.slice(0,-1)),O=!bp.test(te?te.toLowerCase():"")}I=O}if(I)fe(m,"complete"),fe(m,"success");else{m.m=6;try{var ae=2<_r(m)?m.g.statusText:""}catch{ae=""}m.l=ae+" ["+m.Z()+"]",sl(m)}}finally{Vr(m)}}}}function Vr(m,b){if(m.g){il(m);const I=m.g,O=m.v[0]?()=>{}:null;m.g=null,m.v=null,b||fe(m,"ready");try{I.onreadystatechange=O}catch{}}}function il(m){m.I&&(u.clearTimeout(m.I),m.I=null)}n.isActive=function(){return!!this.g};function _r(m){return m.g?m.g.readyState:0}n.Z=function(){try{return 2<_r(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(m){if(this.g){var b=this.g.responseText;return m&&b.indexOf(m)==0&&(b=b.substring(m.length)),Ft(b)}};function qc(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function ol(m){const b={};m=(m.g&&2<=_r(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<m.length;O++){if(z(m[O]))continue;var I=D(m[O]);const te=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const ae=b[te]||[];b[te]=ae,ae.push(I)}R(b,function(O){return O.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Bs(m,b,I){return I&&I.internalChannelParams&&I.internalChannelParams[m]||b}function Hc(m){this.Aa=0,this.i=[],this.j=new gn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Bs("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Bs("baseRetryDelayMs",5e3,m),this.cb=Bs("retryDelaySeedMs",1e4,m),this.Wa=Bs("forwardChannelMaxRetries",2,m),this.wa=Bs("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new Vs(m&&m.concurrentRequestLimit),this.Da=new wp,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Hc.prototype,n.la=8,n.G=1,n.connect=function(m,b,I,O){Pt(0),this.W=m,this.H=b||{},I&&O!==void 0&&(this.H.OSID=I,this.H.OAID=O),this.F=this.X,this.I=uh(this,null,this.W),$s(this)};function kn(m){if(al(m),m.G==3){var b=m.U++,I=Fr(m.I);if(_t(I,"SID",m.K),_t(I,"RID",b),_t(I,"TYPE","terminate"),pi(m,I),b=new vr(m,m.j,b),b.L=2,b.v=Ji(Fr(I)),I=!1,u.navigator&&u.navigator.sendBeacon)try{I=u.navigator.sendBeacon(b.v.toString(),"")}catch{}!I&&u.Image&&(new Image().src=b.v,I=!0),I||(b.g=dh(b.j,null),b.g.ea(b.v)),b.F=Date.now(),We(b)}ch(m)}function Is(m){m.g&&(Wc(m),m.g.cancel(),m.g=null)}function al(m){Is(m),m.u&&(u.clearTimeout(m.u),m.u=null),ul(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&u.clearTimeout(m.s),m.s=null)}function $s(m){if(!Or(m.h)&&!m.s){m.s=!0;var b=m.Ga;ue||M(),Q||(ue(),Q=!0),Z.add(b,m),m.B=0}}function _p(m,b){return Xd(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=b.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=Lr(x(m.Ga,m,b),lh(m,m.B)),m.B++,!0)}n.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const te=new vr(this,this.j,m);let ae=this.o;if(this.S&&(ae?(ae=k(ae),T(ae,this.S)):ae=this.S),this.m!==null||this.O||(te.H=ae,ae=null),this.P)e:{for(var b=0,I=0;I<this.i.length;I++){t:{var O=this.i[I];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(b+=O,4096<b){b=I;break e}if(b===4096||I===this.i.length-1){b=I+1;break e}}b=1e3}else b=1e3;b=no(this,te,b),I=Fr(this.I),_t(I,"RID",m),_t(I,"CVER",22),this.D&&_t(I,"X-HTTP-Session-Id",this.D),pi(this,I),ae&&(this.O?b="headers="+encodeURIComponent(String(mi(ae)))+"&"+b:this.m&&to(I,this.m,ae)),zc(this.h,te),this.Ua&&_t(I,"TYPE","init"),this.P?(_t(I,"$req",b),_t(I,"SID","null"),te.T=!0,ge(te,I,null)):ge(te,I,b),this.G=2}}else this.G==3&&(m?ll(this,m):this.i.length==0||Or(this.h)||ll(this))};function ll(m,b){var I;b?I=b.l:I=m.U++;const O=Fr(m.I);_t(O,"SID",m.K),_t(O,"RID",I),_t(O,"AID",m.T),pi(m,O),m.m&&m.o&&to(O,m.m,m.o),I=new vr(m,m.j,I,m.B+1),m.m===null&&(I.H=m.o),b&&(m.i=b.D.concat(m.i)),b=no(m,I,1e3),I.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),zc(m.h,I),ge(I,O,b)}function pi(m,b){m.H&&F(m.H,function(I,O){_t(b,O,I)}),m.l&&Qi({},function(I,O){_t(b,O,I)})}function no(m,b,I){I=Math.min(m.i.length,I);var O=m.l?x(m.l.Na,m.l,m):null;e:{var te=m.i;let ae=-1;for(;;){const Ie=["count="+I];ae==-1?0<I?(ae=te[0].g,Ie.push("ofs="+ae)):ae=0:Ie.push("ofs="+ae);let yt=!0;for(let cn=0;cn<I;cn++){let lt=te[cn].g;const yn=te[cn].map;if(lt-=ae,0>lt)ae=Math.max(0,te[cn].g-100),yt=!1;else try{ih(yn,Ie,"req"+lt+"_")}catch{O&&O(yn)}}if(yt){O=Ie.join("&");break e}}}return m=m.i.splice(0,I),b.D=m,O}function sa(m){if(!m.g&&!m.u){m.Y=1;var b=m.Fa;ue||M(),Q||(ue(),Q=!0),Z.add(b,m),m.v=0}}function cl(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=Lr(x(m.Fa,m),lh(m,m.v)),m.v++,!0)}n.Fa=function(){if(this.u=null,ah(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=Lr(x(this.ab,this),m)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Pt(10),Is(this),ah(this))};function Wc(m){m.A!=null&&(u.clearTimeout(m.A),m.A=null)}function ah(m){m.g=new vr(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var b=Fr(m.qa);_t(b,"RID","rpc"),_t(b,"SID",m.K),_t(b,"AID",m.T),_t(b,"CI",m.F?"0":"1"),!m.F&&m.ja&&_t(b,"TO",m.ja),_t(b,"TYPE","xmlhttp"),pi(m,b),m.m&&m.o&&to(b,m.m,m.o),m.L&&(m.g.I=m.L);var I=m.g;m=m.ia,I.L=1,I.v=Ji(Fr(b)),I.m=null,I.P=!0,ke(I,m)}n.Za=function(){this.C!=null&&(this.C=null,Is(this),cl(this),Pt(19))};function ul(m){m.C!=null&&(u.clearTimeout(m.C),m.C=null)}function dl(m,b){var I=null;if(m.g==b){ul(m),Wc(m),m.g=null;var O=2}else if(Zn(m.h,b))I=b.D,Jd(m.h,b),O=1;else return;if(m.G!=0){if(b.o)if(O==1){I=b.m?b.m.length:0,b=Date.now()-b.F;var te=m.B;O=pr(),fe(O,new ci(O,I)),$s(m)}else sa(m);else if(te=b.s,te==3||te==0&&0<b.X||!(O==1&&_p(m,b)||O==2&&cl(m)))switch(I&&0<I.length&&(b=m.h,b.i=b.i.concat(I)),te){case 1:gi(m,5);break;case 4:gi(m,10);break;case 3:gi(m,6);break;default:gi(m,2)}}}function lh(m,b){let I=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(I*=2),I*b}function gi(m,b){if(m.j.info("Error code "+b),b==2){var I=x(m.fb,m),O=m.Xa;const te=!O;O=new hi(O||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||ta(O,"https"),Ji(O),te?vp(O.toString(),I):sh(O.toString(),I)}else Pt(2);m.G=0,m.l&&m.l.sa(b),ch(m),al(m)}n.fb=function(m){m?(this.j.info("Successfully pinged google.com"),Pt(2)):(this.j.info("Failed to ping google.com"),Pt(1))};function ch(m){if(m.G=0,m.ka=[],m.l){const b=Zd(m.h);(b.length!=0||m.i.length!=0)&&(A(m.ka,b),A(m.ka,m.i),m.h.i.length=0,S(m.i),m.i.length=0),m.l.ra()}}function uh(m,b,I){var O=I instanceof hi?Fr(I):new hi(I);if(O.g!="")b&&(O.g=b+"."+O.g),Yi(O,O.s);else{var te=u.location;O=te.protocol,b=b?b+"."+te.hostname:te.hostname,te=+te.port;var ae=new hi(null);O&&ta(ae,O),b&&(ae.g=b),te&&Yi(ae,te),I&&(ae.l=I),O=ae}return I=m.D,b=m.ya,I&&b&&_t(O,I,b),_t(O,"VER",m.la),pi(m,O),O}function dh(m,b,I){if(b&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return b=m.Ca&&!m.pa?new jt(new fi({eb:I})):new jt(m.pa),b.Ha(m.J),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gc(){}n=Gc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function hl(){}hl.prototype.g=function(m,b){return new er(m,b)};function er(m,b){oe.call(this),this.g=new Hc(b),this.l=m,this.h=b&&b.messageUrlParams||null,m=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(m?m["X-WebChannel-Content-Type"]=b.messageContentType:m={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.va&&(m?m["X-WebChannel-Client-Profile"]=b.va:m={"X-WebChannel-Client-Profile":b.va}),this.g.S=m,(m=b&&b.Sb)&&!z(m)&&(this.g.m=m),this.v=b&&b.supportsCrossDomainXhr||!1,this.u=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!z(b)&&(this.g.D=b,m=this.h,m!==null&&b in m&&(m=this.h,b in m&&delete m[b])),this.j=new qs(this)}E(er,oe),er.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},er.prototype.close=function(){kn(this.g)},er.prototype.o=function(m){var b=this.g;if(typeof m=="string"){var I={};I.__data__=m,m=I}else this.u&&(I={},I.__data__=pn(m),m=I);b.i.push(new Zo(b.Ya++,m)),b.G==3&&$s(b)},er.prototype.N=function(){this.g.l=null,delete this.j,kn(this.g),delete this.g,er.aa.N.call(this)};function hh(m){Dn.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var b=m.__sm__;if(b){e:{for(const I in b){m=I;break e}m=void 0}(this.i=m)&&(m=this.i,b=b!==null&&m in b?b[m]:void 0),this.data=b}else this.data=m}E(hh,Dn);function fh(){Ki.call(this),this.status=1}E(fh,Ki);function qs(m){this.g=m}E(qs,Gc),qs.prototype.ua=function(){fe(this.g,"a")},qs.prototype.ta=function(m){fe(this.g,new hh(m))},qs.prototype.sa=function(m){fe(this.g,new fh)},qs.prototype.ra=function(){fe(this.g,"b")},hl.prototype.createWebChannel=hl.prototype.g,er.prototype.send=er.prototype.o,er.prototype.open=er.prototype.m,er.prototype.close=er.prototype.close,dE=function(){return new hl},uE=function(){return pr()},cE=es,Wy={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Mn.NO_ERROR=0,Mn.TIMEOUT=8,Mn.HTTP_ERROR=6,kf=Mn,Jo.COMPLETE="complete",lE=Jo,vs.EventType=mr,mr.OPEN="a",mr.CLOSE="b",mr.ERROR="c",mr.MESSAGE="d",oe.prototype.listen=oe.prototype.K,Fu=vs,jt.prototype.listenOnce=jt.prototype.L,jt.prototype.getLastError=jt.prototype.Ka,jt.prototype.getLastErrorCode=jt.prototype.Ba,jt.prototype.getStatus=jt.prototype.Z,jt.prototype.getResponseJson=jt.prototype.Oa,jt.prototype.getResponseText=jt.prototype.oa,jt.prototype.send=jt.prototype.ea,jt.prototype.setWithCredentials=jt.prototype.Ha,aE=jt}).apply(typeof cf<"u"?cf:typeof self<"u"?self:typeof window<"u"?window:{});const E1="@firebase/firestore",T1="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _n=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};_n.UNAUTHENTICATED=new _n(null),_n.GOOGLE_CREDENTIALS=new _n("google-credentials-uid"),_n.FIRST_PARTY=new _n("first-party-uid"),_n.MOCK_USER=new _n("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kc="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma=new V0("@firebase/firestore");function ql(){return Ma.logLevel}function me(n,...e){if(Ma.logLevel<=rt.DEBUG){const t=e.map(X0);Ma.debug(`Firestore (${kc}): ${n}`,...t)}}function Qt(n,...e){if(Ma.logLevel<=rt.ERROR){const t=e.map(X0);Ma.error(`Firestore (${kc}): ${n}`,...t)}}function La(n,...e){if(Ma.logLevel<=rt.WARN){const t=e.map(X0);Ma.warn(`Firestore (${kc}): ${n}`,...t)}}function X0(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,hE(n,r,t)}function hE(n,e,t){let r=`FIRESTORE (${kc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Qt(r),new Error(r)}function Me(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||hE(e,s,r)}function Re(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _e extends zi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Rj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(_n.UNAUTHENTICATED))}shutdown(){}}class Pj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class jj{constructor(e){this.t=e,this.currentUser=_n.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Me(this.o===void 0,42304);let r=this.i;const s=d=>this.i!==r?(r=this.i,t(d)):Promise.resolve();let o=new Ls;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ls,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const d=o;e.enqueueRetryable(async()=>{await d.promise,await s(this.currentUser)})},u=d=>{me("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(d=>u(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(me("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ls)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(me("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Me(typeof r.accessToken=="string",31837,{l:r}),new fE(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Me(e===null||typeof e=="string",2055,{h:e}),new _n(e)}}class Dj{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=_n.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Mj{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Dj(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(_n.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class k1{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Lj{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,sr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Me(this.o===void 0,3512);const r=o=>{o.error!=null&&me("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,me("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const s=o=>{me("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):me("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new k1(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Me(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new k1(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oj(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Oj(40);for(let o=0;o<s.length;++o)r.length<20&&s[o]<t&&(r+=e.charAt(s[o]%62))}return r}}function $e(n,e){return n<e?-1:n>e?1:0}function Gy(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),s=e.codePointAt(t);if(r!==s){if(r<128&&s<128)return $e(r,s);{const o=mE(),a=Fj(o.encode(A1(n,t)),o.encode(A1(e,t)));return a!==0?a:$e(r,s)}}t+=r>65535?2:1}return $e(n.length,e.length)}function A1(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function Fj(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return $e(n[t],e[t]);return $e(n.length,e.length)}function tc(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function gE(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1=-62135596800,N1=1e6;class mt{static now(){return mt.fromMillis(Date.now())}static fromDate(e){return mt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*N1);return new mt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new _e(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new _e(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<C1)throw new _e(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _e(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/N1}_compareTo(e){return this.seconds===e.seconds?$e(this.nanoseconds,e.nanoseconds):$e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-C1;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{static fromTimestamp(e){return new Fe(e)}static min(){return new Fe(new mt(0,0))}static max(){return new Fe(new mt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R1="__name__";class Ys{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ce(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ce(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ys.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ys?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const o=Ys.compareSegments(e.get(s),t.get(s));if(o!==0)return o}return $e(e.length,t.length)}static compareSegments(e,t){const r=Ys.isNumericId(e),s=Ys.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?Ys.extractNumericId(e).compare(Ys.extractNumericId(t)):Gy(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ro.fromString(e.substring(4,e.length-2))}}class pt extends Ys{construct(e,t,r){return new pt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new _e(le.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new pt(t)}static emptyPath(){return new pt([])}}const Vj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ut extends Ys{construct(e,t,r){return new Ut(e,t,r)}static isValidIdentifier(e){return Vj.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ut.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===R1}static keyField(){return new Ut([R1])}static fromServerFormat(e){const t=[];let r="",s=0;const o=()=>{if(r.length===0)throw new _e(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const u=e[s];if(u==="\\"){if(s+1===e.length)throw new _e(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new _e(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=d,s+=2}else u==="`"?(a=!a,s++):u!=="."||a?(r+=u,s++):(o(),s++)}if(o(),a)throw new _e(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ut(t)}static emptyPath(){return new Ut([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(pt.fromString(e))}static fromName(e){return new Ee(pt.fromString(e).popFirst(5))}static empty(){return new Ee(pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new pt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nc=-1;class Qf{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function Ky(n){return n.fields.find(e=>e.kind===2)}function ba(n){return n.fields.filter(e=>e.kind!==2)}Qf.UNKNOWN_ID=-1;class Af{constructor(e,t){this.fieldPath=e,this.kind=t}}class ld{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ld(0,Yr.min())}}function yE(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Fe.fromTimestamp(r===1e9?new mt(t+1,0):new mt(t,r));return new Yr(s,Ee.empty(),e)}function xE(n){return new Yr(n.readTime,n.key,nc)}class Yr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Yr(Fe.min(),Ee.empty(),nc)}static max(){return new Yr(Fe.max(),Ee.empty(),nc)}}function J0(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:$e(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wE{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $o(n){if(n.code!==le.FAILED_PRECONDITION||n.message!==vE)throw n;me("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ce(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ee((r,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ee?t:ee.resolve(t)}catch(t){return ee.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ee.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ee.reject(t)}static resolve(e){return new ee((t,r)=>{t(e)})}static reject(e){return new ee((t,r)=>{r(e)})}static waitFor(e){return new ee((t,r)=>{let s=0,o=0,a=!1;e.forEach(u=>{++s,u.next(()=>{++o,a&&o===s&&t()},d=>r(d))}),a=!0,o===s&&t()})}static or(e){let t=ee.resolve(!1);for(const r of e)t=t.next(s=>s?ee.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,o)=>{r.push(t.call(this,s,o))}),this.waitFor(r)}static mapArray(e,t){return new ee((r,s)=>{const o=e.length,a=new Array(o);let u=0;for(let d=0;d<o;d++){const f=d;t(e[f]).next(g=>{a[f]=g,++u,u===o&&r(a)},g=>s(g))}})}static doWhile(e,t){return new ee((r,s)=>{const o=()=>{e()===!0?t().next(()=>{o()},s):r()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hr="SimpleDb";class Dm{static open(e,t,r,s){try{return new Dm(t,e.transaction(s,r))}catch(o){throw new Hu(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ls,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Hu(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=Z0(r.target.error);this.S.reject(new Hu(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(me(Hr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Uj(t)}}class Po{static delete(e){return me(Hr,"Removing database:",e),Sa(uI().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!xI())return!1;if(Po.F())return!0;const e=fn(),t=Po.M(e),r=0<t&&t<10,s=bE(e),o=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,Po.M(fn())===12.2&&Qt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(me(Hr,"Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=o=>{const a=o.target.result;t(a)},s.onblocked=()=>{r(new Hu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;a.name==="VersionError"?r(new _e(le.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new _e(le.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new Hu(e,a))},s.onupgradeneeded=o=>{me(Hr,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const a=o.target.result;if(this.L!==null&&this.L!==o.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${o.oldVersion}, event.newVersion=${o.newVersion}, db.version=${a.version}`);this.B.q(a,s.transaction,o.oldVersion,this.version).next(()=>{me(Hr,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{const r=t.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=t=>this.$(t)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const o=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.k(e);const u=Dm.open(this.db,e,o?"readonly":"readwrite",r),d=s(u).next(f=>(u.v(),f)).catch(f=>(u.abort(f),ee.reject(f))).toPromise();return d.catch(()=>{}),await u.D,d}catch(u){const d=u,f=d.name!=="FirebaseError"&&a<3;if(me(Hr,"Transaction failed with error:",d.message,"Retrying:",f),this.close(),!f)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function bE(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class zj{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return Sa(this.K.delete())}}class Hu extends _e{constructor(e,t){super(le.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function qo(n){return n.name==="IndexedDbTransactionError"}class Uj{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(me(Hr,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(me(Hr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Sa(r)}add(e){return me(Hr,"ADD",this.store.name,e,e),Sa(this.store.add(e))}get(e){return Sa(this.store.get(e)).next(t=>(t===void 0&&(t=null),me(Hr,"GET",this.store.name,e,t),t))}delete(e){return me(Hr,"DELETE",this.store.name,e),Sa(this.store.delete(e))}count(){return me(Hr,"COUNT",this.store.name),Sa(this.store.count())}J(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const o=s.getAll(r.range);return new ee((a,u)=>{o.onerror=d=>{u(d.target.error)},o.onsuccess=d=>{a(d.target.result)}})}{const o=this.cursor(r),a=[];return this.Y(o,(u,d)=>{a.push(d)}).next(()=>a)}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new ee((s,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{s(a.target.result)}})}X(e,t){me(Hr,"DELETE ALL",this.store.name);const r=this.options(e,t);r.ee=!1;const s=this.cursor(r);return this.Y(s,(o,a,u)=>u.delete())}te(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.Y(s,t)}ne(e){const t=this.cursor({});return new ee((r,s)=>{t.onerror=o=>{const a=Z0(o.target.error);s(a)},t.onsuccess=o=>{const a=o.target.result;a?e(a.primaryKey,a.value).next(u=>{u?a.continue():r()}):r()}})}Y(e,t){const r=[];return new ee((s,o)=>{e.onerror=a=>{o(a.target.error)},e.onsuccess=a=>{const u=a.target.result;if(!u)return void s();const d=new zj(u),f=t(u.primaryKey,u.value,d);if(f instanceof ee){const g=f.catch(y=>(d.done(),ee.reject(y)));r.push(g)}d.isDone?s():d.j===null?u.continue():u.continue(d.j)}}).next(()=>ee.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Sa(n){return new ee((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=Z0(r.target.error);t(s)}})}let P1=!1;function Z0(n){const e=Po.M(fn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new _e("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return P1||(P1=!0,setTimeout(()=>{throw r},0)),r}}return n}const Wu="IndexBackfiller";class Bj{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){me(Wu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.re.se();me(Wu,`Documents written: ${t}`)}catch(t){qo(t)?me(Wu,"Ignoring IndexedDB error during index backfill: ",t):await $o(t)}await this.ie(6e4)})}}class $j{constructor(e,t){this.localStore=e,this.persistence=t}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.oe(t,e))}oe(e,t){const r=new Set;let s=t,o=!0;return ee.doWhile(()=>o===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return me(Wu,`Processing collection: ${a}`),this._e(e,a,s).next(u=>{s-=u,r.add(a)});o=!1})).next(()=>t-s)}_e(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(o=>{const a=o.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.ae(s,o)).next(u=>(me(Wu,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u))).next(()=>a.size)}))}ae(e,t){let r=e;return t.changes.forEach((s,o)=>{const a=xE(o);J0(a,r)>0&&(r=a)}),new Yr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>t.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Rr.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca=-1;function Mm(n){return n==null}function cd(n){return n===0&&1/n==-1/0}function _E(n){return typeof n=="number"&&Number.isInteger(n)&&!cd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yf="";function Hn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=j1(e)),e=qj(n.get(t),e);return j1(e)}function qj(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const o=n.charAt(s);switch(o){case"\0":t+="";break;case Yf:t+="";break;default:t+=o}}return t}function j1(n){return n+Yf+""}function Js(n){const e=n.length;if(Me(e>=2,64408,{path:n}),e===2)return Me(n.charAt(0)===Yf&&n.charAt(1)==="",56145,{path:n}),pt.emptyPath();const t=e-2,r=[];let s="";for(let o=0;o<e;){const a=n.indexOf(Yf,o);switch((a<0||a>t)&&Ce(50515,{path:n}),n.charAt(a+1)){case"":const u=n.substring(o,a);let d;s.length===0?d=u:(s+=u,d=s,s=""),r.push(d);break;case"":s+=n.substring(o,a),s+="\0";break;case"":s+=n.substring(o,a+1);break;default:Ce(61167,{path:n})}o=a+2}return new pt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="remoteDocuments",jd="owner",Dl="owner",ud="mutationQueues",Hj="userId",js="mutations",D1="batchId",Aa="userMutationsIndex",M1=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(n,e){return[n,Hn(e)]}function SE(n,e,t){return[n,Hn(e),t]}const Wj={},rc="documentMutations",Xf="remoteDocumentsV14",Gj=["prefixPath","collectionGroup","readTime","documentId"],Nf="documentKeyIndex",Kj=["prefixPath","collectionGroup","documentId"],IE="collectionGroupIndex",Qj=["collectionGroup","readTime","prefixPath","documentId"],dd="remoteDocumentGlobal",Qy="remoteDocumentGlobalKey",sc="targets",EE="queryTargetsIndex",Yj=["canonicalId","targetId"],ic="targetDocuments",Xj=["targetId","path"],ex="documentTargetsIndex",Jj=["path","targetId"],Jf="targetGlobalKey",Na="targetGlobal",hd="collectionParents",Zj=["collectionId","parent"],oc="clientMetadata",eD="clientId",Lm="bundles",tD="bundleId",Om="namedQueries",nD="name",tx="indexConfiguration",rD="indexId",Yy="collectionGroupIndex",sD="collectionGroup",Gu="indexState",iD=["indexId","uid"],TE="sequenceNumberIndex",oD=["uid","sequenceNumber"],Ku="indexEntries",aD=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],kE="documentKeyIndex",lD=["indexId","uid","orderedDocumentKey"],Fm="documentOverlays",cD=["userId","collectionPath","documentId"],Xy="collectionPathOverlayIndex",uD=["userId","collectionPath","largestBatchId"],AE="collectionGroupOverlayIndex",dD=["userId","collectionGroup","largestBatchId"],nx="globals",hD="name",CE=[ud,js,rc,_a,sc,jd,Na,ic,oc,dd,hd,Lm,Om],fD=[...CE,Fm],NE=[ud,js,rc,Xf,sc,jd,Na,ic,oc,dd,hd,Lm,Om,Fm],RE=NE,rx=[...RE,tx,Gu,Ku],mD=rx,PE=[...rx,nx],pD=PE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy extends wE{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}}function mn(n,e){const t=Re(n);return Po.N(t.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L1(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ho(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function gD(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function jE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,t){this.comparator=e,this.root=t||Rn.EMPTY}insert(e,t){return new kt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Rn.BLACK,null,null))}remove(e){return new kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new uf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new uf(this.root,e,this.comparator,!1)}getReverseIterator(){return new uf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new uf(this.root,e,this.comparator,!0)}}class uf{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rn{constructor(e,t,r,s,o){this.key=e,this.value=t,this.color=r??Rn.RED,this.left=s??Rn.EMPTY,this.right=o??Rn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,o){return new Rn(e??this.key,t??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const o=r(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,r),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Rn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Rn.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ce(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ce(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ce(27949);return e+(this.isRed()?0:1)}}Rn.EMPTY=null,Rn.RED=!0,Rn.BLACK=!1;Rn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ce(57766)}get value(){throw Ce(16141)}get color(){throw Ce(16727)}get left(){throw Ce(29726)}get right(){throw Ce(36894)}copy(e,t,r,s,o){return this}insert(e,t,r){return new Rn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.comparator=e,this.data=new kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new O1(this.data.getIterator())}getIteratorFrom(e){return new O1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof vt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=r.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new vt(this.comparator);return t.data=e,t}}class O1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ml(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.fields=e,e.sort(Ut.comparator)}static empty(){return new Pr([])}unionWith(e){let t=new vt(Ut.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Pr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tc(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new DE("Invalid base64 string: "+o):o}}(e);return new Xt(t)}static fromUint8Array(e){const t=function(s){let o="";for(let a=0;a<s.length;++a)o+=String.fromCharCode(s[a]);return o}(e);return new Xt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xt.EMPTY_BYTE_STRING=new Xt("");const yD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ji(n){if(Me(!!n,39018),typeof n=="string"){let e=0;const t=yD.exec(n);if(Me(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Mt(n.seconds),nanos:Mt(n.nanos)}}function Mt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Di(n){return typeof n=="string"?Xt.fromBase64String(n):Xt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ME="server_timestamp",LE="__type__",OE="__previous_value__",FE="__local_write_time__";function sx(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[LE])===null||t===void 0?void 0:t.stringValue)===ME}function Vm(n){const e=n.mapValue.fields[OE];return sx(e)?Vm(e):e}function fd(n){const e=ji(n.mapValue.fields[FE].timestampValue);return new mt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e,t,r,s,o,a,u,d,f,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=d,this.useFetchStreams=f,this.isUsingEmulator=g}}const Zf="(default)";class Oa{constructor(e,t){this.projectId=e,this.database=t||Zf}static empty(){return new Oa("","")}get isDefaultDatabase(){return this.database===Zf}isEqual(e){return e instanceof Oa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ix="__type__",VE="__max__",Ao={mapValue:{fields:{__type__:{stringValue:VE}}}},ox="__vector__",ac="value",Rf={nullValue:"NULL_VALUE"};function Oo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?sx(n)?4:zE(n)?9007199254740991:zm(n)?10:11:Ce(28295,{value:n})}function ri(n,e){if(n===e)return!0;const t=Oo(n);if(t!==Oo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return fd(n).isEqual(fd(e));case 3:return function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const a=ji(s.timestampValue),u=ji(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,o){return Di(s.bytesValue).isEqual(Di(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,o){return Mt(s.geoPointValue.latitude)===Mt(o.geoPointValue.latitude)&&Mt(s.geoPointValue.longitude)===Mt(o.geoPointValue.longitude)}(n,e);case 2:return function(s,o){if("integerValue"in s&&"integerValue"in o)return Mt(s.integerValue)===Mt(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const a=Mt(s.doubleValue),u=Mt(o.doubleValue);return a===u?cd(a)===cd(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return tc(n.arrayValue.values||[],e.arrayValue.values||[],ri);case 10:case 11:return function(s,o){const a=s.mapValue.fields||{},u=o.mapValue.fields||{};if(L1(a)!==L1(u))return!1;for(const d in a)if(a.hasOwnProperty(d)&&(u[d]===void 0||!ri(a[d],u[d])))return!1;return!0}(n,e);default:return Ce(52216,{left:n})}}function md(n,e){return(n.values||[]).find(t=>ri(t,e))!==void 0}function Fo(n,e){if(n===e)return 0;const t=Oo(n),r=Oo(e);if(t!==r)return $e(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return $e(n.booleanValue,e.booleanValue);case 2:return function(o,a){const u=Mt(o.integerValue||o.doubleValue),d=Mt(a.integerValue||a.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1}(n,e);case 3:return F1(n.timestampValue,e.timestampValue);case 4:return F1(fd(n),fd(e));case 5:return Gy(n.stringValue,e.stringValue);case 6:return function(o,a){const u=Di(o),d=Di(a);return u.compareTo(d)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){const u=o.split("/"),d=a.split("/");for(let f=0;f<u.length&&f<d.length;f++){const g=$e(u[f],d[f]);if(g!==0)return g}return $e(u.length,d.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){const u=$e(Mt(o.latitude),Mt(a.latitude));return u!==0?u:$e(Mt(o.longitude),Mt(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return V1(n.arrayValue,e.arrayValue);case 10:return function(o,a){var u,d,f,g;const y=o.fields||{},x=a.fields||{},w=(u=y[ac])===null||u===void 0?void 0:u.arrayValue,E=(d=x[ac])===null||d===void 0?void 0:d.arrayValue,S=$e(((f=w==null?void 0:w.values)===null||f===void 0?void 0:f.length)||0,((g=E==null?void 0:E.values)===null||g===void 0?void 0:g.length)||0);return S!==0?S:V1(w,E)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===Ao.mapValue&&a===Ao.mapValue)return 0;if(o===Ao.mapValue)return 1;if(a===Ao.mapValue)return-1;const u=o.fields||{},d=Object.keys(u),f=a.fields||{},g=Object.keys(f);d.sort(),g.sort();for(let y=0;y<d.length&&y<g.length;++y){const x=Gy(d[y],g[y]);if(x!==0)return x;const w=Fo(u[d[y]],f[g[y]]);if(w!==0)return w}return $e(d.length,g.length)}(n.mapValue,e.mapValue);default:throw Ce(23264,{Pe:t})}}function F1(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return $e(n,e);const t=ji(n),r=ji(e),s=$e(t.seconds,r.seconds);return s!==0?s:$e(t.nanos,r.nanos)}function V1(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const o=Fo(t[s],r[s]);if(o)return o}return $e(t.length,r.length)}function lc(n){return Zy(n)}function Zy(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=ji(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Di(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ee.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const o of t.values||[])s?s=!1:r+=",",r+=Zy(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",o=!0;for(const a of r)o?o=!1:s+=",",s+=`${a}:${Zy(t.fields[a])}`;return s+"}"}(n.mapValue):Ce(61005,{value:n})}function Pf(n){switch(Oo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Vm(n);return e?16+Pf(e):16;case 5:return 2*n.stringValue.length;case 6:return Di(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,o)=>s+Pf(o),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return Ho(r.fields,(o,a)=>{s+=o.length+Pf(a)}),s}(n.mapValue);default:throw Ce(13486,{value:n})}}function pd(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function e0(n){return!!n&&"integerValue"in n}function gd(n){return!!n&&"arrayValue"in n}function z1(n){return!!n&&"nullValue"in n}function U1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function jf(n){return!!n&&"mapValue"in n}function zm(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[ix])===null||t===void 0?void 0:t.stringValue)===ox}function Qu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ho(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Qu(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Qu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function zE(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===VE}const UE={mapValue:{fields:{[ix]:{stringValue:ox},[ac]:{arrayValue:{}}}}};function vD(n){return"nullValue"in n?Rf:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?pd(Oa.empty(),Ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?zm(n)?UE:{mapValue:{}}:Ce(35942,{value:n})}function wD(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?pd(Oa.empty(),Ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?UE:"mapValue"in n?zm(n)?{mapValue:{}}:Ao:Ce(61959,{value:n})}function B1(n,e){const t=Fo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function $1(n,e){const t=Fo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.value=e}static empty(){return new $n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!jf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qu(t)}setAll(e){let t=Ut.emptyPath(),r={},s=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){const d=this.getFieldsMap(t);this.applyChanges(d,r,s),r={},s=[],t=u.popLast()}a?r[u.lastSegment()]=Qu(a):s.push(u.lastSegment())});const o=this.getFieldsMap(t);this.applyChanges(o,r,s)}delete(e){const t=this.field(e.popLast());jf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ri(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];jf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Ho(t,(s,o)=>e[s]=o);for(const s of r)delete e[s]}clone(){return new $n(Qu(this.value))}}function BE(n){const e=[];return Ho(n.fields,(t,r)=>{const s=new Ut([t]);if(jf(r)){const o=BE(r.mapValue).fields;if(o.length===0)e.push(s);else for(const a of o)e.push(s.child(a))}else e.push(s)}),new Pr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e,t,r,s,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new Ht(e,0,Fe.min(),Fe.min(),Fe.min(),$n.empty(),0)}static newFoundDocument(e,t,r,s){return new Ht(e,1,t,Fe.min(),r,s,0)}static newNoDocument(e,t){return new Ht(e,2,t,Fe.min(),Fe.min(),$n.empty(),0)}static newUnknownDocument(e,t){return new Ht(e,3,t,Fe.min(),Fe.min(),$n.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$n.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$n.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ht&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ht(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e,t){this.position=e,this.inclusive=t}}function q1(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const o=e[s],a=n.position[s];if(o.field.isKeyField()?r=Ee.comparator(Ee.fromName(a.referenceValue),t.key):r=Fo(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function H1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ri(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,t="asc"){this.field=e,this.dir=t}}function bD(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $E=class{};class st extends $E{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new _D(e,t,r):t==="array-contains"?new ED(e,r):t==="in"?new QE(e,r):t==="not-in"?new TD(e,r):t==="array-contains-any"?new kD(e,r):new st(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new SD(e,r):new ID(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Fo(t,this.value)):t!==null&&Oo(this.value)===Oo(t)&&this.matchesComparison(Fo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ce(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class xt extends $E{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new xt(e,t)}matches(e){return uc(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function uc(n){return n.op==="and"}function t0(n){return n.op==="or"}function ax(n){return qE(n)&&uc(n)}function qE(n){for(const e of n.filters)if(e instanceof xt)return!1;return!0}function n0(n){if(n instanceof st)return n.field.canonicalString()+n.op.toString()+lc(n.value);if(ax(n))return n.filters.map(e=>n0(e)).join(",");{const e=n.filters.map(t=>n0(t)).join(",");return`${n.op}(${e})`}}function HE(n,e){return n instanceof st?function(r,s){return s instanceof st&&r.op===s.op&&r.field.isEqual(s.field)&&ri(r.value,s.value)}(n,e):n instanceof xt?function(r,s){return s instanceof xt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((o,a,u)=>o&&HE(a,s.filters[u]),!0):!1}(n,e):void Ce(19439)}function WE(n,e){const t=n.filters.concat(e);return xt.create(t,n.op)}function GE(n){return n instanceof st?function(t){return`${t.field.canonicalString()} ${t.op} ${lc(t.value)}`}(n):n instanceof xt?function(t){return t.op.toString()+" {"+t.getFilters().map(GE).join(" ,")+"}"}(n):"Filter"}class _D extends st{constructor(e,t,r){super(e,t,r),this.key=Ee.fromName(r.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class SD extends st{constructor(e,t){super(e,"in",t),this.keys=KE("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class ID extends st{constructor(e,t){super(e,"not-in",t),this.keys=KE("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function KE(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Ee.fromName(r.referenceValue))}class ED extends st{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return gd(t)&&md(t.arrayValue,this.value)}}class QE extends st{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&md(this.value.arrayValue,t)}}class TD extends st{constructor(e,t){super(e,"not-in",t)}matches(e){if(md(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!md(this.value.arrayValue,t)}}class kD extends st{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!gd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>md(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e,t=null,r=[],s=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=o,this.startAt=a,this.endAt=u,this.Ie=null}}function r0(n,e=null,t=[],r=[],s=null,o=null,a=null){return new AD(n,e,t,r,s,o,a)}function Fa(n){const e=Re(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>n0(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Mm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>lc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>lc(r)).join(",")),e.Ie=t}return e.Ie}function Dd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!bD(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!HE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!H1(n.startAt,e.startAt)&&H1(n.endAt,e.endAt)}function em(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function tm(n,e){return n.filters.filter(t=>t instanceof st&&t.field.isEqual(e))}function W1(n,e,t){let r=Rf,s=!0;for(const o of tm(n,e)){let a=Rf,u=!0;switch(o.op){case"<":case"<=":a=vD(o.value);break;case"==":case"in":case">=":a=o.value;break;case">":a=o.value,u=!1;break;case"!=":case"not-in":a=Rf}B1({value:r,inclusive:s},{value:a,inclusive:u})<0&&(r=a,s=u)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const a=t.position[o];B1({value:r,inclusive:s},{value:a,inclusive:t.inclusive})<0&&(r=a,s=t.inclusive);break}}return{value:r,inclusive:s}}function G1(n,e,t){let r=Ao,s=!0;for(const o of tm(n,e)){let a=Ao,u=!0;switch(o.op){case">=":case">":a=wD(o.value),u=!1;break;case"==":case"in":case"<=":a=o.value;break;case"<":a=o.value,u=!1;break;case"!=":case"not-in":a=Ao}$1({value:r,inclusive:s},{value:a,inclusive:u})>0&&(r=a,s=u)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const a=t.position[o];$1({value:r,inclusive:s},{value:a,inclusive:t.inclusive})>0&&(r=a,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e,t=null,r=[],s=[],o=null,a="F",u=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=d,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function YE(n,e,t,r,s,o,a,u){return new Ac(n,e,t,r,s,o,a,u)}function Md(n){return new Ac(n)}function K1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function XE(n){return n.collectionGroup!==null}function Yu(n){const e=Re(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ee.push(o),t.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new vt(Ut.comparator);return a.filters.forEach(d=>{d.getFlattenedFilters().forEach(f=>{f.isInequality()&&(u=u.add(f.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ee.push(new yd(o,r))}),t.has(Ut.keyField().canonicalString())||e.Ee.push(new yd(Ut.keyField(),r))}return e.Ee}function Gr(n){const e=Re(n);return e.de||(e.de=JE(e,Yu(n))),e.de}function CD(n){const e=Re(n);return e.Ae||(e.Ae=JE(e,n.explicitOrderBy)),e.Ae}function JE(n,e){if(n.limitType==="F")return r0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const o=s.dir==="desc"?"asc":"desc";return new yd(s.field,o)});const t=n.endAt?new cc(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new cc(n.startAt.position,n.startAt.inclusive):null;return r0(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function s0(n,e){const t=n.filters.concat([e]);return new Ac(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function nm(n,e,t){return new Ac(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Um(n,e){return Dd(Gr(n),Gr(e))&&n.limitType===e.limitType}function ZE(n){return`${Fa(Gr(n))}|lt:${n.limitType}`}function Hl(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>GE(s)).join(", ")}]`),Mm(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>lc(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>lc(s)).join(",")),`Target(${r})`}(Gr(n))}; limitType=${n.limitType})`}function Ld(n,e){return e.isFoundDocument()&&function(r,s){const o=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):Ee.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,s){for(const o of Yu(r))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const o of r.filters)if(!o.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(a,u,d){const f=q1(a,u,d);return a.inclusive?f<=0:f<0}(r.startAt,Yu(r),s)||r.endAt&&!function(a,u,d){const f=q1(a,u,d);return a.inclusive?f>=0:f>0}(r.endAt,Yu(r),s))}(n,e)}function eT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function tT(n){return(e,t)=>{let r=!1;for(const s of Yu(n)){const o=ND(s,e,t);if(o!==0)return o;r=r||s.field.isKeyField()}return 0}}function ND(n,e,t){const r=n.field.isKeyField()?Ee.comparator(e.key,t.key):function(o,a,u){const d=a.data.field(o),f=u.data.field(o);return d!==null&&f!==null?Fo(d,f):Ce(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ce(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,o]of r)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ho(this.inner,(t,r)=>{for(const[s,o]of r)e(s,o)})}isEmpty(){return jE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD=new kt(Ee.comparator);function Wr(){return RD}const nT=new kt(Ee.comparator);function Vu(...n){let e=nT;for(const t of n)e=e.insert(t.key,t);return e}function rT(n){let e=nT;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Zs(){return Xu()}function sT(){return Xu()}function Xu(){return new $i(n=>n.toString(),(n,e)=>n.isEqual(e))}const PD=new kt(Ee.comparator),jD=new vt(Ee.comparator);function Je(...n){let e=jD;for(const t of n)e=e.add(t);return e}const DD=new vt($e);function lx(){return DD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cd(e)?"-0":e}}function iT(n){return{integerValue:""+n}}function MD(n,e){return _E(e)?iT(e):cx(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(){this._=void 0}}function LD(n,e,t){return n instanceof dc?function(s,o){const a={fields:{[LE]:{stringValue:ME},[FE]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&sx(o)&&(o=Vm(o)),o&&(a.fields[OE]=o),{mapValue:a}}(t,e):n instanceof Va?aT(n,e):n instanceof hc?lT(n,e):function(s,o){const a=oT(s,o),u=Q1(a)+Q1(s.Re);return e0(a)&&e0(s.Re)?iT(u):cx(s.serializer,u)}(n,e)}function OD(n,e,t){return n instanceof Va?aT(n,e):n instanceof hc?lT(n,e):t}function oT(n,e){return n instanceof xd?function(r){return e0(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class dc extends Bm{}class Va extends Bm{constructor(e){super(),this.elements=e}}function aT(n,e){const t=cT(e);for(const r of n.elements)t.some(s=>ri(s,r))||t.push(r);return{arrayValue:{values:t}}}class hc extends Bm{constructor(e){super(),this.elements=e}}function lT(n,e){let t=cT(e);for(const r of n.elements)t=t.filter(s=>!ri(s,r));return{arrayValue:{values:t}}}class xd extends Bm{constructor(e,t){super(),this.serializer=e,this.Re=t}}function Q1(n){return Mt(n.integerValue||n.doubleValue)}function cT(n){return gd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(e,t){this.field=e,this.transform=t}}function FD(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Va&&s instanceof Va||r instanceof hc&&s instanceof hc?tc(r.elements,s.elements,ri):r instanceof xd&&s instanceof xd?ri(r.Re,s.Re):r instanceof dc&&s instanceof dc}(n.transform,e.transform)}class VD{constructor(e,t){this.version=e,this.transformResults=t}}class hn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new hn}static exists(e){return new hn(void 0,e)}static updateTime(e){return new hn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Df(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class $m{}function uT(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Od(n.key,hn.none()):new Cc(n.key,n.data,hn.none());{const t=n.data,r=$n.empty();let s=new vt(Ut.comparator);for(let o of e.fields)if(!s.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),s=s.add(o)}return new qi(n.key,r,new Pr(s.toArray()),hn.none())}}function zD(n,e,t){n instanceof Cc?function(s,o,a){const u=s.value.clone(),d=X1(s.fieldTransforms,o,a.transformResults);u.setAll(d),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof qi?function(s,o,a){if(!Df(s.precondition,o))return void o.convertToUnknownDocument(a.version);const u=X1(s.fieldTransforms,o,a.transformResults),d=o.data;d.setAll(dT(s)),d.setAll(u),o.convertToFoundDocument(a.version,d).setHasCommittedMutations()}(n,e,t):function(s,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Ju(n,e,t,r){return n instanceof Cc?function(o,a,u,d){if(!Df(o.precondition,a))return u;const f=o.value.clone(),g=J1(o.fieldTransforms,d,a);return f.setAll(g),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof qi?function(o,a,u,d){if(!Df(o.precondition,a))return u;const f=J1(o.fieldTransforms,d,a),g=a.data;return g.setAll(dT(o)),g.setAll(f),a.convertToFoundDocument(a.version,g).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))}(n,e,t,r):function(o,a,u){return Df(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function UD(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),o=oT(r.transform,s||null);o!=null&&(t===null&&(t=$n.empty()),t.set(r.field,o))}return t||null}function Y1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&tc(r,s,(o,a)=>FD(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Cc extends $m{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class qi extends $m{constructor(e,t,r,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function dT(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function X1(n,e,t){const r=new Map;Me(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let s=0;s<t.length;s++){const o=n[s],a=o.transform,u=e.data.field(o.field);r.set(o.field,OD(a,u,t[s]))}return r}function J1(n,e,t){const r=new Map;for(const s of n){const o=s.transform,a=t.data.field(s.field);r.set(s.field,LD(o,a,e))}return r}class Od extends $m{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hT extends $m{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&zD(o,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ju(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Ju(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=sT();return this.mutations.forEach(s=>{const o=e.get(s.key),a=o.overlayedDocument;let u=this.applyToLocalView(a,o.mutatedFields);u=t.has(s.key)?null:u;const d=uT(a,u);d!==null&&r.set(s.key,d),a.isValidDocument()||a.convertToNoDocument(Fe.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Je())}isEqual(e){return this.batchId===e.batchId&&tc(this.mutations,e.mutations,(t,r)=>Y1(t,r))&&tc(this.baseMutations,e.baseMutations,(t,r)=>Y1(t,r))}}class hx{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Me(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let s=function(){return PD}();const o=e.mutations;for(let a=0;a<o.length;a++)s=s.insert(o[a].key,r[a].version);return new hx(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fx{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rn,ct;function qD(n){switch(n){case le.OK:return Ce(64938);case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0;default:return Ce(15467,{code:n})}}function fT(n){if(n===void 0)return Qt("GRPC error has no .code"),le.UNKNOWN;switch(n){case rn.OK:return le.OK;case rn.CANCELLED:return le.CANCELLED;case rn.UNKNOWN:return le.UNKNOWN;case rn.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case rn.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case rn.INTERNAL:return le.INTERNAL;case rn.UNAVAILABLE:return le.UNAVAILABLE;case rn.UNAUTHENTICATED:return le.UNAUTHENTICATED;case rn.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case rn.NOT_FOUND:return le.NOT_FOUND;case rn.ALREADY_EXISTS:return le.ALREADY_EXISTS;case rn.PERMISSION_DENIED:return le.PERMISSION_DENIED;case rn.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case rn.ABORTED:return le.ABORTED;case rn.OUT_OF_RANGE:return le.OUT_OF_RANGE;case rn.UNIMPLEMENTED:return le.UNIMPLEMENTED;case rn.DATA_LOSS:return le.DATA_LOSS;default:return Ce(39323,{code:n})}}(ct=rn||(rn={}))[ct.OK=0]="OK",ct[ct.CANCELLED=1]="CANCELLED",ct[ct.UNKNOWN=2]="UNKNOWN",ct[ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ct[ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ct[ct.NOT_FOUND=5]="NOT_FOUND",ct[ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",ct[ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",ct[ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",ct[ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ct[ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ct[ct.ABORTED=10]="ABORTED",ct[ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",ct[ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",ct[ct.INTERNAL=13]="INTERNAL",ct[ct.UNAVAILABLE=14]="UNAVAILABLE",ct[ct.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD=new Ro([4294967295,4294967295],0);function Z1(n){const e=mE().encode(n),t=new oE;return t.update(e),new Uint8Array(t.digest())}function e_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ro([t,r],0),new Ro([s,o],0)]}class mx{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new zu(`Invalid padding: ${t}`);if(r<0)throw new zu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new zu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new zu(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Ro.fromNumber(this.pe)}we(e,t,r){let s=e.add(t.multiply(Ro.fromNumber(r)));return s.compare(HD)===1&&(s=new Ro([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=Z1(e),[r,s]=e_(t);for(let o=0;o<this.hashCount;o++){const a=this.we(r,s,o);if(!this.be(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new mx(o,s,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.pe===0)return;const t=Z1(e),[r,s]=e_(t);for(let o=0;o<this.hashCount;o++){const a=this.we(r,s,o);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class zu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,t,r,s,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Vd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Fd(Fe.min(),s,new kt($e),Wr(),Je())}}class Vd{constructor(e,t,r,s,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Vd(r,t,Je(),Je(),Je())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(e,t,r,s){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=s}}class mT{constructor(e,t){this.targetId=e,this.Ce=t}}class pT{constructor(e,t,r=Xt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class t_{constructor(){this.Fe=0,this.Me=n_(),this.xe=Xt.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Je(),t=Je(),r=Je();return this.Me.forEach((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:Ce(38017,{changeType:o})}}),new Vd(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=n_()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Me(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class WD{constructor(e){this.ze=e,this.je=new Map,this.He=Wr(),this.Je=df(),this.Ye=df(),this.Ze=new kt($e)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:Ce(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,s)=>{this.it(s)&&t(s)})}ot(e){const t=e.targetId,r=e.Ce.count,s=this._t(t);if(s){const o=s.target;if(em(o))if(r===0){const a=new Ee(o.path);this.tt(t,a,Ht.newNoDocument(a,Fe.min()))}else Me(r===1,20013,{expectedCount:r});else{const a=this.ut(t);if(a!==r){const u=this.ct(e),d=u?this.lt(u,e,a):1;if(d!==0){this.st(t);const f=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,f)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:o=0}=t;let a,u;try{a=Di(r).toUint8Array()}catch(d){if(d instanceof DE)return La("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{u=new mx(a,s,o)}catch(d){return La(d instanceof zu?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return u.pe===0?null:u}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){const r=this.ze.getRemoteKeysForTarget(t);let s=0;return r.forEach(o=>{const a=this.ze.Pt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.tt(t,o,null),s++)}),s}It(e){const t=new Map;this.je.forEach((o,a)=>{const u=this._t(a);if(u){if(o.current&&em(u.target)){const d=new Ee(u.target.path);this.Et(d).has(a)||this.dt(a,d)||this.tt(a,d,Ht.newNoDocument(d,e))}o.Le&&(t.set(a,o.qe()),o.Qe())}});let r=Je();this.Ye.forEach((o,a)=>{let u=!0;a.forEachWhile(d=>{const f=this._t(d);return!f||f.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.He.forEach((o,a)=>a.setReadTime(e));const s=new Fd(e,t,this.Ze,this.He,r);return this.He=Wr(),this.Je=df(),this.Ye=df(),this.Ze=new kt($e),s}et(e,t){if(!this.it(e))return;const r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;const s=this.rt(e);this.dt(e,t)?s.$e(t,1):s.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new t_,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new vt($e),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new vt($e),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||me("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new t_),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function df(){return new kt(Ee.comparator)}function n_(){return new kt(Ee.comparator)}const GD={asc:"ASCENDING",desc:"DESCENDING"},KD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},QD={and:"AND",or:"OR"};class YD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function i0(n,e){return n.useProto3Json||Mm(e)?e:{value:e}}function fc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function gT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function XD(n,e){return fc(n,e.toTimestamp())}function ar(n){return Me(!!n,49232),Fe.fromTimestamp(function(t){const r=ji(t);return new mt(r.seconds,r.nanos)}(n))}function px(n,e){return o0(n,e).canonicalString()}function o0(n,e){const t=function(s){return new pt(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function yT(n){const e=pt.fromString(n);return Me(ET(e),10190,{key:e.toString()}),e}function rm(n,e){return px(n.databaseId,e.path)}function Ra(n,e){const t=yT(e);if(t.get(1)!==n.databaseId.projectId)throw new _e(le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new _e(le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee(wT(t))}function xT(n,e){return px(n.databaseId,e)}function vT(n){const e=yT(n);return e.length===4?pt.emptyPath():wT(e)}function a0(n){return new pt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function wT(n){return Me(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function r_(n,e,t){return{name:rm(n,e),fields:t.value.mapValue.fields}}function JD(n,e,t){const r=Ra(n,e.name),s=ar(e.updateTime),o=e.createTime?ar(e.createTime):Fe.min(),a=new $n({mapValue:{fields:e.fields}}),u=Ht.newFoundDocument(r,s,o,a);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function ZD(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:Ce(39313,{state:f})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=function(f,g){return f.useProto3Json?(Me(g===void 0||typeof g=="string",58123),Xt.fromBase64String(g||"")):(Me(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),Xt.fromUint8Array(g||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(f){const g=f.code===void 0?le.UNKNOWN:fT(f.code);return new _e(g,f.message||"")}(a);t=new pT(r,s,o,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ra(n,r.document.name),o=ar(r.document.updateTime),a=r.document.createTime?ar(r.document.createTime):Fe.min(),u=new $n({mapValue:{fields:r.document.fields}}),d=Ht.newFoundDocument(s,o,a,u),f=r.targetIds||[],g=r.removedTargetIds||[];t=new Mf(f,g,d.key,d)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ra(n,r.document),o=r.readTime?ar(r.readTime):Fe.min(),a=Ht.newNoDocument(s,o),u=r.removedTargetIds||[];t=new Mf([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ra(n,r.document),o=r.removedTargetIds||[];t=new Mf([],o,s,null)}else{if(!("filter"in e))return Ce(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:o}=r,a=new $D(s,o),u=r.targetId;t=new mT(u,a)}}return t}function sm(n,e){let t;if(e instanceof Cc)t={update:r_(n,e.key,e.value)};else if(e instanceof Od)t={delete:rm(n,e.key)};else if(e instanceof qi)t={update:r_(n,e.key,e.data),updateMask:o4(e.fieldMask)};else{if(!(e instanceof hT))return Ce(16599,{ft:e.type});t={verify:rm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,a){const u=a.transform;if(u instanceof dc)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Va)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof hc)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof xd)return{fieldPath:a.field.canonicalString(),increment:u.Re};throw Ce(20930,{transform:a.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,o){return o.updateTime!==void 0?{updateTime:XD(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ce(27497)}(n,e.precondition)),t}function l0(n,e){const t=e.currentDocument?function(o){return o.updateTime!==void 0?hn.updateTime(ar(o.updateTime)):o.exists!==void 0?hn.exists(o.exists):hn.none()}(e.currentDocument):hn.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(a,u){let d=null;if("setToServerValue"in u)Me(u.setToServerValue==="REQUEST_TIME",16630,{proto:u}),d=new dc;else if("appendMissingElements"in u){const g=u.appendMissingElements.values||[];d=new Va(g)}else if("removeAllFromArray"in u){const g=u.removeAllFromArray.values||[];d=new hc(g)}else"increment"in u?d=new xd(a,u.increment):Ce(16584,{proto:u});const f=Ut.fromServerFormat(u.fieldPath);return new ux(f,d)}(n,s)):[];if(e.update){e.update.name;const s=Ra(n,e.update.name),o=new $n({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(d){const f=d.fieldPaths||[];return new Pr(f.map(g=>Ut.fromServerFormat(g)))}(e.updateMask);return new qi(s,o,a,t,r)}return new Cc(s,o,t,r)}if(e.delete){const s=Ra(n,e.delete);return new Od(s,t)}if(e.verify){const s=Ra(n,e.verify);return new hT(s,t)}return Ce(1463,{proto:e})}function e4(n,e){return n&&n.length>0?(Me(e!==void 0,14353),n.map(t=>function(s,o){let a=s.updateTime?ar(s.updateTime):ar(o);return a.isEqual(Fe.min())&&(a=ar(o)),new VD(a,s.transformResults||[])}(t,e))):[]}function bT(n,e){return{documents:[xT(n,e.path)]}}function gx(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=xT(n,s);const o=function(f){if(f.length!==0)return IT(xt.create(f,"and"))}(e.filters);o&&(t.structuredQuery.where=o);const a=function(f){if(f.length!==0)return f.map(g=>function(x){return{field:To(x.field),direction:r4(x.dir)}}(g))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const u=i0(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(f){return{before:f.inclusive,values:f.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(e.endAt)),{gt:t,parent:s}}function t4(n,e,t,r){const{gt:s,parent:o}=gx(n,e),a={},u=[];let d=0;return t.forEach(f=>{const g="aggregate_"+d++;a[g]=f.alias,f.aggregateType==="count"?u.push({alias:g,count:{}}):f.aggregateType==="avg"?u.push({alias:g,avg:{field:To(f.fieldPath)}}):f.aggregateType==="sum"&&u.push({alias:g,sum:{field:To(f.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:u,structuredQuery:s.structuredQuery},parent:s.parent},yt:a,parent:o}}function _T(n){let e=vT(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Me(r===1,65062);const g=t.from[0];g.allDescendants?s=g.collectionId:e=e.child(g.collectionId)}let o=[];t.where&&(o=function(y){const x=ST(y);return x instanceof xt&&ax(x)?x.getFilters():[x]}(t.where));let a=[];t.orderBy&&(a=function(y){return y.map(x=>function(E){return new yd(Wl(E.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(x))}(t.orderBy));let u=null;t.limit&&(u=function(y){let x;return x=typeof y=="object"?y.value:y,Mm(x)?null:x}(t.limit));let d=null;t.startAt&&(d=function(y){const x=!!y.before,w=y.values||[];return new cc(w,x)}(t.startAt));let f=null;return t.endAt&&(f=function(y){const x=!y.before,w=y.values||[];return new cc(w,x)}(t.endAt)),YE(e,s,a,o,u,"F",d,f)}function n4(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ce(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function ST(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Wl(t.unaryFilter.field);return st.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Wl(t.unaryFilter.field);return st.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Wl(t.unaryFilter.field);return st.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Wl(t.unaryFilter.field);return st.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ce(61313);default:return Ce(60726)}}(n):n.fieldFilter!==void 0?function(t){return st.create(Wl(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ce(58110);default:return Ce(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return xt.create(t.compositeFilter.filters.map(r=>ST(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Ce(1026)}}(t.compositeFilter.op))}(n):Ce(30097,{filter:n})}function r4(n){return GD[n]}function s4(n){return KD[n]}function i4(n){return QD[n]}function To(n){return{fieldPath:n.canonicalString()}}function Wl(n){return Ut.fromServerFormat(n.fieldPath)}function IT(n){return n instanceof st?function(t){if(t.op==="=="){if(U1(t.value))return{unaryFilter:{field:To(t.field),op:"IS_NAN"}};if(z1(t.value))return{unaryFilter:{field:To(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(U1(t.value))return{unaryFilter:{field:To(t.field),op:"IS_NOT_NAN"}};if(z1(t.value))return{unaryFilter:{field:To(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:To(t.field),op:s4(t.op),value:t.value}}}(n):n instanceof xt?function(t){const r=t.getFilters().map(s=>IT(s));return r.length===1?r[0]:{compositeFilter:{op:i4(t.op),filters:r}}}(n):Ce(54877,{filter:n})}function o4(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function ET(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e,t,r,s,o=Fe.min(),a=Fe.min(),u=Xt.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=d}withSequenceNumber(e){return new Ni(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ni(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ni(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ni(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(e){this.wt=e}}function a4(n,e){let t;if(e.document)t=JD(n.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Ee.fromSegments(e.noDocument.path),s=Ua(e.noDocument.readTime);t=Ht.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ce(56709);{const r=Ee.fromSegments(e.unknownDocument.path),s=Ua(e.unknownDocument.version);t=Ht.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const o=new mt(s[0],s[1]);return Fe.fromTimestamp(o)}(e.readTime)),t}function s_(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:im(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,a){return{name:rm(o,a.key),fields:a.data.value.mapValue.fields,updateTime:fc(o,a.version.toTimestamp()),createTime:fc(o,a.createTime.toTimestamp())}}(n.wt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:za(e.version)};else{if(!e.isUnknownDocument())return Ce(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:za(e.version)}}return r}function im(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function za(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ua(n){const e=new mt(n.seconds,n.nanoseconds);return Fe.fromTimestamp(e)}function Ia(n,e){const t=(e.baseMutations||[]).map(o=>l0(n.wt,o));for(let o=0;o<e.mutations.length-1;++o){const a=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const u=e.mutations[o+1];a.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map(o=>l0(n.wt,o)),s=mt.fromMillis(e.localWriteTimeMs);return new dx(e.batchId,s,t,r)}function Uu(n){const e=Ua(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ua(n.lastLimboFreeSnapshotVersion):Fe.min();let r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){const a=o.documents.length;return Me(a===1,1966,{count:a}),Gr(Md(vT(o.documents[0])))}(n.query):function(o){return Gr(_T(o))}(n.query),new Ni(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Xt.fromBase64String(n.resumeToken))}function kT(n,e){const t=za(e.snapshotVersion),r=za(e.lastLimboFreeSnapshotVersion);let s;s=em(e.target)?bT(n.wt,e.target):gx(n.wt,e.target).gt;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Fa(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function AT(n){const e=_T({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?nm(e,e.limit,"L"):e}function ey(n,e){return new fx(e.largestBatchId,l0(n.wt,e.overlayMutation))}function i_(n,e){const t=e.path.lastSegment();return[n,Hn(e.path.popLast()),t]}function o_(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:za(r.readTime),documentKey:Hn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{getBundleMetadata(e,t){return a_(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:Ua(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return a_(e).put(function(s){return{bundleId:s.id,createTime:za(ar(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return l_(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:AT(o.bundledQuery),readTime:Ua(o.readTime)}}(r)})}saveNamedQuery(e,t){return l_(e).put(function(s){return{name:s.name,readTime:za(ar(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function a_(n){return mn(n,Lm)}function l_(n){return mn(n,Om)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){const r=t.uid||"";return new qm(e,r)}getOverlay(e,t){return xu(e).get(i_(this.userId,t)).next(r=>r?ey(this.serializer,r):null)}getOverlays(e,t){const r=Zs();return ee.forEach(t,s=>this.getOverlay(e,s).next(o=>{o!==null&&r.set(s,o)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((o,a)=>{const u=new fx(t,a);s.push(this.St(e,u))}),ee.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(a=>s.add(Hn(a.getCollectionPath())));const o=[];return s.forEach(a=>{const u=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);o.push(xu(e).X(Xy,u))}),ee.waitFor(o)}getOverlaysForCollection(e,t,r){const s=Zs(),o=Hn(t),a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return xu(e).J(Xy,a).next(u=>{for(const d of u){const f=ey(this.serializer,d);s.set(f.getKey(),f)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const o=Zs();let a;const u=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return xu(e).te({index:AE,range:u},(d,f,g)=>{const y=ey(this.serializer,f);o.size()<s||y.largestBatchId===a?(o.set(y.getKey(),y),a=y.largestBatchId):g.done()}).next(()=>o)}St(e,t){return xu(e).put(function(s,o,a){const[u,d,f]=i_(o,a.mutation.key);return{userId:o,collectionPath:d,documentId:f,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:sm(s.wt,a.mutation)}}(this.serializer,this.userId,t))}}function xu(n){return mn(n,Fm)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{Dt(e){return mn(e,nx)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?Xt.fromUint8Array(r):Xt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(Mt(e.integerValue));else if("doubleValue"in e){const r=Mt(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),cd(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),typeof r=="string"&&(r=ji(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(Di(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?zE(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):zm(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):Ce(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const r=e.fields||{};this.Mt(t,55);for(const s of Object.keys(r))this.Nt(s,t),this.Ct(r[s],t)}qt(e,t){var r,s;const o=e.fields||{};this.Mt(t,53);const a=ac,u=((s=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Mt(t,15),t.xt(Mt(u)),this.Nt(a,t),this.Ct(o[a],t)}$t(e,t){const r=e.values||[];this.Mt(t,50);for(const s of r)this.Ct(s,t)}kt(e,t){this.Mt(t,37),Ee.fromName(e).path.forEach(r=>{this.Mt(t,60),this.Kt(r,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}Ea.Wt=new Ea;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll=255;function u4(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function c_(n){const e=64-function(r){let s=0;for(let o=0;o<8;++o){const a=u4(255&r[o]);if(s+=a,a!==8)break}return s}(n);return Math.ceil(e/8)}class d4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.zt(r.value),r=t.next();this.jt()}Ht(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Yt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{const s=t.codePointAt(0);this.zt(240|s>>>18),this.zt(128|63&s>>>12),this.zt(128|63&s>>>6),this.zt(128|63&s)}}this.jt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Yt()}en(e){const t=this.tn(e),r=c_(t);this.nn(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}rn(e){const t=this.tn(e),r=c_(t);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}sn(){this._n(Ll),this._n(255)}an(){this.un(Ll),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const t=function(o){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,o,!1),new Uint8Array(a.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}zt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===Ll?(this._n(Ll),this._n(0)):this._n(t)}Jt(e){const t=255&e;t===0?(this.un(0),this.un(255)):t===Ll?(this.un(Ll),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class h4{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class f4{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class vu{constructor(){this.ln=new d4,this.hn=new h4(this.ln),this.Pn=new f4(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e,t,r,s){this.In=e,this.En=t,this.dn=r,this.An=s}Rn(){const e=this.An.length,t=e===0||this.An[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.An,0),t!==e?r.set([0],this.An.length):++r[r.length-1],new Ta(this.In,this.En,this.dn,r)}Vn(e,t,r){return{indexId:this.In,uid:e,arrayValue:Lf(this.dn),directionalValue:Lf(this.An),orderedDocumentKey:Lf(t),documentKey:r.path.toArray()}}mn(e,t,r){const s=this.Vn(e,t,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function vo(n,e){let t=n.In-e.In;return t!==0?t:(t=u_(n.dn,e.dn),t!==0?t:(t=u_(n.An,e.An),t!==0?t:Ee.comparator(n.En,e.En)))}function u_(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function Lf(n){return yI()?function(t){let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t[s]);return r}(n):n}function d_(n){return typeof n!="string"?n:function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(n)}class h_{constructor(e){this.fn=new vt((t,r)=>Ut.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const t of e.filters){const r=t;r.isInequality()?this.fn=this.fn.add(r):this.pn.push(r)}}get yn(){return this.fn.size>1}wn(e){if(Me(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const t=Ky(e);if(t!==void 0&&!this.bn(t))return!1;const r=ba(e);let s=new Set,o=0,a=0;for(;o<r.length&&this.bn(r[o]);++o)s=s.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.fn.size>0){const u=this.fn.getIterator().getNext();if(!s.has(u.field.canonicalString())){const d=r[o];if(!this.Sn(u,d)||!this.Dn(this.gn[a++],d))return!1}++o}for(;o<r.length;++o){const u=r[o];if(a>=this.gn.length||!this.Dn(this.gn[a++],u))return!1}return!0}vn(){if(this.yn)return null;let e=new vt(Ut.comparator);const t=[];for(const r of this.pn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Af(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Af(r.field,0))}for(const r of this.gn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Af(r.field,r.dir==="asc"?0:1)));return new Qf(Qf.UNKNOWN_ID,this.collectionId,t,ld.empty())}bn(e){for(const t of this.pn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}Dn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CT(n){var e,t;if(Me(n instanceof st||n instanceof xt,20012),n instanceof st){if(n instanceof QE){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>st.create(n.field,"==",o)))||[];return xt.create(s,"or")}return n}const r=n.filters.map(s=>CT(s));return xt.create(r,n.op)}function m4(n){if(n.getFilters().length===0)return[];const e=d0(CT(n));return Me(NT(e),7391),c0(e)||u0(e)?[e]:e.getFilters()}function c0(n){return n instanceof st}function u0(n){return n instanceof xt&&ax(n)}function NT(n){return c0(n)||u0(n)||function(t){if(t instanceof xt&&t0(t)){for(const r of t.getFilters())if(!c0(r)&&!u0(r))return!1;return!0}return!1}(n)}function d0(n){if(Me(n instanceof st||n instanceof xt,34018),n instanceof st)return n;if(n.filters.length===1)return d0(n.filters[0]);const e=n.filters.map(r=>d0(r));let t=xt.create(e,n.op);return t=om(t),NT(t)?t:(Me(t instanceof xt,64498),Me(uc(t),40251),Me(t.filters.length>1,57927),t.filters.reduce((r,s)=>yx(r,s)))}function yx(n,e){let t;return Me(n instanceof st||n instanceof xt,38388),Me(e instanceof st||e instanceof xt,25473),t=n instanceof st?e instanceof st?function(s,o){return xt.create([s,o],"and")}(n,e):f_(n,e):e instanceof st?f_(e,n):function(s,o){if(Me(s.filters.length>0&&o.filters.length>0,48005),uc(s)&&uc(o))return WE(s,o.getFilters());const a=t0(s)?s:o,u=t0(s)?o:s,d=a.filters.map(f=>yx(f,u));return xt.create(d,"or")}(n,e),om(t)}function f_(n,e){if(uc(e))return WE(e,n.getFilters());{const t=e.filters.map(r=>yx(n,r));return xt.create(t,"or")}}function om(n){if(Me(n instanceof st||n instanceof xt,11850),n instanceof st)return n;const e=n.getFilters();if(e.length===1)return om(e[0]);if(qE(n))return n;const t=e.map(s=>om(s)),r=[];return t.forEach(s=>{s instanceof st?r.push(s):s instanceof xt&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:xt.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(){this.Cn=new xx}addToCollectionParentIndex(e,t){return this.Cn.add(t),ee.resolve()}getCollectionParents(e,t){return ee.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ee.resolve()}deleteFieldIndex(e,t){return ee.resolve()}deleteAllFieldIndexes(e){return ee.resolve()}createTargetIndexes(e,t){return ee.resolve()}getDocumentsMatchingTarget(e,t){return ee.resolve(null)}getIndexType(e,t){return ee.resolve(0)}getFieldIndexes(e,t){return ee.resolve([])}getNextCollectionGroupToUpdate(e){return ee.resolve(null)}getMinOffset(e,t){return ee.resolve(Yr.min())}getMinOffsetFromCollectionGroup(e,t){return ee.resolve(Yr.min())}updateCollectionGroup(e,t,r){return ee.resolve()}updateIndexEntries(e,t){return ee.resolve()}}class xx{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new vt(pt.comparator),o=!s.has(r);return this.index[t]=s.add(r),o}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new vt(pt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_="IndexedDbIndexManager",hf=new Uint8Array(0);class g4{constructor(e,t){this.databaseId=t,this.Fn=new xx,this.Mn=new $i(r=>Fa(r),(r,s)=>Dd(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Fn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.Fn.add(t)});const o={collectionId:r,parent:Hn(s)};return p_(e).put(o)}return ee.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[gE(t),""],!1,!0);return p_(e).J(s).next(o=>{for(const a of o){if(a.collectionId!==t)break;r.push(Js(a.parent))}return r})}addFieldIndex(e,t){const r=wu(e),s=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])}}(t);delete s.indexId;const o=r.add(s);if(t.indexState){const a=Fl(e);return o.next(u=>{a.put(o_(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){const r=wu(e),s=Fl(e),o=Ol(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=wu(e),r=Ol(e),s=Fl(e);return t.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,t){return ee.forEach(this.xn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const o=new h_(r).vn();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){const r=Ol(e);let s=!0;const o=new Map;return ee.forEach(this.xn(t),a=>this.On(e,a).next(u=>{s&&(s=!!u),o.set(a,u)})).next(()=>{if(s){let a=Je();const u=[];return ee.forEach(o,(d,f)=>{me(m_,`Using index ${function(U){return`id=${U.indexId}|cg=${U.collectionGroup}|f=${U.fields.map(W=>`${W.fieldPath}:${W.kind}`).join(",")}`}(d)} to execute ${Fa(t)}`);const g=function(U,W){const $=Ky(W);if($===void 0)return null;for(const F of tm(U,$.fieldPath))switch(F.op){case"array-contains-any":return F.value.arrayValue.values||[];case"array-contains":return[F.value]}return null}(f,d),y=function(U,W){const $=new Map;for(const F of ba(W))for(const R of tm(U,F.fieldPath))switch(R.op){case"==":case"in":$.set(F.fieldPath.canonicalString(),R.value);break;case"not-in":case"!=":return $.set(F.fieldPath.canonicalString(),R.value),Array.from($.values())}return null}(f,d),x=function(U,W){const $=[];let F=!0;for(const R of ba(W)){const k=R.kind===0?W1(U,R.fieldPath,U.startAt):G1(U,R.fieldPath,U.startAt);$.push(k.value),F&&(F=k.inclusive)}return new cc($,F)}(f,d),w=function(U,W){const $=[];let F=!0;for(const R of ba(W)){const k=R.kind===0?G1(U,R.fieldPath,U.endAt):W1(U,R.fieldPath,U.endAt);$.push(k.value),F&&(F=k.inclusive)}return new cc($,F)}(f,d),E=this.Nn(d,f,x),S=this.Nn(d,f,w),A=this.Bn(d,f,y),N=this.Ln(d.indexId,g,E,x.inclusive,S,w.inclusive,A);return ee.forEach(N,z=>r.Z(z,t.limit).next(U=>{U.forEach(W=>{const $=Ee.fromSegments(W.documentKey);a.has($)||(a=a.add($),u.push($))})}))}).next(()=>u)}return ee.resolve(null)})}xn(e){let t=this.Mn.get(e);return t||(e.filters.length===0?t=[e]:t=m4(xt.create(e.filters,"and")).map(r=>r0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,t),t)}Ln(e,t,r,s,o,a,u){const d=(t!=null?t.length:1)*Math.max(r.length,o.length),f=d/(t!=null?t.length:1),g=[];for(let y=0;y<d;++y){const x=t?this.kn(t[y/f]):hf,w=this.qn(e,x,r[y%f],s),E=this.Qn(e,x,o[y%f],a),S=u.map(A=>this.qn(e,x,A,!0));g.push(...this.createRange(w,E,S))}return g}qn(e,t,r,s){const o=new Ta(e,Ee.empty(),t,r);return s?o:o.Rn()}Qn(e,t,r,s){const o=new Ta(e,Ee.empty(),t,r);return s?o.Rn():o}On(e,t){const r=new h_(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(o=>{let a=null;for(const u of o)r.wn(u)&&(!a||u.fields.length>a.fields.length)&&(a=u);return a})}getIndexType(e,t){let r=2;const s=this.xn(t);return ee.forEach(s,o=>this.On(e,o).next(a=>{a?r!==0&&a.fields.length<function(d){let f=new vt(Ut.comparator),g=!1;for(const y of d.filters)for(const x of y.getFlattenedFilters())x.field.isKeyField()||(x.op==="array-contains"||x.op==="array-contains-any"?g=!0:f=f.add(x.field));for(const y of d.orderBy)y.field.isKeyField()||(f=f.add(y.field));return f.size+(g?1:0)}(o)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(t)&&s.length>1&&r===2?1:r)}$n(e,t){const r=new vu;for(const s of ba(e)){const o=t.data.field(s.fieldPath);if(o==null)return null;const a=r.Tn(s.kind);Ea.Wt.vt(o,a)}return r.cn()}kn(e){const t=new vu;return Ea.Wt.vt(e,t.Tn(0)),t.cn()}Un(e,t){const r=new vu;return Ea.Wt.vt(pd(this.databaseId,t),r.Tn(function(o){const a=ba(o);return a.length===0?0:a[a.length-1].kind}(e))),r.cn()}Bn(e,t,r){if(r===null)return[];let s=[];s.push(new vu);let o=0;for(const a of ba(e)){const u=r[o++];for(const d of s)if(this.Kn(t,a.fieldPath)&&gd(u))s=this.Wn(s,a,u);else{const f=d.Tn(a.kind);Ea.Wt.vt(u,f)}}return this.Gn(s)}Nn(e,t,r){return this.Bn(e,t,r.position)}Gn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].cn();return t}Wn(e,t,r){const s=[...e],o=[];for(const a of r.arrayValue.values||[])for(const u of s){const d=new vu;d.seed(u.cn()),Ea.Wt.vt(a,d.Tn(t.kind)),o.push(d)}return o}Kn(e,t){return!!e.filters.find(r=>r instanceof st&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=wu(e),s=Fl(e);return(t?r.J(Yy,IDBKeyRange.bound(t,t)):r.J()).next(o=>{const a=[];return ee.forEach(o,u=>s.get([u.indexId,this.uid]).next(d=>{a.push(function(g,y){const x=y?new ld(y.sequenceNumber,new Yr(Ua(y.readTime),new Ee(Js(y.documentKey)),y.largestBatchId)):ld.empty(),w=g.fields.map(([E,S])=>new Af(Ut.fromServerFormat(E),S));return new Qf(g.indexId,g.collectionGroup,w,x)}(u,d))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const o=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return o!==0?o:$e(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=wu(e),o=Fl(e);return this.zn(e).next(a=>s.J(Yy,IDBKeyRange.bound(t,t)).next(u=>ee.forEach(u,d=>o.put(o_(d.indexId,this.uid,a,r)))))}updateIndexEntries(e,t){const r=new Map;return ee.forEach(t,(s,o)=>{const a=r.get(s.collectionGroup);return(a?ee.resolve(a):this.getFieldIndexes(e,s.collectionGroup)).next(u=>(r.set(s.collectionGroup,u),ee.forEach(u,d=>this.jn(e,s,d).next(f=>{const g=this.Hn(o,d);return f.isEqual(g)?ee.resolve():this.Jn(e,o,d,f,g)}))))})}Yn(e,t,r,s){return Ol(e).put(s.Vn(this.uid,this.Un(r,t.key),t.key))}Zn(e,t,r,s){return Ol(e).delete(s.mn(this.uid,this.Un(r,t.key),t.key))}jn(e,t,r){const s=Ol(e);let o=new vt(vo);return s.te({index:kE,range:IDBKeyRange.only([r.indexId,this.uid,Lf(this.Un(r,t))])},(a,u)=>{o=o.add(new Ta(r.indexId,t,d_(u.arrayValue),d_(u.directionalValue)))}).next(()=>o)}Hn(e,t){let r=new vt(vo);const s=this.$n(t,e);if(s==null)return r;const o=Ky(t);if(o!=null){const a=e.data.field(o.fieldPath);if(gd(a))for(const u of a.arrayValue.values||[])r=r.add(new Ta(t.indexId,e.key,this.kn(u),s))}else r=r.add(new Ta(t.indexId,e.key,hf,s));return r}Jn(e,t,r,s,o){me(m_,"Updating index entries for document '%s'",t.key);const a=[];return function(d,f,g,y,x){const w=d.getIterator(),E=f.getIterator();let S=Ml(w),A=Ml(E);for(;S||A;){let N=!1,z=!1;if(S&&A){const U=g(S,A);U<0?z=!0:U>0&&(N=!0)}else S!=null?z=!0:N=!0;N?(y(A),A=Ml(E)):z?(x(S),S=Ml(w)):(S=Ml(w),A=Ml(E))}}(s,o,vo,u=>{a.push(this.Yn(e,t,r,u))},u=>{a.push(this.Zn(e,t,r,u))}),ee.waitFor(a)}zn(e){let t=1;return Fl(e).te({index:TE,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,o)=>{o.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((a,u)=>vo(a,u)).filter((a,u,d)=>!u||vo(a,d[u-1])!==0);const s=[];s.push(e);for(const a of r){const u=vo(a,e),d=vo(a,t);if(u===0)s[0]=e.Rn();else if(u>0&&d<0)s.push(a),s.push(a.Rn());else if(d>0)break}s.push(t);const o=[];for(let a=0;a<s.length;a+=2){if(this.Xn(s[a],s[a+1]))return[];const u=s[a].mn(this.uid,hf,Ee.empty()),d=s[a+1].mn(this.uid,hf,Ee.empty());o.push(IDBKeyRange.bound(u,d))}return o}Xn(e,t){return vo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(g_)}getMinOffset(e,t){return ee.mapArray(this.xn(t),r=>this.On(e,r).next(s=>s||Ce(44426))).next(g_)}}function p_(n){return mn(n,hd)}function Ol(n){return mn(n,Ku)}function wu(n){return mn(n,tx)}function Fl(n){return mn(n,Gu)}function g_(n){Me(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;J0(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Yr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},RT=41943040;class Bn{static withCacheSize(e){return new Bn(e,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(n,e,t){const r=n.store(js),s=n.store(rc),o=[],a=IDBKeyRange.only(t.batchId);let u=0;const d=r.te({range:a},(g,y,x)=>(u++,x.delete()));o.push(d.next(()=>{Me(u===1,47070,{batchId:t.batchId})}));const f=[];for(const g of t.mutations){const y=SE(e,g.key.path,t.batchId);o.push(s.delete(y)),f.push(g.key)}return ee.waitFor(o).next(()=>f)}function am(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ce(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bn.DEFAULT_COLLECTION_PERCENTILE=10,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bn.DEFAULT=new Bn(RT,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bn.DISABLED=new Bn(-1,0,0);class Hm{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.er={}}static bt(e,t,r,s){Me(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new Hm(o,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return wo(e).te({index:Aa,range:r},(s,o,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const o=Gl(e),a=wo(e);return a.add({}).next(u=>{Me(typeof u=="number",49019);const d=new dx(u,t,r,s),f=function(w,E,S){const A=S.baseMutations.map(z=>sm(w.wt,z)),N=S.mutations.map(z=>sm(w.wt,z));return{userId:E,batchId:S.batchId,localWriteTimeMs:S.localWriteTime.toMillis(),baseMutations:A,mutations:N}}(this.serializer,this.userId,d),g=[];let y=new vt((x,w)=>$e(x.canonicalString(),w.canonicalString()));for(const x of s){const w=SE(this.userId,x.key.path,u);y=y.add(x.key.path.popLast()),g.push(a.put(f)),g.push(o.put(w,Wj))}return y.forEach(x=>{g.push(this.indexManager.addToCollectionParentIndex(e,x))}),e.addOnCommittedListener(()=>{this.er[u]=d.keys()}),ee.waitFor(g).next(()=>d)})}lookupMutationBatch(e,t){return wo(e).get(t).next(r=>r?(Me(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Ia(this.serializer,r)):null)}tr(e,t){return this.er[t]?ee.resolve(this.er[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.er[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return wo(e).te({index:Aa,range:s},(a,u,d)=>{u.userId===this.userId&&(Me(u.batchId>=r,47524,{nr:r}),o=Ia(this.serializer,u)),d.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Ca;return wo(e).te({index:Aa,range:t,reverse:!0},(s,o,a)=>{r=o.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ca],[this.userId,Number.POSITIVE_INFINITY]);return wo(e).J(Aa,t).next(r=>r.map(s=>Ia(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Cf(this.userId,t.path),s=IDBKeyRange.lowerBound(r),o=[];return Gl(e).te({range:s},(a,u,d)=>{const[f,g,y]=a,x=Js(g);if(f===this.userId&&t.path.isEqual(x))return wo(e).get(y).next(w=>{if(!w)throw Ce(61480,{rr:a,batchId:y});Me(w.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:w.userId,batchId:y}),o.push(Ia(this.serializer,w))});d.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new vt($e);const s=[];return t.forEach(o=>{const a=Cf(this.userId,o.path),u=IDBKeyRange.lowerBound(a),d=Gl(e).te({range:u},(f,g,y)=>{const[x,w,E]=f,S=Js(w);x===this.userId&&o.path.isEqual(S)?r=r.add(E):y.done()});s.push(d)}),ee.waitFor(s).next(()=>this.ir(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,o=Cf(this.userId,r),a=IDBKeyRange.lowerBound(o);let u=new vt($e);return Gl(e).te({range:a},(d,f,g)=>{const[y,x,w]=d,E=Js(x);y===this.userId&&r.isPrefixOf(E)?E.length===s&&(u=u.add(w)):g.done()}).next(()=>this.ir(e,u))}ir(e,t){const r=[],s=[];return t.forEach(o=>{s.push(wo(e).get(o).next(a=>{if(a===null)throw Ce(35274,{batchId:o});Me(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:o}),r.push(Ia(this.serializer,a))}))}),ee.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return PT(e.he,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.sr(t.batchId)}),ee.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return ee.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),s=[];return Gl(e).te({range:r},(o,a,u)=>{if(o[0]===this.userId){const d=Js(o[1]);s.push(d)}else u.done()}).next(()=>{Me(s.length===0,56720,{_r:s.map(o=>o.canonicalString())})})})}containsKey(e,t){return jT(e,this.userId,t)}ar(e){return DT(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ca,lastStreamToken:""})}}function jT(n,e,t){const r=Cf(e,t.path),s=r[1],o=IDBKeyRange.lowerBound(r);let a=!1;return Gl(n).te({range:o,ee:!0},(u,d,f)=>{const[g,y,x]=u;g===e&&y===s&&(a=!0),f.done()}).next(()=>a)}function wo(n){return mn(n,js)}function Gl(n){return mn(n,rc)}function DT(n){return mn(n,ud)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Ba(0)}static lr(){return new Ba(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.hr(e).next(t=>{const r=new Ba(t.highestTargetId);return t.highestTargetId=r.next(),this.Pr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(t=>Fe.fromTimestamp(new mt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.hr(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Pr(e,s)))}addTargetData(e,t){return this.Tr(e,t).next(()=>this.hr(e).next(r=>(r.targetCount+=1,this.Ir(t,r),this.Pr(e,r))))}updateTargetData(e,t){return this.Tr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Vl(e).delete(t.targetId)).next(()=>this.hr(e)).next(r=>(Me(r.targetCount>0,8065),r.targetCount-=1,this.Pr(e,r)))}removeTargets(e,t,r){let s=0;const o=[];return Vl(e).te((a,u)=>{const d=Uu(u);d.sequenceNumber<=t&&r.get(d.targetId)===null&&(s++,o.push(this.removeTargetData(e,d)))}).next(()=>ee.waitFor(o)).next(()=>s)}forEachTarget(e,t){return Vl(e).te((r,s)=>{const o=Uu(s);t(o)})}hr(e){return x_(e).get(Jf).next(t=>(Me(t!==null,2888),t))}Pr(e,t){return x_(e).put(Jf,t)}Tr(e,t){return Vl(e).put(kT(this.serializer,t))}Ir(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.hr(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Fa(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return Vl(e).te({range:s,index:EE},(a,u,d)=>{const f=Uu(u);Dd(t,f.target)&&(o=f,d.done())}).next(()=>o)}addMatchingKeys(e,t,r){const s=[],o=ko(e);return t.forEach(a=>{const u=Hn(a.path);s.push(o.put({targetId:r,path:u})),s.push(this.referenceDelegate.addReference(e,r,a))}),ee.waitFor(s)}removeMatchingKeys(e,t,r){const s=ko(e);return ee.forEach(t,o=>{const a=Hn(o.path);return ee.waitFor([s.delete([r,a]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){const r=ko(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=ko(e);let o=Je();return s.te({range:r,ee:!0},(a,u,d)=>{const f=Js(a[1]),g=new Ee(f);o=o.add(g)}).next(()=>o)}containsKey(e,t){const r=Hn(t.path),s=IDBKeyRange.bound([r],[gE(r)],!1,!0);let o=0;return ko(e).te({index:ex,ee:!0,range:s},([a,u],d,f)=>{a!==0&&(o++,f.done())}).next(()=>o>0)}Rt(e,t){return Vl(e).get(t).next(r=>r?Uu(r):null)}}function Vl(n){return mn(n,sc)}function x_(n){return mn(n,Na)}function ko(n){return mn(n,ic)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_="LruGarbageCollector",x4=1048576;function w_([n,e],[t,r]){const s=$e(n,t);return s===0?$e(e,r):s}class v4{constructor(e){this.Er=e,this.buffer=new vt(w_),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();w_(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class MT{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){me(v_,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){qo(t)?me(v_,"Ignoring IndexedDB error during garbage collection: ",t):await $o(t)}await this.mr(3e5)})}}class w4{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return ee.resolve(Rr.le);const r=new v4(t);return this.gr.forEachTarget(e,s=>r.Rr(s.sequenceNumber)).next(()=>this.gr.yr(e,s=>r.Rr(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.gr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(me("LruGarbageCollector","Garbage collection skipped; disabled"),ee.resolve(y_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(me("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),y_):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let r,s,o,a,u,d,f;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(me("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),s=this.params.maximumSequenceNumbersToCollect):s=y,a=Date.now(),this.nthSequenceNumber(e,s))).next(y=>(r=y,u=Date.now(),this.removeTargets(e,r,t))).next(y=>(o=y,d=Date.now(),this.removeOrphanedDocuments(e,r))).next(y=>(f=Date.now(),ql()<=rt.DEBUG&&me("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-g}ms
	Determined least recently used ${s} in `+(u-a)+`ms
	Removed ${o} targets in `+(d-u)+`ms
	Removed ${y} documents in `+(f-d)+`ms
Total Duration: ${f-g}ms`),ee.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:y})))}}function LT(n,e){return new w4(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(e,t){this.db=e,this.garbageCollector=LT(this,t)}pr(e){const t=this.br(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}br(e){let t=0;return this.yr(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}yr(e,t){return this.Sr(e,(r,s)=>t(s))}addReference(e,t,r){return ff(e,r)}removeReference(e,t,r){return ff(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return ff(e,t)}Dr(e,t){return function(s,o){let a=!1;return DT(s).ne(u=>jT(s,u,o).next(d=>(d&&(a=!0),ee.resolve(!d)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let o=0;return this.Sr(e,(a,u)=>{if(u<=t){const d=this.Dr(e,a).next(f=>{if(!f)return o++,r.getEntry(e,a).next(()=>(r.removeEntry(a,Fe.min()),ko(e).delete(function(y){return[0,Hn(y.path)]}(a))))});s.push(d)}}).next(()=>ee.waitFor(s)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return ff(e,t)}Sr(e,t){const r=ko(e);let s,o=Rr.le;return r.te({index:ex},([a,u],{path:d,sequenceNumber:f})=>{a===0?(o!==Rr.le&&t(new Ee(Js(s)),o),o=f,s=d):o=Rr.le}).next(()=>{o!==Rr.le&&t(new Ee(Js(s)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ff(n,e){return ko(n).put(function(r,s){return{targetId:0,path:Hn(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT{constructor(){this.changes=new $i(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ht.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ee.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return xa(e).put(r)}removeEntry(e,t,r){return xa(e).delete(function(o,a){const u=o.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],im(a),u[u.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.vr(e,r)))}getEntry(e,t){let r=Ht.newInvalidDocument(t);return xa(e).te({index:Nf,range:IDBKeyRange.only(bu(t))},(s,o)=>{r=this.Cr(t,o)}).next(()=>r)}Fr(e,t){let r={size:0,document:Ht.newInvalidDocument(t)};return xa(e).te({index:Nf,range:IDBKeyRange.only(bu(t))},(s,o)=>{r={document:this.Cr(t,o),size:am(o)}}).next(()=>r)}getEntries(e,t){let r=Wr();return this.Mr(e,t,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a)}).next(()=>r)}Or(e,t){let r=Wr(),s=new kt(Ee.comparator);return this.Mr(e,t,(o,a)=>{const u=this.Cr(o,a);r=r.insert(o,u),s=s.insert(o,am(a))}).next(()=>({documents:r,Nr:s}))}Mr(e,t,r){if(t.isEmpty())return ee.resolve();let s=new vt(S_);t.forEach(d=>s=s.add(d));const o=IDBKeyRange.bound(bu(s.first()),bu(s.last())),a=s.getIterator();let u=a.getNext();return xa(e).te({index:Nf,range:o},(d,f,g)=>{const y=Ee.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;u&&S_(u,y)<0;)r(u,null),u=a.getNext();u&&u.isEqual(y)&&(r(u,f),u=a.hasNext()?a.getNext():null),u?g.H(bu(u)):g.done()}).next(()=>{for(;u;)r(u,null),u=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,o){const a=t.path,u=[a.popLast().toArray(),a.lastSegment(),im(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],d=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xa(e).J(IDBKeyRange.bound(u,d,!0)).next(f=>{o==null||o.incrementDocumentReadCount(f.length);let g=Wr();for(const y of f){const x=this.Cr(Ee.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);x.isFoundDocument()&&(Ld(t,x)||s.has(x.key))&&(g=g.insert(x.key,x))}return g})}getAllFromCollectionGroup(e,t,r,s){let o=Wr();const a=__(t,r),u=__(t,Yr.max());return xa(e).te({index:IE,range:IDBKeyRange.bound(a,u,!0)},(d,f,g)=>{const y=this.Cr(Ee.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);o=o.insert(y.key,y),o.size===s&&g.done()}).next(()=>o)}newChangeBuffer(e){return new S4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return b_(e).get(Qy).next(t=>(Me(!!t,20021),t))}vr(e,t){return b_(e).put(Qy,t)}Cr(e,t){if(t){const r=a4(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Fe.min())))return r}return Ht.newInvalidDocument(e)}}function FT(n){return new _4(n)}class S4 extends OT{constructor(e,t){super(),this.Br=e,this.trackRemovals=t,this.Lr=new $i(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new vt((o,a)=>$e(o.canonicalString(),a.canonicalString()));return this.changes.forEach((o,a)=>{const u=this.Lr.get(o);if(t.push(this.Br.removeEntry(e,o,u.readTime)),a.isValidDocument()){const d=s_(this.Br.serializer,a);s=s.add(o.path.popLast());const f=am(d);r+=f-u.size,t.push(this.Br.addEntry(e,o,d))}else if(r-=u.size,this.trackRemovals){const d=s_(this.Br.serializer,a.convertToNoDocument(Fe.min()));t.push(this.Br.addEntry(e,o,d))}}),s.forEach(o=>{t.push(this.Br.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.Br.updateMetadata(e,r)),ee.waitFor(t)}getFromCache(e,t){return this.Br.Fr(e,t).next(r=>(this.Lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Br.Or(e,t).next(({documents:r,Nr:s})=>(s.forEach((o,a)=>{this.Lr.set(o,{size:a,readTime:r.get(o).readTime})}),r))}}function b_(n){return mn(n,dd)}function xa(n){return mn(n,Xf)}function bu(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function __(n,e){const t=e.documentKey.path.toArray();return[n,im(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function S_(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(s=$e(t[o],r[o]),s)return s;return s=$e(t.length,r.length),s||(s=$e(t[t.length-2],r[r.length-2]),s||$e(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Ju(r.mutation,s,Pr.empty(),mt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Je()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Je()){const s=Zs();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(o=>{let a=Vu();return o.forEach((u,d)=>{a=a.insert(u,d.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const r=Zs();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Je()))}populateOverlays(e,t,r){const s=[];return r.forEach(o=>{t.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(e,s).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,s){let o=Wr();const a=Xu(),u=function(){return Xu()}();return t.forEach((d,f)=>{const g=r.get(f.key);s.has(f.key)&&(g===void 0||g.mutation instanceof qi)?o=o.insert(f.key,f):g!==void 0?(a.set(f.key,g.mutation.getFieldMask()),Ju(g.mutation,f,g.mutation.getFieldMask(),mt.now())):a.set(f.key,Pr.empty())}),this.recalculateAndSaveOverlays(e,o).next(d=>(d.forEach((f,g)=>a.set(f,g)),t.forEach((f,g)=>{var y;return u.set(f,new I4(g,(y=a.get(f))!==null&&y!==void 0?y:null))}),u))}recalculateAndSaveOverlays(e,t){const r=Xu();let s=new kt((a,u)=>a-u),o=Je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const u of a)u.keys().forEach(d=>{const f=t.get(d);if(f===null)return;let g=r.get(d)||Pr.empty();g=u.applyToLocalView(f,g),r.set(d,g);const y=(s.get(u.batchId)||Je()).add(d);s=s.insert(u.batchId,y)})}).next(()=>{const a=[],u=s.getReverseIterator();for(;u.hasNext();){const d=u.getNext(),f=d.key,g=d.value,y=sT();g.forEach(x=>{if(!o.has(x)){const w=uT(t.get(x),r.get(x));w!==null&&y.set(x,w),o=o.add(x)}}),a.push(this.documentOverlayCache.saveOverlays(e,f,y))}return ee.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(a){return Ee.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):XE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(o=>{const a=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-o.size):ee.resolve(Zs());let u=nc,d=o;return a.next(f=>ee.forEach(f,(g,y)=>(u<y.largestBatchId&&(u=y.largestBatchId),o.get(g)?ee.resolve():this.remoteDocumentCache.getEntry(e,g).next(x=>{d=d.insert(g,x)}))).next(()=>this.populateOverlays(e,f,o)).next(()=>this.computeViews(e,d,f,Je())).next(g=>({batchId:u,changes:rT(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next(r=>{let s=Vu();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const o=t.collectionGroup;let a=Vu();return this.indexManager.getCollectionParents(e,o).next(u=>ee.forEach(u,d=>{const f=function(y,x){return new Ac(x,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(t,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,f,r,s).next(g=>{g.forEach((y,x)=>{a=a.insert(y,x)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,s))).next(a=>{o.forEach((d,f)=>{const g=f.getKey();a.get(g)===null&&(a=a.insert(g,Ht.newInvalidDocument(g)))});let u=Vu();return a.forEach((d,f)=>{const g=o.get(d);g!==void 0&&Ju(g.mutation,f,Pr.empty(),mt.now()),Ld(t,f)&&(u=u.insert(d,f))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return ee.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:ar(s.createTime)}}(t)),ee.resolve()}getNamedQuery(e,t){return ee.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(s){return{name:s.name,query:AT(s.bundledQuery),readTime:ar(s.readTime)}}(t)),ee.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(){this.overlays=new kt(Ee.comparator),this.Qr=new Map}getOverlay(e,t){return ee.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Zs();return ee.forEach(t,s=>this.getOverlay(e,s).next(o=>{o!==null&&r.set(s,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,o)=>{this.St(e,t,o)}),ee.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Qr.get(r);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.Qr.delete(r)),ee.resolve()}getOverlaysForCollection(e,t,r){const s=Zs(),o=t.length+1,a=new Ee(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const d=u.getNext().value,f=d.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===o&&d.largestBatchId>r&&s.set(d.getKey(),d)}return ee.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let o=new kt((f,g)=>f-g);const a=this.overlays.getIterator();for(;a.hasNext();){const f=a.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let g=o.get(f.largestBatchId);g===null&&(g=Zs(),o=o.insert(f.largestBatchId,g)),g.set(f.getKey(),f)}}const u=Zs(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((f,g)=>u.set(f,g)),!(u.size()>=s)););return ee.resolve(u)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Qr.get(s.largestBatchId).delete(r.key);this.Qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new fx(t,r));let o=this.Qr.get(t);o===void 0&&(o=Je(),this.Qr.set(t,o)),this.Qr.set(t,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{constructor(){this.sessionToken=Xt.EMPTY_BYTE_STRING}getSessionToken(e){return ee.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ee.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(){this.$r=new vt(bn.Ur),this.Kr=new vt(bn.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const r=new bn(e,t);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.zr(new bn(e,t))}jr(e,t){e.forEach(r=>this.removeReference(r,t))}Hr(e){const t=new Ee(new pt([])),r=new bn(t,e),s=new bn(t,e+1),o=[];return this.Kr.forEachInRange([r,s],a=>{this.zr(a),o.push(a.key)}),o}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new Ee(new pt([])),r=new bn(t,e),s=new bn(t,e+1);let o=Je();return this.Kr.forEachInRange([r,s],a=>{o=o.add(a.key)}),o}containsKey(e){const t=new bn(e,0),r=this.$r.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class bn{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return Ee.comparator(e.key,t.key)||$e(e.Zr,t.Zr)}static Wr(e,t){return $e(e.Zr,t.Zr)||Ee.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new vt(bn.Ur)}checkEmpty(e){return ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const o=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new dx(o,t,r,s);this.mutationQueue.push(a);for(const u of s)this.Xr=this.Xr.add(new bn(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ee.resolve(a)}lookupMutationBatch(e,t){return ee.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ti(r),o=s<0?0:s;return ee.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ee.resolve(this.mutationQueue.length===0?Ca:this.nr-1)}getAllMutationBatches(e){return ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new bn(t,0),s=new bn(t,Number.POSITIVE_INFINITY),o=[];return this.Xr.forEachInRange([r,s],a=>{const u=this.ei(a.Zr);o.push(u)}),ee.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new vt($e);return t.forEach(s=>{const o=new bn(s,0),a=new bn(s,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([o,a],u=>{r=r.add(u.Zr)})}),ee.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let o=r;Ee.isDocumentKey(o)||(o=o.child(""));const a=new bn(new Ee(o),0);let u=new vt($e);return this.Xr.forEachWhile(d=>{const f=d.key.path;return!!r.isPrefixOf(f)&&(f.length===s&&(u=u.add(d.Zr)),!0)},a),ee.resolve(this.ni(u))}ni(e){const t=[];return e.forEach(r=>{const s=this.ei(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Me(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return ee.forEach(t.mutations,s=>{const o=new bn(s.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,t){const r=new bn(t,0),s=this.Xr.firstAfterOrEqual(r);return ee.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ee.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C4{constructor(e){this.ii=e,this.docs=function(){return new kt(Ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),o=s?s.size:0,a=this.ii(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ee.resolve(r?r.document.mutableCopy():Ht.newInvalidDocument(t))}getEntries(e,t){let r=Wr();return t.forEach(s=>{const o=this.docs.get(s);r=r.insert(s,o?o.document.mutableCopy():Ht.newInvalidDocument(s))}),ee.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let o=Wr();const a=t.path,u=new Ee(a.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(u);for(;d.hasNext();){const{key:f,value:{document:g}}=d.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||J0(xE(g),r)<=0||(s.has(g.key)||Ld(t,g))&&(o=o.insert(g.key,g.mutableCopy()))}return ee.resolve(o)}getAllFromCollectionGroup(e,t,r,s){Ce(9500)}si(e,t){return ee.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new N4(this)}getSize(e){return ee.resolve(this.size)}}class N4 extends OT{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.Br.addEntry(e,s)):this.Br.removeEntry(r)}),ee.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(e){this.persistence=e,this.oi=new $i(t=>Fa(t),Dd),this.lastRemoteSnapshotVersion=Fe.min(),this.highestTargetId=0,this._i=0,this.ai=new vx,this.targetCount=0,this.ui=Ba.cr()}forEachTarget(e,t){return this.oi.forEach((r,s)=>t(s)),ee.resolve()}getLastRemoteSnapshotVersion(e){return ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ee.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),ee.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this._i&&(this._i=t),ee.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new Ba(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,ee.resolve()}updateTargetData(e,t){return this.Tr(t),ee.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,ee.resolve()}removeTargets(e,t,r){let s=0;const o=[];return this.oi.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.oi.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),s++)}),ee.waitFor(o).next(()=>s)}getTargetCount(e){return ee.resolve(this.targetCount)}getTargetData(e,t){const r=this.oi.get(t)||null;return ee.resolve(r)}addMatchingKeys(e,t,r){return this.ai.Gr(t,r),ee.resolve()}removeMatchingKeys(e,t,r){this.ai.jr(t,r);const s=this.persistence.referenceDelegate,o=[];return s&&t.forEach(a=>{o.push(s.markPotentiallyOrphaned(e,a))}),ee.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),ee.resolve()}getMatchingKeysForTargetId(e,t){const r=this.ai.Yr(t);return ee.resolve(r)}containsKey(e,t){return ee.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(e,t){this.ci={},this.overlays={},this.li=new Rr(0),this.hi=!1,this.hi=!0,this.Pi=new k4,this.referenceDelegate=e(this),this.Ti=new R4(this),this.indexManager=new p4,this.remoteDocumentCache=function(s){return new C4(s)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new TT(t),this.Ei=new E4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new T4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ci[e.toKey()];return r||(r=new A4(t,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,r){me("MemoryPersistence","Starting transaction:",e);const s=new P4(this.li.next());return this.referenceDelegate.di(),r(s).next(o=>this.referenceDelegate.Ai(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Ri(e,t){return ee.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,t)))}}class P4 extends wE{constructor(e){super(),this.currentSequenceNumber=e}}class Wm{constructor(e){this.persistence=e,this.Vi=new vx,this.mi=null}static fi(e){return new Wm(e)}get gi(){if(this.mi)return this.mi;throw Ce(60996)}addReference(e,t,r){return this.Vi.addReference(r,t),this.gi.delete(r.toString()),ee.resolve()}removeReference(e,t,r){return this.Vi.removeReference(r,t),this.gi.add(r.toString()),ee.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),ee.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(s=>this.gi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.gi.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.gi,r=>{const s=Ee.fromPath(r);return this.pi(e,s).next(o=>{o||t.removeEntry(s,Fe.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(r=>{r?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return ee.or([()=>ee.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class lm{constructor(e,t){this.persistence=e,this.yi=new $i(r=>Hn(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=LT(this,t)}static fi(e,t){return new lm(e,t)}di(){}Ai(e){return ee.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}br(e){let t=0;return this.yr(e,r=>{t++}).next(()=>t)}yr(e,t){return ee.forEach(this.yi,(r,s)=>this.Dr(e,r,s).next(o=>o?ee.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.si(e,a=>this.Dr(e,a,t).next(u=>{u||(r++,o.removeEntry(a,Fe.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),ee.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),ee.resolve()}removeReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),ee.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),ee.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Pf(e.data.value)),t}Dr(e,t,r){return ee.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.yi.get(t);return ee.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(e){this.serializer=e}q(e,t,r,s){const o=new Dm("createOrUpgrade",t);r<1&&s>=1&&(function(d){d.createObjectStore(jd)}(e),function(d){d.createObjectStore(ud,{keyPath:Hj}),d.createObjectStore(js,{keyPath:D1,autoIncrement:!0}).createIndex(Aa,M1,{unique:!0}),d.createObjectStore(rc)}(e),I_(e),function(d){d.createObjectStore(_a)}(e));let a=ee.resolve();return r<3&&s>=3&&(r!==0&&(function(d){d.deleteObjectStore(ic),d.deleteObjectStore(sc),d.deleteObjectStore(Na)}(e),I_(e)),a=a.next(()=>function(d){const f=d.store(Na),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Fe.min().toTimestamp(),targetCount:0};return f.put(Jf,g)}(o))),r<4&&s>=4&&(r!==0&&(a=a.next(()=>function(d,f){return f.store(js).J().next(y=>{d.deleteObjectStore(js),d.createObjectStore(js,{keyPath:D1,autoIncrement:!0}).createIndex(Aa,M1,{unique:!0});const x=f.store(js),w=y.map(E=>x.put(E));return ee.waitFor(w)})}(e,o))),a=a.next(()=>{(function(d){d.createObjectStore(oc,{keyPath:eD})})(e)})),r<5&&s>=5&&(a=a.next(()=>this.wi(o))),r<6&&s>=6&&(a=a.next(()=>(function(d){d.createObjectStore(dd)}(e),this.bi(o)))),r<7&&s>=7&&(a=a.next(()=>this.Si(o))),r<8&&s>=8&&(a=a.next(()=>this.Di(e,o))),r<9&&s>=9&&(a=a.next(()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(a=a.next(()=>this.Ci(o))),r<11&&s>=11&&(a=a.next(()=>{(function(d){d.createObjectStore(Lm,{keyPath:tD})})(e),function(d){d.createObjectStore(Om,{keyPath:nD})}(e)})),r<12&&s>=12&&(a=a.next(()=>{(function(d){const f=d.createObjectStore(Fm,{keyPath:cD});f.createIndex(Xy,uD,{unique:!1}),f.createIndex(AE,dD,{unique:!1})})(e)})),r<13&&s>=13&&(a=a.next(()=>function(d){const f=d.createObjectStore(Xf,{keyPath:Gj});f.createIndex(Nf,Kj),f.createIndex(IE,Qj)}(e)).next(()=>this.Fi(e,o)).next(()=>e.deleteObjectStore(_a))),r<14&&s>=14&&(a=a.next(()=>this.Mi(e,o))),r<15&&s>=15&&(a=a.next(()=>function(d){d.createObjectStore(tx,{keyPath:rD,autoIncrement:!0}).createIndex(Yy,sD,{unique:!1}),d.createObjectStore(Gu,{keyPath:iD}).createIndex(TE,oD,{unique:!1}),d.createObjectStore(Ku,{keyPath:aD}).createIndex(kE,lD,{unique:!1})}(e))),r<16&&s>=16&&(a=a.next(()=>{t.objectStore(Gu).clear()}).next(()=>{t.objectStore(Ku).clear()})),r<17&&s>=17&&(a=a.next(()=>{(function(d){d.createObjectStore(nx,{keyPath:hD})})(e)})),r<18&&s>=18&&yI()&&(a=a.next(()=>{t.objectStore(Gu).clear()}).next(()=>{t.objectStore(Ku).clear()})),a}bi(e){let t=0;return e.store(_a).te((r,s)=>{t+=am(s)}).next(()=>{const r={byteSize:t};return e.store(dd).put(Qy,r)})}wi(e){const t=e.store(ud),r=e.store(js);return t.J().next(s=>ee.forEach(s,o=>{const a=IDBKeyRange.bound([o.userId,Ca],[o.userId,o.lastAcknowledgedBatchId]);return r.J(Aa,a).next(u=>ee.forEach(u,d=>{Me(d.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:d.batchId});const f=Ia(this.serializer,d);return PT(e,o.userId,f).next(()=>{})}))}))}Si(e){const t=e.store(ic),r=e.store(_a);return e.store(Na).get(Jf).next(s=>{const o=[];return r.te((a,u)=>{const d=new pt(a),f=function(y){return[0,Hn(y)]}(d);o.push(t.get(f).next(g=>g?ee.resolve():(y=>t.put({targetId:0,path:Hn(y),sequenceNumber:s.highestListenSequenceNumber}))(d)))}).next(()=>ee.waitFor(o))})}Di(e,t){e.createObjectStore(hd,{keyPath:Zj});const r=t.store(hd),s=new xx,o=a=>{if(s.add(a)){const u=a.lastSegment(),d=a.popLast();return r.put({collectionId:u,parent:Hn(d)})}};return t.store(_a).te({ee:!0},(a,u)=>{const d=new pt(a);return o(d.popLast())}).next(()=>t.store(rc).te({ee:!0},([a,u,d],f)=>{const g=Js(u);return o(g.popLast())}))}Ci(e){const t=e.store(sc);return t.te((r,s)=>{const o=Uu(s),a=kT(this.serializer,o);return t.put(a)})}Fi(e,t){const r=t.store(_a),s=[];return r.te((o,a)=>{const u=t.store(Xf),d=function(y){return y.document?new Ee(pt.fromString(y.document.name).popFirst(5)):y.noDocument?Ee.fromSegments(y.noDocument.path):y.unknownDocument?Ee.fromSegments(y.unknownDocument.path):Ce(36783)}(a).path.toArray(),f={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};s.push(u.put(f))}).next(()=>ee.waitFor(s))}Mi(e,t){const r=t.store(js),s=FT(this.serializer),o=new wx(Wm.fi,this.serializer.wt);return r.J().next(a=>{const u=new Map;return a.forEach(d=>{var f;let g=(f=u.get(d.userId))!==null&&f!==void 0?f:Je();Ia(this.serializer,d).keys().forEach(y=>g=g.add(y)),u.set(d.userId,g)}),ee.forEach(u,(d,f)=>{const g=new _n(f),y=qm.bt(this.serializer,g),x=o.getIndexManager(g),w=Hm.bt(g,this.serializer,x,o.referenceDelegate);return new VT(s,w,y,x).recalculateAndSaveOverlaysForDocumentKeys(new Jy(t,Rr.le),d).next()})})}}function I_(n){n.createObjectStore(ic,{keyPath:Xj}).createIndex(ex,Jj,{unique:!0}),n.createObjectStore(sc,{keyPath:"targetId"}).createIndex(EE,Yj,{unique:!0}),n.createObjectStore(Na)}const bo="IndexedDbPersistence",ty=18e5,ny=5e3,ry="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",D4="main";class bx{constructor(e,t,r,s,o,a,u,d,f,g,y=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.xi=o,this.window=a,this.document=u,this.Oi=f,this.Ni=g,this.Bi=y,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=x=>Promise.resolve(),!bx.C())throw new _e(le.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new b4(this,s),this.Ui=t+D4,this.serializer=new TT(d),this.Ki=new Po(this.Ui,this.Bi,new j4(this.serializer)),this.Pi=new c4,this.Ti=new y4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=FT(this.serializer),this.Ei=new l4,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,g===!1&&Qt(bo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new _e(le.FAILED_PRECONDITION,ry);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new Rr(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>mf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(t=>{t||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(t=>this.isPrimary&&!t?this.Xi(e).next(()=>!1):!!t&&this.es(e).next(()=>!0))).catch(e=>{if(qo(e))return me(bo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return me(bo,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return _u(e).get(Dl).next(t=>ee.resolve(this.ts(t)))}ns(e){return mf(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,ty)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=mn(t,oc);return r.J().next(s=>{const o=this._s(s,ty),a=s.filter(u=>o.indexOf(u)===-1);return ee.forEach(a,u=>r.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Wi)for(const t of e)this.Wi.removeItem(this.us(t.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?ee.resolve(!0):_u(e).get(Dl).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,ny)&&!this.cs(t.ownerId)){if(this.ts(t)&&this.networkEnabled)return!0;if(!this.ts(t)){if(!t.allowTabSynchronization)throw new _e(le.FAILED_PRECONDITION,ry);return!1}}return!(!this.networkEnabled||!this.inForeground)||mf(e).J().next(r=>this._s(r,ny).find(s=>{if(this.clientId!==s.clientId){const o=!this.networkEnabled&&s.networkEnabled,a=!this.inForeground&&s.inForeground,u=this.networkEnabled===s.networkEnabled;if(o||a&&u)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&me(bo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[jd,oc],e=>{const t=new Jy(e,Rr.le);return this.Xi(t).next(()=>this.ns(t))}),this.Ki.close(),this.Ts()}_s(e,t){return e.filter(r=>this.ss(r.updateTimeMs,t)&&!this.cs(r.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>mf(e).J().next(t=>this._s(t,ty).map(r=>r.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,t){return Hm.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new g4(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return qm.bt(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,t,r){me(bo,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",o=function(d){return d===18?pD:d===17?PE:d===16?mD:d===15?rx:d===14?RE:d===13?NE:d===12?fD:d===11?CE:void Ce(60245)}(this.Bi);let a;return this.Ki.runTransaction(e,s,o,u=>(a=new Jy(u,this.li?this.li.next():Rr.le),t==="readwrite-primary"?this.Yi(a).next(d=>!!d||this.Zi(a)).next(d=>{if(!d)throw Qt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new _e(le.FAILED_PRECONDITION,vE);return r(a)}).next(d=>this.es(a).next(()=>d)):this.Es(a).next(()=>r(a)))).then(u=>(a.raiseOnCommittedEvent(),u))}Es(e){return _u(e).get(Dl).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,ny)&&!this.cs(t.ownerId)&&!this.ts(t)&&!(this.Ni||this.allowTabSynchronization&&t.allowTabSynchronization))throw new _e(le.FAILED_PRECONDITION,ry)})}es(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return _u(e).put(Dl,t)}static C(){return Po.C()}Xi(e){const t=_u(e);return t.get(Dl).next(r=>this.ts(r)?(me(bo,"Releasing primary lease."),t.delete(Dl)):ee.resolve())}ss(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Qt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const t=/(?:Version|Mobile)\/1[456]/;gI()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var t;try{const r=((t=this.Wi)===null||t===void 0?void 0:t.getItem(this.us(e)))!==null;return me(bo,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Qt(bo,"Failed to get zombied client id.",r),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){Qt("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function _u(n){return mn(n,jd)}function mf(n){return mn(n,oc)}function zT(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.ds=r,this.As=s}static Rs(e,t){let r=Je(),s=Je();for(const o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new _x(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return gI()?8:bE(fn())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,r,s){const o={result:null};return this.ws(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.bs(e,t,s,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new M4;return this.Ss(e,t,a).next(u=>{if(o.result=u,this.fs)return this.Ds(e,t,a,u.size)})}).next(()=>o.result)}Ds(e,t,r,s){return r.documentReadCount<this.gs?(ql()<=rt.DEBUG&&me("QueryEngine","SDK will not create cache indexes for query:",Hl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),ee.resolve()):(ql()<=rt.DEBUG&&me("QueryEngine","Query:",Hl(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ps*s?(ql()<=rt.DEBUG&&me("QueryEngine","The SDK decides to create cache indexes for query:",Hl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Gr(t))):ee.resolve())}ws(e,t){if(K1(t))return ee.resolve(null);let r=Gr(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=nm(t,null,"F"),r=Gr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const a=Je(...o);return this.ys.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(d=>{const f=this.vs(t,u);return this.Cs(t,f,a,d.readTime)?this.ws(e,nm(t,null,"F")):this.Fs(e,f,t,d)}))})))}bs(e,t,r,s){return K1(t)||s.isEqual(Fe.min())?ee.resolve(null):this.ys.getDocuments(e,r).next(o=>{const a=this.vs(t,o);return this.Cs(t,a,r,s)?ee.resolve(null):(ql()<=rt.DEBUG&&me("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Hl(t)),this.Fs(e,a,t,yE(s,nc)).next(u=>u))})}vs(e,t){let r=new vt(tT(e));return t.forEach((s,o)=>{Ld(e,o)&&(r=r.add(o))}),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ss(e,t,r){return ql()<=rt.DEBUG&&me("QueryEngine","Using full collection scan to execute query:",Hl(t)),this.ys.getDocumentsMatchingQuery(e,t,Yr.min(),r)}Fs(e,t,r,s){return this.ys.getDocumentsMatchingQuery(e,r,s).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sx="LocalStore",L4=3e8;class O4{constructor(e,t,r,s){this.persistence=e,this.Ms=t,this.serializer=s,this.xs=new kt($e),this.Os=new $i(o=>Fa(o),Dd),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new VT(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function BT(n,e,t,r){return new O4(n,e,t,r)}async function $T(n,e){const t=Re(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(o=>(s=o,t.Ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{const a=[],u=[];let d=Je();for(const f of s){a.push(f.batchId);for(const g of f.mutations)d=d.add(g.key)}for(const f of o){u.push(f.batchId);for(const g of f.mutations)d=d.add(g.key)}return t.localDocuments.getDocuments(r,d).next(f=>({ks:f,removedBatchIds:a,addedBatchIds:u}))})})}function F4(n,e){const t=Re(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),o=t.Bs.newChangeBuffer({trackRemovals:!0});return function(u,d,f,g){const y=f.batch,x=y.keys();let w=ee.resolve();return x.forEach(E=>{w=w.next(()=>g.getEntry(d,E)).next(S=>{const A=f.docVersions.get(E);Me(A!==null,48541),S.version.compareTo(A)<0&&(y.applyToRemoteDocument(S,f),S.isValidDocument()&&(S.setReadTime(f.commitVersion),g.addEntry(S)))})}),w.next(()=>u.mutationQueue.removeMutationBatch(d,y))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let d=Je();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(d=d.add(u.batch.mutations[f].key));return d}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function qT(n){const e=Re(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function V4(n,e){const t=Re(n),r=e.snapshotVersion;let s=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=t.Bs.newChangeBuffer({trackRemovals:!0});s=t.xs;const u=[];e.targetChanges.forEach((g,y)=>{const x=s.get(y);if(!x)return;u.push(t.Ti.removeMatchingKeys(o,g.removedDocuments,y).next(()=>t.Ti.addMatchingKeys(o,g.addedDocuments,y)));let w=x.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?w=w.withResumeToken(Xt.EMPTY_BYTE_STRING,Fe.min()).withLastLimboFreeSnapshotVersion(Fe.min()):g.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(g.resumeToken,r)),s=s.insert(y,w),function(S,A,N){return S.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=L4?!0:N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0}(x,w,g)&&u.push(t.Ti.updateTargetData(o,w))});let d=Wr(),f=Je();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,g))}),u.push(z4(o,a,e.documentUpdates).next(g=>{d=g.qs,f=g.Qs})),!r.isEqual(Fe.min())){const g=t.Ti.getLastRemoteSnapshotVersion(o).next(y=>t.Ti.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(g)}return ee.waitFor(u).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,d,f)).next(()=>d)}).then(o=>(t.xs=s,o))}function z4(n,e,t){let r=Je(),s=Je();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=Wr();return t.forEach((u,d)=>{const f=o.get(u);d.isFoundDocument()!==f.isFoundDocument()&&(s=s.add(u)),d.isNoDocument()&&d.version.isEqual(Fe.min())?(e.removeEntry(u,d.readTime),a=a.insert(u,d)):!f.isValidDocument()||d.version.compareTo(f.version)>0||d.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(d),a=a.insert(u,d)):me(Sx,"Ignoring outdated watch update for ",u,". Current version:",f.version," Watch version:",d.version)}),{qs:a,Qs:s}})}function U4(n,e){const t=Re(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Ca),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function cm(n,e){const t=Re(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ti.getTargetData(r,e).next(o=>o?(s=o,ee.resolve(s)):t.Ti.allocateTargetId(r).next(a=>(s=new Ni(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ti.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.xs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.xs=t.xs.insert(r.targetId,r),t.Os.set(e,r.targetId)),r})}async function mc(n,e,t){const r=Re(n),s=r.xs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!qo(a))throw a;me(Sx,`Failed to update sequence numbers for target ${e}: ${a}`)}r.xs=r.xs.remove(e),r.Os.delete(s.target)}function h0(n,e,t){const r=Re(n);let s=Fe.min(),o=Je();return r.persistence.runTransaction("Execute query","readwrite",a=>function(d,f,g){const y=Re(d),x=y.Os.get(g);return x!==void 0?ee.resolve(y.xs.get(x)):y.Ti.getTargetData(f,g)}(r,a,Gr(e)).next(u=>{if(u)return s=u.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(a,u.targetId).next(d=>{o=d})}).next(()=>r.Ms.getDocumentsMatchingQuery(a,e,t?s:Fe.min(),t?o:Je())).next(u=>(GT(r,eT(e),u),{documents:u,$s:o})))}function HT(n,e){const t=Re(n),r=Re(t.Ti),s=t.xs.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",o=>r.Rt(o,e).next(a=>a?a.target:null))}function WT(n,e){const t=Re(n),r=t.Ns.get(e)||Fe.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.Bs.getAllFromCollectionGroup(s,e,yE(r,nc),Number.MAX_SAFE_INTEGER)).then(s=>(GT(t,e,s),s))}function GT(n,e,t){let r=n.Ns.get(e)||Fe.min();t.forEach((s,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.Ns.set(e,r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KT="firestore_clients";function E_(n,e){return`${KT}_${n}_${e}`}const QT="firestore_mutations";function T_(n,e,t){let r=`${QT}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const YT="firestore_targets";function sy(n,e){return`${YT}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs="SharedClientState";class um{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Gs(e,t,r){const s=JSON.parse(r);let o,a=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return a&&s.error&&(a=typeof s.error.message=="string"&&typeof s.error.code=="string",a&&(o=new _e(s.error.code,s.error.message))),a?new um(e,t,s.state,o):(Qt(Xs,`Failed to parse mutation state for ID '${t}': ${r}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Zu{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Gs(e,t){const r=JSON.parse(t);let s,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(s=new _e(r.error.code,r.error.message))),o?new Zu(e,r.state,s):(Qt(Xs,`Failed to parse target state for ID '${e}': ${t}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class dm{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Gs(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,o=lx();for(let a=0;s&&a<r.activeTargetIds.length;++a)s=_E(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return s?new dm(e,o):(Qt(Xs,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Ix{constructor(e,t){this.clientId=e,this.onlineState=t}static Gs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Ix(t.clientId,t.onlineState):(Qt(Xs,`Failed to parse online state: ${e}`),null)}}class f0{constructor(){this.activeTargetIds=lx()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class iy{constructor(e,t,r,s,o){this.window=e,this.xi=t,this.persistenceKey=r,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ys=this.Zs.bind(this),this.Xs=new kt($e),this.started=!1,this.eo=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.no=E_(this.persistenceKey,this.Js),this.ro=function(d){return`firestore_sequence_number_${d}`}(this.persistenceKey),this.Xs=this.Xs.insert(this.Js,new f0),this.io=new RegExp(`^${KT}_${a}_([^_]*)$`),this.so=new RegExp(`^${QT}_${a}_(\\d+)(?:_(.*))?$`),this.oo=new RegExp(`^${YT}_${a}_(\\d+)$`),this._o=function(d){return`firestore_online_state_${d}`}(this.persistenceKey),this.ao=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ys)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Is();for(const r of e){if(r===this.Js)continue;const s=this.getItem(E_(this.persistenceKey,r));if(s){const o=dm.Gs(r,s);o&&(this.Xs=this.Xs.insert(o.clientId,o))}}this.uo();const t=this.storage.getItem(this._o);if(t){const r=this.co(t);r&&this.lo(r)}for(const r of this.eo)this.Zs(r);this.eo=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ro,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ho(this.Xs)}isActiveQueryTarget(e){let t=!1;return this.Xs.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Po(e,"pending")}updateMutationState(e,t,r){this.Po(e,t,r),this.To(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(sy(this.persistenceKey,e));if(s){const o=Zu.Gs(e,s);o&&(r=o.state)}}return t&&this.Io.js(e),this.uo(),r}removeLocalQueryTarget(e){this.Io.Hs(e),this.uo()}isLocalQueryTarget(e){return this.Io.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(sy(this.persistenceKey,e))}updateQueryState(e,t,r){this.Eo(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.To(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Ao(e)}notifyBundleLoaded(e){this.Ro(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ys),this.removeItem(this.no),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return me(Xs,"READ",e,t),t}setItem(e,t){me(Xs,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){me(Xs,"REMOVE",e),this.storage.removeItem(e)}Zs(e){const t=e;if(t.storageArea===this.storage){if(me(Xs,"EVENT",t.key,t.newValue),t.key===this.no)return void Qt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.xi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.io.test(t.key)){if(t.newValue==null){const r=this.Vo(t.key);return this.mo(r,null)}{const r=this.fo(t.key,t.newValue);if(r)return this.mo(r.clientId,r)}}else if(this.so.test(t.key)){if(t.newValue!==null){const r=this.po(t.key,t.newValue);if(r)return this.yo(r)}}else if(this.oo.test(t.key)){if(t.newValue!==null){const r=this.wo(t.key,t.newValue);if(r)return this.bo(r)}}else if(t.key===this._o){if(t.newValue!==null){const r=this.co(t.newValue);if(r)return this.lo(r)}}else if(t.key===this.ro){const r=function(o){let a=Rr.le;if(o!=null)try{const u=JSON.parse(o);Me(typeof u=="number",30636,{So:o}),a=u}catch(u){Qt(Xs,"Failed to read sequence number from WebStorage",u)}return a}(t.newValue);r!==Rr.le&&this.sequenceNumberHandler(r)}else if(t.key===this.ao){const r=this.Do(t.newValue);await Promise.all(r.map(s=>this.syncEngine.vo(s)))}}}else this.eo.push(t)})}}get Io(){return this.Xs.get(this.Js)}uo(){this.setItem(this.no,this.Io.zs())}Po(e,t,r){const s=new um(this.currentUser,e,t,r),o=T_(this.persistenceKey,this.currentUser,e);this.setItem(o,s.zs())}To(e){const t=T_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ao(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this._o,JSON.stringify(t))}Eo(e,t,r){const s=sy(this.persistenceKey,e),o=new Zu(e,t,r);this.setItem(s,o.zs())}Ro(e){const t=JSON.stringify(Array.from(e));this.setItem(this.ao,t)}Vo(e){const t=this.io.exec(e);return t?t[1]:null}fo(e,t){const r=this.Vo(e);return dm.Gs(r,t)}po(e,t){const r=this.so.exec(e),s=Number(r[1]),o=r[2]!==void 0?r[2]:null;return um.Gs(new _n(o),s,t)}wo(e,t){const r=this.oo.exec(e),s=Number(r[1]);return Zu.Gs(s,t)}co(e){return Ix.Gs(e)}Do(e){return JSON.parse(e)}async yo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);me(Xs,`Ignoring mutation for non-active user ${e.user.uid}`)}bo(e){return this.syncEngine.Fo(e.targetId,e.state,e.error)}mo(e,t){const r=t?this.Xs.insert(e,t):this.Xs.remove(e),s=this.ho(this.Xs),o=this.ho(r),a=[],u=[];return o.forEach(d=>{s.has(d)||a.push(d)}),s.forEach(d=>{o.has(d)||u.push(d)}),this.syncEngine.Mo(a,u).then(()=>{this.Xs=r})}lo(e){this.Xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ho(e){let t=lx();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class XT{constructor(){this.xo=new f0,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,r){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new f0,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k_="ConnectivityMonitor";class A_{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){me(k_,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){me(k_,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pf=null;function m0(){return pf===null?pf=function(){return 268435456+Math.round(2147483648*Math.random())}():pf++,"0x"+pf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oy="RestConnection",$4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class q4{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${r}/databases/${s}`,this.Go=this.databaseId.database===Zf?`project_id=${r}`:`project_id=${r}&database_id=${s}`}zo(e,t,r,s,o){const a=m0(),u=this.jo(e,t.toUriEncodedString());me(oy,`Sending RPC '${e}' ${a}:`,u,r);const d={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(d,s,o);const{host:f}=new URL(u),g=Ga(f);return this.Jo(e,u,d,r,g).then(y=>(me(oy,`Received RPC '${e}' ${a}: `,y),y),y=>{throw La(oy,`RPC '${e}' ${a} failed with error: `,y,"url: ",u,"request:",r),y})}Yo(e,t,r,s,o,a){return this.zo(e,t,r,s,o)}Ho(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+kc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,o)=>e[o]=s),r&&r.headers.forEach((s,o)=>e[o]=s)}jo(e,t){const r=$4[e];return`${this.Ko}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Un="WebChannelConnection";class W4 extends q4{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,o){const a=m0();return new Promise((u,d)=>{const f=new aE;f.setWithCredentials(!0),f.listenOnce(lE.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case kf.NO_ERROR:const y=f.getResponseJson();me(Un,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(y)),u(y);break;case kf.TIMEOUT:me(Un,`RPC '${e}' ${a} timed out`),d(new _e(le.DEADLINE_EXCEEDED,"Request time out"));break;case kf.HTTP_ERROR:const x=f.getStatus();if(me(Un,`RPC '${e}' ${a} failed with status:`,x,"response text:",f.getResponseText()),x>0){let w=f.getResponseJson();Array.isArray(w)&&(w=w[0]);const E=w==null?void 0:w.error;if(E&&E.status&&E.message){const S=function(N){const z=N.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(z)>=0?z:le.UNKNOWN}(E.status);d(new _e(S,E.message))}else d(new _e(le.UNKNOWN,"Server responded with status "+f.getStatus()))}else d(new _e(le.UNAVAILABLE,"Connection failed."));break;default:Ce(9055,{h_:e,streamId:a,P_:f.getLastErrorCode(),T_:f.getLastError()})}}finally{me(Un,`RPC '${e}' ${a} completed.`)}});const g=JSON.stringify(s);me(Un,`RPC '${e}' ${a} sending request:`,s),f.send(t,"POST",g,r,15)})}I_(e,t,r){const s=m0(),o=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=dE(),u=uE(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(d.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Ho(d.initMessageHeaders,t,r),d.encodeInitMessageHeaders=!0;const g=o.join("");me(Un,`Creating RPC '${e}' stream ${s}: ${g}`,d);const y=a.createWebChannel(g,d);this.E_(y);let x=!1,w=!1;const E=new H4({Zo:A=>{w?me(Un,`Not sending because RPC '${e}' stream ${s} is closed:`,A):(x||(me(Un,`Opening RPC '${e}' stream ${s} transport.`),y.open(),x=!0),me(Un,`RPC '${e}' stream ${s} sending:`,A),y.send(A))},Xo:()=>y.close()}),S=(A,N,z)=>{A.listen(N,U=>{try{z(U)}catch(W){setTimeout(()=>{throw W},0)}})};return S(y,Fu.EventType.OPEN,()=>{w||(me(Un,`RPC '${e}' stream ${s} transport opened.`),E.__())}),S(y,Fu.EventType.CLOSE,()=>{w||(w=!0,me(Un,`RPC '${e}' stream ${s} transport closed`),E.u_(),this.d_(y))}),S(y,Fu.EventType.ERROR,A=>{w||(w=!0,La(Un,`RPC '${e}' stream ${s} transport errored. Name:`,A.name,"Message:",A.message),E.u_(new _e(le.UNAVAILABLE,"The operation could not be completed")))}),S(y,Fu.EventType.MESSAGE,A=>{var N;if(!w){const z=A.data[0];Me(!!z,16349);const U=z,W=(U==null?void 0:U.error)||((N=U[0])===null||N===void 0?void 0:N.error);if(W){me(Un,`RPC '${e}' stream ${s} received error:`,W);const $=W.status;let F=function(P){const T=rn[P];if(T!==void 0)return fT(T)}($),R=W.message;F===void 0&&(F=le.INTERNAL,R="Unknown error status: "+$+" with message "+W.message),w=!0,E.u_(new _e(F,R)),y.close()}else me(Un,`RPC '${e}' stream ${s} received:`,z),E.c_(z)}}),S(u,cE.STAT_EVENT,A=>{A.stat===Wy.PROXY?me(Un,`RPC '${e}' stream ${s} detected buffering proxy`):A.stat===Wy.NOPROXY&&me(Un,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{E.a_()},0),E}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JT(){return typeof window<"u"?window:null}function Of(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gm(n){return new YD(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(e,t,r=1e3,s=1.5,o=6e4){this.xi=e,this.timerId=t,this.A_=r,this.R_=s,this.V_=o,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),r=Math.max(0,Date.now()-this.g_),s=Math.max(0,t-r);s>0&&me("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,s,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_="PersistentStream";class ek{constructor(e,t,r,s,o,a,u,d){this.xi=e,this.S_=r,this.D_=s,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=d,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new ZT(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===le.RESOURCE_EXHAUSTED?(Qt(t.toString()),Qt("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.v_===t&&this.z_(r,s)},r=>{e(()=>{const s=new _e(le.UNKNOWN,"Fetching auth token failed: "+r.message);return this.j_(s)})})}z_(e,t){const r=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(s=>{r(()=>this.j_(s))}),this.stream.onMessage(s=>{r(()=>++this.M_==1?this.J_(s):this.onNext(s))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return me(C_,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(me(C_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class G4 extends ek{constructor(e,t,r,s,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=o}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=ZD(this.serializer,e),r=function(o){if(!("targetChange"in o))return Fe.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?Fe.min():a.readTime?ar(a.readTime):Fe.min()}(e);return this.listener.Y_(t,r)}Z_(e){const t={};t.database=a0(this.serializer),t.addTarget=function(o,a){let u;const d=a.target;if(u=em(d)?{documents:bT(o,d)}:{query:gx(o,d).gt},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=gT(o,a.resumeToken);const f=i0(o,a.expectedCount);f!==null&&(u.expectedCount=f)}else if(a.snapshotVersion.compareTo(Fe.min())>0){u.readTime=fc(o,a.snapshotVersion.toTimestamp());const f=i0(o,a.expectedCount);f!==null&&(u.expectedCount=f)}return u}(this.serializer,e);const r=n4(this.serializer,e);r&&(t.labels=r),this.Q_(t)}X_(e){const t={};t.database=a0(this.serializer),t.removeTarget=e,this.Q_(t)}}class K4 extends ek{constructor(e,t,r,s,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=o}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Me(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Me(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Me(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=e4(e.writeResults,e.commitTime),r=ar(e.commitTime);return this.listener.ra(r,t)}ia(){const e={};e.database=a0(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>sm(this.serializer,r))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{}class Y4 extends Q4{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.sa=!1}oa(){if(this.sa)throw new _e(le.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,r,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.zo(e,o0(t,r),s,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new _e(le.UNKNOWN,o.toString())})}Yo(e,t,r,s,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Yo(e,o0(t,r),s,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new _e(le.UNKNOWN,a.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class X4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Qt(t),this.ua=!1):me("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a="RemoteStore";class J4{constructor(e,t,r,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=o,this.Ra.No(a=>{r.enqueueAndForget(async()=>{Qa(this)&&(me($a,"Restarting streams for network reachability change."),await async function(d){const f=Re(d);f.da.add(4),await zd(f),f.Va.set("Unknown"),f.da.delete(4),await Km(f)}(this))})}),this.Va=new X4(r,s)}}async function Km(n){if(Qa(n))for(const e of n.Aa)await e(!0)}async function zd(n){for(const e of n.Aa)await e(!1)}function Qm(n,e){const t=Re(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),kx(t)?Tx(t):Rc(t).N_()&&Ex(t,e))}function pc(n,e){const t=Re(n),r=Rc(t);t.Ea.delete(e),r.N_()&&tk(t,e),t.Ea.size===0&&(r.N_()?r.k_():Qa(t)&&t.Va.set("Unknown"))}function Ex(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Fe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Rc(n).Z_(e)}function tk(n,e){n.ma.Ke(e),Rc(n).X_(e)}function Tx(n){n.ma=new WD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),Rc(n).start(),n.Va.ca()}function kx(n){return Qa(n)&&!Rc(n).O_()&&n.Ea.size>0}function Qa(n){return Re(n).da.size===0}function nk(n){n.ma=void 0}async function Z4(n){n.Va.set("Online")}async function e5(n){n.Ea.forEach((e,t)=>{Ex(n,e)})}async function t5(n,e){nk(n),kx(n)?(n.Va.Pa(e),Tx(n)):n.Va.set("Unknown")}async function n5(n,e,t){if(n.Va.set("Online"),e instanceof pT&&e.state===2&&e.cause)try{await async function(s,o){const a=o.cause;for(const u of o.targetIds)s.Ea.has(u)&&(await s.remoteSyncer.rejectListen(u,a),s.Ea.delete(u),s.ma.removeTarget(u))}(n,e)}catch(r){me($a,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await hm(n,r)}else if(e instanceof Mf?n.ma.Xe(e):e instanceof mT?n.ma.ot(e):n.ma.nt(e),!t.isEqual(Fe.min()))try{const r=await qT(n.localStore);t.compareTo(r)>=0&&await function(o,a){const u=o.ma.It(a);return u.targetChanges.forEach((d,f)=>{if(d.resumeToken.approximateByteSize()>0){const g=o.Ea.get(f);g&&o.Ea.set(f,g.withResumeToken(d.resumeToken,a))}}),u.targetMismatches.forEach((d,f)=>{const g=o.Ea.get(d);if(!g)return;o.Ea.set(d,g.withResumeToken(Xt.EMPTY_BYTE_STRING,g.snapshotVersion)),tk(o,d);const y=new Ni(g.target,d,f,g.sequenceNumber);Ex(o,y)}),o.remoteSyncer.applyRemoteEvent(u)}(n,t)}catch(r){me($a,"Failed to raise snapshot:",r),await hm(n,r)}}async function hm(n,e,t){if(!qo(e))throw e;n.da.add(1),await zd(n),n.Va.set("Offline"),t||(t=()=>qT(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{me($a,"Retrying IndexedDB access"),await t(),n.da.delete(1),await Km(n)})}function rk(n,e){return e().catch(t=>hm(n,t,e))}async function Nc(n){const e=Re(n),t=Vo(e);let r=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Ca;for(;r5(e);)try{const s=await U4(e.localStore,r);if(s===null){e.Ia.length===0&&t.k_();break}r=s.batchId,s5(e,s)}catch(s){await hm(e,s)}sk(e)&&ik(e)}function r5(n){return Qa(n)&&n.Ia.length<10}function s5(n,e){n.Ia.push(e);const t=Vo(n);t.N_()&&t.ea&&t.ta(e.mutations)}function sk(n){return Qa(n)&&!Vo(n).O_()&&n.Ia.length>0}function ik(n){Vo(n).start()}async function i5(n){Vo(n).ia()}async function o5(n){const e=Vo(n);for(const t of n.Ia)e.ta(t.mutations)}async function a5(n,e,t){const r=n.Ia.shift(),s=hx.from(r,e,t);await rk(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Nc(n)}async function l5(n,e){e&&Vo(n).ea&&await async function(r,s){if(function(a){return qD(a)&&a!==le.ABORTED}(s.code)){const o=r.Ia.shift();Vo(r).L_(),await rk(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),await Nc(r)}}(n,e),sk(n)&&ik(n)}async function N_(n,e){const t=Re(n);t.asyncQueue.verifyOperationInProgress(),me($a,"RemoteStore received new credentials");const r=Qa(t);t.da.add(3),await zd(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await Km(t)}async function p0(n,e){const t=Re(n);e?(t.da.delete(2),await Km(t)):e||(t.da.add(2),await zd(t),t.Va.set("Unknown"))}function Rc(n){return n.fa||(n.fa=function(t,r,s){const o=Re(t);return o.oa(),new G4(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(n.datastore,n.asyncQueue,{e_:Z4.bind(null,n),n_:e5.bind(null,n),i_:t5.bind(null,n),Y_:n5.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),kx(n)?Tx(n):n.Va.set("Unknown")):(await n.fa.stop(),nk(n))})),n.fa}function Vo(n){return n.ga||(n.ga=function(t,r,s){const o=Re(t);return o.oa(),new K4(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:i5.bind(null,n),i_:l5.bind(null,n),na:o5.bind(null,n),ra:a5.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await Nc(n)):(await n.ga.stop(),n.Ia.length>0&&(me($a,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(e,t,r,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=o,this.deferred=new Ls,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,o){const a=Date.now()+r,u=new Ax(e,t,a,s,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new _e(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Cx(n,e){if(Qt("AsyncQueue",`${e}: ${n}`),qo(n))return new _e(le.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{static emptySet(e){return new Zl(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ee.comparator(t.key,r.key):(t,r)=>Ee.comparator(t.key,r.key),this.keyedMap=Vu(),this.sortedSet=new kt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Zl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=r.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Zl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(){this.pa=new kt(Ee.comparator)}track(e){const t=e.doc.key,r=this.pa.get(t);r?e.type!==0&&r.type===3?this.pa=this.pa.insert(t,e):e.type===3&&r.type!==1?this.pa=this.pa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.pa=this.pa.remove(t):e.type===1&&r.type===2?this.pa=this.pa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Ce(63341,{Vt:e,ya:r}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,r)=>{e.push(r)}),e}}class gc{constructor(e,t,r,s,o,a,u,d,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=d,this.hasCachedResults=f}static fromInitialDocuments(e,t,r,s,o){const a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new gc(e,t,Zl.emptySet(t),a,r,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Um(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c5{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class u5{constructor(){this.queries=P_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=Re(t),o=s.queries;s.queries=P_(),o.forEach((a,u)=>{for(const d of u.Sa)d.onError(r)})})(this,new _e(le.ABORTED,"Firestore shutting down"))}}function P_(){return new $i(n=>ZE(n),Um)}async function Nx(n,e){const t=Re(n);let r=3;const s=e.query;let o=t.queries.get(s);o?!o.Da()&&e.va()&&(r=2):(o=new c5,r=e.va()?0:1);try{switch(r){case 0:o.ba=await t.onListen(s,!0);break;case 1:o.ba=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const u=Cx(a,`Initialization of query '${Hl(e.query)}' failed`);return void e.onError(u)}t.queries.set(s,o),o.Sa.push(e),e.Fa(t.onlineState),o.ba&&e.Ma(o.ba)&&Px(t)}async function Rx(n,e){const t=Re(n),r=e.query;let s=3;const o=t.queries.get(r);if(o){const a=o.Sa.indexOf(e);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?s=e.va()?0:1:!o.Da()&&e.va()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function d5(n,e){const t=Re(n);let r=!1;for(const s of e){const o=s.query,a=t.queries.get(o);if(a){for(const u of a.Sa)u.Ma(s)&&(r=!0);a.ba=s}}r&&Px(t)}function h5(n,e,t){const r=Re(n),s=r.queries.get(e);if(s)for(const o of s.Sa)o.onError(t);r.queries.delete(e)}function Px(n){n.Ca.forEach(e=>{e.next()})}var g0,j_;(j_=g0||(g0={})).xa="default",j_.Cache="cache";class jx{constructor(e,t,r){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=r||{}}Ma(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new gc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const r=t!=="Offline";return(!this.options.Qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=gc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==g0.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e){this.key=e}}class ak{constructor(e){this.key=e}}class f5{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Je(),this.mutatedKeys=Je(),this.Za=tT(e),this.Xa=new Zl(this.Za)}get eu(){return this.Ha}tu(e,t){const r=t?t.nu:new R_,s=t?t.Xa:this.Xa;let o=t?t.mutatedKeys:this.mutatedKeys,a=s,u=!1;const d=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,f=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((g,y)=>{const x=s.get(g),w=Ld(this.query,y)?y:null,E=!!x&&this.mutatedKeys.has(x.key),S=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let A=!1;x&&w?x.data.isEqual(w.data)?E!==S&&(r.track({type:3,doc:w}),A=!0):this.ru(x,w)||(r.track({type:2,doc:w}),A=!0,(d&&this.Za(w,d)>0||f&&this.Za(w,f)<0)&&(u=!0)):!x&&w?(r.track({type:0,doc:w}),A=!0):x&&!w&&(r.track({type:1,doc:x}),A=!0,(d||f)&&(u=!0)),A&&(w?(a=a.add(w),o=S?o.add(g):o.delete(g)):(a=a.delete(g),o=o.delete(g)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const g=this.query.limitType==="F"?a.last():a.first();a=a.delete(g.key),o=o.delete(g.key),r.track({type:1,doc:g})}return{Xa:a,nu:r,Cs:u,mutatedKeys:o}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const o=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const a=e.nu.wa();a.sort((g,y)=>function(w,E){const S=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ce(20277,{Vt:A})}};return S(w)-S(E)}(g.type,y.type)||this.Za(g.doc,y.doc)),this.iu(r),s=s!=null&&s;const u=t&&!s?this.su():[],d=this.Ya.size===0&&this.current&&!s?1:0,f=d!==this.Ja;return this.Ja=d,a.length!==0||f?{snapshot:new gc(this.query,e.Xa,o,a,e.mutatedKeys,d===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),ou:u}:{ou:u}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new R_,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Je(),this.Xa.forEach(r=>{this._u(r.key)&&(this.Ya=this.Ya.add(r.key))});const t=[];return e.forEach(r=>{this.Ya.has(r)||t.push(new ak(r))}),this.Ya.forEach(r=>{e.has(r)||t.push(new ok(r))}),t}au(e){this.Ha=e.$s,this.Ya=Je();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return gc.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const Pc="SyncEngine";class m5{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class p5{constructor(e){this.key=e,this.cu=!1}}class g5{constructor(e,t,r,s,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.lu={},this.hu=new $i(u=>ZE(u),Um),this.Pu=new Map,this.Tu=new Set,this.Iu=new kt(Ee.comparator),this.Eu=new Map,this.du=new vx,this.Au={},this.Ru=new Map,this.Vu=Ba.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function y5(n,e,t=!0){const r=Ym(n);let s;const o=r.hu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.uu()):s=await lk(r,e,t,!0),s}async function x5(n,e){const t=Ym(n);await lk(t,e,!0,!1)}async function lk(n,e,t,r){const s=await cm(n.localStore,Gr(e)),o=s.targetId,a=n.sharedClientState.addLocalQueryTarget(o,t);let u;return r&&(u=await Dx(n,e,o,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&Qm(n.remoteStore,s),u}async function Dx(n,e,t,r,s){n.fu=(y,x,w)=>async function(S,A,N,z){let U=A.view.tu(N);U.Cs&&(U=await h0(S.localStore,A.query,!1).then(({documents:R})=>A.view.tu(R,U)));const W=z&&z.targetChanges.get(A.targetId),$=z&&z.targetMismatches.get(A.targetId)!=null,F=A.view.applyChanges(U,S.isPrimaryClient,W,$);return y0(S,A.targetId,F.ou),F.snapshot}(n,y,x,w);const o=await h0(n.localStore,e,!0),a=new f5(e,o.$s),u=a.tu(o.documents),d=Vd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),f=a.applyChanges(u,n.isPrimaryClient,d);y0(n,t,f.ou);const g=new m5(e,t,a);return n.hu.set(e,g),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),f.snapshot}async function v5(n,e,t){const r=Re(n),s=r.hu.get(e),o=r.Pu.get(s.targetId);if(o.length>1)return r.Pu.set(s.targetId,o.filter(a=>!Um(a,e))),void r.hu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await mc(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&pc(r.remoteStore,s.targetId),yc(r,s.targetId)}).catch($o)):(yc(r,s.targetId),await mc(r.localStore,s.targetId,!0))}async function w5(n,e){const t=Re(n),r=t.hu.get(e),s=t.Pu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),pc(t.remoteStore,r.targetId))}async function b5(n,e,t){const r=Fx(n);try{const s=await function(a,u){const d=Re(a),f=mt.now(),g=u.reduce((w,E)=>w.add(E.key),Je());let y,x;return d.persistence.runTransaction("Locally write mutations","readwrite",w=>{let E=Wr(),S=Je();return d.Bs.getEntries(w,g).next(A=>{E=A,E.forEach((N,z)=>{z.isValidDocument()||(S=S.add(N))})}).next(()=>d.localDocuments.getOverlayedDocuments(w,E)).next(A=>{y=A;const N=[];for(const z of u){const U=UD(z,y.get(z.key).overlayedDocument);U!=null&&N.push(new qi(z.key,U,BE(U.value.mapValue),hn.exists(!0)))}return d.mutationQueue.addMutationBatch(w,f,N,u)}).next(A=>{x=A;const N=A.applyToLocalDocumentSet(y,S);return d.documentOverlayCache.saveOverlays(w,A.batchId,N)})}).then(()=>({batchId:x.batchId,changes:rT(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,u,d){let f=a.Au[a.currentUser.toKey()];f||(f=new kt($e)),f=f.insert(u,d),a.Au[a.currentUser.toKey()]=f}(r,s.batchId,t),await Wo(r,s.changes),await Nc(r.remoteStore)}catch(s){const o=Cx(s,"Failed to persist write");t.reject(o)}}async function ck(n,e){const t=Re(n);try{const r=await V4(t.localStore,e);e.targetChanges.forEach((s,o)=>{const a=t.Eu.get(o);a&&(Me(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.cu=!0:s.modifiedDocuments.size>0?Me(a.cu,14607):s.removedDocuments.size>0&&(Me(a.cu,42227),a.cu=!1))}),await Wo(t,r,e)}catch(r){await $o(r)}}function D_(n,e,t){const r=Re(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.hu.forEach((o,a)=>{const u=a.view.Fa(e);u.snapshot&&s.push(u.snapshot)}),function(a,u){const d=Re(a);d.onlineState=u;let f=!1;d.queries.forEach((g,y)=>{for(const x of y.Sa)x.Fa(u)&&(f=!0)}),f&&Px(d)}(r.eventManager,e),s.length&&r.lu.Y_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function _5(n,e,t){const r=Re(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Eu.get(e),o=s&&s.key;if(o){let a=new kt(Ee.comparator);a=a.insert(o,Ht.newNoDocument(o,Fe.min()));const u=Je().add(o),d=new Fd(Fe.min(),new Map,new kt($e),a,u);await ck(r,d),r.Iu=r.Iu.remove(o),r.Eu.delete(e),Ox(r)}else await mc(r.localStore,e,!1).then(()=>yc(r,e,t)).catch($o)}async function S5(n,e){const t=Re(n),r=e.batch.batchId;try{const s=await F4(t.localStore,e);Lx(t,r,null),Mx(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Wo(t,s)}catch(s){await $o(s)}}async function I5(n,e,t){const r=Re(n);try{const s=await function(a,u){const d=Re(a);return d.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let g;return d.mutationQueue.lookupMutationBatch(f,u).next(y=>(Me(y!==null,37113),g=y.keys(),d.mutationQueue.removeMutationBatch(f,y))).next(()=>d.mutationQueue.performConsistencyCheck(f)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(f,g,u)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,g)).next(()=>d.localDocuments.getDocuments(f,g))})}(r.localStore,e);Lx(r,e,t),Mx(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Wo(r,s)}catch(s){await $o(s)}}function Mx(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function Lx(n,e,t){const r=Re(n);let s=r.Au[r.currentUser.toKey()];if(s){const o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),r.Au[r.currentUser.toKey()]=s}}function yc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Pu.get(e))n.hu.delete(r),t&&n.lu.gu(r,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(r=>{n.du.containsKey(r)||uk(n,r)})}function uk(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(pc(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),Ox(n))}function y0(n,e,t){for(const r of t)r instanceof ok?(n.du.addReference(r.key,e),E5(n,r)):r instanceof ak?(me(Pc,"Document no longer in limbo: "+r.key),n.du.removeReference(r.key,e),n.du.containsKey(r.key)||uk(n,r.key)):Ce(19791,{pu:r})}function E5(n,e){const t=e.key,r=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(r)||(me(Pc,"New document in limbo: "+t),n.Tu.add(r),Ox(n))}function Ox(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new Ee(pt.fromString(e)),r=n.Vu.next();n.Eu.set(r,new p5(t)),n.Iu=n.Iu.insert(t,r),Qm(n.remoteStore,new Ni(Gr(Md(t.path)),r,"TargetPurposeLimboResolution",Rr.le))}}async function Wo(n,e,t){const r=Re(n),s=[],o=[],a=[];r.hu.isEmpty()||(r.hu.forEach((u,d)=>{a.push(r.fu(d,e,t).then(f=>{var g;if((f||t)&&r.isPrimaryClient){const y=f?!f.fromCache:(g=t==null?void 0:t.targetChanges.get(d.targetId))===null||g===void 0?void 0:g.current;r.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(f){s.push(f);const y=_x.Rs(d.targetId,f);o.push(y)}}))}),await Promise.all(a),r.lu.Y_(s),await async function(d,f){const g=Re(d);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>ee.forEach(f,x=>ee.forEach(x.ds,w=>g.persistence.referenceDelegate.addReference(y,x.targetId,w)).next(()=>ee.forEach(x.As,w=>g.persistence.referenceDelegate.removeReference(y,x.targetId,w)))))}catch(y){if(!qo(y))throw y;me(Sx,"Failed to update sequence numbers: "+y)}for(const y of f){const x=y.targetId;if(!y.fromCache){const w=g.xs.get(x),E=w.snapshotVersion,S=w.withLastLimboFreeSnapshotVersion(E);g.xs=g.xs.insert(x,S)}}}(r.localStore,o))}async function T5(n,e){const t=Re(n);if(!t.currentUser.isEqual(e)){me(Pc,"User change. New user:",e.toKey());const r=await $T(t.localStore,e);t.currentUser=e,function(o,a){o.Ru.forEach(u=>{u.forEach(d=>{d.reject(new _e(le.CANCELLED,a))})}),o.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Wo(t,r.ks)}}function k5(n,e){const t=Re(n),r=t.Eu.get(e);if(r&&r.cu)return Je().add(r.key);{let s=Je();const o=t.Pu.get(e);if(!o)return s;for(const a of o){const u=t.hu.get(a);s=s.unionWith(u.view.eu)}return s}}async function A5(n,e){const t=Re(n),r=await h0(t.localStore,e.query,!0),s=e.view.au(r);return t.isPrimaryClient&&y0(t,e.targetId,s.ou),s}async function C5(n,e){const t=Re(n);return WT(t.localStore,e).then(r=>Wo(t,r))}async function N5(n,e,t,r){const s=Re(n),o=await function(u,d){const f=Re(u),g=Re(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",y=>g.tr(y,d).next(x=>x?f.localDocuments.getDocuments(y,x):ee.resolve(null)))}(s.localStore,e);o!==null?(t==="pending"?await Nc(s.remoteStore):t==="acknowledged"||t==="rejected"?(Lx(s,e,r||null),Mx(s,e),function(u,d){Re(Re(u).mutationQueue).sr(d)}(s.localStore,e)):Ce(6720,"Unknown batchState",{yu:t}),await Wo(s,o)):me(Pc,"Cannot apply mutation batch with id: "+e)}async function R5(n,e){const t=Re(n);if(Ym(t),Fx(t),e===!0&&t.mu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await M_(t,r.toArray());t.mu=!0,await p0(t.remoteStore,!0);for(const o of s)Qm(t.remoteStore,o)}else if(e===!1&&t.mu!==!1){const r=[];let s=Promise.resolve();t.Pu.forEach((o,a)=>{t.sharedClientState.isLocalQueryTarget(a)?r.push(a):s=s.then(()=>(yc(t,a),mc(t.localStore,a,!0))),pc(t.remoteStore,a)}),await s,await M_(t,r),function(a){const u=Re(a);u.Eu.forEach((d,f)=>{pc(u.remoteStore,f)}),u.du.Jr(),u.Eu=new Map,u.Iu=new kt(Ee.comparator)}(t),t.mu=!1,await p0(t.remoteStore,!1)}}async function M_(n,e,t){const r=Re(n),s=[],o=[];for(const a of e){let u;const d=r.Pu.get(a);if(d&&d.length!==0){u=await cm(r.localStore,Gr(d[0]));for(const f of d){const g=r.hu.get(f),y=await A5(r,g);y.snapshot&&o.push(y.snapshot)}}else{const f=await HT(r.localStore,a);u=await cm(r.localStore,f),await Dx(r,dk(f),a,!1,u.resumeToken)}s.push(u)}return r.lu.Y_(o),s}function dk(n){return YE(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function P5(n){return function(t){return Re(Re(t).persistence).Is()}(Re(n).localStore)}async function j5(n,e,t,r){const s=Re(n);if(s.mu)return void me(Pc,"Ignoring unexpected query state notification.");const o=s.Pu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const a=await WT(s.localStore,eT(o[0])),u=Fd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Xt.EMPTY_BYTE_STRING);await Wo(s,a,u);break}case"rejected":await mc(s.localStore,e,!0),yc(s,e,r);break;default:Ce(64155,t)}}async function D5(n,e,t){const r=Ym(n);if(r.mu){for(const s of e){if(r.Pu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){me(Pc,"Adding an already active target "+s);continue}const o=await HT(r.localStore,s),a=await cm(r.localStore,o);await Dx(r,dk(o),a.targetId,!1,a.resumeToken),Qm(r.remoteStore,a)}for(const s of t)r.Pu.has(s)&&await mc(r.localStore,s,!1).then(()=>{pc(r.remoteStore,s),yc(r,s)}).catch($o)}}function Ym(n){const e=Re(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=ck.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=k5.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_5.bind(null,e),e.lu.Y_=d5.bind(null,e.eventManager),e.lu.gu=h5.bind(null,e.eventManager),e}function Fx(n){const e=Re(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=S5.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=I5.bind(null,e),e}class vd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Gm(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return BT(this.persistence,new UT,e.initialUser,this.serializer)}Su(e){return new wx(Wm.fi,this.serializer)}bu(e){return new XT}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vd.provider={build:()=>new vd};class M5 extends vd{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Me(this.persistence.referenceDelegate instanceof lm,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new MT(r,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?Bn.withCacheSize(this.cacheSizeBytes):Bn.DEFAULT;return new wx(r=>lm.fi(r,t),this.serializer)}}class L5 extends vd{constructor(e,t,r){super(),this.Fu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Fu.initialize(this,e),await Fx(this.Fu.syncEngine),await Nc(this.Fu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Du(e){return BT(this.persistence,new UT,e.initialUser,this.serializer)}vu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new MT(r,e.asyncQueue,t)}Cu(e,t){const r=new $j(t,this.persistence);return new Bj(e.asyncQueue,r)}Su(e){const t=zT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Bn.withCacheSize(this.cacheSizeBytes):Bn.DEFAULT;return new bx(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,JT(),Of(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new XT}}class O5 extends L5{constructor(e,t){super(e,t,!1),this.Fu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Fu.syncEngine;this.sharedClientState instanceof iy&&(this.sharedClientState.syncEngine={Co:N5.bind(null,t),Fo:j5.bind(null,t),Mo:D5.bind(null,t),Is:P5.bind(null,t),vo:C5.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji(async r=>{await R5(this.Fu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}bu(e){const t=JT();if(!iy.C(t))throw new _e(le.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=zT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new iy(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class fm{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>D_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=T5.bind(null,this.syncEngine),await p0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new u5}()}createDatastore(e){const t=Gm(e.databaseInfo.databaseId),r=function(o){return new W4(o)}(e.databaseInfo);return function(o,a,u,d){return new Y4(o,a,u,d)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,o,a,u){return new J4(r,s,o,a,u)}(this.localStore,this.datastore,e.asyncQueue,t=>D_(this.syncEngine,t,0),function(){return A_.C()?new A_:new B4}())}createSyncEngine(e,t){return function(s,o,a,u,d,f,g){const y=new g5(s,o,a,u,d,f);return g&&(y.mu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const o=Re(s);me($a,"RemoteStore shutting down."),o.da.add(5),await zd(o),o.Ra.shutdown(),o.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}fm.provider={build:()=>new fm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Qt("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zo="FirestoreClient";class F5{constructor(e,t,r,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=_n.UNAUTHENTICATED,this.clientId=pE.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async a=>{me(zo,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(me(zo,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ls;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Cx(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ay(n,e){n.asyncQueue.verifyOperationInProgress(),me(zo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await $T(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function L_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await V5(n);me(zo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>N_(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>N_(e.remoteStore,s)),n._onlineComponents=e}async function V5(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){me(zo,"Using user provided OfflineComponentProvider");try{await ay(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===le.FAILED_PRECONDITION||s.code===le.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;La("Error using user provided cache. Falling back to memory cache: "+t),await ay(n,new vd)}}else me(zo,"Using default OfflineComponentProvider"),await ay(n,new M5(void 0));return n._offlineComponents}async function zx(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(me(zo,"Using user provided OnlineComponentProvider"),await L_(n,n._uninitializedComponentsProvider._online)):(me(zo,"Using default OnlineComponentProvider"),await L_(n,new fm))),n._onlineComponents}function z5(n){return zx(n).then(e=>e.syncEngine)}function U5(n){return zx(n).then(e=>e.datastore)}async function mm(n){const e=await zx(n),t=e.eventManager;return t.onListen=y5.bind(null,e.syncEngine),t.onUnlisten=v5.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=x5.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=w5.bind(null,e.syncEngine),t}function B5(n,e,t={}){const r=new Ls;return n.asyncQueue.enqueueAndForget(async()=>function(o,a,u,d,f){const g=new Vx({next:x=>{g.xu(),a.enqueueAndForget(()=>Rx(o,y));const w=x.docs.has(u);!w&&x.fromCache?f.reject(new _e(le.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&x.fromCache&&d&&d.source==="server"?f.reject(new _e(le.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(x)},error:x=>f.reject(x)}),y=new jx(Md(u.path),g,{includeMetadataChanges:!0,Qa:!0});return Nx(o,y)}(await mm(n),n.asyncQueue,e,t,r)),r.promise}function $5(n,e,t={}){const r=new Ls;return n.asyncQueue.enqueueAndForget(async()=>function(o,a,u,d,f){const g=new Vx({next:x=>{g.xu(),a.enqueueAndForget(()=>Rx(o,y)),x.fromCache&&d.source==="server"?f.reject(new _e(le.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(x)},error:x=>f.reject(x)}),y=new jx(u,g,{includeMetadataChanges:!0,Qa:!0});return Nx(o,y)}(await mm(n),n.asyncQueue,e,t,r)),r.promise}function q5(n,e,t){const r=new Ls;return n.asyncQueue.enqueueAndForget(async()=>{try{const s=await U5(n);r.resolve(async function(a,u,d){var f;const g=Re(a),{request:y,yt:x,parent:w}=t4(g.serializer,CD(u),d);g.connection.Uo||delete y.parent;const E=(await g.Yo("RunAggregationQuery",g.serializer.databaseId,w,y,1)).filter(A=>!!A.result);Me(E.length===1,64727);const S=(f=E[0].result)===null||f===void 0?void 0:f.aggregateFields;return Object.keys(S).reduce((A,N)=>(A[x[N]]=S[N],A),{})}(s,e,t))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(n,e,t){if(!t)throw new _e(le.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function H5(n,e,t,r){if(e===!0&&r===!0)throw new _e(le.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function F_(n){if(!Ee.isDocumentKey(n))throw new _e(le.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function V_(n){if(Ee.isDocumentKey(n))throw new _e(le.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Xm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ce(12329,{type:typeof n})}function Pn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new _e(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Xm(n);throw new _e(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk="firestore.googleapis.com",z_=!0;class U_{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new _e(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=mk,this.ssl=z_}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:z_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=RT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<x4)throw new _e(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}H5("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hk((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new _e(le.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new _e(le.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new _e(le.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Jm{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new U_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new _e(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new _e(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new U_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Rj;switch(r.type){case"firstParty":return new Mj(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new _e(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=O_.get(t);r&&(me("ComponentProvider","Removing Datastore"),O_.delete(t),r.terminate())}(this),Promise.resolve()}}function W5(n,e,t,r={}){var s;n=Pn(n,Jm);const o=Ga(e),a=n._getSettings(),u=Object.assign(Object.assign({},a),{emulatorOptions:n._getEmulatorOptions()}),d=`${e}:${t}`;o&&(O0(`https://${d}`),F0("Firestore",!0)),a.host!==mk&&a.host!==d&&La("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f=Object.assign(Object.assign({},a),{host:d,ssl:o,emulatorOptions:r});if(!Mo(f,u)&&(n._setSettings(f),r.mockUserToken)){let g,y;if(typeof r.mockUserToken=="string")g=r.mockUserToken,y=_n.MOCK_USER;else{g=VC(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const x=r.mockUserToken.sub||r.mockUserToken.user_id;if(!x)throw new _e(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new _n(x)}n._authCredentials=new Pj(new fE(g,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Hi(this.firestore,e,this._query)}}class Wn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Wn(this.firestore,e,this._key)}}class jo extends Hi{constructor(e,t,r){super(e,t,Md(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Wn(this.firestore,null,new Ee(e))}withConverter(e){return new jo(this.firestore,e,this._path)}}function at(n,e,...t){if(n=Lt(n),fk("collection","path",e),n instanceof Jm){const r=pt.fromString(e,...t);return V_(r),new jo(n,null,r)}{if(!(n instanceof Wn||n instanceof jo))throw new _e(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(pt.fromString(e,...t));return V_(r),new jo(n.firestore,null,r)}}function Ot(n,e,...t){if(n=Lt(n),arguments.length===1&&(e=pE.newId()),fk("doc","path",e),n instanceof Jm){const r=pt.fromString(e,...t);return F_(r),new Wn(n,null,new Ee(r))}{if(!(n instanceof Wn||n instanceof jo))throw new _e(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(pt.fromString(e,...t));return F_(r),new Wn(n.firestore,n instanceof jo?n.converter:null,new Ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_="AsyncQueue";class $_{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new ZT(this,"async_queue_retry"),this.rc=()=>{const r=Of();r&&me(B_,"Visibility state changed to "+r.visibilityState),this.x_.b_()},this.sc=e;const t=Of();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Of();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Ls;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!qo(e))throw e;me(B_,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(r=>{throw this.Xu=r,this.ec=!1,Qt("INTERNAL UNHANDLED ERROR: ",q_(r)),r}).then(r=>(this.ec=!1,r))));return this.sc=t,t}enqueueAfterDelay(e,t,r){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const s=Ax.createAndSchedule(this,e,t,r,o=>this.uc(o));return this.Zu.push(s),s}oc(){this.Xu&&Ce(47125,{cc:q_(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function q_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H_(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const o of r)if(o in s&&typeof s[o]=="function")return!0;return!1}(n,["next","error","complete"])}class fs extends Jm{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new $_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $_(e),this._firestoreClient=void 0,await e}}}function G5(n,e){const t=typeof n=="object"?n:Cm(),r=typeof n=="string"?n:Zf,s=Am(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const o=hI("firestore");o&&W5(s,...o)}return s}function jc(n){if(n._terminated)throw new _e(le.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||pk(n),n._firestoreClient}function pk(n){var e,t,r;const s=n._freezeSettings(),o=function(u,d,f,g){return new xD(u,d,f,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,hk(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new F5(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(u){const d=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(d),_online:d}}(n._componentsProvider))}async function K5(n){La("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();Q5(n,fm.provider,{build:t=>new O5(t,e.cacheSizeBytes)})}function Q5(n,e,t){if((n=Pn(n,fs))._firestoreClient||n._terminated)throw new _e(le.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new _e(le.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},pk(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y5{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class X5{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xc(Xt.fromBase64String(e))}catch(t){throw new _e(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new xc(Xt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new _e(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ut(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new _e(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new _e(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $e(this._lat,e._lat)||$e(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==s[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J5=/^__.*__$/;class Z5{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new qi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Cc(e,this.data,t,this.fieldTransforms)}}class gk{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new qi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function yk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ce(40011,{Ic:n})}}class Zm{constructor(e,t,r,s,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,o===void 0&&this.Ec(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Zm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.dc({path:r,Rc:!1});return s.Vc(e),s}mc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.dc({path:r,Rc:!1});return s.Ec(),s}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return pm(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(yk(this.Ic)&&J5.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class eM{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Gm(e)}bc(e,t,r,s=!1){return new Zm({Ic:e,methodName:t,wc:r,path:Ut.emptyPath(),Rc:!1,yc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $d(n){const e=n._freezeSettings(),t=Gm(n._databaseId);return new eM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function $x(n,e,t,r,s,o={}){const a=n.bc(o.merge||o.mergeFields?2:0,e,t,s);Wx("Data must be an object, but it was:",a,r);const u=wk(r,a);let d,f;if(o.merge)d=new Pr(a.fieldMask),f=a.fieldTransforms;else if(o.mergeFields){const g=[];for(const y of o.mergeFields){const x=x0(e,y,t);if(!a.contains(x))throw new _e(le.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);_k(g,x)||g.push(x)}d=new Pr(g),f=a.fieldTransforms.filter(y=>d.covers(y.field))}else d=null,f=a.fieldTransforms;return new Z5(new $n(u),d,f)}class ep extends Bd{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ep}}function tM(n,e,t){return new Zm({Ic:3,wc:e.settings.wc,methodName:n._methodName,Rc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class qx extends Bd{_toFieldTransform(e){return new ux(e.path,new dc)}isEqual(e){return e instanceof qx}}class Hx extends Bd{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=tM(this,e,!0),r=this.Sc.map(o=>Dc(o,t)),s=new Va(r);return new ux(e.path,s)}isEqual(e){return e instanceof Hx&&Mo(this.Sc,e.Sc)}}function xk(n,e,t,r){const s=n.bc(1,e,t);Wx("Data must be an object, but it was:",s,r);const o=[],a=$n.empty();Ho(r,(d,f)=>{const g=Gx(e,d,t);f=Lt(f);const y=s.mc(g);if(f instanceof ep)o.push(g);else{const x=Dc(f,y);x!=null&&(o.push(g),a.set(g,x))}});const u=new Pr(o);return new gk(a,u,s.fieldTransforms)}function vk(n,e,t,r,s,o){const a=n.bc(1,e,t),u=[x0(e,r,t)],d=[s];if(o.length%2!=0)throw new _e(le.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<o.length;x+=2)u.push(x0(e,o[x])),d.push(o[x+1]);const f=[],g=$n.empty();for(let x=u.length-1;x>=0;--x)if(!_k(f,u[x])){const w=u[x];let E=d[x];E=Lt(E);const S=a.mc(w);if(E instanceof ep)f.push(w);else{const A=Dc(E,S);A!=null&&(f.push(w),g.set(w,A))}}const y=new Pr(f);return new gk(g,y,a.fieldTransforms)}function nM(n,e,t,r=!1){return Dc(t,n.bc(r?4:3,e))}function Dc(n,e){if(bk(n=Lt(n)))return Wx("Unsupported field value:",e,n),wk(n,e);if(n instanceof Bd)return function(r,s){if(!yk(s.Ic))throw s.gc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.gc(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(s);o&&s.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(r,s){const o=[];let a=0;for(const u of r){let d=Dc(u,s.fc(a));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),a++}return{arrayValue:{values:o}}}(n,e)}return function(r,s){if((r=Lt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return MD(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=mt.fromDate(r);return{timestampValue:fc(s.serializer,o)}}if(r instanceof mt){const o=new mt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:fc(s.serializer,o)}}if(r instanceof Ux)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof xc)return{bytesValue:gT(s.serializer,r._byteString)};if(r instanceof Wn){const o=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw s.gc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:px(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Bx)return function(a,u){return{mapValue:{fields:{[ix]:{stringValue:ox},[ac]:{arrayValue:{values:a.toArray().map(f=>{if(typeof f!="number")throw u.gc("VectorValues must only contain numeric values.");return cx(u.serializer,f)})}}}}}}(r,s);throw s.gc(`Unsupported field value: ${Xm(r)}`)}(n,e)}function wk(n,e){const t={};return jE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ho(n,(r,s)=>{const o=Dc(s,e.Ac(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function bk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof mt||n instanceof Ux||n instanceof xc||n instanceof Wn||n instanceof Bd||n instanceof Bx)}function Wx(n,e,t){if(!bk(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=Xm(t);throw r==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+r)}}function x0(n,e,t){if((e=Lt(e))instanceof Ud)return e._internalPath;if(typeof e=="string")return Gx(n,e);throw pm("Field path arguments must be of type string or ",n,!1,void 0,t)}const rM=new RegExp("[~\\*/\\[\\]]");function Gx(n,e,t){if(e.search(rM)>=0)throw pm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ud(...e.split("."))._internalPath}catch{throw pm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function pm(n,e,t,r,s){const o=r&&!r.isEmpty(),a=s!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let d="";return(o||a)&&(d+=" (found",o&&(d+=` in field ${r}`),a&&(d+=` in document ${s}`),d+=")"),new _e(le.INVALID_ARGUMENT,u+n+d)}function _k(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{constructor(e,t,r,s,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Wn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new sM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(tp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class sM extends Sk{data(){return super.data()}}function tp(n,e){return typeof e=="string"?Gx(n,e):e instanceof Ud?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new _e(le.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Kx{}class Qx extends Kx{}function ft(n,e,...t){let r=[];e instanceof Kx&&r.push(e),r=r.concat(t),function(o){const a=o.filter(d=>d instanceof Yx).length,u=o.filter(d=>d instanceof np).length;if(a>1||a>0&&u>0)throw new _e(le.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class np extends Qx{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new np(e,t,r)}_apply(e){const t=this._parse(e);return Tk(e._query,t),new Hi(e.firestore,e.converter,s0(e._query,t))}_parse(e){const t=$d(e.firestore);return function(o,a,u,d,f,g,y){let x;if(f.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new _e(le.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){G_(y,g);const E=[];for(const S of y)E.push(W_(d,o,S));x={arrayValue:{values:E}}}else x=W_(d,o,y)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||G_(y,g),x=nM(u,a,y,g==="in"||g==="not-in");return st.create(f,g,x)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function ot(n,e,t){const r=e,s=tp("where",n);return np._create(s,r,t)}class Yx extends Kx{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Yx(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:xt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,o){let a=s;const u=o.getFlattenedFilters();for(const d of u)Tk(a,d),a=s0(a,d)}(e._query,t),new Hi(e.firestore,e.converter,s0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Xx extends Qx{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Xx(e,t)}_apply(e){const t=function(s,o,a){if(s.startAt!==null)throw new _e(le.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new _e(le.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new yd(o,a)}(e._query,this._field,this._direction);return new Hi(e.firestore,e.converter,function(s,o){const a=s.explicitOrderBy.concat([o]);return new Ac(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function si(n,e="asc"){const t=e,r=tp("orderBy",n);return Xx._create(r,t)}class Jx extends Qx{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Jx(e,t,r)}_apply(e){return new Hi(e.firestore,e.converter,nm(e._query,this._limit,this._limitType))}}function Ek(n){return Jx._create("limit",n,"F")}function W_(n,e,t){if(typeof(t=Lt(t))=="string"){if(t==="")throw new _e(le.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!XE(e)&&t.indexOf("/")!==-1)throw new _e(le.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(pt.fromString(t));if(!Ee.isDocumentKey(r))throw new _e(le.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return pd(n,new Ee(r))}if(t instanceof Wn)return pd(n,t._key);throw new _e(le.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Xm(t)}.`)}function G_(n,e){if(!Array.isArray(n)||n.length===0)throw new _e(le.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Tk(n,e){const t=function(s,o){for(const a of s)for(const u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new _e(le.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new _e(le.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class iM{convertValue(e,t="none"){switch(Oo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Mt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Di(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ce(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ho(e,(s,o)=>{r[s]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,s;const o=(s=(r=(t=e.fields)===null||t===void 0?void 0:t[ac].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>Mt(a.doubleValue));return new Bx(o)}convertGeoPoint(e){return new Ux(Mt(e.latitude),Mt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Vm(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(fd(e));default:return null}}convertTimestamp(e){const t=ji(e);return new mt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=pt.fromString(e);Me(ET(r),9688,{name:e});const s=new Oa(r.get(1),r.get(3)),o=new Ee(r.popFirst(5));return s.isEqual(t)||Qt(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}function oM(){return new Y5("count")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class kk extends Sk{constructor(e,t,r,s,o,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ff(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(tp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Ff extends kk{data(e={}){return super.data(e)}}class Ak{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Bu(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Ff(this._firestore,this._userDataWriter,r.key,r,new Bu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new _e(le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,o){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(u=>{const d=new Ff(s._firestore,s._userDataWriter,u.doc.key,u.doc,new Bu(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);return u.doc,{type:"added",doc:d,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const d=new Ff(s._firestore,s._userDataWriter,u.doc.key,u.doc,new Bu(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);let f=-1,g=-1;return u.type!==0&&(f=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),g=a.indexOf(u.doc.key)),{type:aM(u.type),doc:d,oldIndex:f,newIndex:g}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function aM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ce(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(n){n=Pn(n,Wn);const e=Pn(n.firestore,fs);return B5(jc(e),n._key).then(t=>Nk(e,n,t))}class rp extends iM{constructor(e){super(),this.firestore=e}convertBytes(e){return new xc(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Wn(this.firestore,null,t)}}function St(n){n=Pn(n,Hi);const e=Pn(n.firestore,fs),t=jc(e),r=new rp(e);return Ik(n._query),$5(t,n._query).then(s=>new Ak(e,r,n,s))}function lM(n,e,t){n=Pn(n,Wn);const r=Pn(n.firestore,fs),s=Zx(n.converter,e,t);return Hd(r,[$x($d(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,hn.none())])}function Mc(n,e,t,...r){n=Pn(n,Wn);const s=Pn(n.firestore,fs),o=$d(s);let a;return a=typeof(e=Lt(e))=="string"||e instanceof Ud?vk(o,"updateDoc",n._key,e,t,r):xk(o,"updateDoc",n._key,e),Hd(s,[a.toMutation(n._key,hn.exists(!0))])}function sp(n){return Hd(Pn(n.firestore,fs),[new Od(n._key,hn.none())])}function qd(n,e){const t=Pn(n.firestore,fs),r=Ot(n),s=Zx(n.converter,e);return Hd(t,[$x($d(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,hn.exists(!1))]).then(()=>r)}function Ck(n,...e){var t,r,s;n=Lt(n);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||H_(e[a])||(o=e[a],a++);const u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(H_(e[a])){const y=e[a];e[a]=(t=y.next)===null||t===void 0?void 0:t.bind(y),e[a+1]=(r=y.error)===null||r===void 0?void 0:r.bind(y),e[a+2]=(s=y.complete)===null||s===void 0?void 0:s.bind(y)}let d,f,g;if(n instanceof Wn)f=Pn(n.firestore,fs),g=Md(n._key.path),d={next:y=>{e[a]&&e[a](Nk(f,n,y))},error:e[a+1],complete:e[a+2]};else{const y=Pn(n,Hi);f=Pn(y.firestore,fs),g=y._query;const x=new rp(f);d={next:w=>{e[a]&&e[a](new Ak(f,x,y,w))},error:e[a+1],complete:e[a+2]},Ik(n._query)}return function(x,w,E,S){const A=new Vx(S),N=new jx(w,A,E);return x.asyncQueue.enqueueAndForget(async()=>Nx(await mm(x),N)),()=>{A.xu(),x.asyncQueue.enqueueAndForget(async()=>Rx(await mm(x),N))}}(jc(f),g,u,d)}function Hd(n,e){return function(r,s){const o=new Ls;return r.asyncQueue.enqueueAndForget(async()=>b5(await z5(r),s,o)),o.promise}(jc(n),e)}function Nk(n,e,t){const r=t.docs.get(e._key),s=new rp(n);return new kk(n,s,e._key,r,new Bu(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(n){return cM(n,{count:oM()})}function cM(n,e){const t=Pn(n.firestore,fs),r=jc(t),s=gD(e,(o,a)=>new BD(a,o.aggregateType,o._internalFieldPath));return q5(r,n._query,s).then(o=>function(u,d,f){const g=new rp(u);return new X5(d,g,f)}(t,n,o))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=$d(e)}set(e,t,r){this._verifyNotCommitted();const s=ly(e,this._firestore),o=Zx(s.converter,t,r),a=$x(this._dataReader,"WriteBatch.set",s._key,o,s.converter!==null,r);return this._mutations.push(a.toMutation(s._key,hn.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const o=ly(e,this._firestore);let a;return a=typeof(t=Lt(t))=="string"||t instanceof Ud?vk(this._dataReader,"WriteBatch.update",o._key,t,r,s):xk(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(a.toMutation(o._key,hn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ly(e,this._firestore);return this._mutations=this._mutations.concat(new Od(t._key,hn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new _e(le.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ly(n,e){if((n=Lt(n)).firestore!==e)throw new _e(le.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Gn(){return new qx("serverTimestamp")}function dM(...n){return new Hx("arrayUnion",n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vc(n){return jc(n=Pn(n,fs)),new uM(n,e=>Hd(n,e))}(function(e,t=!0){(function(s){kc=s})(Tc),Pa(new Lo("firestore",(r,{instanceIdentifier:s,options:o})=>{const a=r.getProvider("app").getImmediate(),u=new fs(new jj(r.getProvider("auth-internal")),new Lj(a,r.getProvider("app-check-internal")),function(f,g){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new _e(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Oa(f.options.projectId,g)}(a,s),a);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),ei(E1,T1,e),ei(E1,T1,"esm2017")})();var hM="firebase",fM="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ei(hM,fM,"app");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM{constructor(e,t,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,sr(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(o=>this.auth=o,()=>{}),this.messaging||r.get().then(o=>this.messaging=o,()=>{}),this.appCheck||s==null||s.get().then(o=>this.appCheck=o,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v0="us-central1";class pM{constructor(e,t,r,s,o=v0,a=(...u)=>fetch(...u)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new mM(e,t,r,s),this.cancelAllRequests=new Promise(u=>{this.deleteService=()=>Promise.resolve(u())});try{const u=new URL(o);this.customDomain=u.origin+(u.pathname==="/"?"":u.pathname),this.region=v0}catch{this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function gM(n,e,t){const r=Ga(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(O0(n.emulatorOrigin),F0("Functions",!0))}const K_="@firebase/functions",Q_="0.12.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yM="auth-internal",xM="app-check-internal",vM="messaging-internal";function wM(n){const e=(t,{instanceIdentifier:r})=>{const s=t.getProvider("app").getImmediate(),o=t.getProvider(yM),a=t.getProvider(vM),u=t.getProvider(xM);return new pM(s,o,a,u,r)};Pa(new Lo(Rk,e,"PUBLIC").setMultipleInstances(!0)),ei(K_,Q_,n),ei(K_,Q_,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bM(n=Cm(),e=v0){const r=Am(Lt(n),Rk).getImmediate({identifier:e}),s=hI("functions");return s&&_M(r,...s),r}function _M(n,e,t){gM(Lt(n),e,t)}wM();const SM={apiKey:"AIzaSyBuuhiNfinjIqySaRYXIAW9qBqA1706Kzo",authDomain:"agwa-wsi.firebaseapp.com",projectId:"agwa-wsi",storageBucket:"gwa-wsi.appspot.com",messagingSenderId:"852740116552",appId:"1:852740116552:web:e5fc6b0735d85e0af8887d",measurementId:`G-78DWK78P2B
`};let wd;ZN().length?wd=Cm():wd=bI(SM);const Su=Cj(wd),Kt=G5(wd);bM(wd);console.log(" Connecting to Production Firebase Services ");K5(Kt).then(()=>{console.log("Firestore offline persistence enabled for multiple tabs.")}).catch(n=>{n.code==="failed-precondition"?console.warn("Firestore offline persistence failed: Multiple tabs open or other issues."):n.code==="unimplemented"&&console.warn("Firestore offline persistence failed: Browser does not support all features.")});const IM="c_0e480e34ffaa3f81_agwa_water_services_app-268",EM=()=>typeof __app_id<"u"&&__app_id!==null&&__app_id!==""?__app_id:IM,Pk=EM(),TM=()=>`artifacts/${Pk}/users`,ip=n=>`${TM()}/${n}/profile/data`,Ya=()=>`artifacts/${Pk}/public/data`,jr=()=>`${Ya()}/profiles`,Lc=()=>`${Ya()}/support_tickets`,op=n=>`${Lc()}/${n}`,Wd=()=>`${Ya()}/announcements`,jk=n=>`${Wd()}/${n}`,ap=()=>`${Ya()}/system_config/settings`,Mi=()=>`${Ya()}/all_bills`,kM=n=>`${Mi()}/${n}`,Go=()=>`${Ya()}/all_meter_readings`,Dk=n=>`${Go()}/${n}`,bd=()=>`${Ya()}/meter_routes`,Xa=n=>{let e=n.message||"An unknown authentication error occurred.";return n.code&&(e=n.code.replace("auth/","").replace(/-/g," "),e=e.charAt(0).toUpperCase()+e.slice(1)+".",(n.code==="auth/invalid-credential"||n.code==="auth/wrong-password"||n.code==="auth/user-not-found")&&(e="Invalid credentials. Please check your email and password."),n.code==="auth/email-already-in-use"&&(e="This email address is already registered. Please try logging in.")),console.error("Auth Service Error:",n.code,n.message),e},AM=async(n,e,t)=>{try{return{success:!0,userCredential:await dP(n,e,t)}}catch(r){return{success:!1,error:Xa(r)}}},CM=async(n,e,t)=>{try{return{success:!0,userCredential:await hP(n,e,t)}}catch(r){return{success:!1,error:Xa(r)}}},NM=async n=>{try{const e=new Ti;return{success:!0,userCredential:await FP(n,e)}}catch(e){return{success:!1,error:Xa(e)}}},RM=async(n,e,t)=>{try{return await fP(n,e,t),window.localStorage.setItem("emailForSignIn",e),{success:!0,message:`Sign-in link sent to ${e}!`}}catch(r){return{success:!1,error:Xa(r)}}},PM=async(n,e,t)=>{if(KI(n,t))try{const r=await mP(n,e,t);return window.localStorage.removeItem("emailForSignIn"),{success:!0,userCredential:r}}catch(r){return{success:!1,error:Xa(r)}}return{success:!1,error:"Not a valid sign-in-with-email-link request."}},jM=async(n,e)=>{try{return await uP(n,e),{success:!0,message:"Password reset email sent!"}}catch(t){return{success:!1,error:Xa(t)}}},DM=async n=>{try{return await xP(n),{success:!0,message:"Logged out successfully."}}catch(e){return{success:!1,error:Xa(e)}}},Mk=(n,e,t='1/2"',r={})=>{let s=0,o=0,a=0,u=0,d=0,f=0,g=0,y=0;const x=parseFloat(n)||0,w={fcdaPercentage:1.29,environmentalChargePercentage:25,sewerageChargePercentageCommercial:32.85,governmentTaxPercentage:2,vatPercentage:12},E={...w,...r},S=(E.fcdaPercentage||w.fcdaPercentage)/100,A=(E.environmentalChargePercentage||w.environmentalChargePercentage)/100,N=(E.sewerageChargePercentageCommercial||w.sewerageChargePercentageCommercial)/100,z=(E.governmentTaxPercentage||w.governmentTaxPercentage)/100,U=(E.vatPercentage||w.vatPercentage)/100,W=String(t).replace(/["]/g,"").trim();if(W==="1/2"||W==="15mm"?d=1.5:W==="3/4"||W==="20mm"?d=2:W==="1"||W==="25mm"?d=3:W==="1 1/4"||W==="40mm"||W==="1 1/2"||W==="32mm"?d=4:W==="2"||W==="50mm"?d=6:W==="3"||W==="75mm"?d=10:W==="4"||W==="100mm"?d=20:W==="6"||W==="150mm"?d=35:W==="8"||W==="200mm"?d=50:d=1.5,e==="Residential Low-Income")if(x<=10)s=70.07;else if(x<=20)s=70.07+(x-10)*14.29;else{s=70.07+10*14.29;let k=x-20;k>0&&(k<=10?s+=k*23.82:k<=20?s+=10*23.82+(k-10)*45.17:s+=10*23.82+10*45.17+(k-20)*59.54)}else if(e==="Residential")x<=10?s=195.49:x<=20?s=195.49+(x-10)*23.82:x<=30?s=195.49+10*23.82+(x-20)*45.17:x<=50?s=195.49+10*23.82+10*45.17+(x-30)*59.54:x<=70?s=195.49+10*23.82+10*45.17+20*59.54+(x-50)*69.52:x<=90?s=195.49+10*23.82+10*45.17+20*59.54+20*69.52+(x-70)*72.89:x<=140?s=195.49+10*23.82+10*45.17+20*59.54+20*69.52+20*72.89+(x-90)*76.14:x<=200?s=195.49+10*23.82+10*45.17+20*59.54+20*69.52+20*72.89+50*76.14+(x-140)*79.42:s=195.49+10*23.82+10*45.17+20*59.54+20*69.52+20*72.89+50*76.14+60*79.42+(x-200)*82.67;else if(e==="Semi-Business")if(x<=10)s=195.49;else{s=195.49;let k=x-10;k<=10?s+=k*39.9:k<=30?s+=10*39.9+(k-10)*49.22:k<=50?s+=10*39.9+20*49.22+(k-30)*62.55:k<=70?s+=10*39.9+20*49.22+20*62.55+(k-50)*72.88:k<=120?s+=10*39.9+20*49.22+20*62.55+20*72.88+(k-70)*76.14:k<=170?s+=10*39.9+20*49.22+20*62.55+20*72.88+50*76.14+(k-120)*79.42:s+=10*39.9+20*49.22+20*62.55+20*72.88+50*76.14+50*79.42+(k-170)*82.67}else if(e==="Commercial"||e==="Admin"){const k=[{limit:10,rate:0,fixed:512.3},{limit:20,rate:53.61},{limit:40,rate:58.98},{limit:60,rate:64.33},{limit:80,rate:69.69},{limit:100,rate:72.88},{limit:150,rate:76.14},{limit:200,rate:79.42},{limit:1/0,rate:82.67}];let P=x;s=0,P>0&&k[0].fixed&&(s+=k[0].fixed,P-=k[0].limit);for(let T=1;T<k.length&&!(P<=0);T++){const D=k[T-1].limit,L=k[T].limit-D,C=Math.min(P,L);s+=C*k[T].rate,P-=C}}else e==="Industrial"||e==="Meter Reading Personnel"?s=x*72.68:x<=10?s=195.49:s=195.49+(x-10)*23.82;o=s*S,y=s+o,a=y*A,e==="Commercial"||e==="Industrial"||e==="Admin"||e==="Meter Reading Personnel"?u=y*N:u=0;const $=y+a+u+d;f=$*z;const F=$;g=F*U;const R=F+f+g;return{consumption:x,serviceType:e,meterSize:W,basicCharge:parseFloat(s.toFixed(2)),fcda:parseFloat(o.toFixed(2)),waterCharge:parseFloat(y.toFixed(2)),environmentalCharge:parseFloat(a.toFixed(2)),sewerageCharge:parseFloat(u.toFixed(2)),maintenanceServiceCharge:parseFloat(d.toFixed(2)),subTotalBeforeTaxes:parseFloat(F.toFixed(2)),governmentTaxes:parseFloat(f.toFixed(2)),vatableSales:parseFloat(F.toFixed(2)),vat:parseFloat(g.toFixed(2)),totalCalculatedCharges:parseFloat(R.toFixed(2))}},gm=n=>{if(!n||typeof n!="string")return{serviceType:"Residential",role:"customer"};const e=n.toUpperCase().trim();return e.startsWith("ADM")?{serviceType:"Admin",role:"admin"}:e.startsWith("PER")?{serviceType:"Meter Reading Personnel",role:"meter_reader"}:e.startsWith("CLK")?{serviceType:"Clerk Operations",role:"clerk_cashier"}:e.startsWith("RES-LI")?{serviceType:"Residential Low-Income",role:"customer"}:e.startsWith("RES")?{serviceType:"Residential",role:"customer"}:e.startsWith("COM")?{serviceType:"Commercial",role:"customer"}:e.startsWith("IND")?{serviceType:"Industrial",role:"customer"}:{serviceType:"Residential",role:"customer"}},MM=n=>`https://placehold.co/100x100/3b82f6/FFFFFF?text=${n?n.charAt(0).toUpperCase():"A"}`,bt=(n,e={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})=>{if(!n)return"N/A";let t;if(n.toDate&&typeof n.toDate=="function")t=n.toDate();else if(n instanceof Date)t=n;else if(typeof n=="string"||typeof n=="number")t=new Date(n);else return"Invalid Date";if(isNaN(t.getTime()))return"Invalid Date";try{return new Intl.DateTimeFormat("en-US",e).format(t)}catch{return"Invalid Date"}},Ke=(n,e)=>(console.error(`Firestore Error in ${n}:`,e.code,e.message),{success:!1,error:`An error occurred in ${n}. Code: ${e.code}. Please check Firestore rules and indexes. If the error is 'failed-precondition', you likely need to create a database index in the Firebase console.`}),LM=async(n,e,t)=>{try{const r=vc(n);return e.forEach(s=>{const o=Ot(n,op(s));r.update(o,{status:t,lastUpdatedAt:Gn()})}),await r.commit(),{success:!0}}catch(r){return Ke("batchUpdateTicketStatus",r)}},OM=async(n,e)=>{try{const t=vc(n),r=Ot(n,jr(),e),s=Ot(n,ip(e));return t.delete(r),t.delete(s),await t.commit(),{success:!0}}catch(t){return Ke("deleteUserProfile",t)}},lp=async(n,e)=>{try{const t=await St(at(n,e)),r=500;let s=0,o=vc(n);for(const a of t.docs)o.delete(a.ref),s++,s%r===0&&(await o.commit(),o=vc(n));return s%r!==0&&await o.commit(),{success:!0,count:s}}catch(t){return Ke(`deleteAllFromCollection: ${e}`,t)}},FM=n=>lp(n,Lc()),VM=n=>lp(n,Mi()),zM=n=>lp(n,Go()),UM=n=>lp(n,Wd()),BM=async(n,e,t)=>{if(!t||!e)return{success:!1,error:"User ID and Account Number are required."};try{const r=t.toUpperCase(),s=at(n,jr()),o=ft(s,ot("accountNumber","==",r)),a=await St(o);if(a.empty)return{success:!1,error:"This Account Number was not found in our records. Please check and try again."};const d=a.docs[0].data();if(d.uid&&d.uid!==e)return{success:!1,error:"This account is already linked to another user. Please contact support."};const{role:f,serviceType:g}=gm(r),y={accountNumber:r,role:f,serviceType:g,meterSerialNumber:d.meterSerialNumber||"",serviceAddress:d.serviceAddress||{street:"",barangay:"",district:"",landmark:""}};return await Ql(n,e,y)}catch(r){return Ke("linkAccountNumberToProfile",r)}},$M=async n=>{try{const e=at(n,jr()),t=await St(e),r=new Set;return t.docs.forEach(s=>{var a;const o=(a=s.data().serviceAddress)==null?void 0:a.barangay;o&&r.add(o)}),{success:!0,data:Array.from(r).sort()}}catch(e){return Ke("getUniqueServiceLocations",e)}},qM=async(n,e)=>{try{const t=at(n,jr()),r=ft(t,ot("serviceAddress.barangay","==",e));return{success:!0,data:(await St(r)).docs.map(a=>a.data().accountNumber).filter(Boolean)}}catch(t){return Ke("getAccountsByLocation",t)}},HM=async(n,e,t=null)=>{try{if(t){const r=Ot(n,bd(),t);await Mc(r,{...e,updatedAt:Gn()})}else await qd(at(n,bd()),{...e,createdAt:Gn()});return{success:!0}}catch(r){return Ke("createOrUpdateMeterRoute",r)}},WM=async n=>{try{const e=ft(at(n,bd()),si("name","asc"));return{success:!0,data:(await St(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return Ke("getAllMeterRoutes",e)}},GM=async(n,e)=>{try{return await sp(Ot(n,bd(),e)),{success:!0}}catch(t){return Ke("deleteMeterRoute",t)}},KM=async n=>{try{const e=ft(at(n,jr()),ot("role","==","meter_reader"));return{success:!0,data:(await St(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return Ke("getAllMeterReaders",e)}},QM=async n=>{try{const e=ft(at(n,Mi()),ot("status","==","Paid")),t=await St(e),r={};t.forEach(o=>{var f;const a=o.data(),u=(f=a.paymentDate)!=null&&f.toDate?a.paymentDate.toDate():new Date,d=`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}`;r[d]=(r[d]||0)+(a.amountPaid||0)});const s=Object.entries(r).sort(([o],[a])=>o.localeCompare(a)).slice(-12);return{success:!0,data:Object.fromEntries(s)}}catch(e){return Ke("getRevenueStats",e)}},YM=async n=>{try{const e=ft(at(n,Mi()),ot("status","==","Paid")),t=await St(e),r={Sun:0,Mon:0,Tue:0,Wed:0,Thu:0,Fri:0,Sat:0};return t.forEach(s=>{var u;const o=s.data(),a=(u=o.paymentDate)!=null&&u.toDate?o.paymentDate.toDate():null;if(a){const d=a.getDay(),f=Object.keys(r)[d];r[f]++}}),{success:!0,data:r}}catch(e){return Ke("getPaymentDayOfWeekStats",e)}},XM=async(n,e,t)=>{try{const r=at(n,Go()),s=ft(r,ot("readerId","==",e),ot("readingDateString","==",t));return{success:!0,data:{count:(await ki(s)).data().count}}}catch(r){return Ke("getReadingsCountByReaderForDate",r)}},JM=async(n,e)=>{if(!e||!e.accountNumbers||e.accountNumbers.length===0)return{success:!0,data:[]};try{const t=e.accountNumbers,r=at(n,jr()),s=[];for(let o=0;o<t.length;o+=30){const a=t.slice(o,o+30),u=ft(r,ot("accountNumber","in",a));(await St(u)).forEach(f=>s.push({id:f.id,...f.data()}))}return{success:!0,data:s}}catch(t){return Ke("getAccountsInRoute",t)}},ZM=async(n,e)=>{try{const t=Ot(n,jr(),e),r=await ev(t);return r.exists()?{success:!0,data:{id:r.id,...r.data()}}:{success:!1,error:"User profile not found."}}catch(t){return Ke("getUserProfile",t)}},cp=async(n,e)=>{if(!e||!e.trim())return{success:!1,error:"Search term cannot be empty."};const t=e.toLowerCase();try{const r=at(n,jr()),s=[ft(r,ot("accountNumber","==",e.toUpperCase())),ft(r,ot("email","==",t)),ft(r,ot("meterSerialNumber","==",t)),ft(r,ot("displayNameLower",">=",t),ot("displayNameLower","<=",t+""))],o=await Promise.all(s.map(u=>St(u))),a=new Map;return o.forEach(u=>{u.forEach(d=>{a.has(d.id)||a.set(d.id,{id:d.id,...d.data()})})}),{success:!0,data:Array.from(a.values())}}catch(r){return Ke("searchUserProfiles",r)}},Lk=async(n,e,t)=>{try{const r=ft(at(n,Go()),ot("userId","==",e),si("readingDate","desc"),Ek(2)),s=await St(r);if(s.docs.length<2)return{success:!1,error:"Cannot generate bill. At least two meter readings are required to calculate consumption."};const o=s.docs[0].data(),a=s.docs[1].data(),u=o.readingValue-a.readingValue;if(u<0)return{success:!1,error:"Cannot generate bill. The latest reading value is less than the previous one."};const d=new Date(o.readingDate.toDate()).toLocaleString("default",{month:"long",year:"numeric"}),f=ft(at(n,Mi()),ot("userId","==",e),ot("monthYear","==",d));if(!(await St(f)).empty)return{success:!1,error:`A bill for ${d} already exists for this user.`};const y=await tv(n),x=y.success?y.data:{},w=Mk(u,t.serviceType,t.meterSize,x),E=o.readingDate.toDate(),S=new Date(E);S.setDate(S.getDate()+15);const A={userId:e,accountNumber:t.accountNumber,userName:t.displayName,billingPeriod:`${Y_(a.readingDate.toDate())} - ${Y_(o.readingDate.toDate())}`,monthYear:d,billDate:mt.fromDate(E),dueDate:mt.fromDate(S),previousReading:a.readingValue,currentReading:o.readingValue,consumption:u,...w,amount:w.totalCalculatedCharges,previousUnpaidAmount:0,totalAmountDue:w.totalCalculatedCharges,status:"Unpaid",createdAt:Gn()};return await qd(at(n,Mi()),A),{success:!0,message:`Bill for ${d} generated successfully!`}}catch(r){return Ke("generateBillForUser",r)}},eL=async(n,e)=>{try{const t=ft(at(n,jr()),ot("serviceAddress.barangay","==",e)),r=await St(t);if(r.empty)return{success:!0,data:[]};const s=[];for(const o of r.docs){const a={id:o.id,...o.data()},u=ft(at(n,Go()),ot("userId","==",a.id),si("readingDate","desc"),Ek(2)),d=await St(u);if(d.docs.length<2)continue;const f=d.docs[0].data(),g=new Date(f.readingDate.toDate()).toLocaleString("default",{month:"long",year:"numeric"}),y=ft(at(n,Mi()),ot("userId","==",a.id),ot("monthYear","==",g));(await St(y)).empty&&s.push(a)}return{success:!0,data:s}}catch(t){return Ke("getBillableAccountsInLocation",t)}},tL=async(n,e)=>{const t=[];for(const r of e){const s=await Lk(n,r.id,r);s.success?t.push({success:!0,message:`SUCCESS: Bill generated for ${r.accountNumber} - ${s.message}`}):t.push({success:!1,message:`FAILED: Bill for ${r.accountNumber} - ${s.error}`})}return t},Y_=n=>new Date(n).toLocaleDateString("en-US"),nL=async(n,e,t)=>{try{const r=vc(n);t.accountNumber&&(t.accountNumber=t.accountNumber.toUpperCase());const s={...t,uid:e,createdAt:Gn(),lastLoginAt:Gn(),displayNameLower:t.displayName?t.displayName.toLowerCase():""},o=Ot(n,ip(e));r.set(o,s);const a=Ot(n,jr(),e);return r.set(a,s),await r.commit(),{success:!0}}catch(r){return Ke("createUserProfile",r)}},Ql=async(n,e,t)=>{try{const r=vc(n);t.accountNumber&&(t.accountNumber=t.accountNumber.toUpperCase()),t.displayName&&(t.displayNameLower=t.displayName.toLowerCase());const s={...t,updatedAt:Gn()};return r.update(Ot(n,ip(e)),s),r.update(Ot(n,jr(),e),s),await r.commit(),{success:!0}}catch(r){return Ke("updateUserProfile",r)}},rL=async n=>{try{const e=at(n,jr());return{success:!0,data:(await St(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return Ke("getAllUsersProfiles",e)}},sL=async(n,e)=>{try{const t=at(n,Lc());return{success:!0,id:(await qd(t,{...e,status:"Open",submittedAt:Gn(),conversation:[]})).id}}catch(t){return Ke("createSupportTicket",t)}},iL=async(n,e)=>{try{return await sp(Ot(n,op(e))),{success:!0}}catch(t){return Ke("deleteSupportTicket",t)}},Ok=async(n,e,t)=>{try{const r=Ot(n,op(e)),s={conversation:dM(t),lastUpdatedAt:Gn()};return t.authorRole!=="admin"&&(s.status="In Progress"),await Mc(r,s),{success:!0}}catch(r){return Ke("addTicketReply",r)}},X_=async n=>{try{const e=ft(at(n,Lc()),si("submittedAt","desc"));return{success:!0,data:(await St(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return Ke("getAllSupportTickets",e)}},Fk=async(n,e)=>{try{const t=ft(at(n,Lc()),ot("userId","==",e),si("submittedAt","desc"));return{success:!0,data:(await St(t)).docs.map(s=>({id:s.id,...s.data()}))}}catch(t){return Ke("getTicketsByReporter",t)}},oL=async(n,e,t)=>{try{const r=Ot(n,op(e));return await Mc(r,{...t,lastUpdatedAt:Gn()}),{success:!0}}catch(r){return Ke("updateSupportTicket",r)}},aL=async(n,e)=>{try{return await qd(at(n,Wd()),{...e,createdAt:Gn()}),{success:!0}}catch(t){return Ke("createAnnouncement",t)}},lL=async(n,e=!1)=>{try{const t=at(n,Wd()),r=e?[ot("status","==","active"),si("createdAt","desc")]:[si("createdAt","desc")],s=ft(t,...r);return{success:!0,data:(await St(s)).docs.map(a=>({id:a.id,...a.data()}))}}catch(t){return Ke("getAllAnnouncements",t)}},J_=async(n,e,t)=>{try{return await Mc(Ot(n,jk(e)),{...t,updatedAt:Gn()}),{success:!0}}catch(r){return Ke("updateAnnouncement",r)}},cL=async(n,e)=>{try{return await sp(Ot(n,jk(e))),{success:!0}}catch(t){return Ke("deleteAnnouncement",t)}},tv=async n=>{try{const e=await ev(Ot(n,ap()));return{success:!0,data:e.exists()?e.data():{}}}catch(e){return Ke("getSystemSettings",e)}},uL=async(n,e)=>{try{return await lM(Ot(n,ap()),e,{merge:!0}),{success:!0}}catch(t){return Ke("updateSystemSettings",t)}},up=async(n,e)=>{try{const t=ft(at(n,Mi()),ot("userId","==",e));return{success:!0,data:(await St(t)).docs.map(s=>({id:s.id,...s.data()}))}}catch(t){return Ke("getBillsForUser",t)}},Vk=async(n,e,t)=>{try{return await Mc(Ot(n,kM(e)),{...t,lastUpdatedAt:Gn()}),{success:!0}}catch(r){return Ke("updateBill",r)}},zk=async(n,e)=>{try{const t=new Date(e.readingDate),r={...e,readingDate:mt.fromDate(t),readingDateString:e.readingDate,recordedAt:Gn()};return{success:!0,id:(await qd(at(n,Go()),r)).id}}catch(t){return Ke("addMeterReading",t)}},dL=async(n,e,t)=>{try{const r=Ot(n,Dk(e));return t.readingDate&&typeof t.readingDate=="string"&&(t.readingDate=mt.fromDate(new Date(t.readingDate))),await Mc(r,{...t,lastUpdatedAt:Gn()}),{success:!0}}catch(r){return Ke("updateMeterReading",r)}},hL=async(n,e)=>{try{return await sp(Ot(n,Dk(e))),{success:!0}}catch(t){return Ke("deleteMeterReading",t)}},fL=async(n,e)=>{try{const t=ft(at(n,Go()),ot("accountNumber","==",e),si("readingDate","desc"));return{success:!0,data:(await St(t)).docs.map(s=>({id:s.id,...s.data()}))}}catch(t){return Ke("getMeterReadingsForAccount",t)}},Uk=async(n,e)=>{try{const t=ft(at(n,bd()),ot("assignedReaderId","==",e),si("name"));return{success:!0,data:(await St(t)).docs.map(s=>({id:s.id,...s.data()}))}}catch(t){return Ke("getRoutesForReader",t)}},mL=async(n,e,t=[])=>{try{const r=ft(at(n,e),...t);return{success:!0,data:(await St(r)).docs.map(o=>({id:o.id,...o.data()}))}}catch(r){return Ke(`getDocuments from ${e}`,r)}},Bk=async n=>{try{const e=at(n,jr()),t=await ki(e),s=(await St(e)).docs.reduce((o,a)=>{const u=a.data().role||"unknown";return o[u]=(o[u]||0)+1,o},{});return{success:!0,data:{total:t.data().count,byRole:s}}}catch(e){return Ke("getUsersStats",e)}},$k=async n=>{try{const e=at(n,Lc()),t=await ki(e),r=ft(e,ot("status","==","Open")),s=ft(e,ot("status","==","In Progress")),o=ft(e,ot("status","==","Resolved")),a=ft(e,ot("status","==","Closed")),[u,d,f,g]=await Promise.all([ki(r),ki(s),ki(o),ki(a)]);return{success:!0,data:{total:t.data().count,open:u.data().count,inProgress:d.data().count,resolved:f.data().count,closed:g.data().count}}}catch(e){return Ke("getTicketsStats",e)}},pL=async n=>{try{const e=at(n,Wd()),t=await ki(e),r=ft(e,ot("status","==","active")),s=await ki(r);return{success:!0,data:{total:t.data().count,active:s.data().count}}}catch(e){return Ke("getAnnouncementsStats",e)}},gL=async(n,e)=>{try{const t=new Date,r=mt.fromDate(new Date(new Date().setHours(0,0,0,0))),s=mt.fromDate(new Date(new Date().setHours(23,59,59,999))),o=at(n,Mi()),a=ft(o,ot("processedByClerkId","==",e),ot("paymentTimestamp",">=",r),ot("paymentTimestamp","<=",s)),u=await St(a);let d=0;const f=u.docs.map(y=>{const x=y.data();return d+=x.amountPaid||0,{id:y.id,...x}});return{success:!0,data:{paymentsTodayCount:u.size,totalCollectedToday:d,transactions:f.sort((y,x)=>x.paymentTimestamp.toDate()-y.paymentTimestamp.toDate())}}}catch(t){return Ke("getPaymentsByClerkForToday",t)}};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yL=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qk=(...n)=>n.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var xL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vL=B.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:o,iconNode:a,...u},d)=>B.createElement("svg",{ref:d,...xL,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:qk("lucide",s),...u},[...a.map(([f,g])=>B.createElement(f,g)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=(n,e)=>{const t=B.forwardRef(({className:r,...s},o)=>B.createElement(vL,{ref:o,iconNode:e,className:qk(`lucide-${yL(n)}`,r),...s}));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ym=Se("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wL=Se("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xm=Se("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nv=Se("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hk=Se("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wk=Se("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wc=Se("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bL=Se("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _L=Se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SL=Se("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=Se("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gk=Se("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IL=Se("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rv=Se("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=Se("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EL=Se("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TL=Se("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sv=Se("ClipboardPen",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",key:"1oijnt"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5",key:"cereej"}],["path",{d:"M4 13.5V6a2 2 0 0 1 2-2h2",key:"5ua5vh"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bc=Se("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kL=Se("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=Se("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AL=Se("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CL=Se("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vm=Se("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=Se("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NL=Se("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RL=Se("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iv=Se("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=Se("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PL=Se("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=Se("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jL=Se("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oi=Se("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ov=Se("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=Se("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=Se("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wm=Se("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ML=Se("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const av=Se("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=Se("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LL=Se("ListFilter",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OL=Se("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=Se("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk=Se("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=Se("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _c=Se("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _d=Se("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=Se("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FL=Se("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VL=Se("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wi=Se("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zL=Se("OctagonAlert",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lv=Se("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UL=Se("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cy=Se("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xk=Se("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BL=Se("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cv=Se("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $L=Se("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=Se("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=Se("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=Se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dp=Se("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uv=Se("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=Se("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qL=Se("ShieldQuestion",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=Se("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HL=Se("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dv=Se("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WL=Se("SquareX",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GL=Se("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KL=Se("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=Se("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=Se("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QL=Se("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YL=Se("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XL=Se("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jk=Se("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uy=Se("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=Se("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZL=Se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sc=Se("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eO=Se("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hp=Se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),w0=Do.memo(({message:n,type:e,onClose:t})=>{if(B.useEffect(()=>{if(!n)return;const o=setTimeout(()=>{t()},5e3);return()=>clearTimeout(o)},[t,n,e]),!n)return null;let r="bg-red-500",s=Yt;return e==="success"?(r="bg-green-500",s=Li):e==="warning"?(r="bg-yellow-500",s=Yt):e==="info"&&(r="bg-blue-500",s=Yt),c.jsxs("div",{className:`fixed top-5 right-5 ${r} text-white p-4 rounded-lg shadow-xl flex items-center space-x-3 z-[200] animate-slide-in-right`,role:"alert",children:[c.jsx(s,{size:24,"aria-hidden":"true"}),c.jsx("span",{className:"text-sm font-medium",children:n}),c.jsx("button",{onClick:t,className:"ml-auto p-1 rounded-full hover:bg-white/20 transition-colors","aria-label":"Close notification",children:c.jsx(hp,{size:18})}),c.jsx("style",{jsx:!0,global:!0,children:`
        @keyframes slide-in-right {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        .animate-slide-in-right {
          animation: slide-in-right 0.5s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
        }
      `})]})});w0.displayName="Notification";const Z_=({message:n="Loading..."})=>c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-700 to-indigo-800 flex flex-col justify-center items-center p-4 font-inter text-white selection:bg-blue-300 selection:text-blue-900",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-6xl font-bold tracking-tight mb-2 animate-pulse",children:"AGWA"}),c.jsx("p",{className:"text-blue-200 text-lg italic mb-8",children:"Ensuring Clarity, Sustaining Life."}),c.jsx(Ge,{className:"h-12 w-12 mx-auto animate-spin text-blue-300"}),c.jsx("p",{className:"text-blue-300 text-sm mt-4",children:n})]}),c.jsxs("p",{className:"text-center text-xs text-blue-400 mt-12 absolute bottom-6",children:[" ",new Date().getFullYear()," AGWA Water Services, Inc."]})]}),Zk=Do.memo(({children:n,authError:e,appIdForPaths:t,systemSettings:r={}})=>c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-700 to-indigo-800 flex flex-col justify-center items-center p-4 font-sans selection:bg-blue-300 selection:text-blue-900",children:[c.jsxs("div",{className:"bg-white p-8 sm:p-10 md:p-12 rounded-xl shadow-2xl w-full max-w-md transform transition-all duration-500 ease-out animate-fadeInUp",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-5xl font-bold text-blue-600 tracking-tight",children:"AGWA"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1 italic",children:"Ensuring Clarity, Sustaining Life."})]}),e&&c.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 text-red-700 rounded-lg text-sm text-center animate-shake",role:"alert",children:e}),Do.cloneElement(n,{systemSettings:r})]}),t&&c.jsxs("p",{className:"text-center text-xs text-blue-200 mt-8",children:["App ID (DB): ",c.jsx("span",{className:"font-semibold opacity-80",children:t})]}),c.jsxs("p",{className:"text-center text-xs text-blue-300 mt-2",children:[" ",new Date().getFullYear()," AGWA Water Services, Inc."]}),c.jsx("div",{id:"recaptcha-container",className:"my-2 mx-auto"}),c.jsx("style",{children:`
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .animate-fadeInUp {
        animation: fadeInUp 0.6s ease-out forwards;
      }

      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
      }
      .animate-shake {
        animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
      }
    `})]}));Zk.displayName="AuthFormContainer";function eA(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=eA(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function hv(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=eA(n))&&(r&&(r+=" "),r+=e);return r}const Nr="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none transition duration-200 text-gray-900 placeholder-gray-400 disabled:bg-gray-200 disabled:cursor-not-allowed",Id=n=>hv("w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 active:scale-95 flex items-center justify-center",{"opacity-60 cursor-not-allowed":n}),tA=n=>hv("w-full bg-white hover:bg-gray-100 text-gray-700 font-semibold py-3 px-4 rounded-lg border border-gray-300 shadow-sm hover:shadow transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-opacity-50 flex items-center justify-center space-x-2 active:scale-95",{"opacity-50 cursor-not-allowed":n}),nA=n=>hv("w-full bg-teal-500 hover:bg-teal-600 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-teal-400 focus:ring-opacity-50 flex items-center justify-center space-x-2 active:scale-95",{"opacity-50 cursor-not-allowed":n}),tO=({navigateTo:n,authActionLoading:e,handleLoginExternal:t,handleGoogleSignIn:r,setAuthError:s,systemSettings:o={}})=>{const[a,u]=B.useState(""),[d,f]=B.useState(""),[g,y]=B.useState(!1),x=async N=>{if(N.preventDefault(),!a||!d){s&&s("Please enter both email and password.");return}s&&s(""),await t(a,d)},w=async()=>{s&&s(""),await r()},{isGoogleLoginEnabled:E=!0,isPasswordlessLoginEnabled:S=!0,isSignupEnabled:A=!0}=o;return c.jsxs("form",{onSubmit:x,className:"space-y-5",children:[c.jsxs("div",{className:"relative",children:[c.jsx(Fi,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"email",placeholder:"Email Address *",value:a,onChange:N=>u(N.target.value),className:`${Nr} pl-11`,required:!0,disabled:e,"aria-label":"Email Address"})]}),c.jsxs("div",{className:"relative",children:[c.jsx(wm,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:g?"text":"password",placeholder:"Password *",value:d,onChange:N=>f(N.target.value),className:`${Nr} pl-11`,required:!0,disabled:e,"aria-label":"Password"}),c.jsx("button",{type:"button",onClick:()=>y(!g),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":g?"Hide password":"Show password",disabled:e,children:g?c.jsx(vm,{size:20}):c.jsx(qa,{size:20})})]}),c.jsxs("button",{type:"submit",className:Id(e),disabled:e,children:[e&&c.jsx(Ge,{className:"animate-spin inline mr-2",size:18}),e?"Logging In...":"Login"]}),(E||S)&&c.jsxs("div",{className:"relative my-4",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:"w-full border-t border-gray-300"})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),E&&c.jsxs("button",{type:"button",onClick:w,className:tA(e),disabled:e,children:[c.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"h-5 w-5",onError:N=>N.target.style.display="none"}),c.jsx("span",{children:"Sign in with Google"})]}),S&&c.jsxs("button",{type:"button",onClick:()=>n("passwordlessLogin"),className:nA(e),disabled:e,children:[c.jsx(av,{size:18,className:"mr-2"}),c.jsx("span",{children:"Sign in with Email Link"})]}),c.jsxs("div",{className:"text-sm text-center mt-5 space-y-1.5",children:[A&&c.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",c.jsx("button",{type:"button",onClick:()=>n("signup"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Sign Up"})]}),c.jsx("p",{className:"text-gray-600",children:c.jsx("button",{type:"button",onClick:()=>n("forgotPassword"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Forgot Password?"})})]})]})},nO=({navigateTo:n,authActionLoading:e,handleSignupExternal:t,handleGoogleSignIn:r,setAuthError:s,showNotification:o,systemSettings:a={}})=>{const[u,d]=B.useState(""),[f,g]=B.useState(""),[y,x]=B.useState(""),[w,E]=B.useState(""),[S,A]=B.useState(""),[N,z]=B.useState(!1),[U,W]=B.useState(!1),$=async k=>{if(k.preventDefault(),s(""),!w.trim()){s("Full Name is required."),o("Full Name is required.","warning");return}if(!S.trim()){s("AGWA Account Number is required (e.g., RES-12345, ADM-001)."),o("AGWA Account Number is required.","warning");return}if(f.length<6){s("Password must be at least 6 characters long."),o("Password too short (min. 6 chars).","warning");return}if(f!==y){s("Passwords do not match."),o("Passwords don't match.","warning");return}await t(u,f,w,S)},F=async()=>{await r()},{isGoogleLoginEnabled:R=!0}=a;return c.jsxs("form",{onSubmit:$,className:"space-y-5",children:[c.jsxs("div",{className:"relative",children:[c.jsx(ms,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Full Name *",value:w,onChange:k=>E(k.target.value),className:`${Nr} pl-11`,required:!0,disabled:e,"aria-label":"Full Name"})]}),c.jsxs("div",{className:"relative",children:[c.jsx(Oi,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"AGWA Account Number (e.g., RES-12345) *",value:S,onChange:k=>A(k.target.value),className:`${Nr} pl-11`,required:!0,disabled:e,"aria-label":"AGWA Account Number"})]}),c.jsxs("div",{className:"relative",children:[c.jsx(Fi,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"email",placeholder:"Email Address *",value:u,onChange:k=>d(k.target.value),className:`${Nr} pl-11`,required:!0,disabled:e,"aria-label":"Email Address"})]}),c.jsxs("div",{className:"relative",children:[c.jsx(wm,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:N?"text":"password",placeholder:"Password (min. 6 chars) *",value:f,onChange:k=>g(k.target.value),className:`${Nr} pl-11`,required:!0,disabled:e,"aria-label":"Password"}),c.jsx("button",{type:"button",onClick:()=>z(!N),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":N?"Hide password":"Show password",disabled:e,children:N?c.jsx(vm,{size:20}):c.jsx(qa,{size:20})})]}),c.jsxs("div",{className:"relative",children:[c.jsx(wm,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:U?"text":"password",placeholder:"Confirm Password *",value:y,onChange:k=>x(k.target.value),className:`${Nr} pl-11`,required:!0,disabled:e,"aria-label":"Confirm Password"}),c.jsx("button",{type:"button",onClick:()=>W(!U),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":U?"Hide confirm password":"Show confirm password",disabled:e,children:U?c.jsx(vm,{size:20}):c.jsx(qa,{size:20})})]}),c.jsxs("button",{type:"submit",className:Id(e),disabled:e,children:[e&&c.jsx(Ge,{className:"animate-spin inline mr-2",size:18}),e?"Creating Account...":"Create My Account"]}),R&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"relative my-4",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:"w-full border-t border-gray-300"})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or sign up with"})})]}),c.jsxs("button",{type:"button",onClick:F,className:tA(e),disabled:e,children:[c.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"h-5 w-5",onError:k=>k.target.style.display="none"}),c.jsx("span",{children:"Sign up with Google"})]})]}),c.jsxs("p",{className:"text-sm text-center text-gray-600 mt-5",children:["Already have an account?"," ",c.jsx("button",{type:"button",onClick:()=>n("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Login"})]})]})},rO=({handleForgotPasswordExternal:n,navigateTo:e,authActionLoading:t})=>{const[r,s]=B.useState(""),[o,a]=B.useState(!1),u=async d=>{if(d.preventDefault(),!r.trim()){alert("Please enter your email address.");return}await n(r)&&a(!0)};return o?c.jsxs("div",{className:"space-y-5 text-center",children:[c.jsx(Fi,{size:48,className:"mx-auto text-green-500 mb-3"}),c.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Password Reset Email Sent"}),c.jsxs("p",{className:"text-sm text-gray-600",children:["If an account exists for ",c.jsx("strong",{children:r}),", you will receive an email with instructions to reset your password. Please check your inbox (and spam folder)."]}),c.jsxs("button",{type:"button",onClick:()=>e("login"),className:`${Id(!1)} bg-green-600 hover:bg-green-700 focus:ring-green-500 mt-4`,children:[c.jsx(ym,{size:18,className:"mr-2"})," Back to Login"]})]}):c.jsxs("form",{onSubmit:u,className:"space-y-5",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-4 text-center",children:"Enter your email address below, and we'll send you a link to reset your password."}),c.jsxs("div",{className:"relative",children:[c.jsx(Fi,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"email",placeholder:"Enter your Email Address",value:r,onChange:d=>s(d.target.value),className:`${Nr} pl-11`,required:!0,disabled:t,"aria-label":"Email for password reset"})]}),c.jsxs("button",{type:"submit",className:Id(t||!r.trim()),disabled:t||!r.trim(),children:[t?c.jsx(Ge,{className:"animate-spin mr-2",size:20}):null,t?"Sending Link...":"Send Password Reset Link"]}),c.jsx("div",{className:"text-sm text-center mt-6",children:c.jsxs("button",{type:"button",onClick:()=>e("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-50",disabled:t,children:[c.jsx(ym,{size:16,className:"inline mr-1"})," Remembered your password? Login"]})})]})},sO=({handlePasswordlessSignInExternal:n,navigateTo:e,authActionLoading:t})=>{const[r,s]=B.useState(""),[o,a]=B.useState(!1),u=async d=>{if(d.preventDefault(),!r.trim()){alert("Please enter your email address.");return}const f=await n(r);f&&f.success&&a(!0)};return o?c.jsxs("div",{className:"space-y-5 text-center",children:[c.jsx(Li,{size:48,className:"mx-auto text-green-500 mb-3"}),c.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Sign-in Link Sent!"}),c.jsxs("p",{className:"text-sm text-gray-600",children:["A magic sign-in link has been sent to ",c.jsx("strong",{children:r}),". Please check your email and click the link to sign in. The link is valid for a limited time."]}),c.jsxs("button",{type:"button",onClick:()=>e("login"),className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 flex items-center justify-center mt-4",children:[c.jsx(ym,{size:18,className:"mr-2"})," Okay, Got It!"]})]}):c.jsxs("form",{onSubmit:u,className:"space-y-5",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-4 text-center",children:"Enter your email address, and we'll send you a magic link to sign in instantly. No password needed!"}),c.jsxs("div",{className:"relative",children:[c.jsx(Fi,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"email",placeholder:"Enter your Email Address",value:r,onChange:d=>s(d.target.value),className:`${Nr} pl-11`,required:!0,disabled:t,"aria-label":"Email for passwordless sign-in"})]}),c.jsxs("button",{type:"submit",className:nA(t||!r.trim()),disabled:t||!r.trim(),children:[t?c.jsx(Ge,{className:"animate-spin mr-2",size:20}):c.jsx(av,{size:20,className:"mr-2"}),t?"Sending Link...":"Send Sign-in Link"]}),c.jsx("div",{className:"text-sm text-center mt-6",children:c.jsxs("button",{type:"button",onClick:()=>e("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-50",disabled:t,children:[c.jsx(ym,{size:16,className:"inline mr-1"})," Prefer a password? Login"]})})]})},iO={Home:ov,UserCog:Jk,FileText:Uo,AlertTriangle:Yt,Users:Sc,MessageSquare:Wi,Settings:uv,HelpCircle:Gk,Info:on,PhoneCall:Xk,LogOut:Yk,ShieldCheck:Gd,Megaphone:Sd,BarChart3:nv,Edit:dv,Gauge:Bo,Map:_d,ClipboardEdit:sv,Search:ps,Banknote:xm,FileSearch:iv},oO=({userData:n,navItems:e,activeSection:t,onNavigate:r,onLogout:s,isMobileOpen:o,setMobileOpen:a})=>{var f;const u=`https://placehold.co/40x40/FFFFFF/3B82F6?text=${(n.displayName||n.email||"U").charAt(0).toUpperCase()}`,d=c.jsxs("div",{className:"h-full flex flex-col bg-gradient-to-b from-blue-700 to-blue-900 text-white shadow-2xl",children:[c.jsxs("div",{className:"p-5 pt-6 text-center border-b border-blue-600",children:[c.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-white tracking-tight",children:"AGWA"}),c.jsx("p",{className:"text-xs text-blue-200 font-light mt-0.5 italic",children:"Ensuring Clarity, Sustaining Life."})]}),c.jsx("nav",{className:"flex-grow p-3 space-y-1.5 overflow-y-auto",children:e.map(g=>{const y=iO[g.iconName]||Gk,x=t===g.section;return c.jsxs("button",{onClick:()=>r(g.section),className:`w-full flex items-center space-x-3 px-3.5 py-2.5 rounded-lg transition-all duration-200 ease-in-out text-sm font-medium focus:outline-none focus:ring-2 focus:ring-opacity-50 focus:ring-sky-300
                                ${x?"bg-sky-500 text-white shadow-md transform scale-105":"text-blue-100 hover:bg-blue-600 hover:text-white hover:pl-4"}`,title:g.name,children:[c.jsx(y,{size:20,className:`${x?"text-white":"text-blue-300 group-hover:text-white"}`}),c.jsx("span",{className:"truncate",children:g.name})]},g.name)})}),c.jsxs("div",{className:"p-4 border-t border-blue-600",children:[c.jsxs("div",{className:"flex items-center mb-3 p-2.5 bg-blue-700/60 rounded-lg shadow",children:[c.jsx("img",{src:n.photoURL||u,alt:"User",className:"h-10 w-10 rounded-full border-2 border-blue-400 object-cover bg-gray-200",onError:g=>{g.target.onerror=null,g.target.src=u}}),c.jsxs("div",{className:"ml-3 overflow-hidden",children:[c.jsx("p",{className:"text-sm font-semibold leading-tight truncate text-white",title:n.displayName||n.email,children:n.displayName||n.email}),c.jsxs("p",{className:"text-xs text-blue-200 leading-tight capitalize truncate",title:`Role: ${n.role}`,children:["Role: ",((f=n.role)==null?void 0:f.replace("_"," "))||"N/A"]}),c.jsxs("p",{className:"text-xs text-blue-300 leading-tight truncate",title:`Account: ${n.accountNumber}`,children:["Acc: ",n.accountNumber||"N/A"]})]})]}),c.jsxs("button",{onClick:s,className:"w-full flex items-center justify-center space-x-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-2.5 px-4 rounded-lg transition-all duration-150 active:scale-95 focus:outline-none focus:ring-2 focus:ring-red-400",children:[c.jsx(Yk,{size:20}),c.jsx("span",{children:"Logout"})]})]})]});return c.jsxs(c.Fragment,{children:[o&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>a(!1)}),c.jsx("aside",{className:`fixed top-0 left-0 h-screen w-64 z-50 transform transition-transform duration-300 ease-in-out lg:translate-x-0 ${o?"translate-x-0":"-translate-x-full"}`,children:d})]})},aO=({title:n,value:e,icon:t,iconColor:r="text-blue-600",borderColor:s="border-blue-600",subtext:o,onClick:a,className:u=""})=>{const d="bg-white p-5 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 ease-in-out flex items-start space-x-4 border-l-4",f=a?"cursor-pointer":"";return c.jsxs("div",{className:`${d} ${s} ${f} ${u}`,onClick:a,role:a?"button":"figure",tabIndex:a?0:-1,onKeyDown:a?g=>{(g.key==="Enter"||g.key===" ")&&a()}:void 0,children:[t&&c.jsx("div",{className:"p-2 bg-gray-100 rounded-full",children:c.jsx(t,{className:`w-7 h-7 ${r}`,"aria-hidden":"true"})}),c.jsxs("div",{className:"flex-1 overflow-hidden",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider truncate",title:n,children:n}),c.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-800 truncate",title:String(e),children:e}),o&&c.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",title:o,children:o})]})]})},or=Do.memo(aO),Xr=Do.memo(({isOpen:n,onClose:e,title:t="",children:r,size:s="md",hideCloseButton:o=!1,modalDialogClassName:a="",contentClassName:u=""})=>{if(!n)return null;const d={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","3xl":"max-w-3xl","4xl":"max-w-4xl","5xl":"max-w-5xl",full:"max-w-full h-full rounded-none sm:rounded-lg"};return B.useEffect(()=>{const f=g=>{g.key==="Escape"&&e()};return window.addEventListener("keydown",f),()=>{window.removeEventListener("keydown",f)}},[e]),B.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n]),c.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex justify-center items-center z-[100] p-4 overflow-y-auto animate-fadeIn",onClick:e,children:[c.jsxs("div",{className:`bg-white rounded-xl shadow-2xl w-full ${d[s]} transform transition-all duration-300 ease-out scale-95 opacity-0 animate-modal-appear flex flex-col max-h-[90vh] ${a}`,onClick:f=>f.stopPropagation(),children:[t&&c.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-5 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-xl",children:[c.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-800",children:t}),!o&&c.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Close modal",children:c.jsx(hp,{size:24})})]}),c.jsx("div",{className:`p-4 sm:p-6 flex-grow overflow-y-auto ${u}`,children:r})]}),c.jsx("style",{jsx:!0,global:!0,children:`
                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }
                .animate-fadeIn {
                    animation: fadeIn 0.2s ease-out forwards;
                }
                @keyframes modal-appear {
                    0% { transform: scale(0.95) translateY(10px); opacity: 0; }
                    100% { transform: scale(1) translateY(0); opacity: 1; }
                }
                .animate-modal-appear {
                    animation: modal-appear 0.25s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
                }
            `})]})}),Nt=({size:n="h-8 w-8",color:e="text-blue-600",className:t="",message:r="",messageClassName:s="text-sm text-gray-500 mt-2"})=>c.jsxs("div",{className:`flex flex-col items-center justify-center ${t}`,children:[c.jsx(Ge,{className:`animate-spin ${n} ${e}`}),r&&c.jsx("p",{className:s,children:r})]}),lO="AIzaSyAx600ru2hfy_h7yq8o2rc2yM-WOg_xvdE",cO=`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${lO}`,Vi=async n=>{var t,r,s,o,a,u,d,f;const e={contents:[{parts:[{text:n}]}]};try{const g=await fetch(cO,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!g.ok){const x=await g.json();throw new Error(`Gemini API request failed: ${((t=x.error)==null?void 0:t.message)||g.statusText}`)}const y=await g.json();if((u=(a=(o=(s=(r=y.candidates)==null?void 0:r[0])==null?void 0:s.content)==null?void 0:o.parts)==null?void 0:a[0])!=null&&u.text)return y.candidates[0].content.parts[0].text;throw((f=(d=y.candidates)==null?void 0:d[0])==null?void 0:f.finishReason)==="SAFETY"?new Error("AI response blocked due to safety settings."):new Error("Failed to extract text from Gemini API response.")}catch(g){throw console.error("Error calling Gemini API:",g),g}},uO=async({title:n,reason:e,area:t,time:r})=>{const s=`
        You are a professional communications officer for AGWA Water Services.
        Generate a formal, clear, and customer-friendly public service announcement based on the following details.
        Use markdown for formatting, especially **bolding** for key information.

        **Announcement Details:**
        - **Primary Title/Reason:** ${n||e}
        - **Event Description:** ${e}
        - **Affected Area(s):** ${t||"All service areas"}
        - **Date and Time:** ${r||"Effective immediately until further notice"}

        **Instructions:**
        1.  Start with a clear headline. Use the provided Title/Reason.
        2.  Write a main paragraph explaining the situation clearly.
        3.  List the key details (Affected Areas, Date/Time) using bolded headers.
        4.  If it's a service interruption, advise customers to store an adequate amount of water for their needs during this period.
        5.  Apologize for the inconvenience.
        6.  End with contact information: "For inquiries, please call our 24/7 hotline at 1627-AGWA."
        7.  Ensure the tone is professional, empathetic, and reassuring.

        Generate the full announcement content now.
    `;return Vi(s)},dO=({user:n,userData:e,db:t,showNotification:r,setActiveSection:s,billingService:o})=>{const[a,u]=B.useState([]),[d,f]=B.useState(!0),[g,y]=B.useState(""),[x,w]=B.useState(0),[E,S]=B.useState(""),[A,N]=B.useState(""),[z,U]=B.useState(!1),[W,$]=B.useState(!1),F=B.useCallback(async()=>{if(!n||!n.uid||!e||!o){f(!1),y("User data or essential services are unavailable.");return}f(!0),y("");try{const L=await up(t,n.uid);if(L.success){const C=L.data.map(K=>{var Q;const ce=o(K.consumption,e.serviceType,e.meterSize,e.systemSettings||{}),ue=ce.totalCalculatedCharges+(K.previousUnpaidAmount||0)-(K.seniorCitizenDiscount||0);return{...K,amount:ue,calculatedCharges:ce,billDateTimestamp:(Q=K.billDate)!=null&&Q.toDate?K.billDate.toDate():new Date(K.billDate)}}).sort((K,ce)=>ce.billDateTimestamp-K.billDateTimestamp);u(C.slice(0,3));const G=C.filter(K=>K.status==="Unpaid");if(G.length>0){const ce=G.sort((ue,Q)=>new Date(ue.dueDate||0)-new Date(Q.dueDate||0))[0];w(ce.amount),S(ce.dueDate)}else w(0),S("")}else y(L.error||"Failed to fetch recent bills."),r(L.error||"Failed to fetch recent bills.","error")}catch(L){console.error("Error fetching customer dashboard data:",L);const C="An error occurred while loading your dashboard information.";y(C),r(C,"error")}f(!1)},[n,e,t,r,o]);B.useEffect(()=>{F()},[F]);const R=async()=>{U(!0),$(!0),N("");try{const L=e.serviceAddress?`for a household in ${e.serviceAddress.split(",").pop().trim()}`:"for a household",G=await Vi("You are Agie, a friendly and knowledgeable water conservation expert from AGWA. Provide a mix of 8-10 engaging items for a customer. Include practical water-saving tips, surprising water trivia/facts, and at least one local-context tip for the Philippines. Format them as a fun, easy-to-read list using markdown (e.g., using emojis like  or , and bolding for emphasis).");N(G)}catch(L){r(L.message||"Could not fetch water saving tips at the moment.","error"),N("Sorry, couldn't fetch tips right now. Try checking online for general water conservation advice!")}finally{U(!1)}},k=`${x.toFixed(2)}`,P=x>0&&E?`Next Due: ${bt(E,{month:"short",day:"numeric",year:"numeric"})}`:x===0?"All bills settled!":"",T="p-5 bg-white rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-opacity-75 flex flex-col items-start",D=()=>c.jsx("span",{className:"font-bold",children:""});return c.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5",children:[c.jsx(or,{title:"Account Status",value:d&&!e.accountStatus?c.jsx(Ge,{className:"animate-spin h-5 w-5"}):e.accountStatus||"Active",icon:Gd,borderColor:"border-green-500",iconColor:"text-green-500"}),c.jsx(or,{title:"Current Balance",value:d&&x===0&&E===""?c.jsx(Ge,{className:"animate-spin h-5 w-5"}):k,subtext:P,icon:D,borderColor:x>0?"border-red-500":"border-green-500",iconColor:x>0?"text-red-500":"text-green-500"}),c.jsx(or,{title:"Account Number",value:e.accountNumber||"N/A",icon:ms,borderColor:"border-blue-500",iconColor:"text-blue-500"}),c.jsx(or,{title:"Service Type",value:e.serviceType||"Residential",icon:ov,borderColor:"border-purple-500",iconColor:"text-purple-500"})]}),g&&c.jsxs("div",{className:"p-4 bg-red-50 text-red-700 border border-red-200 rounded-lg text-sm flex items-center justify-center",children:[c.jsx(Yt,{size:20,className:"mr-2"})," ",g]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 bg-white p-5 rounded-xl shadow-lg",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[c.jsx(Uo,{size:22,className:"mr-2 text-gray-500"}),"Recent Bills Summary"]}),d?c.jsx(Nt,{message:"Loading recent bills..."}):a.length>0?c.jsxs("div",{className:"space-y-3",children:[a.map(L=>{var C;return c.jsxs("div",{className:`flex flex-col sm:flex-row justify-between items-start sm:items-center p-3.5 border rounded-lg hover:bg-gray-50/70 transition-colors duration-150 ${L.status==="Paid"?"border-green-200 bg-green-50/50":"border-yellow-200 bg-yellow-50/30"}`,children:[c.jsxs("div",{children:[c.jsxs("p",{className:"font-medium text-gray-800 text-sm",children:[L.monthYear||L.billingPeriod," - ",c.jsxs("span",{className:"font-bold",children:["",(C=L.amount)==null?void 0:C.toFixed(2)]})]}),c.jsxs("p",{className:`text-xs mt-0.5 font-semibold ${L.status==="Paid"?"text-green-600":"text-orange-600"}`,children:["Status: ",L.status," ",L.status==="Unpaid"&&`(Due: ${bt(L.dueDate,{month:"short",day:"numeric"})})`]})]}),c.jsxs("div",{className:"flex gap-2 mt-2 sm:mt-0",children:[L.status==="Unpaid"&&c.jsx("button",{onClick:()=>s("myBills"),className:"text-xs bg-red-500 hover:bg-red-600 text-white py-1.5 px-3 rounded-md transition-all active:scale-95 font-medium",children:"Pay Now"}),c.jsx("button",{onClick:()=>s("myBills"),className:"text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 py-1.5 px-3 rounded-md transition-all font-medium",children:"View Details"})]})]},L.id)}),c.jsx("button",{onClick:()=>s("myBills"),className:"mt-3 text-sm text-blue-600 hover:text-blue-800 font-medium hover:underline",children:"View All Bills & Payment History "})]}):c.jsxs("div",{className:"text-sm text-gray-500 py-4 text-center",children:[c.jsx(on,{size:24,className:"mx-auto mb-1 text-gray-400"}),"No recent bills to display. All up to date!"]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("button",{onClick:()=>s("myBills"),className:`${T} focus:ring-green-500 border-l-4 border-green-500`,children:[c.jsx(Kk,{size:26,className:"mb-2 text-green-500"}),c.jsx("h4",{className:"font-semibold text-green-700 text-md",children:"Pay My Bill"}),c.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"View outstanding bills and make (simulated) payments."})]}),c.jsxs("button",{onClick:()=>s("reportIssue"),className:`${T} focus:ring-orange-500 border-l-4 border-orange-500`,children:[c.jsx(Yt,{size:26,className:"mb-2 text-orange-500"}),c.jsx("h4",{className:"font-semibold text-orange-700 text-md",children:"Report an Issue"}),c.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Report leaks, service interruptions, or other concerns."})]}),c.jsxs("button",{onClick:R,className:`${T} focus:ring-teal-500 border-l-4 border-teal-500`,disabled:z,children:[c.jsxs("div",{className:"flex items-center justify-between w-full",children:[c.jsx(Kr,{size:26,className:"mb-2 text-teal-500"}),z&&c.jsx(Ge,{className:"animate-spin text-teal-500",size:20})]}),c.jsx("h4",{className:"font-semibold text-teal-700 text-md",children:z?"Getting Tips...":" Get Water Saving Tips"}),c.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Discover ways to conserve water and save money."})]})]})]}),c.jsx(Xr,{isOpen:W,onClose:()=>$(!1),title:" Water Saving Tips by Agie",size:"lg",children:z?c.jsx("div",{className:"flex justify-center items-center h-40",children:c.jsx(Nt,{message:"Agie is thinking of the best tips for you..."})}):c.jsx("div",{className:"prose prose-sm sm:prose max-w-none whitespace-pre-line p-2 leading-relaxed text-gray-700",children:A||"No tips available at the moment. Please try again!"})})]})},hO=({isOpen:n,onClose:e,billToPay:t,onConfirmPayment:r,isProcessingPayment:s,userData:o})=>{const[a,u]=B.useState(null),[d,f]=B.useState((t==null?void 0:t.amount.toFixed(2))||"0.00"),g=[{name:"Credit/Debit Card",icon:Kk,custom:!1},{name:"Bank Transfer",icon:ML,custom:!1},{name:"GCash",custom:!0,bgColor:"#0E62FE",textColor:"#FFFFFF"},{name:"Maya",custom:!0,bgColor:"#00C27C",textColor:"#FFFFFF"}],y=()=>{if(!a){alert("Please select a payment method.");return}r({billId:t.id,paymentMethod:a,amountPaid:parseFloat(d),paymentReference:`SIM-${Date.now()}`})};return n?c.jsx(Xr,{isOpen:n,onClose:e,title:"Secure Payment",size:"md",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg text-center",children:[c.jsx("p",{className:"text-sm text-blue-700",children:"You are paying for bill:"}),c.jsx("p",{className:"font-bold text-lg text-blue-800",children:t.monthYear}),c.jsxs("div",{className:"mt-2 text-3xl font-bold text-gray-800",children:["",parseFloat(d).toFixed(2)]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Select Payment Method:"}),c.jsx("div",{className:"grid grid-cols-2 gap-3",children:g.map(x=>c.jsx("button",{onClick:()=>u(x.name),className:`p-3 border rounded-lg flex flex-col items-center justify-center transition-all duration-200 h-24 ${a===x.name?"ring-2 ring-blue-500 border-blue-500":"border-gray-300 hover:border-blue-400"}`,style:x.custom?{backgroundColor:x.bgColor}:{},children:x.custom?c.jsx("span",{className:"font-bold text-lg",style:{color:x.textColor},children:x.name}):c.jsxs(c.Fragment,{children:[c.jsx(x.icon,{className:"w-8 h-8 mb-1 text-gray-600"}),c.jsx("span",{className:"text-xs sm:text-sm font-medium text-center text-gray-700",children:x.name})]})},x.name))})]}),c.jsx("div",{className:"pt-6 border-t border-gray-200",children:c.jsx("button",{onClick:y,className:"w-full flex items-center justify-center py-3 px-4 bg-green-600 text-white font-bold rounded-lg text-lg hover:bg-green-700 disabled:bg-gray-400 transition-colors",disabled:!a||s,children:s?c.jsxs(c.Fragment,{children:[c.jsx(Ge,{className:"animate-spin mr-2"})," Processing..."]}):c.jsxs(c.Fragment,{children:[" ",c.jsx("span",{className:"mr-1 font-bold",children:""})," Confirm Payment"]})})})]})}):null},rA=({value:n})=>{if(!n)return null;const e=r=>{const s={0:"1101100",1:"1100110",2:"1001101",3:"1011001",4:"1010011",5:"1100101",6:"1000111",7:"1011100",8:"1110100",9:"1110010","-":"1001011"},o="11010010000",a="1100011101011";let u=o;for(const d of r)s[d]&&(u+=s[d]);return u+=a,u.split("").map((d,f)=>c.jsx("div",{className:`h-full ${d==="1"?"bg-black":"bg-transparent"}`,style:{width:"2px"}},f))},t=n.replace(/[^0-9-]/g,"");return c.jsxs("div",{className:"flex flex-col items-center justify-center",children:[c.jsx("div",{className:"flex h-16 items-stretch","aria-label":`Barcode for ${t}`,children:e(t)}),c.jsx("p",{className:"tracking-widest text-xs font-mono mt-1",children:t})]})};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:sA,setPrototypeOf:eS,isFrozen:fO,getPrototypeOf:mO,getOwnPropertyDescriptor:pO}=Object;let{freeze:lr,seal:gs,create:iA}=Object,{apply:b0,construct:_0}=typeof Reflect<"u"&&Reflect;lr||(lr=function(e){return e});gs||(gs=function(e){return e});b0||(b0=function(e,t,r){return e.apply(t,r)});_0||(_0=function(e,t){return new e(...t)});const gf=cr(Array.prototype.forEach),gO=cr(Array.prototype.lastIndexOf),tS=cr(Array.prototype.pop),Iu=cr(Array.prototype.push),yO=cr(Array.prototype.splice),Vf=cr(String.prototype.toLowerCase),dy=cr(String.prototype.toString),nS=cr(String.prototype.match),Eu=cr(String.prototype.replace),xO=cr(String.prototype.indexOf),vO=cr(String.prototype.trim),Ps=cr(Object.prototype.hasOwnProperty),rr=cr(RegExp.prototype.test),Tu=wO(TypeError);function cr(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return b0(n,e,r)}}function wO(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return _0(n,t)}}function tt(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Vf;eS&&eS(n,null);let r=e.length;for(;r--;){let s=e[r];if(typeof s=="string"){const o=t(s);o!==s&&(fO(e)||(e[r]=o),s=o)}n[s]=!0}return n}function bO(n){for(let e=0;e<n.length;e++)Ps(n,e)||(n[e]=null);return n}function Ei(n){const e=iA(null);for(const[t,r]of sA(n))Ps(n,t)&&(Array.isArray(r)?e[t]=bO(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=Ei(r):e[t]=r);return e}function ku(n,e){for(;n!==null;){const r=pO(n,e);if(r){if(r.get)return cr(r.get);if(typeof r.value=="function")return cr(r.value)}n=mO(n)}function t(){return null}return t}const rS=lr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),hy=lr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),fy=lr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),_O=lr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),my=lr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),SO=lr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),sS=lr(["#text"]),iS=lr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),py=lr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),oS=lr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),yf=lr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),IO=gs(/\{\{[\w\W]*|[\w\W]*\}\}/gm),EO=gs(/<%[\w\W]*|[\w\W]*%>/gm),TO=gs(/\$\{[\w\W]*/gm),kO=gs(/^data-[\-\w.\u00B7-\uFFFF]+$/),AO=gs(/^aria-[\-\w]+$/),oA=gs(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),CO=gs(/^(?:\w+script|data):/i),NO=gs(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),aA=gs(/^html$/i),RO=gs(/^[a-z][.\w]*(-[.\w]+)+$/i);var aS=Object.freeze({__proto__:null,ARIA_ATTR:AO,ATTR_WHITESPACE:NO,CUSTOM_ELEMENT:RO,DATA_ATTR:kO,DOCTYPE_NAME:aA,ERB_EXPR:EO,IS_ALLOWED_URI:oA,IS_SCRIPT_OR_DATA:CO,MUSTACHE_EXPR:IO,TMPLIT_EXPR:TO});const Au={element:1,text:3,progressingInstruction:7,comment:8,document:9},PO=function(){return typeof window>"u"?null:window},jO=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(r=t.getAttribute(s));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},lS=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function lA(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:PO();const e=je=>lA(je);if(e.version="3.2.6",e.removed=[],!n||!n.document||n.document.nodeType!==Au.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const r=t,s=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:a,Node:u,Element:d,NodeFilter:f,NamedNodeMap:g=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:y,DOMParser:x,trustedTypes:w}=n,E=d.prototype,S=ku(E,"cloneNode"),A=ku(E,"remove"),N=ku(E,"nextSibling"),z=ku(E,"childNodes"),U=ku(E,"parentNode");if(typeof a=="function"){const je=t.createElement("template");je.content&&je.content.ownerDocument&&(t=je.content.ownerDocument)}let W,$="";const{implementation:F,createNodeIterator:R,createDocumentFragment:k,getElementsByTagName:P}=t,{importNode:T}=r;let D=lS();e.isSupported=typeof sA=="function"&&typeof U=="function"&&F&&F.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:L,ERB_EXPR:C,TMPLIT_EXPR:G,DATA_ATTR:K,ARIA_ATTR:ce,IS_SCRIPT_OR_DATA:ue,ATTR_WHITESPACE:Q,CUSTOM_ELEMENT:Z}=aS;let{IS_ALLOWED_URI:M}=aS,q=null;const ne=tt({},[...rS,...hy,...fy,...my,...sS]);let V=null;const de=tt({},[...iS,...py,...oS,...yf]);let xe=Object.seal(iA(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),be=null,Be=null,He=!0,et=!0,wt=!1,Sn=!0,Qn=!1,Yn=!0,In=!1,Mr=!1,Jr=!1,Xn=!1,ys=!1,ur=!1,Jn=!0,dr=!1;const ai="user-content-";let Zr=!0,hr=!1,fr={},oe=null;const fe=tt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Le=null;const Qe=tt({},["audio","video","img","source","image","track"]);let Xe=null;const Bt=tt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Jt="http://www.w3.org/1998/Math/MathML",Zt="http://www.w3.org/2000/svg",Wt="http://www.w3.org/1999/xhtml";let pn=Wt,Ft=!1,jn=null;const an=tt({},[Jt,Zt,Wt],dy);let xs=tt({},["mi","mo","mn","ms","mtext"]),vs=tt({},["annotation-xml"]);const mr=tt({},["title","style","font","a","script"]);let Dn=null;const Ki=["application/xhtml+xml","text/html"],es="text/html";let Rt=null,pr=null;const Xo=t.createElement("form"),ts=function(X){return X instanceof RegExp||X instanceof Function},li=function(){let X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(pr&&pr===X)){if((!X||typeof X!="object")&&(X={}),X=Ei(X),Dn=Ki.indexOf(X.PARSER_MEDIA_TYPE)===-1?es:X.PARSER_MEDIA_TYPE,Rt=Dn==="application/xhtml+xml"?dy:Vf,q=Ps(X,"ALLOWED_TAGS")?tt({},X.ALLOWED_TAGS,Rt):ne,V=Ps(X,"ALLOWED_ATTR")?tt({},X.ALLOWED_ATTR,Rt):de,jn=Ps(X,"ALLOWED_NAMESPACES")?tt({},X.ALLOWED_NAMESPACES,dy):an,Xe=Ps(X,"ADD_URI_SAFE_ATTR")?tt(Ei(Bt),X.ADD_URI_SAFE_ATTR,Rt):Bt,Le=Ps(X,"ADD_DATA_URI_TAGS")?tt(Ei(Qe),X.ADD_DATA_URI_TAGS,Rt):Qe,oe=Ps(X,"FORBID_CONTENTS")?tt({},X.FORBID_CONTENTS,Rt):fe,be=Ps(X,"FORBID_TAGS")?tt({},X.FORBID_TAGS,Rt):Ei({}),Be=Ps(X,"FORBID_ATTR")?tt({},X.FORBID_ATTR,Rt):Ei({}),fr=Ps(X,"USE_PROFILES")?X.USE_PROFILES:!1,He=X.ALLOW_ARIA_ATTR!==!1,et=X.ALLOW_DATA_ATTR!==!1,wt=X.ALLOW_UNKNOWN_PROTOCOLS||!1,Sn=X.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Qn=X.SAFE_FOR_TEMPLATES||!1,Yn=X.SAFE_FOR_XML!==!1,In=X.WHOLE_DOCUMENT||!1,Xn=X.RETURN_DOM||!1,ys=X.RETURN_DOM_FRAGMENT||!1,ur=X.RETURN_TRUSTED_TYPE||!1,Jr=X.FORCE_BODY||!1,Jn=X.SANITIZE_DOM!==!1,dr=X.SANITIZE_NAMED_PROPS||!1,Zr=X.KEEP_CONTENT!==!1,hr=X.IN_PLACE||!1,M=X.ALLOWED_URI_REGEXP||oA,pn=X.NAMESPACE||Wt,xs=X.MATHML_TEXT_INTEGRATION_POINTS||xs,vs=X.HTML_INTEGRATION_POINTS||vs,xe=X.CUSTOM_ELEMENT_HANDLING||{},X.CUSTOM_ELEMENT_HANDLING&&ts(X.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(xe.tagNameCheck=X.CUSTOM_ELEMENT_HANDLING.tagNameCheck),X.CUSTOM_ELEMENT_HANDLING&&ts(X.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(xe.attributeNameCheck=X.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),X.CUSTOM_ELEMENT_HANDLING&&typeof X.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(xe.allowCustomizedBuiltInElements=X.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Qn&&(et=!1),ys&&(Xn=!0),fr&&(q=tt({},sS),V=[],fr.html===!0&&(tt(q,rS),tt(V,iS)),fr.svg===!0&&(tt(q,hy),tt(V,py),tt(V,yf)),fr.svgFilters===!0&&(tt(q,fy),tt(V,py),tt(V,yf)),fr.mathMl===!0&&(tt(q,my),tt(V,oS),tt(V,yf))),X.ADD_TAGS&&(q===ne&&(q=Ei(q)),tt(q,X.ADD_TAGS,Rt)),X.ADD_ATTR&&(V===de&&(V=Ei(V)),tt(V,X.ADD_ATTR,Rt)),X.ADD_URI_SAFE_ATTR&&tt(Xe,X.ADD_URI_SAFE_ATTR,Rt),X.FORBID_CONTENTS&&(oe===fe&&(oe=Ei(oe)),tt(oe,X.FORBID_CONTENTS,Rt)),Zr&&(q["#text"]=!0),In&&tt(q,["html","head","body"]),q.table&&(tt(q,["tbody"]),delete be.tbody),X.TRUSTED_TYPES_POLICY){if(typeof X.TRUSTED_TYPES_POLICY.createHTML!="function")throw Tu('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof X.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Tu('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');W=X.TRUSTED_TYPES_POLICY,$=W.createHTML("")}else W===void 0&&(W=jO(w,s)),W!==null&&typeof $=="string"&&($=W.createHTML(""));lr&&lr(X),pr=X}},Pt=tt({},[...hy,...fy,..._O]),ci=tt({},[...my,...SO]),Lr=function(X){let ge=U(X);(!ge||!ge.tagName)&&(ge={namespaceURI:pn,tagName:"template"});const ke=Vf(X.tagName),gt=Vf(ge.tagName);return jn[X.namespaceURI]?X.namespaceURI===Zt?ge.namespaceURI===Wt?ke==="svg":ge.namespaceURI===Jt?ke==="svg"&&(gt==="annotation-xml"||xs[gt]):!!Pt[ke]:X.namespaceURI===Jt?ge.namespaceURI===Wt?ke==="math":ge.namespaceURI===Zt?ke==="math"&&vs[gt]:!!ci[ke]:X.namespaceURI===Wt?ge.namespaceURI===Zt&&!vs[gt]||ge.namespaceURI===Jt&&!xs[gt]?!1:!ci[ke]&&(mr[ke]||!Pt[ke]):!!(Dn==="application/xhtml+xml"&&jn[X.namespaceURI]):!1},gn=function(X){Iu(e.removed,{element:X});try{U(X).removeChild(X)}catch{A(X)}},gr=function(X,ge){try{Iu(e.removed,{attribute:ge.getAttributeNode(X),from:ge})}catch{Iu(e.removed,{attribute:null,from:ge})}if(ge.removeAttribute(X),X==="is")if(Xn||ys)try{gn(ge)}catch{}else try{ge.setAttribute(X,"")}catch{}},ui=function(X){let ge=null,ke=null;if(Jr)X="<remove></remove>"+X;else{const We=nS(X,/^[\r\n\t ]+/);ke=We&&We[0]}Dn==="application/xhtml+xml"&&pn===Wt&&(X='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+X+"</body></html>");const gt=W?W.createHTML(X):X;if(pn===Wt)try{ge=new x().parseFromString(gt,Dn)}catch{}if(!ge||!ge.documentElement){ge=F.createDocument(pn,"template",null);try{ge.documentElement.innerHTML=Ft?$:gt}catch{}}const en=ge.body||ge.documentElement;return X&&ke&&en.insertBefore(t.createTextNode(ke),en.childNodes[0]||null),pn===Wt?P.call(ge,In?"html":"body")[0]:In?ge.documentElement:en},yr=function(X){return R.call(X.ownerDocument||X,X,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},di=function(X){return X instanceof y&&(typeof X.nodeName!="string"||typeof X.textContent!="string"||typeof X.removeChild!="function"||!(X.attributes instanceof g)||typeof X.removeAttribute!="function"||typeof X.setAttribute!="function"||typeof X.namespaceURI!="string"||typeof X.insertBefore!="function"||typeof X.hasChildNodes!="function")},Za=function(X){return typeof u=="function"&&X instanceof u};function Mn(je,X,ge){gf(je,ke=>{ke.call(e,X,ge,pr)})}const Jo=function(X){let ge=null;if(Mn(D.beforeSanitizeElements,X,null),di(X))return gn(X),!0;const ke=Rt(X.nodeName);if(Mn(D.uponSanitizeElement,X,{tagName:ke,allowedTags:q}),Yn&&X.hasChildNodes()&&!Za(X.firstElementChild)&&rr(/<[/\w!]/g,X.innerHTML)&&rr(/<[/\w!]/g,X.textContent)||X.nodeType===Au.progressingInstruction||Yn&&X.nodeType===Au.comment&&rr(/<[/\w]/g,X.data))return gn(X),!0;if(!q[ke]||be[ke]){if(!be[ke]&&Fs(ke)&&(xe.tagNameCheck instanceof RegExp&&rr(xe.tagNameCheck,ke)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(ke)))return!1;if(Zr&&!oe[ke]){const gt=U(X)||X.parentNode,en=z(X)||X.childNodes;if(en&&gt){const We=en.length;for(let ln=We-1;ln>=0;--ln){const En=S(en[ln],!0);En.__removalCount=(X.__removalCount||0)+1,gt.insertBefore(En,N(X))}}}return gn(X),!0}return X instanceof d&&!Lr(X)||(ke==="noscript"||ke==="noembed"||ke==="noframes")&&rr(/<\/no(script|embed|frames)/i,X.innerHTML)?(gn(X),!0):(Qn&&X.nodeType===Au.text&&(ge=X.textContent,gf([L,C,G],gt=>{ge=Eu(ge,gt," ")}),X.textContent!==ge&&(Iu(e.removed,{element:X.cloneNode()}),X.textContent=ge)),Mn(D.afterSanitizeElements,X,null),!1)},xr=function(X,ge,ke){if(Jn&&(ge==="id"||ge==="name")&&(ke in t||ke in Xo))return!1;if(!(et&&!Be[ge]&&rr(K,ge))){if(!(He&&rr(ce,ge))){if(!V[ge]||Be[ge]){if(!(Fs(X)&&(xe.tagNameCheck instanceof RegExp&&rr(xe.tagNameCheck,X)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(X))&&(xe.attributeNameCheck instanceof RegExp&&rr(xe.attributeNameCheck,ge)||xe.attributeNameCheck instanceof Function&&xe.attributeNameCheck(ge))||ge==="is"&&xe.allowCustomizedBuiltInElements&&(xe.tagNameCheck instanceof RegExp&&rr(xe.tagNameCheck,ke)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(ke))))return!1}else if(!Xe[ge]){if(!rr(M,Eu(ke,Q,""))){if(!((ge==="src"||ge==="xlink:href"||ge==="href")&&X!=="script"&&xO(ke,"data:")===0&&Le[X])){if(!(wt&&!rr(ue,Eu(ke,Q,"")))){if(ke)return!1}}}}}}return!0},Fs=function(X){return X!=="annotation-xml"&&nS(X,Z)},vr=function(X){Mn(D.beforeSanitizeAttributes,X,null);const{attributes:ge}=X;if(!ge||di(X))return;const ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:V,forceKeepAttr:void 0};let gt=ge.length;for(;gt--;){const en=ge[gt],{name:We,namespaceURI:ln,value:En}=en,wr=Rt(We),Ln=En;let $t=We==="value"?Ln:vO(Ln);if(ke.attrName=wr,ke.attrValue=$t,ke.keepAttr=!0,ke.forceKeepAttr=void 0,Mn(D.uponSanitizeAttribute,X,ke),$t=ke.attrValue,dr&&(wr==="id"||wr==="name")&&(gr(We,X),$t=ai+$t),Yn&&rr(/((--!?|])>)|<\/(style|title)/i,$t)){gr(We,X);continue}if(ke.forceKeepAttr)continue;if(!ke.keepAttr){gr(We,X);continue}if(!Sn&&rr(/\/>/i,$t)){gr(We,X);continue}Qn&&gf([L,C,G],Vs=>{$t=Eu($t,Vs," ")});const Zo=Rt(X.nodeName);if(!xr(Zo,wr,$t)){gr(We,X);continue}if(W&&typeof w=="object"&&typeof w.getAttributeType=="function"&&!ln)switch(w.getAttributeType(Zo,wr)){case"TrustedHTML":{$t=W.createHTML($t);break}case"TrustedScriptURL":{$t=W.createScriptURL($t);break}}if($t!==Ln)try{ln?X.setAttributeNS(ln,We,$t):X.setAttribute(We,$t),di(X)?gn(X):tS(e.removed)}catch{gr(We,X)}}Mn(D.afterSanitizeAttributes,X,null)},el=function je(X){let ge=null;const ke=yr(X);for(Mn(D.beforeSanitizeShadowDOM,X,null);ge=ke.nextNode();)Mn(D.uponSanitizeShadowNode,ge,null),Jo(ge),vr(ge),ge.content instanceof o&&je(ge.content);Mn(D.afterSanitizeShadowDOM,X,null)};return e.sanitize=function(je){let X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ge=null,ke=null,gt=null,en=null;if(Ft=!je,Ft&&(je="<!-->"),typeof je!="string"&&!Za(je))if(typeof je.toString=="function"){if(je=je.toString(),typeof je!="string")throw Tu("dirty is not a string, aborting")}else throw Tu("toString is not a function");if(!e.isSupported)return je;if(Mr||li(X),e.removed=[],typeof je=="string"&&(hr=!1),hr){if(je.nodeName){const En=Rt(je.nodeName);if(!q[En]||be[En])throw Tu("root node is forbidden and cannot be sanitized in-place")}}else if(je instanceof u)ge=ui("<!---->"),ke=ge.ownerDocument.importNode(je,!0),ke.nodeType===Au.element&&ke.nodeName==="BODY"||ke.nodeName==="HTML"?ge=ke:ge.appendChild(ke);else{if(!Xn&&!Qn&&!In&&je.indexOf("<")===-1)return W&&ur?W.createHTML(je):je;if(ge=ui(je),!ge)return Xn?null:ur?$:""}ge&&Jr&&gn(ge.firstChild);const We=yr(hr?je:ge);for(;gt=We.nextNode();)Jo(gt),vr(gt),gt.content instanceof o&&el(gt.content);if(hr)return je;if(Xn){if(ys)for(en=k.call(ge.ownerDocument);ge.firstChild;)en.appendChild(ge.firstChild);else en=ge;return(V.shadowroot||V.shadowrootmode)&&(en=T.call(r,en,!0)),en}let ln=In?ge.outerHTML:ge.innerHTML;return In&&q["!doctype"]&&ge.ownerDocument&&ge.ownerDocument.doctype&&ge.ownerDocument.doctype.name&&rr(aA,ge.ownerDocument.doctype.name)&&(ln="<!DOCTYPE "+ge.ownerDocument.doctype.name+`>
`+ln),Qn&&gf([L,C,G],En=>{ln=Eu(ln,En," ")}),W&&ur?W.createHTML(ln):ln},e.setConfig=function(){let je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};li(je),Mr=!0},e.clearConfig=function(){pr=null,Mr=!1},e.isValidAttribute=function(je,X,ge){pr||li({});const ke=Rt(je),gt=Rt(X);return xr(ke,gt,ge)},e.addHook=function(je,X){typeof X=="function"&&Iu(D[je],X)},e.removeHook=function(je,X){if(X!==void 0){const ge=gO(D[je],X);return ge===-1?void 0:yO(D[je],ge,1)[0]}return tS(D[je])},e.removeHooks=function(je){D[je]=[]},e.removeAllHooks=function(){D=lS()},e}var DO=lA();const cA=({isOpen:n,onClose:e,bill:t,userData:r,calculateBillDetails:s,showNotification:o})=>{var S,A,N,z,U,W,$,F,R,k,P,T,D,L;if(!n||!t||!r)return null;const a=t.calculatedCharges||s(t.consumption,r.serviceType,r.meterSize||'1/2"'),u=(a.totalCalculatedCharges+(t.previousUnpaidAmount||0)-(t.seniorCitizenDiscount||0)).toFixed(2),d=(S=t.billDate)!=null&&S.toDate?t.billDate.toDate():null,f=d?`${d.getFullYear()}${String(d.getMonth()+1).padStart(2,"0")}${String(d.getDate()).padStart(2,"0")}`:Date.now().toString().slice(-6),g=t.invoiceNumber||`AGWA-${(A=t.id)==null?void 0:A.slice(0,4).toUpperCase()}-${f}`,y=C=>!C||typeof C!="object"?C||"N/A":[C.street,C.barangay,C.district,"Quezon City"].filter(K=>K&&K.trim()).join(", "),x=()=>{const C=document.getElementById("invoice-content-to-print-modal-fullscreen");if(C){const G=DO.sanitize(C.innerHTML),K=window.open("","_blank","height=800,width=1000,scrollbars=yes");K.document.write("<html><head><title>AGWA Water Services - Invoice</title>"),K.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),K.document.write(`
                <style>
                    body { font-family: 'Inter', sans-serif; margin: 0; padding: 15px; font-size: 9.5pt; line-height: 1.45; color: #2d3748; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                    .invoice-container-print { max-width: 820px; margin: auto; padding: 20px; background-color: #fff; position: relative; }
                    .paid-stamp {
                        position: absolute;
                        top: 40%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-20deg);
                        color: #e53e3e;
                        border: 5px double #e53e3e;
                        padding: 12px 30px;
                        border-radius: 6px;
                        font-family: 'Courier New', Courier, monospace;
                        text-align: center;
                        opacity: 0.6;
                        z-index: 1000;
                        pointer-events: none;
                        filter: blur(0.5px) grayscale(10%) sepia(50%) brightness(90%) contrast(120%);
                    }
                    .paid-stamp-main { font-size: 3rem; font-weight: bold; letter-spacing: 5px; line-height: 1; text-shadow: 1px 1px 0 rgba(0,0,0,0.1); }
                    .paid-stamp-date { font-size: 0.9rem; font-weight: 600; margin-top: 8px; display: block; }
                    table { width: 100%; border-collapse: collapse; margin-bottom: 10px; position: relative; z-index: 1; }
                    td, th { border: 1px solid #e2e8f0; padding: 5px 7px; text-align: left; font-size: 9pt; vertical-align: top; }
                    th { background-color: #f7fafc; font-weight: 600; color: #4a5568; }
                    .header-logo-print { font-size: 24pt; font-weight: bold; color: #2b6cb0; margin-bottom: 0px; }
                    .header-tagline-print { font-size: 8pt; color: #4299e1; margin-top: -2px; }
                    .invoice-title-print { font-size: 20pt; font-weight: bold; text-align: center; margin-bottom: 12px; margin-top: 8px; text-transform: uppercase; color: #1a202c; }
                    .section-title-print { font-weight: bold; margin-top: 12px; margin-bottom: 4px; font-size: 11pt; border-bottom: 2px solid #4a5568; padding-bottom: 3px; color: #2c5282;}
                    .text-right-print { text-align: right; }
                    .font-bold-print { font-weight: bold; }
                    .total-due-print { font-size: 14pt; font-weight: bold; color: #c53030; }
                    hr.dashed-print { border: none; border-top: 1px dashed #a0aec0; margin: 10px 0; }
                    .footer-notes-print { font-size: 8pt; text-align: center; margin-top: 20px; padding-top: 12px; border-top: 1px solid #e2e8f0; color: #4a5568; }
                    .payment-stub-print { margin-top: 20px; padding: 12px; border: 1px dashed #718096; background-color: #f8f9fa; }
                    .no-print-in-iframe { display: none !important; }
                    @media print {
                        body { margin: 0; font-size: 9.5pt; background-color: #fff; }
                        .no-print-in-iframe { display: none !important; }
                        .invoice-container-print { border: none; box-shadow: none; padding: 0;}
                        .paid-stamp { color: #e53e3e !important; border-color: #e53e3e !important; filter: blur(0.3px) grayscale(5%) sepia(40%) brightness(90%) contrast(120%); }
                        table td, table th {font-size: 8.5pt;}
                    }
                </style>
            `),K.document.write('</head><body><div class="invoice-container-print">'),K.document.write(G),K.document.write("</div></body></html>"),K.document.close(),setTimeout(()=>{K.print()},700)}else o&&o("Invoice content element not found for printing.","error")},w=({label:C,value:G,valueClass:K="text-gray-800",labelWidth:ce="w-2/5 sm:w-1/3",valueWidth:ue="w-3/5 sm:w-2/3"})=>c.jsxs("div",{className:"flex justify-between py-1.5 text-sm border-b border-gray-100 last:border-b-0 hover:bg-gray-50/50 px-1 -mx-1 rounded-sm",children:[c.jsxs("span",{className:`text-gray-500 ${ce} pr-2`,children:[C,":"]}),c.jsx("span",{className:`${ue} text-right font-medium ${K}`,children:G})]}),E=({label:C,value:G,valueClass:K="text-gray-800",isBold:ce=!1,isTotal:ue=!1})=>c.jsxs("tr",{className:`${ue?"bg-gray-100 font-semibold":"hover:bg-gray-50/50"}`,children:[c.jsx("td",{className:`py-2 px-2 ${ce?"font-semibold":""}`,children:C}),c.jsx("td",{className:`py-2 px-2 text-right ${K} ${ce?"font-semibold":""}`,children:G})]});return c.jsxs(Xr,{isOpen:n,onClose:e,title:"",size:"full",modalDialogClassName:"sm:max-w-4xl md:max-w-5xl lg:max-w-6xl xl:max-w-7xl w-[95vw] h-[95vh]",contentClassName:"p-0",children:[c.jsx("style",{children:`
                    .paid-stamp {
                        position: absolute;
                        top: 40%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-20deg);
                        color: #e53e3e;
                        border: 5px double #e53e3e;
                        padding: 12px 30px;
                        border-radius: 6px;
                        font-family: 'Courier New', Courier, monospace;
                        text-align: center;
                        opacity: 0.6;
                        z-index: 1000;
                        pointer-events: none;
                        filter: blur(0.5px) grayscale(10%) sepia(50%) brightness(90%) contrast(120%);
                    }
                    .paid-stamp-main { font-size: 3rem; font-weight: bold; letter-spacing: 5px; line-height: 1; text-shadow: 1px 1px 0 rgba(0,0,0,0.1); }
                    .paid-stamp-date { font-size: 0.9rem; font-weight: 600; margin-top: 8px; display: block; }
                `}),c.jsxs("div",{className:"flex justify-between items-center p-3 sm:p-4 border-b border-gray-200 bg-slate-50 rounded-t-xl sticky top-0 z-20",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Uo,{size:22,className:"mr-2.5 text-blue-600"}),c.jsxs("h3",{className:"text-md sm:text-lg font-semibold text-slate-800 truncate",title:g,children:["Invoice: ",g]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("button",{onClick:x,className:"p-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors flex items-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",title:"Print/Download Invoice",children:[c.jsx(CL,{size:16,className:"mr-0 sm:mr-1.5"})," ",c.jsx("span",{className:"hidden sm:inline",children:"Print/Save"})]}),c.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 bg-gray-200 hover:bg-gray-300 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Close Invoice View",children:c.jsx(hp,{size:18})})]})]}),c.jsx("div",{className:"overflow-y-auto flex-grow p-1",children:c.jsxs("div",{id:"invoice-content-to-print-modal-fullscreen",className:"p-3 sm:p-5 font-sans text-gray-700 text-xs sm:text-sm bg-white shadow-lg rounded-lg max-w-4xl mx-auto my-2 relative",children:[((N=t.status)==null?void 0:N.toLowerCase())==="paid"&&c.jsxs("div",{className:"paid-stamp",children:[c.jsx("div",{className:"paid-stamp-main",children:"PAID"}),c.jsx("div",{className:"paid-stamp-date",children:bt(t.paymentDate,{year:"numeric",month:"short",day:"numeric"})})]}),c.jsxs("div",{className:"relative z-0",children:[c.jsxs("div",{className:"flex justify-between items-start mb-5 pb-4 border-b-2 border-blue-700",children:[c.jsxs("div",{children:[c.jsx("div",{className:"header-logo-print text-3xl font-bold text-blue-700",children:"AGWA"}),c.jsx("div",{className:"header-tagline-print text-xs text-blue-600 italic",children:"Ensuring Clarity, Sustaining Life."})]}),c.jsxs("div",{className:"text-right text-xs",children:[c.jsx("div",{className:"font-semibold",children:"AGWA Water Services, Inc."}),c.jsx("div",{children:"123 Aqua Drive, Hydro Business Park"}),c.jsx("div",{children:"Quezon City, Metro Manila, Philippines 1101"}),c.jsx("div",{children:"VAT Reg. TIN: 000-123-456-789"}),c.jsx("div",{className:"no-print-in-iframe",children:"Machine Serial No.: AGWAMSN001"})]})]}),c.jsx("div",{className:"invoice-title-print text-2xl font-bold text-center mb-2 text-gray-800",children:"STATEMENT OF ACCOUNT"}),c.jsxs("div",{className:"text-center text-sm mb-5",children:["Invoice No.: ",g]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 mb-5 text-xs",children:[c.jsxs("div",{className:"border border-gray-200 p-3.5 rounded-lg bg-slate-50/60 shadow-sm",children:[c.jsx("h5",{className:"font-semibold text-slate-600 mb-2 text-sm border-b pb-1.5",children:"SERVICE INFORMATION"}),c.jsx(w,{label:"Contract Acct No.",value:r.accountNumber,valueClass:"font-bold text-slate-900"}),c.jsx(w,{label:"Account Name",value:r.displayName||r.email,valueClass:"font-bold text-slate-900"}),c.jsx(w,{label:"Service Address",value:y(r.serviceAddress)}),c.jsx(w,{label:"Meter Serial No.",value:r.meterSerialNumber||"N/A"}),c.jsx(w,{label:"Rate Class",value:r.serviceType||"Residential"})]}),c.jsxs("div",{className:"border border-gray-200 p-3.5 rounded-lg bg-slate-50/60 mt-3 md:mt-0 shadow-sm",children:[c.jsx("h5",{className:"font-semibold text-slate-600 mb-2 text-sm border-b pb-1.5",children:"BILLING SUMMARY"}),c.jsx(w,{label:"Bill Date",value:bt(t.billDate,{year:"numeric",month:"long",day:"numeric"})||"N/A"}),c.jsx(w,{label:"Billing Period",value:t.billingPeriod||t.monthYear}),c.jsx(w,{label:"Current Reading",value:`${t.currentReading??"N/A"} m`}),c.jsx(w,{label:"Previous Reading",value:`${t.prevReading??"N/A"} m`}),c.jsx(w,{label:"Consumption",value:`${a.consumption??"N/A"} m`,valueClass:"font-bold text-slate-900"})]})]}),c.jsx("hr",{className:"my-4 border-gray-300 dashed-print"}),c.jsx("div",{className:"section-title-print text-sm font-semibold text-slate-700 mb-1.5",children:"CHARGES BREAKDOWN"}),c.jsxs("table",{className:"w-full text-xs mb-4",children:[c.jsx("thead",{className:"bg-slate-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"py-2 px-2.5 text-left",children:"Description"}),c.jsx("th",{className:"py-2 px-2.5 text-right",children:"Amount (PHP)"})]})}),c.jsxs("tbody",{children:[c.jsx(E,{label:"Basic Charge",value:(z=a.basicCharge)==null?void 0:z.toFixed(2)}),c.jsx(E,{label:"Foreign Currency Differential Adj. (FCDA)",value:(U=a.fcda)==null?void 0:U.toFixed(2)}),c.jsx(E,{label:"Water Charge (Basic + FCDA)",value:(W=a.waterCharge)==null?void 0:W.toFixed(2),isBold:!0}),c.jsx(E,{label:"Environmental Charge (EC)",value:($=a.environmentalCharge)==null?void 0:$.toFixed(2)}),c.jsx(E,{label:"Sewerage Charge (SC)",value:(F=a.sewerageCharge)==null?void 0:F.toFixed(2)}),c.jsx(E,{label:"Maintenance Service Charge",value:(R=a.maintenanceServiceCharge)==null?void 0:R.toFixed(2)}),t.seniorCitizenDiscount>0&&c.jsx(E,{label:"Senior Citizen Discount",value:`(${parseFloat(t.seniorCitizenDiscount).toFixed(2)})`,valueClass:"text-green-600"}),c.jsx(E,{label:"SUB-TOTAL (Water & Other Charges)",value:(k=a.subTotalBeforeTaxes)==null?void 0:k.toFixed(2),isTotal:!0}),c.jsx(E,{label:"Government Taxes (Local Franchise Tax)",value:(P=a.governmentTaxes)==null?void 0:P.toFixed(2)}),c.jsx(E,{label:"VATable Sales",value:(T=a.vatableSales)==null?void 0:T.toFixed(2),isTotal:!0}),c.jsx(E,{label:"VAT (12%)",value:(D=a.vat)==null?void 0:D.toFixed(2)})]})]}),c.jsx("hr",{className:"my-4 border-gray-300 dashed-print"}),c.jsxs("div",{className:"text-xs space-y-1.5 mt-1",children:[c.jsx(w,{label:"Total Current Charges",value:`PHP ${(L=a.totalCalculatedCharges)==null?void 0:L.toFixed(2)}`,valueClass:"font-bold text-slate-900 text-sm"}),c.jsx(w,{label:"Previous Unpaid Amount",value:`PHP ${(t.previousUnpaidAmount||0).toFixed(2)}`,valueClass:`font-semibold text-sm ${(t.previousUnpaidAmount||0)>0?"text-red-600":"text-slate-800"}`}),c.jsxs("div",{className:"flex justify-between items-center py-2.5 text-lg sm:text-xl border-t-2 border-b-2 border-black my-2.5 px-1",children:[c.jsx("span",{className:"font-bold text-slate-900",children:"TOTAL AMOUNT DUE"}),c.jsxs("span",{className:"font-bold text-red-600 total-due-print",children:["",u]})]}),c.jsx(w,{label:"Payment Due Date",value:bt(t.dueDate,{weekday:"long",year:"numeric",month:"long",day:"numeric"})||"N/A",valueClass:"font-bold text-red-700 text-sm"})]}),c.jsx("hr",{className:"my-4 border-gray-300 dashed-print"}),t.paymentHistory&&t.paymentHistory.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"section-title-print text-sm font-semibold text-slate-700 mb-1.5 mt-4",children:"PAYMENT HISTORY (This Bill)"}),c.jsxs("table",{className:"w-full text-xs mb-4",children:[c.jsx("thead",{className:"bg-slate-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"py-2 px-2.5",children:"Date"}),c.jsx("th",{className:"py-2 px-2.5",children:"Ref. No."}),c.jsx("th",{className:"py-2 px-2.5 text-right",children:"Amount Paid"})]})}),c.jsx("tbody",{children:t.paymentHistory.map((C,G)=>c.jsxs("tr",{className:"hover:bg-gray-50/50",children:[c.jsx("td",{className:"py-1.5 px-2.5",children:bt(C.postingDate)}),c.jsx("td",{className:"py-1.5 px-2.5",children:C.referenceNo}),c.jsx("td",{className:"py-1.5 px-2.5 text-right",children:parseFloat(C.amount).toFixed(2)})]},G))})]}),c.jsx("hr",{className:"my-4 border-gray-300 dashed-print"})]}),c.jsxs("div",{className:"footer-notes-print text-xs text-center my-4 space-y-1 text-gray-600",children:[c.jsx("p",{className:"no-print-in-iframe",children:"BIR Permit No. AGWA-001-012025-000001 | Date Issued: 01/01/2025"}),c.jsx("p",{children:"Please settle your account on or before the due date to avoid disconnection and late payment penalties."}),c.jsx("p",{className:"font-semibold",children:"CUSTOMER SERVICE: 1627-AGWA | support@agwa-waterservices.com.ph"})]}),c.jsxs("div",{className:"payment-stub-print mt-5 p-3.5 border-t-2 border-dashed border-gray-500 text-xs no-print-in-iframe",children:[c.jsx("h5",{className:"font-bold text-center mb-2 text-slate-700 text-sm",children:"PAYMENT STUB (For Accredited Centers)"}),c.jsx(w,{label:"Acct. No.",value:r.accountNumber,valueClass:"font-bold"}),c.jsx(w,{label:"Acct. Name",value:r.displayName||r.email}),c.jsx(w,{label:"Invoice No.",value:g}),c.jsx(w,{label:"Amount Due",value:`${u}`,valueClass:"font-bold text-lg"}),c.jsx(w,{label:"Due Date",value:bt(t.dueDate,{month:"long",day:"numeric",year:"numeric"}),valueClass:"font-bold"}),c.jsx("div",{className:"py-2",children:c.jsx(rA,{value:g})})]})]})]})})]})},MO=({user:n,userData:e,db:t,showNotification:r,billingService:s,systemSettings:o={}})=>{const[a,u]=B.useState([]),[d,f]=B.useState(!0),[g,y]=B.useState(""),[x,w]=B.useState(null),[E,S]=B.useState(!1),[A,N]=B.useState(!1),[z,U]=B.useState(null),[W,$]=B.useState(""),[F,R]=B.useState(!1),[k,P]=B.useState(null),[T,D]=B.useState(!1),{isOnlinePaymentsEnabled:L=!0}=o,C=JSON.stringify(o);B.useEffect(()=>{const Q=async()=>{f(!0),y("");const Z=await up(t,n.uid);if(Z.success){const q=Z.data.sort((ne,V)=>{var be,Be;const de=(be=ne.billDate)!=null&&be.toDate?ne.billDate.toDate():new Date(0);return((Be=V.billDate)!=null&&Be.toDate?V.billDate.toDate():new Date(0))-de}).map(ne=>{const V=s(ne.consumption,e.serviceType,e.meterSize,o),de=V.totalCalculatedCharges+(ne.previousUnpaidAmount||0)-(ne.seniorCitizenDiscount||0);return{...ne,amount:de,calculatedCharges:V}});u(q)}else y(Z.error||"Failed to fetch your bills."),r(Z.error||"Failed to fetch bills.","error");f(!1)};n!=null&&n.uid&&(e!=null&&e.serviceType)&&Q()},[t,n.uid,r,s,e.serviceType,e.meterSize,C]);const G=Q=>{w(Q),S(!0)},K=async({billId:Q,paymentMethod:Z,amountPaid:M,paymentReference:q})=>{N(!0);const ne=await Vk(t,Q,{status:"Paid",paymentDate:new Date,amountPaid:M,paymentMethod:Z,paymentReference:q});N(!1),ne.success?(r("Payment successful! Your bill status has been updated.","success"),S(!1),w(null),u(V=>V.map(de=>de.id===Q?{...de,status:"Paid"}:de))):r(ne.error||"Payment processing failed.","error")},ce=async Q=>{U(Q),$(""),R(!0);try{const Z=Q.calculatedCharges,M=`
                Explain this water bill to a customer named ${e.displayName}. 
                Be friendly, clear, and encouraging. Use markdown for formatting like **bolding**.
                
                Bill Details:
                - Bill Period: ${Q.monthYear}
                - Total Amount Due: **${Q.amount.toFixed(2)}**
                - Due Date: ${bt(Q.dueDate)}
                - Water Consumption: **${Q.consumption} cubic meters**

                Explain the breakdown clearly:
                1.  **Basic Charge (${Z.basicCharge.toFixed(2)})**: This is the main cost for the ${Q.consumption} cubic meters of water you used, based on your '${e.serviceType}' tariff rate.
                2.  **Other Charges**: Briefly explain what these are for.
                    - FCDA (${Z.fcda.toFixed(2)}): A small adjustment for foreign currency costs.
                    - Environmental Charge (${Z.environmentalCharge.toFixed(2)}): This funds wastewater treatment and protects our environment.
                    - Maintenance Service Charge (${Z.maintenanceServiceCharge.toFixed(2)}): A fixed fee for meter upkeep.
                3.  **Taxes (${Z.vat.toFixed(2)})**: This is the 12% Value Added Tax required by the government.
                4.  **Previous Unpaid Balance**: Mention if there is a previous balance of ${(Q.previousUnpaidAmount||0).toFixed(2)}.

                Conclude by summarizing how all these add up to the Total Amount Due and gently remind them of the due date.
            `,q=await Vi(M);$(q)}catch{$("Sorry, I couldn't generate an explanation right now. The detailed breakdown is available on the full invoice."),r("AI explanation failed.","error")}finally{R(!1)}},ue=Q=>{P(Q),D(!0)};return d?c.jsx(Nt,{message:"Loading your bills..."}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsx(Uo,{size:30,className:"mr-3 text-blue-600"})," My Bills & Payment History"]}),g&&c.jsx("div",{className:"text-red-500 bg-red-50 p-3 rounded-md text-center",children:g}),a.length===0&&!g&&c.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[c.jsx(on,{size:48,className:"mx-auto text-gray-400 mb-4"}),c.jsx("p",{className:"text-gray-600 text-lg",children:"No billing history found."})]}),c.jsx("div",{className:"space-y-4",children:a.map(Q=>c.jsxs("div",{className:`p-4 rounded-lg shadow-md border-l-4 ${Q.status==="Paid"?"bg-green-50 border-green-400":"bg-yellow-50 border-yellow-400"}`,children:[c.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:Q.monthYear}),c.jsxs("p",{className:"text-sm text-gray-600",children:["Due: ",bt(Q.dueDate,{month:"long",day:"numeric"})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("p",{className:"text-2xl font-bold text-gray-700",children:["",Q.amount.toFixed(2)]}),c.jsx("p",{className:`text-sm font-semibold ${Q.status==="Paid"?"text-green-600":"text-red-600"}`,children:Q.status})]})]}),c.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200/80 flex flex-wrap gap-2 justify-end",children:[c.jsxs("button",{onClick:()=>ue(Q),className:"text-xs font-medium bg-blue-100 text-blue-700 hover:bg-blue-200 px-3 py-1.5 rounded-md transition flex items-center",children:[c.jsx(qa,{size:14,className:"mr-1"}),"View Invoice"]}),c.jsxs("button",{onClick:()=>ce(Q),className:"text-xs font-medium bg-purple-100 text-purple-700 hover:bg-purple-200 px-3 py-1.5 rounded-md transition flex items-center",disabled:F&&(z==null?void 0:z.id)===Q.id,children:[F&&(z==null?void 0:z.id)===Q.id?c.jsx(Ge,{size:14,className:"animate-spin mr-1"}):c.jsx(Kr,{size:14,className:"mr-1"})," Explain Bill"]}),Q.status==="Unpaid"&&L&&c.jsxs("button",{onClick:()=>G(Q),className:"text-xs font-bold bg-green-500 text-white hover:bg-green-600 px-4 py-1.5 rounded-md transition flex items-center",children:[c.jsx("span",{className:"mr-1 font-bold",children:""})," Pay Now"]})]})]},Q.id))}),c.jsx(Xr,{isOpen:!!z,onClose:()=>U(null),title:`Explanation for ${z==null?void 0:z.monthYear} Bill`,size:"lg",children:F?c.jsx(Nt,{message:"Agie is analyzing your bill..."}):c.jsx("div",{className:"prose prose-sm max-w-none whitespace-pre-line leading-relaxed p-2",dangerouslySetInnerHTML:{__html:z?W.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"):W}})}),E&&c.jsx(hO,{isOpen:E,onClose:()=>S(!1),billToPay:x,onConfirmPayment:K,isProcessingPayment:A,userData:e}),T&&c.jsx(cA,{isOpen:T,onClose:()=>D(!1),bill:k,userData:e,calculateBillDetails:s})]})},uA={"District 1":["Alicia","Bago Bantay","Bagong Pag-asa","Bungad","Damar","Damayan","Del Monte","Katipunan","Mariblo","Masambong","N.S. Amoranto","Paltok","Paraiso","Phil-Am","Project 6","Ramon Magsaysay","Saint Peter","San Antonio","San Isidro Labrador","San Jose","Santa Cruz","Santa Teresita","Siena","Talayan","Vasra","Veterans Village","West Triangle"],"District 2":["Bagong Silangan","Batasan Hills","Commonwealth","Holy Spirit","Payatas"],"District 3":["Amihan","Bagumbayan","Bagumbuhay","Bayanihan","Blue Ridge A","Blue Ridge B","Camp Aguinaldo","Claro","Dioquino Zobel","Duyan-duyan","E. Rodriguez","East Kamias","Escopa I","Escopa II","Escopa III","Escopa IV","Libis","Loyola Heights","Mangga","Marilag","Masagana","Matandang Balara","Milagrosa","Pansol","Quirino 2-A","Quirino 2-B","Quirino 2-C","Quirino 3-A","St. Ignatius","San Roque","Silangan","Socorro","Tagumpay","Ugong Norte","West Kamias","White Plains"],"District 4":["Bagong Lipunan ng Crame","Botocan","Central","Damayang Lagi","Don Manuel","Doa Aurora","Doa Imelda","Doa Josefa","Horseshoe","Immaculate Conception","Kalusugan","Kamuning","Kaunlaran","Kristong Hari","Krus na Ligas","Laging Handa","Malaya","Mariana","Obrero","Old Capitol Site","Paligsahan","Pinyahan","Pinagkaisahan","Roxas","Sacred Heart","San Isidro Galas","San Martin de Porres","San Vicente","Santol","Sikatuna Village","South Triangle","Sto. Nio","Tatalon","Teacher's Village East","Teacher's Village West","U.P. Campus","U.P. Village","Valencia"],"District 5":["Bagbag","Capri","Fairview","Gulod","Greater Lagro","Kaligayahan","Nagkaisang Nayon","North Fairview","Novaliches Proper","Pasong Putik Proper","San Agustin","San Bartolome","Sta. Lucia","Sta. Monica"],"District 6":["Apolonio Samson","Baesa","Balon Bato","Culiat","New Era","Pasong Tamo","Sangandaan","Sauyo","Talipapa","Tandang Sora","Unang Sigaw"]},fv=()=>Object.keys(uA),Ic=n=>uA[n]||[],Rs="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",Cu="bg-gray-200 cursor-not-allowed text-gray-500",LO=({user:n,userData:e,setUserData:t,auth:r,db:s,showNotification:o})=>{var T;const[a,u]=B.useState(!1),[d,f]=B.useState({}),[g,y]=B.useState({district:"",barangay:"",street:"",landmark:""}),[x,w]=B.useState(!1),[E,S]=B.useState(""),[A,N]=B.useState([]),[z,U]=B.useState([]);B.useEffect(()=>{if(N(fv()),e)if(f({...e}),e.serviceAddress&&typeof e.serviceAddress=="object"){const D=e.serviceAddress.district||"";y(e.serviceAddress),D&&U(Ic(D))}else y({district:"",barangay:"",street:"",landmark:""})},[e]);const W=D=>!D||typeof D!="object"?"N/A":[D.street,D.barangay,D.district,"Quezon City"].filter(C=>C&&C.trim()).join(", "),$=D=>{const{name:L,value:C}=D.target;y(G=>{const K={...G,[L]:C};return L==="district"&&(K.barangay="",U(Ic(C))),K})},F=D=>{const{name:L,value:C}=D.target;f(G=>({...G,[L]:C}))},R=async D=>{var G,K;if(D.preventDefault(),S(""),!((G=d.displayName)!=null&&G.trim())){S("Display Name cannot be empty.");return}w(!0);const L={displayName:d.displayName.trim(),photoURL:((K=d.photoURL)==null?void 0:K.trim())||"",serviceAddress:g},C=await Ql(s,n.uid,L);if(!C.success){o(C.error||"Failed to update profile in database.","error"),w(!1);return}t(ce=>({...ce,...L})),o("Profile updated successfully!","success"),u(!1),w(!1)},k=()=>{u(!1),S(""),e.serviceAddress&&typeof e.serviceAddress=="object"&&y(e.serviceAddress)};if(!e)return c.jsx(Nt,{message:"Loading profile..."});const P=d.photoURL||MM(d.displayName);return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[c.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Jk,{size:30,className:"mr-3 text-blue-600"})," My Profile"]}),!a&&c.jsxs("button",{onClick:()=>u(!0),className:"flex items-center bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg",children:[c.jsx(lv,{size:18,className:"mr-2"})," Edit Profile"]})]}),E&&c.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[c.jsx(Yt,{size:20,className:"mr-2"})," ",E]}),c.jsxs("form",{onSubmit:R,className:"space-y-5",children:[c.jsxs("div",{className:"text-center space-y-3",children:[c.jsx("img",{src:P,alt:"Profile",className:"h-28 w-28 rounded-full object-cover border-4 border-blue-200 shadow-md bg-gray-200 mx-auto"}),a&&c.jsx("input",{type:"url",name:"photoURL",value:d.photoURL||"",onChange:F,className:`${Rs} max-w-sm mx-auto text-center`,placeholder:"Image URL"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[c.jsx(ms,{size:14,className:"mr-1.5"}),"Full Name"]}),a?c.jsx("input",{type:"text",name:"displayName",value:d.displayName||"",onChange:F,className:Rs}):c.jsx("p",{className:`${Rs} ${Cu}`,children:d.displayName})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[c.jsx(Fi,{size:14,className:"mr-1.5"}),"Email Address"]}),c.jsx("p",{className:`${Rs} ${Cu}`,children:d.email})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[c.jsx(Oi,{size:14,className:"mr-1.5"}),"Account Number"]}),c.jsx("p",{className:`${Rs} ${Cu}`,children:d.accountNumber})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[c.jsx(Hk,{size:14,className:"mr-1.5"}),"User Role"]}),c.jsx("p",{className:`${Rs} ${Cu} capitalize`,children:(T=d.role)==null?void 0:T.replace("_"," ")})]})]}),c.jsxs("div",{className:"pt-4 mt-4 border-t",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Service Address"}),a?c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"District"}),c.jsxs("select",{name:"district",value:g.district,onChange:$,className:Rs,children:[c.jsx("option",{value:"",children:"Select District"}),A.map(D=>c.jsx("option",{value:D,children:D},D))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Barangay"}),c.jsxs("select",{name:"barangay",value:g.barangay,onChange:$,className:Rs,disabled:!g.district,children:[c.jsx("option",{value:"",children:"Select Barangay"}),z.map(D=>c.jsx("option",{value:D,children:D},D))]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Street Name, Building, House No."}),c.jsx("input",{type:"text",name:"street",value:g.street,onChange:$,className:Rs})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Landmark"}),c.jsx("input",{type:"text",name:"landmark",value:g.landmark,onChange:$,className:Rs})]})]}):c.jsx("p",{className:`${Rs} ${Cu}`,children:W(d.serviceAddress)})]}),a&&c.jsxs("div",{className:"flex justify-end space-x-4 pt-5",children:[c.jsx("button",{type:"button",onClick:k,className:"px-6 py-2.5 text-sm font-medium bg-gray-100 rounded-lg",disabled:x,children:"Cancel"}),c.jsxs("button",{type:"submit",className:"px-6 py-2.5 text-sm font-medium text-white bg-green-600 rounded-lg flex items-center",disabled:x,children:[x?c.jsx(Ge,{size:18,className:"animate-spin mr-2"}):c.jsx(Qo,{size:18,className:"mr-2"}),x?"Saving...":"Save Changes"]})]})]})]})};function OO(n,e,t){const[r,s]=B.useState(n),[o,a]=B.useState({}),[u,d]=B.useState(!1),[f,g]=B.useState(!1),y=B.useCallback(S=>{const{name:A,value:N,type:z,checked:U}=S.target;s(W=>({...W,[A]:z==="checkbox"?U:N})),o[A]&&a(W=>({...W,[A]:void 0}))},[o]),x=B.useCallback((S,A)=>{s(N=>({...N,[S]:A})),o[S]&&a(N=>({...N,[S]:void 0}))},[o]),w=B.useCallback(()=>{s(n),a({}),d(!1),g(!1)},[n]);return{values:r,setValues:s,setFieldValue:x,errors:o,setErrors:a,isLoading:u,handleChange:y,handleSubmit:async S=>{if(S&&S.preventDefault(),f)return;g(!0),d(!0),a({});let A={};if(e&&(A=e(r),a(A)),Object.keys(A).length===0)try{t&&await t(r,w)}catch(N){console.error("Form submission error:",N),a(z=>({...z,submit:N.message||"An unexpected error occurred during submission."}))}d(!1),g(!1)},resetForm:w}}const bm=({children:n,text:e,position:t="top",className:r="",delay:s=100})=>{const[o,a]=B.useState(!1),[u,d]=B.useState(null),f=()=>{const w=setTimeout(()=>{a(!0)},s);d(w)},g=()=>{u&&(clearTimeout(u),d(null)),a(!1)},y={top:"bottom-full left-1/2 -translate-x-1/2 mb-2",bottom:"top-full left-1/2 -translate-x-1/2 mt-2",left:"right-full top-1/2 -translate-y-1/2 mr-2",right:"left-full top-1/2 -translate-y-1/2 ml-2"},x={top:"absolute left-1/2 -translate-x-1/2 top-full h-0 w-0 border-x-4 border-x-transparent border-t-4 border-t-gray-800",bottom:"absolute left-1/2 -translate-x-1/2 bottom-full h-0 w-0 border-x-4 border-x-transparent border-b-4 border-b-gray-800",left:"absolute top-1/2 -translate-y-1/2 left-full h-0 w-0 border-y-4 border-y-transparent border-l-4 border-l-gray-800",right:"absolute top-1/2 -translate-y-1/2 right-full h-0 w-0 border-y-4 border-y-transparent border-r-4 border-r-gray-800"};return e?c.jsxs("div",{className:"relative inline-flex",onMouseEnter:f,onMouseLeave:g,onFocus:f,onBlur:g,tabIndex:0,children:[n,o&&c.jsxs("div",{role:"tooltip",className:`absolute z-50 whitespace-nowrap px-3 py-1.5 text-xs font-medium text-white bg-gray-800 rounded-md shadow-lg transition-opacity duration-150 ease-in-out opacity-100 ${y[t]} ${r}`,children:[e,c.jsx("div",{className:x[t]})]})]}):c.jsx(c.Fragment,{children:n})},gy="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",yy="flex items-center justify-center px-5 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95 text-sm",FO=({user:n,userData:e,db:t,auth:r,showNotification:s})=>{const o={issueType:"",description:"",issueAddress:(e==null?void 0:e.serviceAddress)||(e==null?void 0:e.accountNumber)||""},[a,u]=B.useState(!1),[d,f]=B.useState(!1),g=T=>{const D={};return T.issueType||(D.issueType="Please select an issue type."),T.description.trim()||(D.description="Description cannot be empty."),T.issueAddress.trim()||(D.issueAddress="Please specify the location of the issue."),D},y=async(T,D)=>{const L={...T,userId:n.uid,userName:e.displayName,userEmail:e.email,accountNumber:e.accountNumber||"N/A"},C=await sL(t,L);C.success?(s("Support ticket submitted successfully!","success"),D()):s(C.error||"Failed to submit ticket.","error")},{values:x,errors:w,isLoading:E,handleChange:S,handleSubmit:A,setFieldValue:N}=OO(o,g,y),z=["Billing Discrepancy or Inquiry","Water Leak (Before Meter)","Water Leak (After Meter - Your Property)","No Water Supply / Low Pressure","Water Quality Issue (Color, Odor, Taste)","Meter Problem (Damaged, Stuck, Inaccurate)","Online Portal Issue / Account Access","Request for Service (Disconnection/Reconnection)","Chatbot Assistance Follow-up","Other Concern"],U=["Unable to Access Meter","Damaged or Tampered Meter Found","Suspected Illegal Connection","Route Data Inaccuracy","Safety Concern on Route","Device or App Problem","Customer Inquiry on Field","Other Field Report"],W=["Payment Posting Issue","Customer Account Inquiry","Bill Printing Problem","System Access/Login Issue","Other Office Concern"],$=["User Role/Permission Change Request","Data Correction Request","System Bug Report","Feature Request","Urgent System Alert"],[F,R]=B.useState(z);B.useEffect(()=>{switch(e==null?void 0:e.role){case"meter_reader":R(U);break;case"clerk_cashier":R(W);break;case"admin":R($);break;default:R(z)}N("issueType","")},[e.role,N]);const k=async()=>{if(!x.description.trim()){s("Please describe your issue first before using the AI categorizer.","warning");return}u(!0);try{const D=`Based on the following user complaint, which of these categories does it best fit into? Categories: [${F.join(", ")}]. Respond with only the exact category name from the list and nothing else. Complaint: "${x.description}"`;let L=await Vi(D);L=L.replace(/["'.]/g,"").trim(),F.includes(L)?(N("issueType",L),s(`AI suggested category: "${L}"`,"success")):s("AI could not determine a matching category. Please select one manually.","info")}catch(T){s(T.message||"AI categorization failed.","error")}finally{u(!1)}},P=async()=>{if(!x.description.trim()){s("Please provide some keywords or a brief description for the AI to expand upon.","warning");return}f(!0);try{const T=`You are helping a user report an issue to AGWA Water Services. Elaborate on the following user-provided details to create a clear, detailed, and formal issue description. Be polite and include any relevant questions the user might need to answer. Do not add any extra commentary, just provide the refined description.

User's input: "${x.description}"`,D=await Vi(T);N("description",D),s("AI has helped draft your issue description!","success")}catch(T){s(T.message||"AI assistance failed.","error")}finally{f(!1)}};return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Yt,{size:30,className:"mr-3 text-orange-500"})," Report an Issue or Concern"]})}),c.jsxs("form",{onSubmit:A,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"issueType",className:"text-sm font-medium text-gray-700 mb-1 flex items-center",children:[c.jsx(Qk,{size:16,className:"mr-1.5 text-gray-500"})," Issue Type / Category *"]}),c.jsxs("div",{className:"flex gap-2 items-center",children:[c.jsxs("select",{id:"issueType",name:"issueType",value:x.issueType,onChange:S,className:`${gy} ${w.issueType?"border-red-500":""}`,children:[c.jsx("option",{value:"",disabled:!0,children:"Select the type of issue..."}),F.map(T=>c.jsx("option",{value:T,children:T},T))]}),c.jsx(bm,{text:"Let AI suggest a category based on your description below.",children:c.jsx("button",{type:"button",onClick:k,className:`${yy} w-auto bg-blue-100 text-blue-700 hover:bg-blue-200 focus:ring-blue-300 px-3`,disabled:a||E,children:a?c.jsx(Ge,{size:16,className:"animate-spin"}):c.jsx(Kr,{size:16})})})]}),w.issueType&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:w.issueType})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"issueAddress",className:"text-sm font-medium text-gray-700 mb-1 flex items-center",children:[c.jsx(_c,{size:16,className:"mr-1.5 text-gray-500"})," Address / Location of Issue *"]}),c.jsx("input",{type:"text",id:"issueAddress",name:"issueAddress",value:x.issueAddress,onChange:S,className:`${gy} ${w.issueAddress?"border-red-500":""}`,placeholder:"E.g., Your service address, specific street, or account number if general"}),w.issueAddress&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:w.issueAddress})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsxs("label",{htmlFor:"description",className:"text-sm font-medium text-gray-700 flex items-center",children:[c.jsx(VL,{size:16,className:"mr-1.5 text-gray-500"})," Detailed Description of Issue *"]}),c.jsx(bm,{text:x.description.trim()?"Use AI to help draft or refine your description.":"Write a description first to enable AI Assist",children:c.jsxs("button",{type:"button",onClick:P,className:`${yy} text-xs bg-purple-100 text-purple-700 hover:bg-purple-200 focus:ring-purple-300 py-1.5 px-3`,disabled:d||E||!x.description.trim(),children:[d?c.jsx(Ge,{size:16,className:"animate-spin mr-1.5"}):c.jsx(Kr,{size:16,className:"mr-1.5"}),d?"Drafting...":"AI Assist"]})})]}),c.jsx("textarea",{id:"description",name:"description",value:x.description,onChange:S,rows:"6",className:`${gy} ${w.description?"border-red-500":""}`,placeholder:"Please provide as much detail as possible: What is the problem? When did it start? Any specific error messages or observations?"}),w.description&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:w.description})]}),c.jsx("div",{className:"pt-3",children:c.jsxs("button",{type:"submit",className:`${yy} w-full bg-orange-500 hover:bg-orange-600 text-white focus:ring-orange-400`,disabled:E||d||a,children:[E?c.jsx(Ge,{size:20,className:"animate-spin mr-2"}):c.jsx(dp,{size:18,className:"mr-2"}),E?"Submitting Report...":"Submit Issue Report"]})})]})]})},VO=[{q:"How do I register for an online account?",a:"Click 'Sign Up' on the login page. Provide your full name, AGWA account number (e.g., RES-12345), a valid email address, and create a password of at least 6 characters."},{q:"I forgot my password. How can I reset it?",a:"On the login page, click the 'Forgot Password?' link. Enter the email address associated with your AGWA account, and we'll send you a link to reset your password."},{q:"How can I pay my water bill through this portal?",a:"Once logged in, navigate to 'My Bills'. Select an unpaid bill, click 'Pay Now', and choose a simulated payment option (e.g., GCash, Maya, Bank Transfer, Credit Card). Please note that payments in this portal are for demonstration purposes only. For actual payments, please use AGWA's officially accredited payment channels."},{q:"How is my water consumption calculated?",a:"Your consumption is the difference between your current meter reading and your previous meter reading, measured in cubic meters (m). This consumption is then used with the tariff rates applicable to your service type to calculate your water bill charges."},{q:"What are the different charges on my bill?",a:"Your bill typically includes a Basic Charge (based on consumption and service type), Foreign Currency Differential Adjustment (FCDA), Environmental Charge (EC), Sewerage Charge (SC, if applicable), Maintenance Service Charge (based on your meter size), Government Taxes, and Value Added Tax (VAT). You can use the ' Explain Bill' feature in the 'My Bills' section for a personalized breakdown of a specific bill."},{q:"How can I view my past bills and payment history?",a:"Navigate to the 'My Bills' section after logging in. You'll find a history of your past bills, their status (Paid/Unpaid), and payment details if paid via the portal (simulated). You can also view a detailed invoice for each bill."},{q:"What should I do if I suspect a water leak at my premises?",a:"If it's safe to do so, try to identify the source of the leak and turn off your main water shut-off valve (usually located near your meter). Immediately report the suspected leak to AGWA via the 'Report Issue' section in the portal or by calling our 24/7 emergency hotline: 1627-AGWA (1627-2492)."},{q:"My water supply is interrupted. What should I do?",a:"First, check for any service advisories on our official AGWA website or social media channels. If there are no posted advisories for your area, please report the interruption via the 'Report Issue' section in the portal or call our customer service hotline with your account details."},{q:"Can I change my registered email address or other profile details?",a:"You can update your Display Name, Photo URL, Service Address, and Meter Size in the 'My Profile' section. For changes to critical information like your registered email address (if it's your primary login ID), account number, or assigned role, please contact AGWA customer support for assistance and verification."},{q:"What is FCDA (Foreign Currency Differential Adjustment)?",a:"FCDA is a tariff mechanism approved by regulatory bodies that allows water utilities like AGWA to recover or pass on to customers the gains or losses arising from fluctuations in foreign exchange rates. These fluctuations affect the cost of foreign currency-denominated loans and expenses used for service improvements and operational needs."},{q:"Why is there an Environmental Charge (EC) on my bill?",a:"The Environmental Charge (EC) is a fee collected to fund projects and initiatives related to wastewater treatment, septage management, and other environmental protection programs. This helps ensure that water resources are used sustainably and that wastewater is treated properly before being discharged back into the environment."},{q:"What if I think my water meter is malfunctioning or inaccurate?",a:"If you suspect your water meter is not recording your consumption accurately, please report it immediately. You can do this through the 'Report Issue' section of the portal (select 'Meter Problem') or by contacting AGWA customer service. We will arrange for an inspection and testing of your meter."},{q:"How often are water meters read?",a:"Water meters are typically read on a monthly cycle. The specific reading schedule can vary by area. Your billing statement will indicate the period covered by the meter reading (e.g., 'Billing Period: 01 Jan 2025 to 31 Jan 2025')."},{q:"Are there discounts for senior citizens or Persons with Disabilities (PWDs)?",a:"Yes, AGWA Water Services adheres to Republic Act No. 9994 (Expanded Senior Citizens Act) and Republic Act No. 10754 (Act Expanding the Benefits and Privileges of Persons with Disability). Qualified senior citizens and PWDs are entitled to a discount on their water consumption, subject to certain conditions (e.g., the account must be registered in their name, consumption limits). Please update your details in 'My Profile' or contact customer service with the necessary identification to apply for these discounts."},{q:"How do I update my contact number or service address on file with AGWA?",a:"You can update your Service Address directly in the 'My Profile' section of this portal. For changes to your primary contact number, especially if it's used for OTPs or critical alerts, it's best to contact AGWA customer service or visit one of our business offices to ensure your records are accurately updated and verified."},{q:"What are the accepted payment methods for my water bill?",a:"This portal simulates payments via various methods for demonstration. For actual payments, AGWA accepts payments through a wide range of accredited channels, including: AGWA Business Offices, Bayad Centers, 7-Eleven, SM Bills Payment, selected banks (over-the-counter and online banking), and mobile wallets like GCash and Maya. Please refer to the official AGWA website or your bill statement for a complete list of authorized payment partners."},{q:"How can I get an official receipt (OR) after making a payment?",a:"For payments made through this portal (which are simulated), a transaction reference is provided. For actual payments made via AGWA's accredited channels, an official receipt or proof of payment will be issued by that specific channel (e.g., a bank validation slip, a payment center receipt, a digital receipt from an e-wallet). AGWA is continuously working on enhancing digital services, including the future provision of consolidated digital ORs through the portal."},{q:"What is a 'meter deposit' for new service connections?",a:"A meter deposit is a one-time charge collected from customers upon application for a new water service connection. This deposit serves as a security against potential unpaid bills or damages to the water meter. It is refundable, with interest (if applicable by law), upon termination of the service contract, provided all outstanding obligations to AGWA have been settled."},{q:"How do I report a damaged, leaking, or stolen water meter?",a:"Report any instance of a damaged, leaking, or stolen water meter to AGWA immediately. You can use the 'Report Issue' section in this portal (select 'Meter Problem') or call our emergency hotline. Tampering with or unauthorized removal of water meters is illegal and may result in penalties."},{q:"Can I request for a temporary disconnection of my water service if I'll be away for an extended period?",a:"Yes, you can request a temporary or voluntary disconnection of your water service. To do this, please visit any AGWA business office to file your formal request. There might be applicable fees for the disconnection and subsequent reconnection process. Please inquire about the specific requirements and charges."}],zO=()=>c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(qL,{size:30,className:"mr-3 text-blue-600"}),"Frequently Asked Questions"]})}),c.jsx("div",{className:"space-y-4",children:VO.map((n,e)=>c.jsxs("details",{className:"group bg-gray-50 hover:bg-gray-100 p-4 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 ease-in-out",children:[c.jsxs("summary",{className:"flex justify-between items-center font-medium cursor-pointer list-none text-gray-900 text-sm sm:text-base",children:[c.jsx("span",{className:"group-open:text-blue-700 group-open:font-semibold",children:n.q}),c.jsx("span",{className:"transition-transform duration-300 transform group-open:rotate-180 text-blue-600 group-open:text-blue-700",children:c.jsx(_L,{size:24})})]}),c.jsx("div",{className:"text-gray-600 mt-3 prose prose-sm max-w-none grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:c.jsx("div",{className:"overflow-hidden",children:c.jsx("p",{className:"pb-2",children:n.a})})})]},e))})]}),UO=()=>{const n=[{letter:"C",word:"Customer-Centricity",desc:"Our customers are at the heart of every decision and action we take, ensuring their needs are met with utmost priority and care.",icon:ms},{letter:"R",word:"Responsibility",desc:"We hold ourselves accountable for our impact on the communities we serve and the environment, operating with integrity and a commitment to social good.",icon:Gd},{letter:"E",word:"Excellence",desc:"We relentlessly pursue the highest standards in all aspects of our service, operations, and innovation, striving for continuous improvement.",icon:Kr},{letter:"S",word:"Sustainability",desc:"We are dedicated to the long-term health and viability of our precious water resources and the planet, implementing eco-friendly practices.",icon:Bo},{letter:"T",word:"Teamwork & Integrity",desc:"We foster a collaborative environment built on mutual respect, honesty, and transparency, working together to achieve our common goals.",icon:Sc}],e=[{title:"Deliver Quality",description:"Consistently provide safe, reliable, and affordable water and wastewater services that exceed customer expectations and meet stringent regulatory standards."},{title:"Innovate & Adapt",description:"Embrace technological advancements and innovative practices to enhance operational efficiency, service delivery, and resource management in an ever-changing world."},{title:"Customer First",description:"Cultivate a culture of exceptional customer care through responsive, transparent, fair, and easily accessible service channels, including this advanced digital portal."},{title:"Protect Resources",description:"Champion water conservation, actively work to reduce non-revenue water, and promote environmental protection through sustainable practices and robust community engagement."},{title:"Empower People",description:"Invest in the growth, professional development, and overall well-being of our employees, fostering a skilled, motivated, diverse, and safety-conscious workforce."},{title:"Community Partnership",description:"Actively contribute to the socio-economic development, health, and resilience of the communities we serve through targeted corporate social responsibility programs and collaborative partnerships."}];return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn leading-relaxed text-gray-700",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(on,{size:30,className:"mr-3 text-blue-600"}),"About AGWA Water Services, Inc."]})}),c.jsxs("section",{className:"mb-8",children:[c.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[c.jsx(Wk,{size:22,className:"mr-2.5 text-blue-600/80"})," Our Genesis & Enduring Commitment"]}),c.jsx("p",{children:"AGWA Water Services, Inc. was established in 2005 with a singular, profound vision: to ensure every Filipino has access to clean, safe, and sustainable water. Recognizing water as the cornerstone of life, health, and economic progress, AGWA embarked on a mission to become a leading force in the Philippine water utility sector. From humble beginnings, we have grown through unwavering dedication, strategic investments in infrastructure and technology, and a deep-rooted commitment to the communities we are privileged to serve. Our journey has been one of continuous learning, adaptation, and an ever-stronger resolve to meet the evolving water needs of a dynamic nation."})]}),c.jsxs("section",{className:"mb-8",children:[c.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[c.jsx(Kr,{size:22,className:"mr-2.5 text-blue-600/80"})," Operational Excellence & Innovation"]}),c.jsx("p",{children:"At the heart of AGWA lies a relentless pursuit of excellence. We employ state-of-the-art water sourcing techniques, advanced multi-stage treatment processes, and smart distribution networks, all managed by a team of highly skilled engineers, certified technicians, and dedicated customer service professionals. Our operations strictly adhere to, and often exceed, national and international quality standards (PNSDW, WHO guidelines), ensuring that the water reaching your taps is not just potable but of the highest purity and reliability. We continuously invest in research and development to innovate and improve our services, from leak detection technologies and pressure management systems to digital customer interfaces and data-driven resource planning."})]}),c.jsxs("section",{className:"mb-8",children:[c.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[c.jsx(Bo,{size:22,className:"mr-2.5 text-blue-600/80"})," Sustainability and Environmental Stewardship: Our Pledge"]}),c.jsx("p",{children:"AGWA is profoundly aware of its responsibility as a steward of one of Earth's most precious resources. Sustainability is not just a buzzword for us; it's integrated into every facet of our operations. This includes responsible water abstraction from diverse sources, active participation in watershed protection and reforestation programs, and the implementation of advanced wastewater treatment and water recycling initiatives to minimize our environmental footprint. We actively promote water conservation education among our consumers and invest in projects that enhance climate resilience and mitigate environmental impact, ensuring that future generations can also enjoy the gift of clean water."})]}),c.jsxs("div",{className:"my-10 p-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-xl shadow-xl text-center",children:[c.jsx(qa,{size:36,className:"mx-auto mb-3 text-blue-200"}),c.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Our Vision"}),c.jsx("p",{className:"italic text-lg text-blue-100 leading-relaxed max-w-3xl mx-auto",children:`"To be the Philippines' most trusted and innovative water solutions provider, empowering communities with sustainable access to life-enhancing water services and championing environmental stewardship for a resilient future."`})]}),c.jsxs("div",{className:"my-10",children:[c.jsxs("h3",{className:"text-2xl font-bold text-blue-700 mb-6 text-center flex items-center justify-center",children:[c.jsx(KL,{size:28,className:"mr-3 text-blue-600"})," Our Mission"]}),c.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-5",children:e.map((t,r)=>c.jsxs("div",{className:"bg-blue-50 p-5 rounded-lg shadow-md hover:shadow-lg transition-shadow h-full flex flex-col",children:[c.jsx("strong",{className:"text-blue-700 block text-md mb-1.5",children:t.title}),c.jsx("p",{className:"text-sm text-gray-600 leading-normal flex-grow",children:t.description})]},r))})]}),c.jsxs("div",{className:"my-12 pt-8 border-t border-gray-200",children:[c.jsx("h3",{className:"text-2xl font-bold text-blue-700 mb-8 text-center",children:"Our Core Values: The AGWA C.R.E.S.T."}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-5",children:n.map(t=>{const r=t.icon;return c.jsxs("div",{className:"p-5 border border-blue-100 rounded-xl bg-white shadow-lg hover:shadow-2xl transition-all duration-300 flex flex-col items-center text-center h-full hover:border-blue-300 transform hover:-translate-y-1",children:[c.jsx("div",{className:"p-3 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white mb-3 shadow-md",children:c.jsx(r,{className:"",size:32})}),c.jsx("p",{className:"text-4xl font-bold text-blue-600 mb-1",children:t.letter}),c.jsx("strong",{className:"text-blue-700 block text-md mb-1.5",children:t.word}),c.jsx("p",{className:"text-xs text-gray-600 mt-1 leading-snug flex-grow",children:t.desc})]},t.letter)})})]}),c.jsx("p",{className:"pt-8 mt-8 text-gray-800 font-medium text-center text-lg border-t border-gray-200",children:"AGWA Water Services, Inc.  Ensuring Clarity, Sustaining Life."})]})},BO=({type:n,href:e})=>{let t,r="hover:text-blue-700";switch(n){case"Facebook":t=NL,r="hover:text-blue-600";break;case"Twitter":t=QL,r="hover:text-sky-500";break;case"Instagram":t=DL,r="hover:text-pink-600";break;default:return null}return c.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:`text-gray-500 transition-colors duration-200 ${r}`,title:n,children:c.jsx(t,{size:28})})},$O=({systemSettings:n={}})=>{const{supportHotline:e="1627-AGWA (24/7 Emergency)",supportEmail:t="support@agwa-waterservices.com.ph"}=n,r=[{icon:Xk,title:"Customer Service Hotlines",lines:[{text:e,valueClass:"text-2xl font-semibold text-blue-700 tracking-tight"},{text:"(+63 2) 8162-2492 (Outside Metro Manila / Standard Hours)",valueClass:"text-lg text-gray-700"}],note:"Emergency reports are handled 24/7. General inquiries: Mon - Fri, 8 AM - 5 PM PHT.",bgColor:"bg-blue-50",iconColor:"text-blue-600"},{icon:Fi,title:"Email Support",lines:[{text:t,valueClass:"text-lg text-green-700 hover:underline"}],note:"For general inquiries, billing concerns, feedback, and non-urgent requests. Expect a response within 1-2 business days.",href:`mailto:${t}`,bgColor:"bg-green-50",iconColor:"text-green-600"}],s={title:"AGWA Head Office",addressLines:["AGWA Water Services Tower","123 Aqua Drive, Hydro Business Park","Quezon City, Metro Manila, Philippines 1101"],hours:"Mon - Fri, 8:00 AM - 5:00 PM PHT (Closed on weekends & public holidays)",note:"Walk-ins are welcome for payments and specific services. For complex concerns, an appointment is recommended to ensure specialist availability.",mapLink:"https://maps.google.com/?q=AGWA+Water+Services+Tower,Quezon+City",bgColor:"bg-gray-100",iconColor:"text-gray-600"},o=[{type:"Facebook",href:"https://facebook.com/AGWAwaterservices"},{type:"Twitter",href:"https://twitter.com/AGWAwaterserv"},{type:"Instagram",href:"https://instagram.com/AGWAwater"}];return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Wi,{size:30,className:"mr-3 text-blue-600"}),"Get In Touch With AGWA"]})}),c.jsx("p",{className:"text-gray-700 mb-8 leading-relaxed text-sm sm:text-base",children:"We value your feedback and are dedicated to assisting you with your water service needs. For immediate assistance, especially during emergencies like major leaks or widespread service interruptions, please use our 24/7 hotline. For other inquiries, choose the most convenient channel below."}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:r.map((a,u)=>{const d=a.icon;return c.jsxs("div",{className:`p-5 rounded-xl shadow-lg hover:shadow-xl transition-shadow ${a.bgColor} border border-gray-200`,children:[c.jsxs("div",{className:"flex items-start mb-3",children:[c.jsx(d,{size:28,className:`mr-4 mt-1 flex-shrink-0 ${a.iconColor}`}),c.jsxs("div",{children:[c.jsx("h3",{className:`text-lg font-semibold ${a.iconColor}`,children:a.title}),a.lines.map((f,g)=>a.href&&g===0?c.jsx("a",{href:a.href,className:f.valueClass,children:f.text},g):c.jsx("p",{className:f.valueClass,children:f.text},g))]})]}),c.jsx("p",{className:"text-xs text-gray-500 leading-normal",children:a.note})]},u)})}),c.jsxs("div",{className:`p-5 rounded-xl shadow-lg hover:shadow-xl transition-shadow mb-8 ${s.bgColor} border border-gray-200`,children:[c.jsxs("div",{className:"flex items-start mb-3",children:[c.jsx(Wk,{size:28,className:`mr-4 mt-1 flex-shrink-0 ${s.iconColor}`}),c.jsxs("div",{children:[c.jsx("h3",{className:`text-lg font-semibold ${s.iconColor}`,children:s.title}),s.addressLines.map((a,u)=>c.jsx("p",{className:"text-sm text-gray-700 leading-snug",children:a},u))]})]}),c.jsxs("div",{className:"text-sm text-gray-600 space-y-1 mt-2",children:[c.jsxs("p",{className:"flex items-center",children:[c.jsx(bc,{size:14,className:"mr-2 text-gray-500"}),c.jsx("strong",{children:"Hours:"})," ",s.hours]}),c.jsxs("p",{className:"flex items-start",children:[c.jsx(_c,{size:14,className:"mr-2 mt-0.5 text-gray-500 flex-shrink-0"}),c.jsx("strong",{children:"Location Note:"})," ",s.note]})]}),c.jsxs("a",{href:s.mapLink,target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-flex items-center text-xs text-blue-600 hover:text-blue-800 hover:underline font-medium",children:["View on Map ",c.jsx(_c,{size:12,className:"ml-1"})]})]}),c.jsxs("div",{className:"mt-10 text-center border-t border-gray-200 pt-8",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Stay Connected"}),c.jsx("p",{className:"text-sm text-gray-600 mb-5 max-w-md mx-auto",children:"Follow us on our official social media channels for the latest news, service advisories, water conservation tips, and community program updates."}),c.jsx("div",{className:"flex justify-center space-x-6 sm:space-x-8",children:o.map(a=>c.jsx(BO,{type:a.type,href:a.href},a.type))}),c.jsxs("p",{className:"mt-8 text-xs text-gray-500",children:["For online self-service options, please ",c.jsx("button",{onClick:()=>{alert("Please log in to access self-service options.")},className:"text-blue-600 hover:underline font-medium",children:"log in"})," to your account. ",c.jsx("br",{}),"General information is also available on our official website: ",c.jsx("a",{href:"https://www.agwa-waterservices.com.ph",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-medium",children:"www.agwa-waterservices.com.ph"})]})]})]})},qO=({user:n,userData:e,db:t,showNotification:r,setActiveSection:s})=>{const[o,a]=B.useState({totalUsers:0,openTickets:0,activeAnnouncements:0,systemStatus:"Operational"}),[u,d]=B.useState(!0),[f,g]=B.useState(""),y=B.useCallback(async()=>{d(!0),g("");try{const w=await Promise.allSettled([Bk(t),$k(t),pL(t)]),[E,S,A]=w,N={systemStatus:"Operational"};let z="";E.status==="fulfilled"&&E.value.success?N.totalUsers=E.value.data.total:z+="Users data unavailable. ",S.status==="fulfilled"&&S.value.success?N.openTickets=S.value.data.open:z+="Tickets data unavailable. ",A.status==="fulfilled"&&A.value.success?N.activeAnnouncements=A.value.data.active:z+="Announcements data unavailable. ",a(U=>({...U,...N})),z.trim()&&(g(z.trim()),r(`Partial data load: ${z}`,"warning"))}catch{const E="A critical error occurred while fetching dashboard statistics.";g(E),r(E,"error"),a(S=>({...S,systemStatus:"Error"}))}finally{d(!1)}},[t,r]);B.useEffect(()=>{y()},[y]);const x=[{title:"User Management",icon:Sc,section:"userManagement",description:"View, edit, and manage all user accounts.",color:"blue"},{title:"Support Tickets",icon:Wi,section:"supportTickets",description:"Address and manage user-submitted issues.",color:"purple"},{title:"Announcements",icon:Sd,section:"manageAnnouncements",description:"Create and publish portal-wide announcements.",color:"teal"},{title:"System Analytics",icon:nv,section:"systemAnalytics",description:"View key metrics and system performance data.",color:"orange"},{title:"Meter Readings Mgt.",icon:Bo,section:"editMeterReadingsAdmin",description:"Oversee and manage meter reading entries.",color:"sky"},{title:"System Settings",icon:uv,section:"systemSettings",description:"Configure application parameters and settings.",color:"gray"}];return u?c.jsx(Nt,{message:"Loading admin dashboard statistics...",className:"mt-10 h-48"}):c.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[c.jsx("div",{className:"p-6 bg-gradient-to-r from-slate-700 to-slate-900 text-white rounded-xl shadow-2xl",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Administrator Dashboard"}),c.jsxs("p",{className:"mt-1 text-slate-300",children:["Welcome, ",(e==null?void 0:e.displayName)||"Admin",". Oversee portal operations."]})]}),c.jsxs("button",{onClick:y,className:"text-sm flex items-center bg-slate-600 hover:bg-slate-500 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70",disabled:u,title:"Refresh Statistics",children:[u?c.jsx(Ge,{size:16,className:"animate-spin"}):c.jsx(Ko,{size:16}),c.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),f&&c.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center flex items-center justify-center gap-2",children:[c.jsx(on,{size:16})," ",f]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:[c.jsx(or,{title:"Total Users",value:o.totalUsers??"N/A",icon:Sc,borderColor:"border-blue-500",iconColor:"text-blue-500",onClick:()=>s("userManagement")}),c.jsx(or,{title:"Open Support Tickets",value:o.openTickets??"N/A",icon:Yt,borderColor:"border-red-500",iconColor:"text-red-500",onClick:()=>s("supportTickets")}),c.jsx(or,{title:"Active Announcements",value:o.activeAnnouncements??"N/A",icon:Sd,borderColor:"border-teal-500",iconColor:"text-teal-500",onClick:()=>s("viewAnnouncements")}),c.jsx(or,{title:"System Status",value:o.systemStatus,icon:Gd,borderColor:o.systemStatus==="Error"?"border-red-500":"border-green-500",iconColor:o.systemStatus==="Error"?"text-red-500":"text-green-500"})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Administrative Tools"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(w=>c.jsxs("button",{onClick:()=>s(w.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${w.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[c.jsx("div",{className:`p-3 bg-${w.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:c.jsx(w.icon,{size:28,className:`text-${w.color}-600`})}),c.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${w.color}-700 transition-colors`,children:w.title}),c.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:w.description})]},w.section))})]})]})},us="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",cS="bg-gray-200 cursor-not-allowed text-gray-500",HO=({user:n,isOpen:e,onClose:t,onSave:r,isSaving:s,determineServiceTypeAndRole:o})=>{const[a,u]=B.useState({displayName:"",email:"",accountNumber:"",accountStatus:"Active",role:"customer",serviceType:"Residential",meterSerialNumber:"",meterSize:'1/2"'}),[d,f]=B.useState({district:"",barangay:"",street:"",landmark:""}),[g,y]=B.useState([]),[x,w]=B.useState([]);B.useEffect(()=>{if(y(fv()),n)if(u({displayName:n.displayName||"",email:n.email||"",accountNumber:n.accountNumber||"",accountStatus:n.accountStatus||"Active",role:n.role||"customer",serviceType:n.serviceType||"Residential",meterSerialNumber:n.meterSerialNumber||"",meterSize:n.meterSize||'1/2"'}),n.serviceAddress&&typeof n.serviceAddress=="object"){const N=n.serviceAddress.district||"";f({district:n.serviceAddress.district||"",barangay:n.serviceAddress.barangay||"",street:n.serviceAddress.street||"",landmark:n.serviceAddress.landmark||""}),N&&w(Ic(N))}else f({district:"",barangay:"",street:"",landmark:""})},[n]);const E=N=>{const{name:z,value:U}=N.target;f(W=>{const $={...W,[z]:U};return z==="district"&&($.barangay="",w(Ic(U))),$})},S=N=>{const{name:z,value:U}=N.target;let W={...a,[z]:U};if(z==="accountNumber"&&o){const{role:$,serviceType:F}=o(U);W={...W,role:$,serviceType:F}}u(W)},A=N=>{N.preventDefault(),r({...a,serviceAddress:d})};return c.jsx(Xr,{isOpen:e,onClose:t,title:`Edit User: ${n.displayName||n.email}`,size:"3xl",children:c.jsxs("form",{onSubmit:A,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx("input",{type:"text",name:"displayName",value:a.displayName,onChange:S,className:us,placeholder:"Full Name"}),c.jsx("input",{type:"email",name:"email",value:a.email,className:`${us} ${cS}`,disabled:!0}),c.jsx("input",{type:"text",name:"accountNumber",value:a.accountNumber,onChange:S,className:us,placeholder:"Account Number"}),c.jsxs("select",{name:"accountStatus",value:a.accountStatus,onChange:S,className:us,children:[c.jsx("option",{value:"Active",children:"Active"}),c.jsx("option",{value:"Inactive",children:"Inactive"}),c.jsx("option",{value:"Suspended",children:"Suspended"})]}),c.jsx("select",{name:"role",value:a.role,onChange:S,className:`${us} capitalize`,children:["customer","admin","meter_reader","clerk_cashier"].map(N=>c.jsx("option",{value:N,children:N.replace("_"," ")},N))}),c.jsx("input",{type:"text",name:"serviceType",value:a.serviceType,className:`${us} ${cS}`,disabled:!0}),c.jsx("input",{type:"text",name:"meterSerialNumber",value:a.meterSerialNumber,onChange:S,className:us,placeholder:"Meter Serial Number"}),c.jsx("input",{type:"text",name:"meterSize",value:a.meterSize,onChange:S,className:us,placeholder:"Meter Size"})]}),c.jsxs("div",{className:"pt-4 mt-4 border-t",children:[c.jsx("h3",{className:"text-md font-semibold text-gray-700 mb-2",children:"Service Address"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("select",{name:"district",value:d.district,onChange:E,className:us,children:[c.jsx("option",{value:"",children:"Select District"}),g.map(N=>c.jsx("option",{value:N,children:N},N))]}),c.jsxs("select",{name:"barangay",value:d.barangay,onChange:E,className:us,disabled:!d.district,children:[c.jsx("option",{value:"",children:"Select Barangay"}),x.map(N=>c.jsx("option",{value:N,children:N},N))]}),c.jsx("div",{className:"md:col-span-2",children:c.jsx("input",{type:"text",name:"street",value:d.street,onChange:E,className:us,placeholder:"Street Name, Building, House No."})}),c.jsx("div",{className:"md:col-span-2",children:c.jsx("input",{type:"text",name:"landmark",value:d.landmark,onChange:E,className:us,placeholder:"Landmark"})})]})]}),c.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg border",disabled:s,children:"Cancel"}),c.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg flex items-center",disabled:s,children:[s?c.jsx(Ge,{size:18,className:"animate-spin mr-2"}):c.jsx(Qo,{size:18,className:"mr-2"}),s?"Saving...":"Save Changes"]})]})]})})},Ha=({isOpen:n,onClose:e,onConfirm:t,title:r,children:s,confirmText:o="Confirm",cancelText:a="Cancel",confirmButtonClass:u="bg-red-600 hover:bg-red-700 focus:ring-red-500",cancelButtonClass:d="bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-400",iconType:f="warning",isConfirming:g=!1})=>{if(!n)return null;let y,x="";switch(f){case"success":y=Li,x="text-green-500";break;case"danger":y=EL,x="text-red-500";break;case"warning":default:y=Yt,x="text-yellow-500";break}return c.jsxs(Xr,{isOpen:n,onClose:e,title:r,size:"md",children:[c.jsxs("div",{className:"text-center",children:[y&&c.jsx("div",{className:`mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-${f==="warning"?"yellow":f==="success"?"green":"red"}-100 mb-4`,children:c.jsx(y,{className:`h-6 w-6 ${x}`,"aria-hidden":"true"})}),c.jsx("div",{className:"text-sm text-gray-600 mb-6",children:s})]}),c.jsxs("div",{className:"mt-5 sm:mt-6 flex flex-col sm:flex-row-reverse gap-3",children:[c.jsxs("button",{type:"button",className:`w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 sm:text-sm ${u} ${g?"opacity-50 cursor-not-allowed":""}`,onClick:t,disabled:g,children:[g?c.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,g?"Processing...":o]}),c.jsx("button",{type:"button",className:`w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 text-base font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 sm:text-sm ${d}`,onClick:e,disabled:g,children:a})]})]})};function S0(){return S0=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},S0.apply(null,arguments)}function uS(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function I0(n,e){return I0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},I0(n,e)}function WO(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,I0(n,e)}var dS=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function GO(n,e){return!!(n===e||dS(n)&&dS(e))}function KO(n,e){if(n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(!GO(n[t],e[t]))return!1;return!0}function xy(n,e){e===void 0&&(e=KO);var t,r=[],s,o=!1;function a(){for(var u=[],d=0;d<arguments.length;d++)u[d]=arguments[d];return o&&t===this&&e(u,r)||(s=n.apply(this,u),o=!0,t=this,r=u),s}return a}var QO=typeof performance=="object"&&typeof performance.now=="function",hS=QO?function(){return performance.now()}:function(){return Date.now()};function fS(n){cancelAnimationFrame(n.id)}function YO(n,e){var t=hS();function r(){hS()-t>=e?n.call(null):s.id=requestAnimationFrame(r)}var s={id:requestAnimationFrame(r)};return s}var vy=-1;function mS(n){if(n===void 0&&(n=!1),vy===-1||n){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",document.body.appendChild(e),vy=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return vy}var zl=null;function pS(n){if(n===void 0&&(n=!1),zl===null||n){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";var r=document.createElement("div"),s=r.style;return s.width="100px",s.height="100px",e.appendChild(r),document.body.appendChild(e),e.scrollLeft>0?zl="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?zl="negative":zl="positive-ascending"),document.body.removeChild(e),zl}return zl}var XO=150,JO=function(e,t){return e};function ZO(n){var e,t=n.getItemOffset,r=n.getEstimatedTotalSize,s=n.getItemSize,o=n.getOffsetForIndexAndAlignment,a=n.getStartIndexForOffset,u=n.getStopIndexForStartIndex,d=n.initInstanceProps,f=n.shouldResetStyleCacheOnItemSizeChange,g=n.validateProps;return e=function(y){WO(x,y);function x(E){var S;return S=y.call(this,E)||this,S._instanceProps=d(S.props,uS(S)),S._outerRef=void 0,S._resetIsScrollingTimeoutId=null,S.state={instance:uS(S),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof S.props.initialScrollOffset=="number"?S.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},S._callOnItemsRendered=void 0,S._callOnItemsRendered=xy(function(A,N,z,U){return S.props.onItemsRendered({overscanStartIndex:A,overscanStopIndex:N,visibleStartIndex:z,visibleStopIndex:U})}),S._callOnScroll=void 0,S._callOnScroll=xy(function(A,N,z){return S.props.onScroll({scrollDirection:A,scrollOffset:N,scrollUpdateWasRequested:z})}),S._getItemStyle=void 0,S._getItemStyle=function(A){var N=S.props,z=N.direction,U=N.itemSize,W=N.layout,$=S._getItemStyleCache(f&&U,f&&W,f&&z),F;if($.hasOwnProperty(A))F=$[A];else{var R=t(S.props,A,S._instanceProps),k=s(S.props,A,S._instanceProps),P=z==="horizontal"||W==="horizontal",T=z==="rtl",D=P?R:0;$[A]=F={position:"absolute",left:T?void 0:D,right:T?D:void 0,top:P?0:R,height:P?"100%":k,width:P?k:"100%"}}return F},S._getItemStyleCache=void 0,S._getItemStyleCache=xy(function(A,N,z){return{}}),S._onScrollHorizontal=function(A){var N=A.currentTarget,z=N.clientWidth,U=N.scrollLeft,W=N.scrollWidth;S.setState(function($){if($.scrollOffset===U)return null;var F=S.props.direction,R=U;if(F==="rtl")switch(pS()){case"negative":R=-U;break;case"positive-descending":R=W-z-U;break}return R=Math.max(0,Math.min(R,W-z)),{isScrolling:!0,scrollDirection:$.scrollOffset<R?"forward":"backward",scrollOffset:R,scrollUpdateWasRequested:!1}},S._resetIsScrollingDebounced)},S._onScrollVertical=function(A){var N=A.currentTarget,z=N.clientHeight,U=N.scrollHeight,W=N.scrollTop;S.setState(function($){if($.scrollOffset===W)return null;var F=Math.max(0,Math.min(W,U-z));return{isScrolling:!0,scrollDirection:$.scrollOffset<F?"forward":"backward",scrollOffset:F,scrollUpdateWasRequested:!1}},S._resetIsScrollingDebounced)},S._outerRefSetter=function(A){var N=S.props.outerRef;S._outerRef=A,typeof N=="function"?N(A):N!=null&&typeof N=="object"&&N.hasOwnProperty("current")&&(N.current=A)},S._resetIsScrollingDebounced=function(){S._resetIsScrollingTimeoutId!==null&&fS(S._resetIsScrollingTimeoutId),S._resetIsScrollingTimeoutId=YO(S._resetIsScrolling,XO)},S._resetIsScrolling=function(){S._resetIsScrollingTimeoutId=null,S.setState({isScrolling:!1},function(){S._getItemStyleCache(-1,null)})},S}x.getDerivedStateFromProps=function(S,A){return e3(S,A),g(S),null};var w=x.prototype;return w.scrollTo=function(S){S=Math.max(0,S),this.setState(function(A){return A.scrollOffset===S?null:{scrollDirection:A.scrollOffset<S?"forward":"backward",scrollOffset:S,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},w.scrollToItem=function(S,A){A===void 0&&(A="auto");var N=this.props,z=N.itemCount,U=N.layout,W=this.state.scrollOffset;S=Math.max(0,Math.min(S,z-1));var $=0;if(this._outerRef){var F=this._outerRef;U==="vertical"?$=F.scrollWidth>F.clientWidth?mS():0:$=F.scrollHeight>F.clientHeight?mS():0}this.scrollTo(o(this.props,S,A,W,this._instanceProps,$))},w.componentDidMount=function(){var S=this.props,A=S.direction,N=S.initialScrollOffset,z=S.layout;if(typeof N=="number"&&this._outerRef!=null){var U=this._outerRef;A==="horizontal"||z==="horizontal"?U.scrollLeft=N:U.scrollTop=N}this._callPropsCallbacks()},w.componentDidUpdate=function(){var S=this.props,A=S.direction,N=S.layout,z=this.state,U=z.scrollOffset,W=z.scrollUpdateWasRequested;if(W&&this._outerRef!=null){var $=this._outerRef;if(A==="horizontal"||N==="horizontal")if(A==="rtl")switch(pS()){case"negative":$.scrollLeft=-U;break;case"positive-ascending":$.scrollLeft=U;break;default:var F=$.clientWidth,R=$.scrollWidth;$.scrollLeft=R-F-U;break}else $.scrollLeft=U;else $.scrollTop=U}this._callPropsCallbacks()},w.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&fS(this._resetIsScrollingTimeoutId)},w.render=function(){var S=this.props,A=S.children,N=S.className,z=S.direction,U=S.height,W=S.innerRef,$=S.innerElementType,F=S.innerTagName,R=S.itemCount,k=S.itemData,P=S.itemKey,T=P===void 0?JO:P,D=S.layout,L=S.outerElementType,C=S.outerTagName,G=S.style,K=S.useIsScrolling,ce=S.width,ue=this.state.isScrolling,Q=z==="horizontal"||D==="horizontal",Z=Q?this._onScrollHorizontal:this._onScrollVertical,M=this._getRangeToRender(),q=M[0],ne=M[1],V=[];if(R>0)for(var de=q;de<=ne;de++)V.push(B.createElement(A,{data:k,key:T(de,k),index:de,isScrolling:K?ue:void 0,style:this._getItemStyle(de)}));var xe=r(this.props,this._instanceProps);return B.createElement(L||C||"div",{className:N,onScroll:Z,ref:this._outerRefSetter,style:S0({position:"relative",height:U,width:ce,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:z},G)},B.createElement($||F||"div",{children:V,ref:W,style:{height:Q?"100%":xe,pointerEvents:ue?"none":void 0,width:Q?xe:"100%"}}))},w._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var S=this.props.itemCount;if(S>0){var A=this._getRangeToRender(),N=A[0],z=A[1],U=A[2],W=A[3];this._callOnItemsRendered(N,z,U,W)}}if(typeof this.props.onScroll=="function"){var $=this.state,F=$.scrollDirection,R=$.scrollOffset,k=$.scrollUpdateWasRequested;this._callOnScroll(F,R,k)}},w._getRangeToRender=function(){var S=this.props,A=S.itemCount,N=S.overscanCount,z=this.state,U=z.isScrolling,W=z.scrollDirection,$=z.scrollOffset;if(A===0)return[0,0,0,0];var F=a(this.props,$,this._instanceProps),R=u(this.props,F,$,this._instanceProps),k=!U||W==="backward"?Math.max(1,N):1,P=!U||W==="forward"?Math.max(1,N):1;return[Math.max(0,F-k),Math.max(0,Math.min(A-1,R+P)),F,R]},x}(B.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var e3=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},t3=ZO({getItemOffset:function(e,t){var r=e.itemSize;return t*r},getItemSize:function(e,t){var r=e.itemSize;return r},getEstimatedTotalSize:function(e){var t=e.itemCount,r=e.itemSize;return r*t},getOffsetForIndexAndAlignment:function(e,t,r,s,o,a){var u=e.direction,d=e.height,f=e.itemCount,g=e.itemSize,y=e.layout,x=e.width,w=u==="horizontal"||y==="horizontal",E=w?x:d,S=Math.max(0,f*g-E),A=Math.min(S,t*g),N=Math.max(0,t*g-E+g+a);switch(r==="smart"&&(s>=N-E&&s<=A+E?r="auto":r="center"),r){case"start":return A;case"end":return N;case"center":{var z=Math.round(N+(A-N)/2);return z<Math.ceil(E/2)?0:z>S+Math.floor(E/2)?S:z}case"auto":default:return s>=N&&s<=A?s:s<N?N:A}},getStartIndexForOffset:function(e,t){var r=e.itemCount,s=e.itemSize;return Math.max(0,Math.min(r-1,Math.floor(t/s)))},getStopIndexForStartIndex:function(e,t,r){var s=e.direction,o=e.height,a=e.itemCount,u=e.itemSize,d=e.layout,f=e.width,g=s==="horizontal"||d==="horizontal",y=t*u,x=g?f:o,w=Math.ceil((x+r-y)/u);return Math.max(0,Math.min(a-1,t+w-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});const wy="w-full px-3 py-2 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",n3=({db:n,showNotification:e,determineServiceTypeAndRole:t,userData:r})=>{const[s,o]=B.useState([]),[a,u]=B.useState(!0),[d,f]=B.useState(null),[g,y]=B.useState(null),[x,w]=B.useState(""),[E,S]=B.useState(!1),[A,N]=B.useState(!1),[z,U]=B.useState(""),[W,$]=B.useState(""),[F,R]=B.useState(""),[k,P]=B.useState(!1),[T,D]=B.useState(""),L=B.useCallback(async()=>{u(!0),D("");const de=await rL(n);if(de.success)o(de.data.sort((xe,be)=>(xe.displayName||xe.email||"").localeCompare(be.displayName||be.email||"")));else{const xe=de.error||"Failed to fetch user list. Please try again.";D(xe)}u(!1)},[n]);B.useEffect(()=>{L()},[L]);const C=de=>f(de),G=()=>f(null),K=async de=>{if(!d)return;P(!0);const xe=await Ql(n,d.id,de);xe.success?(e("User profile updated successfully!","success"),G(),L()):e(xe.error||"Failed to update user profile.","error"),P(!1)},ce=(de,xe)=>{y(de),w(xe),S(!0)},ue=async()=>{!g||!x||(P(!0),await Ql(n,g.id,{accountStatus:x}),e(`User account status changed to ${x}.`,"success"),L(),S(!1),y(null),w(""),P(!1))},Q=de=>{y(de),N(!0)},Z=async()=>{if(!g)return;P(!0),await Ql(n,g.id,{accountStatus:"Suspended"});const de=await OM(n,g.id);de.success?(e(`User ${g.displayName} has been permanently deleted.`,"success"),L()):(e(de.error||"Failed to delete user profile.","error"),await Ql(n,g.id,{accountStatus:g.accountStatus})),N(!1),y(null),P(!1)},M=s.filter(de=>{var be,Be,He;const xe=z.toLowerCase();return(((be=de.displayName)==null?void 0:be.toLowerCase().includes(xe))||((Be=de.email)==null?void 0:Be.toLowerCase().includes(xe))||((He=de.accountNumber)==null?void 0:He.toLowerCase().includes(xe)))&&(W?de.role===W:!0)&&(F?de.accountStatus===F:!0)}),q={admin:"bg-purple-100 text-purple-700",customer:"bg-blue-100 text-blue-700",meter_reader:"bg-teal-100 text-teal-700",clerk_cashier:"bg-indigo-100 text-indigo-700",unknown:"bg-gray-100 text-gray-700"},ne={Active:"bg-green-100 text-green-700",Inactive:"bg-gray-200 text-gray-600",Suspended:"bg-red-100 text-red-700","Profile Missing":"bg-yellow-100 text-yellow-700",Unknown:"bg-gray-100 text-gray-600"},V=({index:de,style:xe})=>{var Be;const be=M[de];return c.jsxs("div",{style:xe,className:"flex items-center border-b border-gray-200 text-sm",children:[c.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-800 font-medium flex-1",children:be.displayName||"N/A"}),c.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 truncate flex-1",title:be.email||be.phoneNumber,children:be.email||be.phoneNumber||"N/A"}),c.jsx("div",{className:"px-4 py-2 flex-1",children:c.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full capitalize ${q[be.role||"unknown"]}`,children:((Be=be.role)==null?void 0:Be.replace("_"," "))||"Unknown"})}),c.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 font-mono text-xs flex-1",children:be.accountNumber||"N/A"}),c.jsx("div",{className:"px-4 py-2 flex-1",children:c.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${ne[be.accountStatus||"Unknown"]}`,children:be.accountStatus||"Unknown"})}),c.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 flex-1",children:be.createdAt?bt(be.createdAt,{year:"numeric",month:"short",day:"numeric"}):"N/A"}),c.jsxs("div",{className:"px-4 py-2 whitespace-nowrap text-sm text-center space-x-1.5 flex-1",children:[c.jsx("button",{onClick:()=>C(be),className:"text-blue-600 hover:text-blue-800 p-1 hover:bg-blue-100 rounded-md",title:"Edit User",children:c.jsx(lv,{size:16})}),be.accountStatus!=="Suspended"&&c.jsx("button",{onClick:()=>ce(be,"Suspended"),className:"text-orange-500 hover:text-orange-700 p-1 hover:bg-orange-100 rounded-md",title:"Suspend User",children:c.jsx(JL,{size:16})}),(be.accountStatus==="Suspended"||be.accountStatus==="Inactive")&&c.jsx("button",{onClick:()=>ce(be,"Active"),className:"text-green-500 hover:text-green-700 p-1 hover:bg-green-100 rounded-md",title:"Activate User",children:c.jsx(XL,{size:16})}),(r==null?void 0:r.uid)!==be.id&&c.jsx("button",{onClick:()=>Q(be),className:"text-red-600 hover:text-red-800 p-1 hover:bg-red-100 rounded-md",title:"Delete User",children:c.jsx(Oc,{size:16})})]})]})};return a?c.jsx(Nt,{message:"Loading user accounts...",className:"mt-10 h-64"}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Sc,{size:30,className:"mr-3 text-blue-600"})," User Account Management"]}),c.jsxs("button",{onClick:L,className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:a,title:"Refresh User List",children:[a?c.jsx(Ge,{size:16,className:"animate-spin mr-1.5"}):c.jsx(Ko,{size:16,className:"mr-1.5"})," Refresh List"]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-gray-50 rounded-lg shadow-sm",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"userMgmtSearchTerm",className:"block text-xs font-medium text-gray-600 mb-1",children:"Search Users"}),c.jsxs("div",{className:"relative",children:[c.jsx(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",id:"userMgmtSearchTerm",placeholder:"Name, Email, Account No...",className:`${wy} pl-9`,value:z,onChange:de=>U(de.target.value)})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"userMgmtFilterRole",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Role"}),c.jsxs("div",{className:"relative",children:[c.jsx(PL,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsxs("select",{id:"userMgmtFilterRole",className:`${wy} pl-9`,value:W,onChange:de=>$(de.target.value),children:[c.jsx("option",{value:"",children:"All Roles"}),c.jsx("option",{value:"customer",children:"Customer"}),c.jsx("option",{value:"admin",children:"Admin"}),c.jsx("option",{value:"meter_reader",children:"Meter Reader"}),c.jsx("option",{value:"clerk_cashier",children:"Clerk/Cashier"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"userMgmtFilterStatus",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Status"}),c.jsxs("div",{className:"relative",children:[c.jsx(Gd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsxs("select",{id:"userMgmtFilterStatus",className:`${wy} pl-9`,value:F,onChange:de=>R(de.target.value),children:[c.jsx("option",{value:"",children:"All Statuses"}),c.jsx("option",{value:"Active",children:"Active"}),c.jsx("option",{value:"Inactive",children:"Inactive"}),c.jsx("option",{value:"Suspended",children:"Suspended"}),c.jsx("option",{value:"Profile Missing",children:"Profile Missing"})]})]})]})]}),!a&&M.length===0&&c.jsxs("div",{className:"text-center py-10",children:[c.jsx(on,{size:48,className:"mx-auto text-gray-400 mb-3"}),c.jsx("p",{className:"text-gray-500 text-lg",children:s.length===0&&!T?"No users found.":"No users match your filters."})]}),!a&&M.length>0&&c.jsxs("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:[c.jsxs("div",{className:"flex bg-gray-100 text-xs font-medium text-gray-500 uppercase tracking-wider",children:[c.jsx("div",{className:"px-4 py-3 flex-1",children:"Name"}),c.jsx("div",{className:"px-4 py-3 flex-1",children:"Email / Contact"}),c.jsx("div",{className:"px-4 py-3 flex-1",children:"Role"}),c.jsx("div",{className:"px-4 py-3 flex-1",children:"Account No."}),c.jsx("div",{className:"px-4 py-3 flex-1",children:"Status"}),c.jsx("div",{className:"px-4 py-3 flex-1",children:"Joined"}),c.jsx("div",{className:"px-4 py-3 text-center flex-1",children:"Actions"})]}),c.jsx(t3,{height:400,itemCount:M.length,itemSize:60,width:"100%",children:V})]}),d&&c.jsx(HO,{user:d,isOpen:!!d,onClose:G,onSave:K,isSaving:k,determineServiceTypeAndRole:t,showNotification:e}),E&&g&&c.jsx(Ha,{isOpen:E,onClose:()=>S(!1),onConfirm:ue,title:"Confirm Status Change",confirmText:k?"Updating...":`Set to ${x}`,isConfirming:k,iconType:x==="Active"?"success":"danger",confirmButtonClass:x==="Active"?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"bg-red-600 hover:bg-red-700 focus:ring-red-500",children:c.jsxs("p",{children:["Change status for ",c.jsx("strong",{children:g.displayName||g.email})," to ",c.jsx("strong",{className:x==="Active"?"text-green-600":"text-red-600",children:x}),"?"]})}),A&&g&&c.jsxs(Ha,{isOpen:A,onClose:()=>N(!1),onConfirm:Z,title:"Confirm User Deletion",confirmText:"Yes, Permanently Delete",isConfirming:k,iconType:"danger",children:[c.jsxs("p",{children:["Are you sure you want to delete ",c.jsx("strong",{children:g.displayName||g.email}),"?"]}),c.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This will permanently delete the user's profile and data. Their authentication account will be disabled. This action cannot be undone."})]})]})},r3=({isOpen:n,onClose:e,ticket:t,db:r,adminUserData:s,showNotification:o,onTicketUpdate:a})=>{const[u,d]=B.useState(null),[f,g]=B.useState(""),[y,x]=B.useState(""),[w,E]=B.useState(!1),[S,A]=B.useState(!1),[N,z]=B.useState(!1),U=B.useRef(null);if(B.useEffect(()=>{t?(d(t),g(t.status||"Open")):d(null)},[t]),B.useEffect(()=>{var L;(L=U.current)==null||L.scrollIntoView({behavior:"smooth"})},[u==null?void 0:u.conversation]),!n||!u)return null;const W="w-full px-3 py-2 rounded-md bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm",$="flex items-center justify-center px-4 py-2 rounded-md font-semibold text-sm transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95",F=async()=>{if(!f||f===u.status){o("Please select a new status or status is unchanged.","info");return}E(!0);const L={status:f,lastUpdatedByAdminName:s.displayName||"Admin",lastUpdatedByAdminId:s.uid},C=await oL(r,u.id,L);if(C.success){o("Ticket status updated successfully!","success");const G={...u,...L,status:f,lastUpdatedAt:new Date};d(G),a&&a(G)}else o(C.error||"Failed to update ticket status.","error");E(!1)},R=async()=>{if(!y.trim()){o("Reply cannot be empty.","warning");return}A(!0);const L={text:y,authorId:s.uid,authorName:s.displayName,authorRole:s.role,timestamp:mt.fromDate(new Date)},C=await Ok(r,u.id,L);if(C.success){o("Reply sent successfully!","success");const G=[...u.conversation||[],L],K={...u,conversation:G,lastUpdatedAt:new Date,status:"In Progress"};d(K),a&&a(K),x("")}else o(C.error||"Failed to send reply.","error");A(!1)},k=async()=>{if(!y.trim()){o("Please write a draft or some keywords for the AI to assist with.","warning");return}z(!0);try{const L=(u.conversation||[]).map(K=>`${K.authorRole}: ${K.text}`).join(`
`),C=`
                You are a professional and empathetic customer support agent for AGWA Water Services.
                A customer has filed a support ticket.
                Ticket Description: "${u.description}"
                Conversation History so far:
                ${L}
                
                My draft reply is: "${y}"

                Please refine my draft into a formal, clear, and helpful response. Address the customer by name if possible (${u.userName}). Maintain a polite and professional tone. Do not add any extra commentary, just provide the refined reply.
            `,G=await Vi(C);x(G),o("AI has refined your reply!","success")}catch(L){o(L.message||"AI assistance failed.","error")}finally{z(!1)}},P=({label:L,value:C,icon:G,valueClass:K="text-gray-700"})=>c.jsxs("div",{className:"flex items-start py-2 border-b border-slate-100 last:border-b-0",children:[c.jsxs("span",{className:"text-xs font-semibold text-slate-500 w-32 flex items-center shrink-0",children:[G&&c.jsx(G,{size:14,className:"mr-2 text-slate-400"}),L,":"]}),c.jsx("span",{className:`text-sm ${K} flex-1`,children:C||"N/A"})]}),T=L=>{switch(L){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"Resolved":return"bg-green-100 text-green-700";case"Closed":return"bg-purple-100 text-purple-700";default:return"bg-gray-100 text-gray-600"}},D=["Open","In Progress","Resolved","Closed"];return c.jsxs(Xr,{isOpen:n,onClose:e,title:"Ticket Details",size:"full",modalDialogClassName:"sm:max-w-4xl w-[95vw] h-[95vh]",contentClassName:"p-0 flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 bg-slate-50 rounded-t-xl sticky top-0 z-10",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800 truncate",title:u.issueType,children:u.issueType}),c.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 rounded-lg",children:c.jsx(hp,{size:18})})]}),c.jsxs("div",{className:"overflow-y-auto flex-grow p-4 space-y-4",children:[c.jsx("div",{className:"p-4 border rounded-lg bg-slate-50/70",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4",children:[c.jsx(P,{label:"User",value:`${u.userName} (${u.userEmail||"N/A"})`,icon:ms}),c.jsx(P,{label:"Account No",value:u.accountNumber||"N/A",icon:Oi}),c.jsx(P,{label:"Submitted",value:bt(u.submittedAt),icon:wc}),c.jsx(P,{label:"Last Update",value:bt(u.lastUpdatedAt),icon:bc}),c.jsx(P,{label:"Status",value:c.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${T(u.status)}`,children:u.status}),icon:Yt})]})}),c.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[c.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-1",children:"Initial Description:"}),c.jsx("div",{className:"p-3 bg-slate-100 rounded-md text-sm text-slate-800 whitespace-pre-line",children:u.description})]}),c.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[c.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-2",children:"Conversation History"}),c.jsxs("div",{className:"max-h-60 overflow-y-auto space-y-3 p-3 bg-slate-50 border rounded-md",children:[u.conversation&&u.conversation.length>0?u.conversation.map((L,C)=>c.jsxs("div",{className:`p-2.5 rounded-lg ${L.authorRole==="admin"?"bg-blue-100":"bg-green-50"}`,children:[c.jsx("p",{className:"text-xs font-bold text-gray-800",children:L.authorName}),c.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-line",children:L.text}),c.jsx("p",{className:"text-right text-xs text-gray-500 mt-1",children:bt(L.timestamp)})]},C)):c.jsx("p",{className:"text-sm text-center text-gray-500 py-4",children:"No replies yet."}),c.jsx("div",{ref:U})]})]}),c.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[c.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-2",children:"Send Reply"}),c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("textarea",{value:y,onChange:L=>x(L.target.value),placeholder:"Type your reply to the customer...",className:`${W} flex-grow`,rows:"3",disabled:S||N}),c.jsx("button",{onClick:k,className:`${$} bg-purple-100 text-purple-700 hover:bg-purple-200 self-start`,disabled:N||!y.trim(),title:"Refine reply with AI",children:N?c.jsx(Ge,{size:18,className:"animate-spin"}):c.jsx(Kr,{size:18})})]}),c.jsxs("button",{onClick:R,className:`${$} bg-blue-600 hover:bg-blue-700 text-white`,disabled:S||!y.trim(),children:[S?c.jsx(Ge,{size:18,className:"animate-spin mr-2"}):c.jsx(dp,{size:16,className:"mr-2"}),"Send Reply"]})]}),c.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[c.jsx("label",{htmlFor:"ticketStatusUpdate",className:"block text-sm font-semibold text-slate-600 mb-1.5",children:"Update Ticket Status:"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("select",{id:"ticketStatusUpdate",value:f,onChange:L=>g(L.target.value),className:`${W} flex-grow`,disabled:w,children:D.map(L=>c.jsx("option",{value:L,children:L},L))}),c.jsxs("button",{onClick:F,className:`${$} bg-green-600 hover:bg-green-700 text-white`,disabled:w||f===u.status,children:[w?c.jsx(Ge,{size:18,className:"animate-spin mr-2"}):c.jsx(Qo,{size:18,className:"mr-2"}),"Update Status"]})]})]})]})]})},s3=({db:n,appId:e,userData:t,showNotification:r})=>{const[s,o]=B.useState([]),[a,u]=B.useState(!0),[d,f]=B.useState(null),[g,y]=B.useState(null),[x,w]=B.useState(!1),[E,S]=B.useState(""),[A,N]=B.useState(""),[z,U]=B.useState(""),W="w-full sm:w-auto text-sm px-3 py-2 rounded-md bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150",$=`${W} placeholder-gray-400`,F=B.useCallback(async(K,ce)=>{const ue=ce==null?void 0:ce.autoCloseTicketsDays;if(!ue||isNaN(ue)||ue<=0)return;const Q=new Date,Z=[];if(K.forEach(M=>{var q;if(M.status==="Resolved"){const ne=(q=M.lastUpdatedAt)!=null&&q.toDate?M.lastUpdatedAt.toDate():new Date(0);(Q-ne)/(1e3*60*60*24)>ue&&Z.push(M.id)}}),Z.length>0){const M=await LM(n,Z,"Closed");M.success?r(`Successfully auto-closed ${Z.length} inactive ticket(s).`,"success"):r(`Failed to auto-close tickets: ${M.error}`,"error")}},[n,r]),R=B.useCallback(async()=>{u(!0);const[K,ce]=await Promise.all([X_(n),tv(n)]);if(K.success){if(o(K.data),ce.success&&ce.data&&(await F(K.data,ce.data),K.data.some(ue=>ue.status==="Resolved"))){const ue=await X_(n);ue.success&&o(ue.data)}}else r(K.error||"Failed to fetch support tickets.","error"),o([]);u(!1)},[n,r,F]);B.useEffect(()=>{R()},[R]);const k=K=>{f(K)},P=()=>{f(null)},T=K=>{o(ce=>ce.map(ue=>ue.id===K.id?K:ue))},D=async()=>{if(!g)return;w(!0);const K=await iL(n,g.id);K.success?(r("Support ticket deleted successfully.","success"),R()):r(K.error||"Failed to delete ticket.","error"),w(!1),y(null)},L=K=>{switch(K){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"On Hold":return"bg-gray-200 text-gray-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";case"Resolved":return"bg-green-100 text-green-700";case"Closed":return"bg-purple-100 text-purple-700";default:return"bg-gray-100 text-gray-600"}},C=s.filter(K=>{var M,q,ne,V,de;const ce=z.toLowerCase(),ue=z?((M=K.id)==null?void 0:M.toLowerCase().includes(ce))||((q=K.userName)==null?void 0:q.toLowerCase().includes(ce))||((ne=K.userEmail)==null?void 0:ne.toLowerCase().includes(ce))||((V=K.accountNumber)==null?void 0:V.toLowerCase().includes(ce))||((de=K.description)==null?void 0:de.toLowerCase().includes(ce)):!0,Q=E?K.status===E:!0,Z=A?K.issueType===A:!0;return ue&&Q&&Z}),G=Array.from(new Set(s.map(K=>K.issueType))).sort();return a&&s.length===0?c.jsx(Nt,{message:"Loading support tickets...",className:"mt-10 h-64"}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Wi,{size:30,className:"mr-3 text-purple-600"})," Support Ticket Management"]}),c.jsxs("button",{onClick:R,className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:a,title:"Refresh Ticket List",children:[a?c.jsx(Ge,{size:16,className:"animate-spin mr-1.5"}):c.jsx(Ko,{size:16,className:"mr-1.5"}),"Refresh"]})]}),c.jsxs("div",{className:"mb-5 p-4 bg-gray-50 rounded-lg shadow-sm grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 items-end",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"searchTerm",className:"block text-xs font-medium text-gray-600 mb-1",children:"Search Tickets"}),c.jsx("input",{type:"text",id:"searchTerm",placeholder:"ID, Name, Email, Account#, Keyword...",value:z,onChange:K=>U(K.target.value),className:$})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"filterStatus",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Status"}),c.jsxs("select",{id:"filterStatus",value:E,onChange:K=>S(K.target.value),className:W,children:[c.jsx("option",{value:"",children:"All Statuses"}),["Open","In Progress","On Hold","Awaiting Customer","Resolved","Closed"].map(K=>c.jsx("option",{value:K,children:K},K))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"filterIssueType",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Issue Type"}),c.jsxs("select",{id:"filterIssueType",value:A,onChange:K=>N(K.target.value),className:W,children:[c.jsx("option",{value:"",children:"All Issue Types"}),G.map(K=>c.jsx("option",{value:K,children:K},K))]})]})]}),!a&&C.length===0&&c.jsxs("div",{className:"text-center py-10",children:[c.jsx(on,{size:48,className:"mx-auto text-gray-400 mb-3"}),c.jsx("p",{className:"text-gray-500 text-lg",children:s.length===0?"No support tickets found in the system.":"No tickets match your current filters."})]}),C.length>0&&c.jsx("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ticket ID"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Issue Type"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Update"}),c.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(K=>c.jsxs("tr",{className:"hover:bg-gray-50/80 transition-colors duration-100",children:[c.jsxs("td",{className:"px-4 py-3 whitespace-nowrap font-mono text-xs text-gray-600",title:K.id,children:[K.id.substring(0,8),"..."]}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:bt(K.submittedAt,{month:"short",day:"numeric",year:"2-digit"})}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-800 font-medium truncate max-w-[150px]",title:K.userName||K.userEmail,children:K.userName||K.userEmail}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-600 truncate max-w-[180px]",title:K.issueType,children:K.issueType}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsx("span",{className:`px-2.5 py-1 inline-flex text-xs leading-tight font-semibold rounded-full ${L(K.status)}`,children:K.status})}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:bt(K.lastUpdatedAt||K.lastUpdatedByAdmin||K.submittedAt,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),c.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-center space-x-2",children:[c.jsx("button",{onClick:()=>k(K),className:"text-indigo-600 hover:text-indigo-800 p-1.5 rounded-md hover:bg-indigo-50 transition-colors",title:"View & Manage Ticket",children:c.jsx(qa,{size:18})}),c.jsx("button",{onClick:()=>y(K),className:"text-red-600 hover:text-red-800 p-1.5 rounded-md hover:bg-red-50 transition-colors",title:"Delete Ticket",children:c.jsx(Oc,{size:18})})]})]},K.id))})]})}),d&&t&&c.jsx(r3,{isOpen:!!d,onClose:P,ticket:d,db:n,appId:e,adminUserData:t,showNotification:r,onTicketUpdate:T}),g&&c.jsxs(Ha,{isOpen:!!g,onClose:()=>y(null),onConfirm:D,title:"Confirm Ticket Deletion",confirmText:"Yes, Delete Ticket",isConfirming:x,iconType:"danger",children:[c.jsxs("p",{children:["Are you sure you want to permanently delete ticket ",c.jsxs("strong",{children:[g.id.substring(0,8),"..."]}),"?"]}),c.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"This action cannot be undone."})]})]})},gS="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",i3="flex items-center justify-center px-5 py-2.5 rounded-lg font-semibold text-sm transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95",xf=({field:n,settings:e,handleChange:t})=>{const r=n.icon;return c.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50/50",children:[c.jsxs("label",{className:`block text-sm font-medium text-gray-700 mb-1.5 ${n.type!=="checkbox"?"flex items-center":""}`,children:[r&&c.jsx(r,{size:16,className:"mr-2 text-gray-500"}),n.label]}),n.type==="textarea"?c.jsx("textarea",{name:n.name,rows:n.rows||3,value:e[n.name]||"",onChange:t,className:gS,placeholder:n.placeholder}):n.type==="checkbox"?c.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-2",children:[c.jsx("input",{type:"checkbox",name:n.name,checked:!!e[n.name],onChange:t,className:"h-5 w-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),c.jsx("span",{className:"text-sm text-gray-600 select-none",children:n.description||"Enable/Disable"})]}):c.jsx("input",{type:n.type,name:n.name,value:e[n.name]??"",onChange:t,className:gS,step:"0.01",placeholder:n.placeholder})]},n.name)},o3=({showNotification:n=console.log})=>{const[e,t]=B.useState({portalAnnouncement:"",isBannerEnabled:!1,latePaymentPenaltyPercentage:2,latePaymentPenaltyDelayDays:15,reconnectionFee:500,fcdaPercentage:1.29,environmentalChargePercentage:25,vatPercentage:12,maintenanceMode:!1,isSignupEnabled:!0,isGoogleLoginEnabled:!0,isPasswordlessLoginEnabled:!0,isOnlinePaymentsEnabled:!0,isChatbotEnabled:!0,supportHotline:"1627-AGWA",supportEmail:"support@agwa-waterservices.com.ph",autoCloseTicketsDays:14}),[r,s]=B.useState(!0),[o,a]=B.useState(!1),[u,d]=B.useState(""),[f,g]=B.useState(null),[y,x]=B.useState(!1),w=B.useCallback(async()=>{s(!0),d("");const F=await tv(Kt);F.success&&F.data?t(R=>({...R,...F.data})):d("Could not load existing settings. Default values are shown. Click 'Save' to create the settings document."),s(!1)},[]);B.useEffect(()=>{w()},[w]);const E=F=>{const{name:R,value:k,type:P,checked:T}=F.target;t(D=>({...D,[R]:P==="checkbox"?T:P==="number"&&k!==""?parseFloat(k):k}))},S=async F=>{F.preventDefault(),a(!0),d("");const R=await uL(Kt,e);R.success?n("System settings updated successfully!","success"):(d(R.error||"Failed to save system settings."),n(R.error||"Failed to save system settings.","error")),a(!1)},A=async()=>{if(!f)return;x(!0);let F,R=f;switch(R){case"tickets":F=await FM(Kt);break;case"bills":F=await VM(Kt);break;case"readings":F=await zM(Kt);break;case"announcements":F=await UM(Kt);break;default:F={success:!1,error:"Unknown data type."}}F.success?n(`Successfully deleted ${F.count} ${R}.`,"success"):n(F.error||`Failed to delete ${R}.`,"error"),x(!1),g(null)},N=[{name:"portalAnnouncement",label:"Portal-Wide Announcement Banner Text",type:"textarea",icon:Sd,rows:3},{name:"isBannerEnabled",label:"Enable Announcement Banner",type:"checkbox",icon:Sd},{name:"maintenanceMode",label:"Enable Portal Maintenance Mode",type:"checkbox",icon:Yt,description:"If enabled, only Admins can log in."}],z=[{name:"latePaymentPenaltyPercentage",label:"Late Payment Penalty (%)",type:"number",icon:cy},{name:"latePaymentPenaltyDelayDays",label:"Late Payment Grace Period (Days)",type:"number",icon:bc},{name:"reconnectionFee",label:"Reconnection Fee (PHP)",type:"number",icon:wm},{name:"fcdaPercentage",label:"FCDA (%)",type:"number",icon:cy},{name:"environmentalChargePercentage",label:"Environmental Charge (%)",type:"number",icon:eO},{name:"vatPercentage",label:"VAT (%)",type:"number",icon:cy}],U=[{name:"isOnlinePaymentsEnabled",label:"Enable Online Payments",type:"checkbox",icon:Hk},{name:"isSignupEnabled",label:"Enable New User Sign-ups",type:"checkbox",icon:uy},{name:"isGoogleLoginEnabled",label:"Enable Sign-in with Google",type:"checkbox",icon:uy},{name:"isPasswordlessLoginEnabled",label:"Enable Passwordless (Email Link) Sign-in",type:"checkbox",icon:uy},{name:"isChatbotEnabled",label:"Enable Chatbot",type:"checkbox",icon:Wi}],W=[{name:"supportHotline",label:"Support Hotline Number",type:"text",icon:BL,placeholder:"e.g., 1627-AGWA"},{name:"supportEmail",label:"Support Email Address",type:"email",icon:wL,placeholder:"e.g., support@agwa.com"},{name:"autoCloseTicketsDays",label:"Auto-close Resolved Tickets After (Days)",type:"number",icon:bc}],$=[{label:"Clear All Support Tickets",action:"tickets"},{label:"Clear All Bills",action:"bills"},{label:"Clear All Meter Readings",action:"readings"},{label:"Clear All Announcements",action:"announcements"}];return r?c.jsx(Nt,{message:"Loading system settings...",className:"mt-10 h-64"}):c.jsxs("form",{onSubmit:S,className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(uv,{size:30,className:"mr-3 text-gray-600"})," System Configuration"]}),c.jsxs("button",{type:"submit",className:`${i3} bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500 w-auto mt-4 sm:mt-0`,disabled:o||r,children:[o?c.jsx(Ge,{size:18,className:"animate-spin mr-2"}):c.jsx(Qo,{size:18,className:"mr-2"}),o?"Saving...":"Save All Settings"]})]}),u&&c.jsxs("div",{className:"mb-4 p-3 bg-yellow-100 border border-yellow-400 text-yellow-800 rounded-lg text-sm flex items-center",children:[c.jsx(Yt,{size:20,className:"mr-2"})," ",u]}),c.jsxs("div",{className:"space-y-8",children:[c.jsxs("section",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"General & Maintenance"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:N.map(F=>c.jsx(xf,{field:F,settings:e,handleChange:E},F.name))})]}),c.jsxs("section",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Billing & Financial"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:z.map(F=>c.jsx(xf,{field:F,settings:e,handleChange:E},F.name))})]}),c.jsxs("section",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Portal Features & Authentication"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:U.map(F=>c.jsx(xf,{field:F,settings:e,handleChange:E},F.name))})]}),c.jsxs("section",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Communication & Support"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:W.map(F=>c.jsx(xf,{field:F,settings:e,handleChange:E},F.name))})]})]}),c.jsxs("div",{className:"mt-12 pt-6 border-t-2 border-red-300",children:[c.jsxs("h3",{className:"text-xl font-bold text-red-700 flex items-center",children:[c.jsx(Yt,{size:24,className:"mr-2"})," Danger Zone"]}),c.jsx("p",{className:"text-sm text-gray-600 mt-1 mb-4",children:"These actions are destructive and cannot be undone. This will permanently delete transactional data from the database, effectively resetting parts of your system."}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:$.map(F=>c.jsxs("button",{type:"button",onClick:()=>g(F.action),className:"p-4 border border-red-200 rounded-lg bg-red-50 hover:bg-red-100 hover:border-red-400 transition-colors text-left",children:[c.jsxs("p",{className:"font-semibold text-red-800 flex items-center",children:[c.jsx(Oc,{size:16,className:"mr-2"}),F.label]}),c.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Permanently delete all ",F.action," from the database."]})]},F.action))})]}),f&&c.jsx(Ha,{isOpen:!!f,onClose:()=>g(null),onConfirm:A,title:`Confirm Deletion of All ${f.charAt(0).toUpperCase()+f.slice(1)}`,confirmText:`Yes, delete all ${f}`,isConfirming:y,iconType:"danger",children:c.jsxs("p",{children:["Are you absolutely sure you want to proceed? All ",c.jsx("strong",{children:f})," data will be permanently erased. This action cannot be undone."]})})]})},a3=({initialData:n=null,onSubmit:e,onCancel:t,isSaving:r,showNotification:s})=>{const[o,a]=B.useState(""),[u,d]=B.useState(""),[f,g]=B.useState("info"),[y,x]=B.useState("active"),[w,E]=B.useState(""),[S,A]=B.useState(""),[N,z]=B.useState(["all"]),[U,W]=B.useState(""),[$,F]=B.useState(""),[R,k]=B.useState(""),[P,T]=B.useState(!1),[D,L]=B.useState(!1),[C,G]=B.useState("");B.useEffect(()=>{var M,q;if(n)a(n.title||""),d(n.content||""),g(n.type||"info"),x(n.status||"active"),E((M=n.startDate)!=null&&M.toDate?n.startDate.toDate().toISOString().split("T")[0]:""),A((q=n.endDate)!=null&&q.toDate?n.endDate.toDate().toISOString().split("T")[0]:""),z(n.targetRoles||["all"]);else{const ne=new Date().toISOString().split("T")[0];E(ne),x("active")}},[n]);const K=async()=>{if(!o.trim()&&!u.trim()){s("Please provide a title or some initial content for AI assistance.","warning");return}L(!0);try{const M=`Refine this announcement for AGWA Water Services. Make it clear, professional, and concise, using markdown for formatting. Announcement Type: ${f}. Title: "${o}". Original Content: "${u}".`,q=await Vi(M);d(q),s("AI has refined your content!","success")}catch(M){s(M.message||"AI assistance failed.","error")}finally{L(!1)}},ce=async()=>{if(!U.trim()){s("Please provide a reason for the announcement to use the AI Wizard.","warning");return}T(!0);try{const M=await uO({title:o,reason:U,area:$,time:R});d(M),!o&&U&&a(U),s("AI has generated an announcement template for you!","success")}catch(M){s(M.message||"AI Wizard failed to generate content.","error")}finally{T(!1)}},ue=M=>{if(M.preventDefault(),G(""),!o.trim()||!u.trim()||!w){G("Title, Content, and Start Date are required.");return}if(S&&new Date(S)<new Date(w)){G("End date cannot be before start date.");return}const q={title:o,content:u,type:f,status:y,startDate:new Date(w),endDate:S?new Date(S):null,targetRoles:N.length===0||N.includes("all")?["all"]:N};e(q)},Q="w-full px-4 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none transition duration-200 text-gray-900",Z="flex items-center justify-center px-4 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95";return c.jsxs("div",{className:"p-1 flex flex-col lg:flex-row gap-8",children:[c.jsx("div",{className:"lg:w-1/2 space-y-6",children:c.jsxs("form",{onSubmit:ue,className:"space-y-6",children:[C&&c.jsxs("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[c.jsx(SL,{size:20,className:"mr-2"})," ",C]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"announcementTitle",className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(YL,{size:16,className:"inline mr-1.5"}),"Title *"]}),c.jsx("input",{type:"text",id:"announcementTitle",value:o,onChange:M=>a(M.target.value),className:Q,placeholder:"E.g., Scheduled Maintenance",required:!0})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("label",{htmlFor:"announcementContent",className:"block text-sm font-medium text-gray-700",children:"Content *"}),c.jsx(bm,{text:"Use AI to rewrite or improve your content below.",children:c.jsxs("button",{type:"button",onClick:K,className:`${Z} text-xs bg-purple-100 text-purple-700 hover:bg-purple-200 focus:ring-purple-300 py-1.5 px-3`,disabled:D||r||P,children:[D?c.jsx(Ge,{size:16,className:"animate-spin mr-1.5"}):c.jsx(Kr,{size:16,className:"mr-1.5"}),D?"Refining...":"Refine Content"]})})]}),c.jsx("textarea",{id:"announcementContent",value:u,onChange:M=>d(M.target.value),rows:"10",className:Q,placeholder:"Describe the announcement, or use the AI Wizard to generate content.",required:!0})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"announcementType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),c.jsxs("select",{id:"announcementType",value:f,onChange:M=>g(M.target.value),className:Q,children:[c.jsx("option",{value:"info",children:"Info"}),c.jsx("option",{value:"warning",children:"Warning"}),c.jsx("option",{value:"critical",children:"Critical"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),c.jsxs("button",{type:"button",onClick:()=>x(y==="active"?"archived":"active"),className:`${Z} w-full ${y==="active"?"bg-green-500 hover:bg-green-600 text-white focus:ring-green-400":"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-300"}`,children:[y==="active"?c.jsx(HL,{size:18,className:"mr-2"}):c.jsx(WL,{size:18,className:"mr-2"}),y==="active"?"Active":"Archived"]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(wc,{size:16,className:"inline mr-1.5"}),"Start Date *"]}),c.jsx("input",{type:"date",id:"startDate",value:w,onChange:M=>E(M.target.value),className:Q,required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(wc,{size:16,className:"inline mr-1.5"}),"End Date (Optional)"]}),c.jsx("input",{type:"date",id:"endDate",value:S,onChange:M=>A(M.target.value),className:Q,min:w})]})]})]})}),c.jsxs("div",{className:"lg:w-1/2 p-6 bg-blue-50 border border-blue-200 rounded-lg space-y-6",children:[c.jsxs("h3",{className:"text-lg font-semibold text-blue-800 flex items-center",children:[c.jsx(Kr,{size:20,className:"mr-2"})," AI Announcement Wizard"]}),c.jsx("p",{className:"text-sm text-blue-700",children:"Fill in the details below and let AI generate a complete, professional announcement for you. It will populate the 'Content' field on the left."}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"aiReason",className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(Wi,{size:16,className:"inline mr-1.5"}),"Reason / Event *"]}),c.jsx("input",{type:"text",id:"aiReason",value:U,onChange:M=>W(M.target.value),className:Q,placeholder:"E.g., Emergency Mainline Repair"})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"aiArea",className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(_c,{size:16,className:"inline mr-1.5"}),"Affected Area(s)"]}),c.jsx("input",{type:"text",id:"aiArea",value:$,onChange:M=>F(M.target.value),className:Q,placeholder:"E.g., Brgy. San Juan, all of Phase 2"})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"aiTime",className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(bc,{size:16,className:"inline mr-1.5"}),"Date & Time of Event"]}),c.jsx("input",{type:"text",id:"aiTime",value:R,onChange:M=>k(M.target.value),className:Q,placeholder:"E.g., June 8, 2025, from 10:00 PM to 4:00 AM"})]}),c.jsxs("button",{type:"button",onClick:ce,className:`${Z} w-full bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500`,disabled:P||r||!U,children:[P?c.jsx(Ge,{size:20,className:"animate-spin mr-2"}):c.jsx(Kr,{size:20,className:"mr-2"}),P?"Generating...":"Generate Announcement Content"]})]}),c.jsxs("div",{className:"lg:col-span-2 w-full pt-6 border-t mt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4",children:[c.jsx("button",{type:"button",onClick:t,className:`${Z} bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-300 focus:ring-gray-300 w-full sm:w-auto order-2 sm:order-1`,disabled:r||P||D,children:"Cancel"}),c.jsxs("button",{type:"submit",form:"announcementForm",onClick:ue,className:`${Z} bg-green-600 hover:bg-green-700 text-white focus:ring-green-500 w-full sm:w-auto order-1 sm:order-2`,disabled:r||P||D||!o||!u,children:[r?c.jsx(Ge,{size:20,className:"animate-spin mr-2"}):c.jsx(Qo,{size:20,className:"mr-2"}),r?"Saving...":n?"Update Announcement":"Create Announcement"]})]})]})};function l3(n,e){const t={};return(n[n.length-1]===""?[...n,""]:n).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const c3=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,u3=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,d3={};function yS(n,e){return(d3.jsx?u3:c3).test(n)}const h3=/[ \t\n\f\r]/g;function f3(n){return typeof n=="object"?n.type==="text"?xS(n.value):!1:xS(n)}function xS(n){return n.replace(h3,"")===""}class Kd{constructor(e,t,r){this.normal=t,this.property=e,r&&(this.space=r)}}Kd.prototype.normal={};Kd.prototype.property={};Kd.prototype.space=void 0;function dA(n,e){const t={},r={};for(const s of n)Object.assign(t,s.property),Object.assign(r,s.normal);return new Kd(t,r,e)}function E0(n){return n.toLowerCase()}class Dr{constructor(e,t){this.attribute=t,this.property=e}}Dr.prototype.attribute="";Dr.prototype.booleanish=!1;Dr.prototype.boolean=!1;Dr.prototype.commaOrSpaceSeparated=!1;Dr.prototype.commaSeparated=!1;Dr.prototype.defined=!1;Dr.prototype.mustUseProperty=!1;Dr.prototype.number=!1;Dr.prototype.overloadedBoolean=!1;Dr.prototype.property="";Dr.prototype.spaceSeparated=!1;Dr.prototype.space=void 0;let m3=0;const Ye=Ja(),sn=Ja(),T0=Ja(),ve=Ja(),Tt=Ja(),ec=Ja(),qr=Ja();function Ja(){return 2**++m3}const k0=Object.freeze(Object.defineProperty({__proto__:null,boolean:Ye,booleanish:sn,commaOrSpaceSeparated:qr,commaSeparated:ec,number:ve,overloadedBoolean:T0,spaceSeparated:Tt},Symbol.toStringTag,{value:"Module"})),by=Object.keys(k0);class mv extends Dr{constructor(e,t,r,s){let o=-1;if(super(e,t),vS(this,"space",s),typeof r=="number")for(;++o<by.length;){const a=by[o];vS(this,by[o],(r&k0[a])===k0[a])}}}mv.prototype.defined=!0;function vS(n,e,t){t&&(n[e]=t)}function Fc(n){const e={},t={};for(const[r,s]of Object.entries(n.properties)){const o=new mv(r,n.transform(n.attributes||{},r),s,n.space);n.mustUseProperty&&n.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),e[r]=o,t[E0(r)]=r,t[E0(o.attribute)]=r}return new Kd(e,t,n.space)}const hA=Fc({properties:{ariaActiveDescendant:null,ariaAtomic:sn,ariaAutoComplete:null,ariaBusy:sn,ariaChecked:sn,ariaColCount:ve,ariaColIndex:ve,ariaColSpan:ve,ariaControls:Tt,ariaCurrent:null,ariaDescribedBy:Tt,ariaDetails:null,ariaDisabled:sn,ariaDropEffect:Tt,ariaErrorMessage:null,ariaExpanded:sn,ariaFlowTo:Tt,ariaGrabbed:sn,ariaHasPopup:null,ariaHidden:sn,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Tt,ariaLevel:ve,ariaLive:null,ariaModal:sn,ariaMultiLine:sn,ariaMultiSelectable:sn,ariaOrientation:null,ariaOwns:Tt,ariaPlaceholder:null,ariaPosInSet:ve,ariaPressed:sn,ariaReadOnly:sn,ariaRelevant:null,ariaRequired:sn,ariaRoleDescription:Tt,ariaRowCount:ve,ariaRowIndex:ve,ariaRowSpan:ve,ariaSelected:sn,ariaSetSize:ve,ariaSort:null,ariaValueMax:ve,ariaValueMin:ve,ariaValueNow:ve,ariaValueText:null,role:null},transform(n,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function fA(n,e){return e in n?n[e]:e}function mA(n,e){return fA(n,e.toLowerCase())}const p3=Fc({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:ec,acceptCharset:Tt,accessKey:Tt,action:null,allow:null,allowFullScreen:Ye,allowPaymentRequest:Ye,allowUserMedia:Ye,alt:null,as:null,async:Ye,autoCapitalize:null,autoComplete:Tt,autoFocus:Ye,autoPlay:Ye,blocking:Tt,capture:null,charSet:null,checked:Ye,cite:null,className:Tt,cols:ve,colSpan:null,content:null,contentEditable:sn,controls:Ye,controlsList:Tt,coords:ve|ec,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Ye,defer:Ye,dir:null,dirName:null,disabled:Ye,download:T0,draggable:sn,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Ye,formTarget:null,headers:Tt,height:ve,hidden:T0,high:ve,href:null,hrefLang:null,htmlFor:Tt,httpEquiv:Tt,id:null,imageSizes:null,imageSrcSet:null,inert:Ye,inputMode:null,integrity:null,is:null,isMap:Ye,itemId:null,itemProp:Tt,itemRef:Tt,itemScope:Ye,itemType:Tt,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Ye,low:ve,manifest:null,max:null,maxLength:ve,media:null,method:null,min:null,minLength:ve,multiple:Ye,muted:Ye,name:null,nonce:null,noModule:Ye,noValidate:Ye,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Ye,optimum:ve,pattern:null,ping:Tt,placeholder:null,playsInline:Ye,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Ye,referrerPolicy:null,rel:Tt,required:Ye,reversed:Ye,rows:ve,rowSpan:ve,sandbox:Tt,scope:null,scoped:Ye,seamless:Ye,selected:Ye,shadowRootClonable:Ye,shadowRootDelegatesFocus:Ye,shadowRootMode:null,shape:null,size:ve,sizes:null,slot:null,span:ve,spellCheck:sn,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ve,step:null,style:null,tabIndex:ve,target:null,title:null,translate:null,type:null,typeMustMatch:Ye,useMap:null,value:sn,width:ve,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Tt,axis:null,background:null,bgColor:null,border:ve,borderColor:null,bottomMargin:ve,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Ye,declare:Ye,event:null,face:null,frame:null,frameBorder:null,hSpace:ve,leftMargin:ve,link:null,longDesc:null,lowSrc:null,marginHeight:ve,marginWidth:ve,noResize:Ye,noHref:Ye,noShade:Ye,noWrap:Ye,object:null,profile:null,prompt:null,rev:null,rightMargin:ve,rules:null,scheme:null,scrolling:sn,standby:null,summary:null,text:null,topMargin:ve,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ve,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Ye,disableRemotePlayback:Ye,prefix:null,property:null,results:ve,security:null,unselectable:null},space:"html",transform:mA}),g3=Fc({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:qr,accentHeight:ve,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ve,amplitude:ve,arabicForm:null,ascent:ve,attributeName:null,attributeType:null,azimuth:ve,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ve,by:null,calcMode:null,capHeight:ve,className:Tt,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ve,diffuseConstant:ve,direction:null,display:null,dur:null,divisor:ve,dominantBaseline:null,download:Ye,dx:null,dy:null,edgeMode:null,editable:null,elevation:ve,enableBackground:null,end:null,event:null,exponent:ve,externalResourcesRequired:null,fill:null,fillOpacity:ve,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:ec,g2:ec,glyphName:ec,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ve,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ve,horizOriginX:ve,horizOriginY:ve,id:null,ideographic:ve,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ve,k:ve,k1:ve,k2:ve,k3:ve,k4:ve,kernelMatrix:qr,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ve,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ve,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ve,overlineThickness:ve,paintOrder:null,panose1:null,path:null,pathLength:ve,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Tt,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ve,pointsAtY:ve,pointsAtZ:ve,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:qr,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:qr,rev:qr,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:qr,requiredFeatures:qr,requiredFonts:qr,requiredFormats:qr,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ve,specularExponent:ve,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ve,strikethroughThickness:ve,string:null,stroke:null,strokeDashArray:qr,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ve,strokeOpacity:ve,strokeWidth:null,style:null,surfaceScale:ve,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:qr,tabIndex:ve,tableValues:null,target:null,targetX:ve,targetY:ve,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:qr,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ve,underlineThickness:ve,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ve,values:null,vAlphabetic:ve,vMathematical:ve,vectorEffect:null,vHanging:ve,vIdeographic:ve,version:null,vertAdvY:ve,vertOriginX:ve,vertOriginY:ve,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ve,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:fA}),pA=Fc({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(n,e){return"xlink:"+e.slice(5).toLowerCase()}}),gA=Fc({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:mA}),yA=Fc({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(n,e){return"xml:"+e.slice(3).toLowerCase()}}),y3={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},x3=/[A-Z]/g,wS=/-[a-z]/g,v3=/^data[-\w.:]+$/i;function w3(n,e){const t=E0(e);let r=e,s=Dr;if(t in n.normal)return n.property[n.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&v3.test(e)){if(e.charAt(4)==="-"){const o=e.slice(5).replace(wS,_3);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=e.slice(4);if(!wS.test(o)){let a=o.replace(x3,b3);a.charAt(0)!=="-"&&(a="-"+a),e="data"+a}}s=mv}return new s(r,e)}function b3(n){return"-"+n.toLowerCase()}function _3(n){return n.charAt(1).toUpperCase()}const S3=dA([hA,p3,pA,gA,yA],"html"),pv=dA([hA,g3,pA,gA,yA],"svg");function I3(n){return n.join(" ").trim()}var Ul={},_y,bS;function E3(){if(bS)return _y;bS=1;var n=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,e=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,s=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,a=/^[;\s]*/,u=/^\s+|\s+$/g,d=`
`,f="/",g="*",y="",x="comment",w="declaration";_y=function(S,A){if(typeof S!="string")throw new TypeError("First argument must be a string");if(!S)return[];A=A||{};var N=1,z=1;function U(C){var G=C.match(e);G&&(N+=G.length);var K=C.lastIndexOf(d);z=~K?C.length-K:z+C.length}function W(){var C={line:N,column:z};return function(G){return G.position=new $(C),k(),G}}function $(C){this.start=C,this.end={line:N,column:z},this.source=A.source}$.prototype.content=S;function F(C){var G=new Error(A.source+":"+N+":"+z+": "+C);if(G.reason=C,G.filename=A.source,G.line=N,G.column=z,G.source=S,!A.silent)throw G}function R(C){var G=C.exec(S);if(G){var K=G[0];return U(K),S=S.slice(K.length),G}}function k(){R(t)}function P(C){var G;for(C=C||[];G=T();)G!==!1&&C.push(G);return C}function T(){var C=W();if(!(f!=S.charAt(0)||g!=S.charAt(1))){for(var G=2;y!=S.charAt(G)&&(g!=S.charAt(G)||f!=S.charAt(G+1));)++G;if(G+=2,y===S.charAt(G-1))return F("End of comment missing");var K=S.slice(2,G-2);return z+=2,U(K),S=S.slice(G),z+=2,C({type:x,comment:K})}}function D(){var C=W(),G=R(r);if(G){if(T(),!R(s))return F("property missing ':'");var K=R(o),ce=C({type:w,property:E(G[0].replace(n,y)),value:K?E(K[0].replace(n,y)):y});return R(a),ce}}function L(){var C=[];P(C);for(var G;G=D();)G!==!1&&(C.push(G),P(C));return C}return k(),L()};function E(S){return S?S.replace(u,y):y}return _y}var _S;function T3(){if(_S)return Ul;_S=1;var n=Ul&&Ul.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.default=t;var e=n(E3());function t(r,s){var o=null;if(!r||typeof r!="string")return o;var a=(0,e.default)(r),u=typeof s=="function";return a.forEach(function(d){if(d.type==="declaration"){var f=d.property,g=d.value;u?s(f,g,d):g&&(o=o||{},o[f]=g)}}),o}return Ul}var Nu={},SS;function k3(){if(SS)return Nu;SS=1,Object.defineProperty(Nu,"__esModule",{value:!0}),Nu.camelCase=void 0;var n=/^--[a-zA-Z0-9_-]+$/,e=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,s=/^-(ms)-/,o=function(f){return!f||t.test(f)||n.test(f)},a=function(f,g){return g.toUpperCase()},u=function(f,g){return"".concat(g,"-")},d=function(f,g){return g===void 0&&(g={}),o(f)?f:(f=f.toLowerCase(),g.reactCompat?f=f.replace(s,u):f=f.replace(r,u),f.replace(e,a))};return Nu.camelCase=d,Nu}var Ru,IS;function A3(){if(IS)return Ru;IS=1;var n=Ru&&Ru.__importDefault||function(s){return s&&s.__esModule?s:{default:s}},e=n(T3()),t=k3();function r(s,o){var a={};return!s||typeof s!="string"||(0,e.default)(s,function(u,d){u&&d&&(a[(0,t.camelCase)(u,o)]=d)}),a}return r.default=r,Ru=r,Ru}var C3=A3();const N3=Tm(C3),xA=vA("end"),gv=vA("start");function vA(n){return e;function e(t){const r=t&&t.position&&t.position[n]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function R3(n){const e=gv(n),t=xA(n);if(e&&t)return{start:e,end:t}}function ed(n){return!n||typeof n!="object"?"":"position"in n||"type"in n?ES(n.position):"start"in n||"end"in n?ES(n):"line"in n||"column"in n?A0(n):""}function A0(n){return TS(n&&n.line)+":"+TS(n&&n.column)}function ES(n){return A0(n&&n.start)+"-"+A0(n&&n.end)}function TS(n){return n&&typeof n=="number"?n:1}class Kn extends Error{constructor(e,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let s="",o={},a=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof e=="string"?s=e:!o.cause&&e&&(a=!0,s=e.message,o.cause=e),!o.ruleId&&!o.source&&typeof r=="string"){const d=r.indexOf(":");d===-1?o.ruleId=r:(o.source=r.slice(0,d),o.ruleId=r.slice(d+1))}if(!o.place&&o.ancestors&&o.ancestors){const d=o.ancestors[o.ancestors.length-1];d&&(o.place=d.position)}const u=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=u?u.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=u?u.line:void 0,this.name=ed(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=a&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}}Kn.prototype.file="";Kn.prototype.name="";Kn.prototype.reason="";Kn.prototype.message="";Kn.prototype.stack="";Kn.prototype.column=void 0;Kn.prototype.line=void 0;Kn.prototype.ancestors=void 0;Kn.prototype.cause=void 0;Kn.prototype.fatal=void 0;Kn.prototype.place=void 0;Kn.prototype.ruleId=void 0;Kn.prototype.source=void 0;const yv={}.hasOwnProperty,P3=new Map,j3=/[A-Z]/g,D3=new Set(["table","tbody","thead","tfoot","tr"]),M3=new Set(["td","th"]),wA="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function L3(n,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=q3(t,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=$3(t,e.jsx,e.jsxs)}const s={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?pv:S3,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},o=bA(s,n,void 0);return o&&typeof o!="string"?o:s.create(n,s.Fragment,{children:o||void 0},void 0)}function bA(n,e,t){if(e.type==="element")return O3(n,e,t);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return F3(n,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return z3(n,e,t);if(e.type==="mdxjsEsm")return V3(n,e);if(e.type==="root")return U3(n,e,t);if(e.type==="text")return B3(n,e)}function O3(n,e,t){const r=n.schema;let s=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(s=pv,n.schema=s),n.ancestors.push(e);const o=SA(n,e.tagName,!1),a=H3(n,e);let u=vv(n,e);return D3.has(e.tagName)&&(u=u.filter(function(d){return typeof d=="string"?!f3(d):!0})),_A(n,a,o,e),xv(a,u),n.ancestors.pop(),n.schema=r,n.create(e,o,a,t)}function F3(n,e){if(e.data&&e.data.estree&&n.evaluater){const r=e.data.estree.body[0];return r.type,n.evaluater.evaluateExpression(r.expression)}Ed(n,e.position)}function V3(n,e){if(e.data&&e.data.estree&&n.evaluater)return n.evaluater.evaluateProgram(e.data.estree);Ed(n,e.position)}function z3(n,e,t){const r=n.schema;let s=r;e.name==="svg"&&r.space==="html"&&(s=pv,n.schema=s),n.ancestors.push(e);const o=e.name===null?n.Fragment:SA(n,e.name,!0),a=W3(n,e),u=vv(n,e);return _A(n,a,o,e),xv(a,u),n.ancestors.pop(),n.schema=r,n.create(e,o,a,t)}function U3(n,e,t){const r={};return xv(r,vv(n,e)),n.create(e,n.Fragment,r,t)}function B3(n,e){return e.value}function _A(n,e,t,r){typeof t!="string"&&t!==n.Fragment&&n.passNode&&(e.node=r)}function xv(n,e){if(e.length>0){const t=e.length>1?e:e[0];t&&(n.children=t)}}function $3(n,e,t){return r;function r(s,o,a,u){const f=Array.isArray(a.children)?t:e;return u?f(o,a,u):f(o,a)}}function q3(n,e){return t;function t(r,s,o,a){const u=Array.isArray(o.children),d=gv(r);return e(s,o,a,u,{columnNumber:d?d.column-1:void 0,fileName:n,lineNumber:d?d.line:void 0},void 0)}}function H3(n,e){const t={};let r,s;for(s in e.properties)if(s!=="children"&&yv.call(e.properties,s)){const o=G3(n,s,e.properties[s]);if(o){const[a,u]=o;n.tableCellAlignToStyle&&a==="align"&&typeof u=="string"&&M3.has(e.tagName)?r=u:t[a]=u}}if(r){const o=t.style||(t.style={});o[n.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function W3(n,e){const t={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&n.evaluater){const o=r.data.estree.body[0];o.type;const a=o.expression;a.type;const u=a.properties[0];u.type,Object.assign(t,n.evaluater.evaluateExpression(u.argument))}else Ed(n,e.position);else{const s=r.name;let o;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&n.evaluater){const u=r.value.data.estree.body[0];u.type,o=n.evaluater.evaluateExpression(u.expression)}else Ed(n,e.position);else o=r.value===null?!0:r.value;t[s]=o}return t}function vv(n,e){const t=[];let r=-1;const s=n.passKeys?new Map:P3;for(;++r<e.children.length;){const o=e.children[r];let a;if(n.passKeys){const d=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(d){const f=s.get(d)||0;a=d+"-"+f,s.set(d,f+1)}}const u=bA(n,o,a);u!==void 0&&t.push(u)}return t}function G3(n,e,t){const r=w3(n.schema,e);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?l3(t):I3(t)),r.property==="style"){let s=typeof t=="object"?t:K3(n,String(t));return n.stylePropertyNameCase==="css"&&(s=Q3(s)),["style",s]}return[n.elementAttributeNameCase==="react"&&r.space?y3[r.property]||r.property:r.attribute,t]}}function K3(n,e){try{return N3(e,{reactCompat:!0})}catch(t){if(n.ignoreInvalidStyle)return{};const r=t,s=new Kn("Cannot parse `style` attribute",{ancestors:n.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw s.file=n.filePath||void 0,s.url=wA+"#cannot-parse-style-attribute",s}}function SA(n,e,t){let r;if(!t)r={type:"Literal",value:e};else if(e.includes(".")){const s=e.split(".");let o=-1,a;for(;++o<s.length;){const u=yS(s[o])?{type:"Identifier",name:s[o]}:{type:"Literal",value:s[o]};a=a?{type:"MemberExpression",object:a,property:u,computed:!!(o&&u.type==="Literal"),optional:!1}:u}r=a}else r=yS(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const s=r.value;return yv.call(n.components,s)?n.components[s]:s}if(n.evaluater)return n.evaluater.evaluateExpression(r);Ed(n)}function Ed(n,e){const t=new Kn("Cannot handle MDX estrees without `createEvaluater`",{ancestors:n.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=n.filePath||void 0,t.url=wA+"#cannot-handle-mdx-estrees-without-createevaluater",t}function Q3(n){const e={};let t;for(t in n)yv.call(n,t)&&(e[Y3(t)]=n[t]);return e}function Y3(n){let e=n.replace(j3,X3);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function X3(n){return"-"+n.toLowerCase()}const Sy={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},J3={};function wv(n,e){const t=J3,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,s=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return IA(n,r,s)}function IA(n,e,t){if(Z3(n)){if("value"in n)return n.type==="html"&&!t?"":n.value;if(e&&"alt"in n&&n.alt)return n.alt;if("children"in n)return kS(n.children,e,t)}return Array.isArray(n)?kS(n,e,t):""}function kS(n,e,t){const r=[];let s=-1;for(;++s<n.length;)r[s]=IA(n[s],e,t);return r.join("")}function Z3(n){return!!(n&&typeof n=="object")}const AS=document.createElement("i");function bv(n){const e="&"+n+";";AS.innerHTML=e;const t=AS.textContent;return t.charCodeAt(t.length-1)===59&&n!=="semi"||t===e?!1:t}function Qr(n,e,t,r){const s=n.length;let o=0,a;if(e<0?e=-e>s?0:s+e:e=e>s?s:e,t=t>0?t:0,r.length<1e4)a=Array.from(r),a.unshift(e,t),n.splice(...a);else for(t&&n.splice(e,t);o<r.length;)a=r.slice(o,o+1e4),a.unshift(e,0),n.splice(...a),o+=1e4,e+=1e4}function ds(n,e){return n.length>0?(Qr(n,n.length,0,e),n):e}const CS={}.hasOwnProperty;function EA(n){const e={};let t=-1;for(;++t<n.length;)e6(e,n[t]);return e}function e6(n,e){let t;for(t in e){const s=(CS.call(n,t)?n[t]:void 0)||(n[t]={}),o=e[t];let a;if(o)for(a in o){CS.call(s,a)||(s[a]=[]);const u=o[a];t6(s[a],Array.isArray(u)?u:u?[u]:[])}}}function t6(n,e){let t=-1;const r=[];for(;++t<e.length;)(e[t].add==="after"?n:r).push(e[t]);Qr(n,0,0,r)}function TA(n,e){const t=Number.parseInt(n,e);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Os(n){return n.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const ir=Yo(/[A-Za-z]/),qn=Yo(/[\dA-Za-z]/),n6=Yo(/[#-'*+\--9=?A-Z^-~]/);function _m(n){return n!==null&&(n<32||n===127)}const C0=Yo(/\d/),r6=Yo(/[\dA-Fa-f]/),s6=Yo(/[!-/:-@[-`{-~]/);function Ue(n){return n!==null&&n<-2}function It(n){return n!==null&&(n<0||n===32)}function nt(n){return n===-2||n===-1||n===32}const fp=Yo(new RegExp("\\p{P}|\\p{S}","u")),Wa=Yo(/\s/);function Yo(n){return e;function e(t){return t!==null&&t>-1&&n.test(String.fromCharCode(t))}}function Vc(n){const e=[];let t=-1,r=0,s=0;for(;++t<n.length;){const o=n.charCodeAt(t);let a="";if(o===37&&qn(n.charCodeAt(t+1))&&qn(n.charCodeAt(t+2)))s=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(a=String.fromCharCode(o));else if(o>55295&&o<57344){const u=n.charCodeAt(t+1);o<56320&&u>56319&&u<57344?(a=String.fromCharCode(o,u),s=1):a=""}else a=String.fromCharCode(o);a&&(e.push(n.slice(r,t),encodeURIComponent(a)),r=t+s+1,a=""),s&&(t+=s,s=0)}return e.join("")+n.slice(r)}function ut(n,e,t,r){const s=r?r-1:Number.POSITIVE_INFINITY;let o=0;return a;function a(d){return nt(d)?(n.enter(t),u(d)):e(d)}function u(d){return nt(d)&&o++<s?(n.consume(d),u):(n.exit(t),e(d))}}const i6={tokenize:o6};function o6(n){const e=n.attempt(this.parser.constructs.contentInitial,r,s);let t;return e;function r(u){if(u===null){n.consume(u);return}return n.enter("lineEnding"),n.consume(u),n.exit("lineEnding"),ut(n,e,"linePrefix")}function s(u){return n.enter("paragraph"),o(u)}function o(u){const d=n.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=d),t=d,a(u)}function a(u){if(u===null){n.exit("chunkText"),n.exit("paragraph"),n.consume(u);return}return Ue(u)?(n.consume(u),n.exit("chunkText"),o):(n.consume(u),a)}}const a6={tokenize:l6},NS={tokenize:c6};function l6(n){const e=this,t=[];let r=0,s,o,a;return u;function u(U){if(r<t.length){const W=t[r];return e.containerState=W[1],n.attempt(W[0].continuation,d,f)(U)}return f(U)}function d(U){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,s&&z();const W=e.events.length;let $=W,F;for(;$--;)if(e.events[$][0]==="exit"&&e.events[$][1].type==="chunkFlow"){F=e.events[$][1].end;break}N(r);let R=W;for(;R<e.events.length;)e.events[R][1].end={...F},R++;return Qr(e.events,$+1,0,e.events.slice(W)),e.events.length=R,f(U)}return u(U)}function f(U){if(r===t.length){if(!s)return x(U);if(s.currentConstruct&&s.currentConstruct.concrete)return E(U);e.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return e.containerState={},n.check(NS,g,y)(U)}function g(U){return s&&z(),N(r),x(U)}function y(U){return e.parser.lazy[e.now().line]=r!==t.length,a=e.now().offset,E(U)}function x(U){return e.containerState={},n.attempt(NS,w,E)(U)}function w(U){return r++,t.push([e.currentConstruct,e.containerState]),x(U)}function E(U){if(U===null){s&&z(),N(0),n.consume(U);return}return s=s||e.parser.flow(e.now()),n.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:o}),S(U)}function S(U){if(U===null){A(n.exit("chunkFlow"),!0),N(0),n.consume(U);return}return Ue(U)?(n.consume(U),A(n.exit("chunkFlow")),r=0,e.interrupt=void 0,u):(n.consume(U),S)}function A(U,W){const $=e.sliceStream(U);if(W&&$.push(null),U.previous=o,o&&(o.next=U),o=U,s.defineSkip(U.start),s.write($),e.parser.lazy[U.start.line]){let F=s.events.length;for(;F--;)if(s.events[F][1].start.offset<a&&(!s.events[F][1].end||s.events[F][1].end.offset>a))return;const R=e.events.length;let k=R,P,T;for(;k--;)if(e.events[k][0]==="exit"&&e.events[k][1].type==="chunkFlow"){if(P){T=e.events[k][1].end;break}P=!0}for(N(r),F=R;F<e.events.length;)e.events[F][1].end={...T},F++;Qr(e.events,k+1,0,e.events.slice(R)),e.events.length=F}}function N(U){let W=t.length;for(;W-- >U;){const $=t[W];e.containerState=$[1],$[0].exit.call(e,n)}t.length=U}function z(){s.write([null]),o=void 0,s=void 0,e.containerState._closeFlow=void 0}}function c6(n,e,t){return ut(n,n.attempt(this.parser.constructs.document,e,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Ec(n){if(n===null||It(n)||Wa(n))return 1;if(fp(n))return 2}function mp(n,e,t){const r=[];let s=-1;for(;++s<n.length;){const o=n[s].resolveAll;o&&!r.includes(o)&&(e=o(e,t),r.push(o))}return e}const N0={name:"attention",resolveAll:u6,tokenize:d6};function u6(n,e){let t=-1,r,s,o,a,u,d,f,g;for(;++t<n.length;)if(n[t][0]==="enter"&&n[t][1].type==="attentionSequence"&&n[t][1]._close){for(r=t;r--;)if(n[r][0]==="exit"&&n[r][1].type==="attentionSequence"&&n[r][1]._open&&e.sliceSerialize(n[r][1]).charCodeAt(0)===e.sliceSerialize(n[t][1]).charCodeAt(0)){if((n[r][1]._close||n[t][1]._open)&&(n[t][1].end.offset-n[t][1].start.offset)%3&&!((n[r][1].end.offset-n[r][1].start.offset+n[t][1].end.offset-n[t][1].start.offset)%3))continue;d=n[r][1].end.offset-n[r][1].start.offset>1&&n[t][1].end.offset-n[t][1].start.offset>1?2:1;const y={...n[r][1].end},x={...n[t][1].start};RS(y,-d),RS(x,d),a={type:d>1?"strongSequence":"emphasisSequence",start:y,end:{...n[r][1].end}},u={type:d>1?"strongSequence":"emphasisSequence",start:{...n[t][1].start},end:x},o={type:d>1?"strongText":"emphasisText",start:{...n[r][1].end},end:{...n[t][1].start}},s={type:d>1?"strong":"emphasis",start:{...a.start},end:{...u.end}},n[r][1].end={...a.start},n[t][1].start={...u.end},f=[],n[r][1].end.offset-n[r][1].start.offset&&(f=ds(f,[["enter",n[r][1],e],["exit",n[r][1],e]])),f=ds(f,[["enter",s,e],["enter",a,e],["exit",a,e],["enter",o,e]]),f=ds(f,mp(e.parser.constructs.insideSpan.null,n.slice(r+1,t),e)),f=ds(f,[["exit",o,e],["enter",u,e],["exit",u,e],["exit",s,e]]),n[t][1].end.offset-n[t][1].start.offset?(g=2,f=ds(f,[["enter",n[t][1],e],["exit",n[t][1],e]])):g=0,Qr(n,r-1,t-r+3,f),t=r+f.length-g-2;break}}for(t=-1;++t<n.length;)n[t][1].type==="attentionSequence"&&(n[t][1].type="data");return n}function d6(n,e){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,s=Ec(r);let o;return a;function a(d){return o=d,n.enter("attentionSequence"),u(d)}function u(d){if(d===o)return n.consume(d),u;const f=n.exit("attentionSequence"),g=Ec(d),y=!g||g===2&&s||t.includes(d),x=!s||s===2&&g||t.includes(r);return f._open=!!(o===42?y:y&&(s||!x)),f._close=!!(o===42?x:x&&(g||!y)),e(d)}}function RS(n,e){n.column+=e,n.offset+=e,n._bufferIndex+=e}const h6={name:"autolink",tokenize:f6};function f6(n,e,t){let r=0;return s;function s(w){return n.enter("autolink"),n.enter("autolinkMarker"),n.consume(w),n.exit("autolinkMarker"),n.enter("autolinkProtocol"),o}function o(w){return ir(w)?(n.consume(w),a):w===64?t(w):f(w)}function a(w){return w===43||w===45||w===46||qn(w)?(r=1,u(w)):f(w)}function u(w){return w===58?(n.consume(w),r=0,d):(w===43||w===45||w===46||qn(w))&&r++<32?(n.consume(w),u):(r=0,f(w))}function d(w){return w===62?(n.exit("autolinkProtocol"),n.enter("autolinkMarker"),n.consume(w),n.exit("autolinkMarker"),n.exit("autolink"),e):w===null||w===32||w===60||_m(w)?t(w):(n.consume(w),d)}function f(w){return w===64?(n.consume(w),g):n6(w)?(n.consume(w),f):t(w)}function g(w){return qn(w)?y(w):t(w)}function y(w){return w===46?(n.consume(w),r=0,g):w===62?(n.exit("autolinkProtocol").type="autolinkEmail",n.enter("autolinkMarker"),n.consume(w),n.exit("autolinkMarker"),n.exit("autolink"),e):x(w)}function x(w){if((w===45||qn(w))&&r++<63){const E=w===45?x:y;return n.consume(w),E}return t(w)}}const Qd={partial:!0,tokenize:m6};function m6(n,e,t){return r;function r(o){return nt(o)?ut(n,s,"linePrefix")(o):s(o)}function s(o){return o===null||Ue(o)?e(o):t(o)}}const kA={continuation:{tokenize:g6},exit:y6,name:"blockQuote",tokenize:p6};function p6(n,e,t){const r=this;return s;function s(a){if(a===62){const u=r.containerState;return u.open||(n.enter("blockQuote",{_container:!0}),u.open=!0),n.enter("blockQuotePrefix"),n.enter("blockQuoteMarker"),n.consume(a),n.exit("blockQuoteMarker"),o}return t(a)}function o(a){return nt(a)?(n.enter("blockQuotePrefixWhitespace"),n.consume(a),n.exit("blockQuotePrefixWhitespace"),n.exit("blockQuotePrefix"),e):(n.exit("blockQuotePrefix"),e(a))}}function g6(n,e,t){const r=this;return s;function s(a){return nt(a)?ut(n,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):o(a)}function o(a){return n.attempt(kA,e,t)(a)}}function y6(n){n.exit("blockQuote")}const AA={name:"characterEscape",tokenize:x6};function x6(n,e,t){return r;function r(o){return n.enter("characterEscape"),n.enter("escapeMarker"),n.consume(o),n.exit("escapeMarker"),s}function s(o){return s6(o)?(n.enter("characterEscapeValue"),n.consume(o),n.exit("characterEscapeValue"),n.exit("characterEscape"),e):t(o)}}const CA={name:"characterReference",tokenize:v6};function v6(n,e,t){const r=this;let s=0,o,a;return u;function u(y){return n.enter("characterReference"),n.enter("characterReferenceMarker"),n.consume(y),n.exit("characterReferenceMarker"),d}function d(y){return y===35?(n.enter("characterReferenceMarkerNumeric"),n.consume(y),n.exit("characterReferenceMarkerNumeric"),f):(n.enter("characterReferenceValue"),o=31,a=qn,g(y))}function f(y){return y===88||y===120?(n.enter("characterReferenceMarkerHexadecimal"),n.consume(y),n.exit("characterReferenceMarkerHexadecimal"),n.enter("characterReferenceValue"),o=6,a=r6,g):(n.enter("characterReferenceValue"),o=7,a=C0,g(y))}function g(y){if(y===59&&s){const x=n.exit("characterReferenceValue");return a===qn&&!bv(r.sliceSerialize(x))?t(y):(n.enter("characterReferenceMarker"),n.consume(y),n.exit("characterReferenceMarker"),n.exit("characterReference"),e)}return a(y)&&s++<o?(n.consume(y),g):t(y)}}const PS={partial:!0,tokenize:b6},jS={concrete:!0,name:"codeFenced",tokenize:w6};function w6(n,e,t){const r=this,s={partial:!0,tokenize:$};let o=0,a=0,u;return d;function d(F){return f(F)}function f(F){const R=r.events[r.events.length-1];return o=R&&R[1].type==="linePrefix"?R[2].sliceSerialize(R[1],!0).length:0,u=F,n.enter("codeFenced"),n.enter("codeFencedFence"),n.enter("codeFencedFenceSequence"),g(F)}function g(F){return F===u?(a++,n.consume(F),g):a<3?t(F):(n.exit("codeFencedFenceSequence"),nt(F)?ut(n,y,"whitespace")(F):y(F))}function y(F){return F===null||Ue(F)?(n.exit("codeFencedFence"),r.interrupt?e(F):n.check(PS,S,W)(F)):(n.enter("codeFencedFenceInfo"),n.enter("chunkString",{contentType:"string"}),x(F))}function x(F){return F===null||Ue(F)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),y(F)):nt(F)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),ut(n,w,"whitespace")(F)):F===96&&F===u?t(F):(n.consume(F),x)}function w(F){return F===null||Ue(F)?y(F):(n.enter("codeFencedFenceMeta"),n.enter("chunkString",{contentType:"string"}),E(F))}function E(F){return F===null||Ue(F)?(n.exit("chunkString"),n.exit("codeFencedFenceMeta"),y(F)):F===96&&F===u?t(F):(n.consume(F),E)}function S(F){return n.attempt(s,W,A)(F)}function A(F){return n.enter("lineEnding"),n.consume(F),n.exit("lineEnding"),N}function N(F){return o>0&&nt(F)?ut(n,z,"linePrefix",o+1)(F):z(F)}function z(F){return F===null||Ue(F)?n.check(PS,S,W)(F):(n.enter("codeFlowValue"),U(F))}function U(F){return F===null||Ue(F)?(n.exit("codeFlowValue"),z(F)):(n.consume(F),U)}function W(F){return n.exit("codeFenced"),e(F)}function $(F,R,k){let P=0;return T;function T(K){return F.enter("lineEnding"),F.consume(K),F.exit("lineEnding"),D}function D(K){return F.enter("codeFencedFence"),nt(K)?ut(F,L,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(K):L(K)}function L(K){return K===u?(F.enter("codeFencedFenceSequence"),C(K)):k(K)}function C(K){return K===u?(P++,F.consume(K),C):P>=a?(F.exit("codeFencedFenceSequence"),nt(K)?ut(F,G,"whitespace")(K):G(K)):k(K)}function G(K){return K===null||Ue(K)?(F.exit("codeFencedFence"),R(K)):k(K)}}}function b6(n,e,t){const r=this;return s;function s(a){return a===null?t(a):(n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),o)}function o(a){return r.parser.lazy[r.now().line]?t(a):e(a)}}const Iy={name:"codeIndented",tokenize:S6},_6={partial:!0,tokenize:I6};function S6(n,e,t){const r=this;return s;function s(f){return n.enter("codeIndented"),ut(n,o,"linePrefix",5)(f)}function o(f){const g=r.events[r.events.length-1];return g&&g[1].type==="linePrefix"&&g[2].sliceSerialize(g[1],!0).length>=4?a(f):t(f)}function a(f){return f===null?d(f):Ue(f)?n.attempt(_6,a,d)(f):(n.enter("codeFlowValue"),u(f))}function u(f){return f===null||Ue(f)?(n.exit("codeFlowValue"),a(f)):(n.consume(f),u)}function d(f){return n.exit("codeIndented"),e(f)}}function I6(n,e,t){const r=this;return s;function s(a){return r.parser.lazy[r.now().line]?t(a):Ue(a)?(n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),s):ut(n,o,"linePrefix",5)(a)}function o(a){const u=r.events[r.events.length-1];return u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?e(a):Ue(a)?s(a):t(a)}}const E6={name:"codeText",previous:k6,resolve:T6,tokenize:A6};function T6(n){let e=n.length-4,t=3,r,s;if((n[t][1].type==="lineEnding"||n[t][1].type==="space")&&(n[e][1].type==="lineEnding"||n[e][1].type==="space")){for(r=t;++r<e;)if(n[r][1].type==="codeTextData"){n[t][1].type="codeTextPadding",n[e][1].type="codeTextPadding",t+=2,e-=2;break}}for(r=t-1,e++;++r<=e;)s===void 0?r!==e&&n[r][1].type!=="lineEnding"&&(s=r):(r===e||n[r][1].type==="lineEnding")&&(n[s][1].type="codeTextData",r!==s+2&&(n[s][1].end=n[r-1][1].end,n.splice(s+2,r-s-2),e-=r-s-2,r=s+2),s=void 0);return n}function k6(n){return n!==96||this.events[this.events.length-1][1].type==="characterEscape"}function A6(n,e,t){let r=0,s,o;return a;function a(y){return n.enter("codeText"),n.enter("codeTextSequence"),u(y)}function u(y){return y===96?(n.consume(y),r++,u):(n.exit("codeTextSequence"),d(y))}function d(y){return y===null?t(y):y===32?(n.enter("space"),n.consume(y),n.exit("space"),d):y===96?(o=n.enter("codeTextSequence"),s=0,g(y)):Ue(y)?(n.enter("lineEnding"),n.consume(y),n.exit("lineEnding"),d):(n.enter("codeTextData"),f(y))}function f(y){return y===null||y===32||y===96||Ue(y)?(n.exit("codeTextData"),d(y)):(n.consume(y),f)}function g(y){return y===96?(n.consume(y),s++,g):s===r?(n.exit("codeTextSequence"),n.exit("codeText"),e(y)):(o.type="codeTextData",f(y))}}class C6{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,t,r){const s=t||0;this.setCursor(Math.trunc(e));const o=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return r&&Pu(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),Pu(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),Pu(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const t=this.left.splice(e,Number.POSITIVE_INFINITY);Pu(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);Pu(this.left,t.reverse())}}}function Pu(n,e){let t=0;if(e.length<1e4)n.push(...e);else for(;t<e.length;)n.push(...e.slice(t,t+1e4)),t+=1e4}function NA(n){const e={};let t=-1,r,s,o,a,u,d,f;const g=new C6(n);for(;++t<g.length;){for(;t in e;)t=e[t];if(r=g.get(t),t&&r[1].type==="chunkFlow"&&g.get(t-1)[1].type==="listItemPrefix"&&(d=r[1]._tokenizer.events,o=0,o<d.length&&d[o][1].type==="lineEndingBlank"&&(o+=2),o<d.length&&d[o][1].type==="content"))for(;++o<d.length&&d[o][1].type!=="content";)d[o][1].type==="chunkText"&&(d[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,N6(g,t)),t=e[t],f=!0);else if(r[1]._container){for(o=t,s=void 0;o--;)if(a=g.get(o),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank")a[0]==="enter"&&(s&&(g.get(s)[1].type="lineEndingBlank"),a[1].type="lineEnding",s=o);else if(!(a[1].type==="linePrefix"||a[1].type==="listItemIndent"))break;s&&(r[1].end={...g.get(s)[1].start},u=g.slice(s,t),u.unshift(r),g.splice(s,t-s+1,u))}}return Qr(n,0,Number.POSITIVE_INFINITY,g.slice(0)),!f}function N6(n,e){const t=n.get(e)[1],r=n.get(e)[2];let s=e-1;const o=[];let a=t._tokenizer;a||(a=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const u=a.events,d=[],f={};let g,y,x=-1,w=t,E=0,S=0;const A=[S];for(;w;){for(;n.get(++s)[1]!==w;);o.push(s),w._tokenizer||(g=r.sliceStream(w),w.next||g.push(null),y&&a.defineSkip(w.start),w._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(g),w._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),y=w,w=w.next}for(w=t;++x<u.length;)u[x][0]==="exit"&&u[x-1][0]==="enter"&&u[x][1].type===u[x-1][1].type&&u[x][1].start.line!==u[x][1].end.line&&(S=x+1,A.push(S),w._tokenizer=void 0,w.previous=void 0,w=w.next);for(a.events=[],w?(w._tokenizer=void 0,w.previous=void 0):A.pop(),x=A.length;x--;){const N=u.slice(A[x],A[x+1]),z=o.pop();d.push([z,z+N.length-1]),n.splice(z,2,N)}for(d.reverse(),x=-1;++x<d.length;)f[E+d[x][0]]=E+d[x][1],E+=d[x][1]-d[x][0]-1;return f}const R6={resolve:j6,tokenize:D6},P6={partial:!0,tokenize:M6};function j6(n){return NA(n),n}function D6(n,e){let t;return r;function r(u){return n.enter("content"),t=n.enter("chunkContent",{contentType:"content"}),s(u)}function s(u){return u===null?o(u):Ue(u)?n.check(P6,a,o)(u):(n.consume(u),s)}function o(u){return n.exit("chunkContent"),n.exit("content"),e(u)}function a(u){return n.consume(u),n.exit("chunkContent"),t.next=n.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,s}}function M6(n,e,t){const r=this;return s;function s(a){return n.exit("chunkContent"),n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),ut(n,o,"linePrefix")}function o(a){if(a===null||Ue(a))return t(a);const u=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?e(a):n.interrupt(r.parser.constructs.flow,t,e)(a)}}function RA(n,e,t,r,s,o,a,u,d){const f=d||Number.POSITIVE_INFINITY;let g=0;return y;function y(N){return N===60?(n.enter(r),n.enter(s),n.enter(o),n.consume(N),n.exit(o),x):N===null||N===32||N===41||_m(N)?t(N):(n.enter(r),n.enter(a),n.enter(u),n.enter("chunkString",{contentType:"string"}),S(N))}function x(N){return N===62?(n.enter(o),n.consume(N),n.exit(o),n.exit(s),n.exit(r),e):(n.enter(u),n.enter("chunkString",{contentType:"string"}),w(N))}function w(N){return N===62?(n.exit("chunkString"),n.exit(u),x(N)):N===null||N===60||Ue(N)?t(N):(n.consume(N),N===92?E:w)}function E(N){return N===60||N===62||N===92?(n.consume(N),w):w(N)}function S(N){return!g&&(N===null||N===41||It(N))?(n.exit("chunkString"),n.exit(u),n.exit(a),n.exit(r),e(N)):g<f&&N===40?(n.consume(N),g++,S):N===41?(n.consume(N),g--,S):N===null||N===32||N===40||_m(N)?t(N):(n.consume(N),N===92?A:S)}function A(N){return N===40||N===41||N===92?(n.consume(N),S):S(N)}}function PA(n,e,t,r,s,o){const a=this;let u=0,d;return f;function f(w){return n.enter(r),n.enter(s),n.consume(w),n.exit(s),n.enter(o),g}function g(w){return u>999||w===null||w===91||w===93&&!d||w===94&&!u&&"_hiddenFootnoteSupport"in a.parser.constructs?t(w):w===93?(n.exit(o),n.enter(s),n.consume(w),n.exit(s),n.exit(r),e):Ue(w)?(n.enter("lineEnding"),n.consume(w),n.exit("lineEnding"),g):(n.enter("chunkString",{contentType:"string"}),y(w))}function y(w){return w===null||w===91||w===93||Ue(w)||u++>999?(n.exit("chunkString"),g(w)):(n.consume(w),d||(d=!nt(w)),w===92?x:y)}function x(w){return w===91||w===92||w===93?(n.consume(w),u++,y):y(w)}}function jA(n,e,t,r,s,o){let a;return u;function u(x){return x===34||x===39||x===40?(n.enter(r),n.enter(s),n.consume(x),n.exit(s),a=x===40?41:x,d):t(x)}function d(x){return x===a?(n.enter(s),n.consume(x),n.exit(s),n.exit(r),e):(n.enter(o),f(x))}function f(x){return x===a?(n.exit(o),d(a)):x===null?t(x):Ue(x)?(n.enter("lineEnding"),n.consume(x),n.exit("lineEnding"),ut(n,f,"linePrefix")):(n.enter("chunkString",{contentType:"string"}),g(x))}function g(x){return x===a||x===null||Ue(x)?(n.exit("chunkString"),f(x)):(n.consume(x),x===92?y:g)}function y(x){return x===a||x===92?(n.consume(x),g):g(x)}}function td(n,e){let t;return r;function r(s){return Ue(s)?(n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),t=!0,r):nt(s)?ut(n,r,t?"linePrefix":"lineSuffix")(s):e(s)}}const L6={name:"definition",tokenize:F6},O6={partial:!0,tokenize:V6};function F6(n,e,t){const r=this;let s;return o;function o(w){return n.enter("definition"),a(w)}function a(w){return PA.call(r,n,u,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(w)}function u(w){return s=Os(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),w===58?(n.enter("definitionMarker"),n.consume(w),n.exit("definitionMarker"),d):t(w)}function d(w){return It(w)?td(n,f)(w):f(w)}function f(w){return RA(n,g,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(w)}function g(w){return n.attempt(O6,y,y)(w)}function y(w){return nt(w)?ut(n,x,"whitespace")(w):x(w)}function x(w){return w===null||Ue(w)?(n.exit("definition"),r.parser.defined.push(s),e(w)):t(w)}}function V6(n,e,t){return r;function r(u){return It(u)?td(n,s)(u):t(u)}function s(u){return jA(n,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(u)}function o(u){return nt(u)?ut(n,a,"whitespace")(u):a(u)}function a(u){return u===null||Ue(u)?e(u):t(u)}}const z6={name:"hardBreakEscape",tokenize:U6};function U6(n,e,t){return r;function r(o){return n.enter("hardBreakEscape"),n.consume(o),s}function s(o){return Ue(o)?(n.exit("hardBreakEscape"),e(o)):t(o)}}const B6={name:"headingAtx",resolve:$6,tokenize:q6};function $6(n,e){let t=n.length-2,r=3,s,o;return n[r][1].type==="whitespace"&&(r+=2),t-2>r&&n[t][1].type==="whitespace"&&(t-=2),n[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&n[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(s={type:"atxHeadingText",start:n[r][1].start,end:n[t][1].end},o={type:"chunkText",start:n[r][1].start,end:n[t][1].end,contentType:"text"},Qr(n,r,t-r+1,[["enter",s,e],["enter",o,e],["exit",o,e],["exit",s,e]])),n}function q6(n,e,t){let r=0;return s;function s(g){return n.enter("atxHeading"),o(g)}function o(g){return n.enter("atxHeadingSequence"),a(g)}function a(g){return g===35&&r++<6?(n.consume(g),a):g===null||It(g)?(n.exit("atxHeadingSequence"),u(g)):t(g)}function u(g){return g===35?(n.enter("atxHeadingSequence"),d(g)):g===null||Ue(g)?(n.exit("atxHeading"),e(g)):nt(g)?ut(n,u,"whitespace")(g):(n.enter("atxHeadingText"),f(g))}function d(g){return g===35?(n.consume(g),d):(n.exit("atxHeadingSequence"),u(g))}function f(g){return g===null||g===35||It(g)?(n.exit("atxHeadingText"),u(g)):(n.consume(g),f)}}const H6=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],DS=["pre","script","style","textarea"],W6={concrete:!0,name:"htmlFlow",resolveTo:Q6,tokenize:Y6},G6={partial:!0,tokenize:J6},K6={partial:!0,tokenize:X6};function Q6(n){let e=n.length;for(;e--&&!(n[e][0]==="enter"&&n[e][1].type==="htmlFlow"););return e>1&&n[e-2][1].type==="linePrefix"&&(n[e][1].start=n[e-2][1].start,n[e+1][1].start=n[e-2][1].start,n.splice(e-2,2)),n}function Y6(n,e,t){const r=this;let s,o,a,u,d;return f;function f(V){return g(V)}function g(V){return n.enter("htmlFlow"),n.enter("htmlFlowData"),n.consume(V),y}function y(V){return V===33?(n.consume(V),x):V===47?(n.consume(V),o=!0,S):V===63?(n.consume(V),s=3,r.interrupt?e:M):ir(V)?(n.consume(V),a=String.fromCharCode(V),A):t(V)}function x(V){return V===45?(n.consume(V),s=2,w):V===91?(n.consume(V),s=5,u=0,E):ir(V)?(n.consume(V),s=4,r.interrupt?e:M):t(V)}function w(V){return V===45?(n.consume(V),r.interrupt?e:M):t(V)}function E(V){const de="CDATA[";return V===de.charCodeAt(u++)?(n.consume(V),u===de.length?r.interrupt?e:L:E):t(V)}function S(V){return ir(V)?(n.consume(V),a=String.fromCharCode(V),A):t(V)}function A(V){if(V===null||V===47||V===62||It(V)){const de=V===47,xe=a.toLowerCase();return!de&&!o&&DS.includes(xe)?(s=1,r.interrupt?e(V):L(V)):H6.includes(a.toLowerCase())?(s=6,de?(n.consume(V),N):r.interrupt?e(V):L(V)):(s=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(V):o?z(V):U(V))}return V===45||qn(V)?(n.consume(V),a+=String.fromCharCode(V),A):t(V)}function N(V){return V===62?(n.consume(V),r.interrupt?e:L):t(V)}function z(V){return nt(V)?(n.consume(V),z):T(V)}function U(V){return V===47?(n.consume(V),T):V===58||V===95||ir(V)?(n.consume(V),W):nt(V)?(n.consume(V),U):T(V)}function W(V){return V===45||V===46||V===58||V===95||qn(V)?(n.consume(V),W):$(V)}function $(V){return V===61?(n.consume(V),F):nt(V)?(n.consume(V),$):U(V)}function F(V){return V===null||V===60||V===61||V===62||V===96?t(V):V===34||V===39?(n.consume(V),d=V,R):nt(V)?(n.consume(V),F):k(V)}function R(V){return V===d?(n.consume(V),d=null,P):V===null||Ue(V)?t(V):(n.consume(V),R)}function k(V){return V===null||V===34||V===39||V===47||V===60||V===61||V===62||V===96||It(V)?$(V):(n.consume(V),k)}function P(V){return V===47||V===62||nt(V)?U(V):t(V)}function T(V){return V===62?(n.consume(V),D):t(V)}function D(V){return V===null||Ue(V)?L(V):nt(V)?(n.consume(V),D):t(V)}function L(V){return V===45&&s===2?(n.consume(V),ce):V===60&&s===1?(n.consume(V),ue):V===62&&s===4?(n.consume(V),q):V===63&&s===3?(n.consume(V),M):V===93&&s===5?(n.consume(V),Z):Ue(V)&&(s===6||s===7)?(n.exit("htmlFlowData"),n.check(G6,ne,C)(V)):V===null||Ue(V)?(n.exit("htmlFlowData"),C(V)):(n.consume(V),L)}function C(V){return n.check(K6,G,ne)(V)}function G(V){return n.enter("lineEnding"),n.consume(V),n.exit("lineEnding"),K}function K(V){return V===null||Ue(V)?C(V):(n.enter("htmlFlowData"),L(V))}function ce(V){return V===45?(n.consume(V),M):L(V)}function ue(V){return V===47?(n.consume(V),a="",Q):L(V)}function Q(V){if(V===62){const de=a.toLowerCase();return DS.includes(de)?(n.consume(V),q):L(V)}return ir(V)&&a.length<8?(n.consume(V),a+=String.fromCharCode(V),Q):L(V)}function Z(V){return V===93?(n.consume(V),M):L(V)}function M(V){return V===62?(n.consume(V),q):V===45&&s===2?(n.consume(V),M):L(V)}function q(V){return V===null||Ue(V)?(n.exit("htmlFlowData"),ne(V)):(n.consume(V),q)}function ne(V){return n.exit("htmlFlow"),e(V)}}function X6(n,e,t){const r=this;return s;function s(a){return Ue(a)?(n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),o):t(a)}function o(a){return r.parser.lazy[r.now().line]?t(a):e(a)}}function J6(n,e,t){return r;function r(s){return n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),n.attempt(Qd,e,t)}}const Z6={name:"htmlText",tokenize:eF};function eF(n,e,t){const r=this;let s,o,a;return u;function u(M){return n.enter("htmlText"),n.enter("htmlTextData"),n.consume(M),d}function d(M){return M===33?(n.consume(M),f):M===47?(n.consume(M),$):M===63?(n.consume(M),U):ir(M)?(n.consume(M),k):t(M)}function f(M){return M===45?(n.consume(M),g):M===91?(n.consume(M),o=0,E):ir(M)?(n.consume(M),z):t(M)}function g(M){return M===45?(n.consume(M),w):t(M)}function y(M){return M===null?t(M):M===45?(n.consume(M),x):Ue(M)?(a=y,ue(M)):(n.consume(M),y)}function x(M){return M===45?(n.consume(M),w):y(M)}function w(M){return M===62?ce(M):M===45?x(M):y(M)}function E(M){const q="CDATA[";return M===q.charCodeAt(o++)?(n.consume(M),o===q.length?S:E):t(M)}function S(M){return M===null?t(M):M===93?(n.consume(M),A):Ue(M)?(a=S,ue(M)):(n.consume(M),S)}function A(M){return M===93?(n.consume(M),N):S(M)}function N(M){return M===62?ce(M):M===93?(n.consume(M),N):S(M)}function z(M){return M===null||M===62?ce(M):Ue(M)?(a=z,ue(M)):(n.consume(M),z)}function U(M){return M===null?t(M):M===63?(n.consume(M),W):Ue(M)?(a=U,ue(M)):(n.consume(M),U)}function W(M){return M===62?ce(M):U(M)}function $(M){return ir(M)?(n.consume(M),F):t(M)}function F(M){return M===45||qn(M)?(n.consume(M),F):R(M)}function R(M){return Ue(M)?(a=R,ue(M)):nt(M)?(n.consume(M),R):ce(M)}function k(M){return M===45||qn(M)?(n.consume(M),k):M===47||M===62||It(M)?P(M):t(M)}function P(M){return M===47?(n.consume(M),ce):M===58||M===95||ir(M)?(n.consume(M),T):Ue(M)?(a=P,ue(M)):nt(M)?(n.consume(M),P):ce(M)}function T(M){return M===45||M===46||M===58||M===95||qn(M)?(n.consume(M),T):D(M)}function D(M){return M===61?(n.consume(M),L):Ue(M)?(a=D,ue(M)):nt(M)?(n.consume(M),D):P(M)}function L(M){return M===null||M===60||M===61||M===62||M===96?t(M):M===34||M===39?(n.consume(M),s=M,C):Ue(M)?(a=L,ue(M)):nt(M)?(n.consume(M),L):(n.consume(M),G)}function C(M){return M===s?(n.consume(M),s=void 0,K):M===null?t(M):Ue(M)?(a=C,ue(M)):(n.consume(M),C)}function G(M){return M===null||M===34||M===39||M===60||M===61||M===96?t(M):M===47||M===62||It(M)?P(M):(n.consume(M),G)}function K(M){return M===47||M===62||It(M)?P(M):t(M)}function ce(M){return M===62?(n.consume(M),n.exit("htmlTextData"),n.exit("htmlText"),e):t(M)}function ue(M){return n.exit("htmlTextData"),n.enter("lineEnding"),n.consume(M),n.exit("lineEnding"),Q}function Q(M){return nt(M)?ut(n,Z,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(M):Z(M)}function Z(M){return n.enter("htmlTextData"),a(M)}}const _v={name:"labelEnd",resolveAll:sF,resolveTo:iF,tokenize:oF},tF={tokenize:aF},nF={tokenize:lF},rF={tokenize:cF};function sF(n){let e=-1;const t=[];for(;++e<n.length;){const r=n[e][1];if(t.push(n[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const s=r.type==="labelImage"?4:2;r.type="data",e+=s}}return n.length!==t.length&&Qr(n,0,n.length,t),n}function iF(n,e){let t=n.length,r=0,s,o,a,u;for(;t--;)if(s=n[t][1],o){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;n[t][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(a){if(n[t][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(o=t,s.type!=="labelLink")){r=2;break}}else s.type==="labelEnd"&&(a=t);const d={type:n[o][1].type==="labelLink"?"link":"image",start:{...n[o][1].start},end:{...n[n.length-1][1].end}},f={type:"label",start:{...n[o][1].start},end:{...n[a][1].end}},g={type:"labelText",start:{...n[o+r+2][1].end},end:{...n[a-2][1].start}};return u=[["enter",d,e],["enter",f,e]],u=ds(u,n.slice(o+1,o+r+3)),u=ds(u,[["enter",g,e]]),u=ds(u,mp(e.parser.constructs.insideSpan.null,n.slice(o+r+4,a-3),e)),u=ds(u,[["exit",g,e],n[a-2],n[a-1],["exit",f,e]]),u=ds(u,n.slice(a+1)),u=ds(u,[["exit",d,e]]),Qr(n,o,n.length,u),n}function oF(n,e,t){const r=this;let s=r.events.length,o,a;for(;s--;)if((r.events[s][1].type==="labelImage"||r.events[s][1].type==="labelLink")&&!r.events[s][1]._balanced){o=r.events[s][1];break}return u;function u(x){return o?o._inactive?y(x):(a=r.parser.defined.includes(Os(r.sliceSerialize({start:o.end,end:r.now()}))),n.enter("labelEnd"),n.enter("labelMarker"),n.consume(x),n.exit("labelMarker"),n.exit("labelEnd"),d):t(x)}function d(x){return x===40?n.attempt(tF,g,a?g:y)(x):x===91?n.attempt(nF,g,a?f:y)(x):a?g(x):y(x)}function f(x){return n.attempt(rF,g,y)(x)}function g(x){return e(x)}function y(x){return o._balanced=!0,t(x)}}function aF(n,e,t){return r;function r(y){return n.enter("resource"),n.enter("resourceMarker"),n.consume(y),n.exit("resourceMarker"),s}function s(y){return It(y)?td(n,o)(y):o(y)}function o(y){return y===41?g(y):RA(n,a,u,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(y)}function a(y){return It(y)?td(n,d)(y):g(y)}function u(y){return t(y)}function d(y){return y===34||y===39||y===40?jA(n,f,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(y):g(y)}function f(y){return It(y)?td(n,g)(y):g(y)}function g(y){return y===41?(n.enter("resourceMarker"),n.consume(y),n.exit("resourceMarker"),n.exit("resource"),e):t(y)}}function lF(n,e,t){const r=this;return s;function s(u){return PA.call(r,n,o,a,"reference","referenceMarker","referenceString")(u)}function o(u){return r.parser.defined.includes(Os(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(u):t(u)}function a(u){return t(u)}}function cF(n,e,t){return r;function r(o){return n.enter("reference"),n.enter("referenceMarker"),n.consume(o),n.exit("referenceMarker"),s}function s(o){return o===93?(n.enter("referenceMarker"),n.consume(o),n.exit("referenceMarker"),n.exit("reference"),e):t(o)}}const uF={name:"labelStartImage",resolveAll:_v.resolveAll,tokenize:dF};function dF(n,e,t){const r=this;return s;function s(u){return n.enter("labelImage"),n.enter("labelImageMarker"),n.consume(u),n.exit("labelImageMarker"),o}function o(u){return u===91?(n.enter("labelMarker"),n.consume(u),n.exit("labelMarker"),n.exit("labelImage"),a):t(u)}function a(u){return u===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(u):e(u)}}const hF={name:"labelStartLink",resolveAll:_v.resolveAll,tokenize:fF};function fF(n,e,t){const r=this;return s;function s(a){return n.enter("labelLink"),n.enter("labelMarker"),n.consume(a),n.exit("labelMarker"),n.exit("labelLink"),o}function o(a){return a===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(a):e(a)}}const Ey={name:"lineEnding",tokenize:mF};function mF(n,e){return t;function t(r){return n.enter("lineEnding"),n.consume(r),n.exit("lineEnding"),ut(n,e,"linePrefix")}}const zf={name:"thematicBreak",tokenize:pF};function pF(n,e,t){let r=0,s;return o;function o(f){return n.enter("thematicBreak"),a(f)}function a(f){return s=f,u(f)}function u(f){return f===s?(n.enter("thematicBreakSequence"),d(f)):r>=3&&(f===null||Ue(f))?(n.exit("thematicBreak"),e(f)):t(f)}function d(f){return f===s?(n.consume(f),r++,d):(n.exit("thematicBreakSequence"),nt(f)?ut(n,u,"whitespace")(f):u(f))}}const Cr={continuation:{tokenize:vF},exit:bF,name:"list",tokenize:xF},gF={partial:!0,tokenize:_F},yF={partial:!0,tokenize:wF};function xF(n,e,t){const r=this,s=r.events[r.events.length-1];let o=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,a=0;return u;function u(w){const E=r.containerState.type||(w===42||w===43||w===45?"listUnordered":"listOrdered");if(E==="listUnordered"?!r.containerState.marker||w===r.containerState.marker:C0(w)){if(r.containerState.type||(r.containerState.type=E,n.enter(E,{_container:!0})),E==="listUnordered")return n.enter("listItemPrefix"),w===42||w===45?n.check(zf,t,f)(w):f(w);if(!r.interrupt||w===49)return n.enter("listItemPrefix"),n.enter("listItemValue"),d(w)}return t(w)}function d(w){return C0(w)&&++a<10?(n.consume(w),d):(!r.interrupt||a<2)&&(r.containerState.marker?w===r.containerState.marker:w===41||w===46)?(n.exit("listItemValue"),f(w)):t(w)}function f(w){return n.enter("listItemMarker"),n.consume(w),n.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||w,n.check(Qd,r.interrupt?t:g,n.attempt(gF,x,y))}function g(w){return r.containerState.initialBlankLine=!0,o++,x(w)}function y(w){return nt(w)?(n.enter("listItemPrefixWhitespace"),n.consume(w),n.exit("listItemPrefixWhitespace"),x):t(w)}function x(w){return r.containerState.size=o+r.sliceSerialize(n.exit("listItemPrefix"),!0).length,e(w)}}function vF(n,e,t){const r=this;return r.containerState._closeFlow=void 0,n.check(Qd,s,o);function s(u){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,ut(n,e,"listItemIndent",r.containerState.size+1)(u)}function o(u){return r.containerState.furtherBlankLines||!nt(u)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,a(u)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,n.attempt(yF,e,a)(u))}function a(u){return r.containerState._closeFlow=!0,r.interrupt=void 0,ut(n,n.attempt(Cr,e,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(u)}}function wF(n,e,t){const r=this;return ut(n,s,"listItemIndent",r.containerState.size+1);function s(o){const a=r.events[r.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===r.containerState.size?e(o):t(o)}}function bF(n){n.exit(this.containerState.type)}function _F(n,e,t){const r=this;return ut(n,s,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function s(o){const a=r.events[r.events.length-1];return!nt(o)&&a&&a[1].type==="listItemPrefixWhitespace"?e(o):t(o)}}const MS={name:"setextUnderline",resolveTo:SF,tokenize:IF};function SF(n,e){let t=n.length,r,s,o;for(;t--;)if(n[t][0]==="enter"){if(n[t][1].type==="content"){r=t;break}n[t][1].type==="paragraph"&&(s=t)}else n[t][1].type==="content"&&n.splice(t,1),!o&&n[t][1].type==="definition"&&(o=t);const a={type:"setextHeading",start:{...n[r][1].start},end:{...n[n.length-1][1].end}};return n[s][1].type="setextHeadingText",o?(n.splice(s,0,["enter",a,e]),n.splice(o+1,0,["exit",n[r][1],e]),n[r][1].end={...n[o][1].end}):n[r][1]=a,n.push(["exit",a,e]),n}function IF(n,e,t){const r=this;let s;return o;function o(f){let g=r.events.length,y;for(;g--;)if(r.events[g][1].type!=="lineEnding"&&r.events[g][1].type!=="linePrefix"&&r.events[g][1].type!=="content"){y=r.events[g][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||y)?(n.enter("setextHeadingLine"),s=f,a(f)):t(f)}function a(f){return n.enter("setextHeadingLineSequence"),u(f)}function u(f){return f===s?(n.consume(f),u):(n.exit("setextHeadingLineSequence"),nt(f)?ut(n,d,"lineSuffix")(f):d(f))}function d(f){return f===null||Ue(f)?(n.exit("setextHeadingLine"),e(f)):t(f)}}const EF={tokenize:TF};function TF(n){const e=this,t=n.attempt(Qd,r,n.attempt(this.parser.constructs.flowInitial,s,ut(n,n.attempt(this.parser.constructs.flow,s,n.attempt(R6,s)),"linePrefix")));return t;function r(o){if(o===null){n.consume(o);return}return n.enter("lineEndingBlank"),n.consume(o),n.exit("lineEndingBlank"),e.currentConstruct=void 0,t}function s(o){if(o===null){n.consume(o);return}return n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),e.currentConstruct=void 0,t}}const kF={resolveAll:MA()},AF=DA("string"),CF=DA("text");function DA(n){return{resolveAll:MA(n==="text"?NF:void 0),tokenize:e};function e(t){const r=this,s=this.parser.constructs[n],o=t.attempt(s,a,u);return a;function a(g){return f(g)?o(g):u(g)}function u(g){if(g===null){t.consume(g);return}return t.enter("data"),t.consume(g),d}function d(g){return f(g)?(t.exit("data"),o(g)):(t.consume(g),d)}function f(g){if(g===null)return!0;const y=s[g];let x=-1;if(y)for(;++x<y.length;){const w=y[x];if(!w.previous||w.previous.call(r,r.previous))return!0}return!1}}}function MA(n){return e;function e(t,r){let s=-1,o;for(;++s<=t.length;)o===void 0?t[s]&&t[s][1].type==="data"&&(o=s,s++):(!t[s]||t[s][1].type!=="data")&&(s!==o+2&&(t[o][1].end=t[s-1][1].end,t.splice(o+2,s-o-2),s=o+2),o=void 0);return n?n(t,r):t}}function NF(n,e){let t=0;for(;++t<=n.length;)if((t===n.length||n[t][1].type==="lineEnding")&&n[t-1][1].type==="data"){const r=n[t-1][1],s=e.sliceStream(r);let o=s.length,a=-1,u=0,d;for(;o--;){const f=s[o];if(typeof f=="string"){for(a=f.length;f.charCodeAt(a-1)===32;)u++,a--;if(a)break;a=-1}else if(f===-2)d=!0,u++;else if(f!==-1){o++;break}}if(e._contentTypeTextTrailing&&t===n.length&&(u=0),u){const f={type:t===n.length||d||u<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?a:r.start._bufferIndex+a,_index:r.start._index+o,line:r.end.line,column:r.end.column-u,offset:r.end.offset-u},end:{...r.end}};r.end={...f.start},r.start.offset===r.end.offset?Object.assign(r,f):(n.splice(t,0,["enter",f,e],["exit",f,e]),t+=2)}t++}return n}const RF={42:Cr,43:Cr,45:Cr,48:Cr,49:Cr,50:Cr,51:Cr,52:Cr,53:Cr,54:Cr,55:Cr,56:Cr,57:Cr,62:kA},PF={91:L6},jF={[-2]:Iy,[-1]:Iy,32:Iy},DF={35:B6,42:zf,45:[MS,zf],60:W6,61:MS,95:zf,96:jS,126:jS},MF={38:CA,92:AA},LF={[-5]:Ey,[-4]:Ey,[-3]:Ey,33:uF,38:CA,42:N0,60:[h6,Z6],91:hF,92:[z6,AA],93:_v,95:N0,96:E6},OF={null:[N0,kF]},FF={null:[42,95]},VF={null:[]},zF=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:FF,contentInitial:PF,disable:VF,document:RF,flow:DF,flowInitial:jF,insideSpan:OF,string:MF,text:LF},Symbol.toStringTag,{value:"Module"}));function UF(n,e,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const s={},o=[];let a=[],u=[];const d={attempt:R($),check:R(F),consume:z,enter:U,exit:W,interrupt:R(F,{interrupt:!0})},f={code:null,containerState:{},defineSkip:S,events:[],now:E,parser:n,previous:null,sliceSerialize:x,sliceStream:w,write:y};let g=e.tokenize.call(f,d);return e.resolveAll&&o.push(e),f;function y(D){return a=ds(a,D),A(),a[a.length-1]!==null?[]:(k(e,0),f.events=mp(o,f.events,f),f.events)}function x(D,L){return $F(w(D),L)}function w(D){return BF(a,D)}function E(){const{_bufferIndex:D,_index:L,line:C,column:G,offset:K}=r;return{_bufferIndex:D,_index:L,line:C,column:G,offset:K}}function S(D){s[D.line]=D.column,T()}function A(){let D;for(;r._index<a.length;){const L=a[r._index];if(typeof L=="string")for(D=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===D&&r._bufferIndex<L.length;)N(L.charCodeAt(r._bufferIndex));else N(L)}}function N(D){g=g(D)}function z(D){Ue(D)?(r.line++,r.column=1,r.offset+=D===-3?2:1,T()):D!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===a[r._index].length&&(r._bufferIndex=-1,r._index++)),f.previous=D}function U(D,L){const C=L||{};return C.type=D,C.start=E(),f.events.push(["enter",C,f]),u.push(C),C}function W(D){const L=u.pop();return L.end=E(),f.events.push(["exit",L,f]),L}function $(D,L){k(D,L.from)}function F(D,L){L.restore()}function R(D,L){return C;function C(G,K,ce){let ue,Q,Z,M;return Array.isArray(G)?ne(G):"tokenize"in G?ne([G]):q(G);function q(be){return Be;function Be(He){const et=He!==null&&be[He],wt=He!==null&&be.null,Sn=[...Array.isArray(et)?et:et?[et]:[],...Array.isArray(wt)?wt:wt?[wt]:[]];return ne(Sn)(He)}}function ne(be){return ue=be,Q=0,be.length===0?ce:V(be[Q])}function V(be){return Be;function Be(He){return M=P(),Z=be,be.partial||(f.currentConstruct=be),be.name&&f.parser.constructs.disable.null.includes(be.name)?xe():be.tokenize.call(L?Object.assign(Object.create(f),L):f,d,de,xe)(He)}}function de(be){return D(Z,M),K}function xe(be){return M.restore(),++Q<ue.length?V(ue[Q]):ce}}}function k(D,L){D.resolveAll&&!o.includes(D)&&o.push(D),D.resolve&&Qr(f.events,L,f.events.length-L,D.resolve(f.events.slice(L),f)),D.resolveTo&&(f.events=D.resolveTo(f.events,f))}function P(){const D=E(),L=f.previous,C=f.currentConstruct,G=f.events.length,K=Array.from(u);return{from:G,restore:ce};function ce(){r=D,f.previous=L,f.currentConstruct=C,f.events.length=G,u=K,T()}}function T(){r.line in s&&r.column<2&&(r.column=s[r.line],r.offset+=s[r.line]-1)}}function BF(n,e){const t=e.start._index,r=e.start._bufferIndex,s=e.end._index,o=e.end._bufferIndex;let a;if(t===s)a=[n[t].slice(r,o)];else{if(a=n.slice(t,s),r>-1){const u=a[0];typeof u=="string"?a[0]=u.slice(r):a.shift()}o>0&&a.push(n[s].slice(0,o))}return a}function $F(n,e){let t=-1;const r=[];let s;for(;++t<n.length;){const o=n[t];let a;if(typeof o=="string")a=o;else switch(o){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=e?" ":"	";break}case-1:{if(!e&&s)continue;a=" ";break}default:a=String.fromCharCode(o)}s=o===-2,r.push(a)}return r.join("")}function qF(n){const r={constructs:EA([zF,...(n||{}).extensions||[]]),content:s(i6),defined:[],document:s(a6),flow:s(EF),lazy:{},string:s(AF),text:s(CF)};return r;function s(o){return a;function a(u){return UF(r,o,u)}}}function HF(n){for(;!NA(n););return n}const LS=/[\0\t\n\r]/g;function WF(){let n=1,e="",t=!0,r;return s;function s(o,a,u){const d=[];let f,g,y,x,w;for(o=e+(typeof o=="string"?o.toString():new TextDecoder(a||void 0).decode(o)),y=0,e="",t&&(o.charCodeAt(0)===65279&&y++,t=void 0);y<o.length;){if(LS.lastIndex=y,f=LS.exec(o),x=f&&f.index!==void 0?f.index:o.length,w=o.charCodeAt(x),!f){e=o.slice(y);break}if(w===10&&y===x&&r)d.push(-3),r=void 0;else switch(r&&(d.push(-5),r=void 0),y<x&&(d.push(o.slice(y,x)),n+=x-y),w){case 0:{d.push(65533),n++;break}case 9:{for(g=Math.ceil(n/4)*4,d.push(-2);n++<g;)d.push(-1);break}case 10:{d.push(-4),n=1;break}default:r=!0,n=1}y=x+1}return u&&(r&&d.push(-5),e&&d.push(e),d.push(null)),d}}const GF=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function KF(n){return n.replace(GF,QF)}function QF(n,e,t){if(e)return e;if(t.charCodeAt(0)===35){const s=t.charCodeAt(1),o=s===120||s===88;return TA(t.slice(o?2:1),o?16:10)}return bv(t)||n}const LA={}.hasOwnProperty;function YF(n,e,t){return typeof e!="string"&&(t=e,e=void 0),XF(t)(HF(qF(t).document().write(WF()(n,e,!0))))}function XF(n){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(ur),autolinkProtocol:P,autolinkEmail:P,atxHeading:o(Mr),blockQuote:o(wt),characterEscape:P,characterReference:P,codeFenced:o(Sn),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:o(Sn,a),codeText:o(Qn,a),codeTextData:P,data:P,codeFlowValue:P,definition:o(Yn),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:o(In),hardBreakEscape:o(Jr),hardBreakTrailing:o(Jr),htmlFlow:o(Xn,a),htmlFlowData:P,htmlText:o(Xn,a),htmlTextData:P,image:o(ys),label:a,link:o(ur),listItem:o(dr),listItemValue:x,listOrdered:o(Jn,y),listUnordered:o(Jn),paragraph:o(ai),reference:V,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:o(Mr),strong:o(Zr),thematicBreak:o(fr)},exit:{atxHeading:d(),atxHeadingSequence:$,autolink:d(),autolinkEmail:et,autolinkProtocol:He,blockQuote:d(),characterEscapeValue:T,characterReferenceMarkerHexadecimal:xe,characterReferenceMarkerNumeric:xe,characterReferenceValue:be,characterReference:Be,codeFenced:d(A),codeFencedFence:S,codeFencedFenceInfo:w,codeFencedFenceMeta:E,codeFlowValue:T,codeIndented:d(N),codeText:d(K),codeTextData:T,data:T,definition:d(),definitionDestinationString:W,definitionLabelString:z,definitionTitleString:U,emphasis:d(),hardBreakEscape:d(L),hardBreakTrailing:d(L),htmlFlow:d(C),htmlFlowData:T,htmlText:d(G),htmlTextData:T,image:d(ue),label:Z,labelText:Q,lineEnding:D,link:d(ce),listItem:d(),listOrdered:d(),listUnordered:d(),paragraph:d(),referenceString:de,resourceDestinationString:M,resourceTitleString:q,resource:ne,setextHeading:d(k),setextHeadingLineSequence:R,setextHeadingText:F,strong:d(),thematicBreak:d()}};OA(e,(n||{}).mdastExtensions||[]);const t={};return r;function r(oe){let fe={type:"root",children:[]};const Le={stack:[fe],tokenStack:[],config:e,enter:u,exit:f,buffer:a,resume:g,data:t},Qe=[];let Xe=-1;for(;++Xe<oe.length;)if(oe[Xe][1].type==="listOrdered"||oe[Xe][1].type==="listUnordered")if(oe[Xe][0]==="enter")Qe.push(Xe);else{const Bt=Qe.pop();Xe=s(oe,Bt,Xe)}for(Xe=-1;++Xe<oe.length;){const Bt=e[oe[Xe][0]];LA.call(Bt,oe[Xe][1].type)&&Bt[oe[Xe][1].type].call(Object.assign({sliceSerialize:oe[Xe][2].sliceSerialize},Le),oe[Xe][1])}if(Le.tokenStack.length>0){const Bt=Le.tokenStack[Le.tokenStack.length-1];(Bt[1]||OS).call(Le,void 0,Bt[0])}for(fe.position={start:_o(oe.length>0?oe[0][1].start:{line:1,column:1,offset:0}),end:_o(oe.length>0?oe[oe.length-2][1].end:{line:1,column:1,offset:0})},Xe=-1;++Xe<e.transforms.length;)fe=e.transforms[Xe](fe)||fe;return fe}function s(oe,fe,Le){let Qe=fe-1,Xe=-1,Bt=!1,Jt,Zt,Wt,pn;for(;++Qe<=Le;){const Ft=oe[Qe];switch(Ft[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ft[0]==="enter"?Xe++:Xe--,pn=void 0;break}case"lineEndingBlank":{Ft[0]==="enter"&&(Jt&&!pn&&!Xe&&!Wt&&(Wt=Qe),pn=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:pn=void 0}if(!Xe&&Ft[0]==="enter"&&Ft[1].type==="listItemPrefix"||Xe===-1&&Ft[0]==="exit"&&(Ft[1].type==="listUnordered"||Ft[1].type==="listOrdered")){if(Jt){let jn=Qe;for(Zt=void 0;jn--;){const an=oe[jn];if(an[1].type==="lineEnding"||an[1].type==="lineEndingBlank"){if(an[0]==="exit")continue;Zt&&(oe[Zt][1].type="lineEndingBlank",Bt=!0),an[1].type="lineEnding",Zt=jn}else if(!(an[1].type==="linePrefix"||an[1].type==="blockQuotePrefix"||an[1].type==="blockQuotePrefixWhitespace"||an[1].type==="blockQuoteMarker"||an[1].type==="listItemIndent"))break}Wt&&(!Zt||Wt<Zt)&&(Jt._spread=!0),Jt.end=Object.assign({},Zt?oe[Zt][1].start:Ft[1].end),oe.splice(Zt||Qe,0,["exit",Jt,Ft[2]]),Qe++,Le++}if(Ft[1].type==="listItemPrefix"){const jn={type:"listItem",_spread:!1,start:Object.assign({},Ft[1].start),end:void 0};Jt=jn,oe.splice(Qe,0,["enter",jn,Ft[2]]),Qe++,Le++,Wt=void 0,pn=!0}}}return oe[fe][1]._spread=Bt,Le}function o(oe,fe){return Le;function Le(Qe){u.call(this,oe(Qe),Qe),fe&&fe.call(this,Qe)}}function a(){this.stack.push({type:"fragment",children:[]})}function u(oe,fe,Le){this.stack[this.stack.length-1].children.push(oe),this.stack.push(oe),this.tokenStack.push([fe,Le||void 0]),oe.position={start:_o(fe.start),end:void 0}}function d(oe){return fe;function fe(Le){oe&&oe.call(this,Le),f.call(this,Le)}}function f(oe,fe){const Le=this.stack.pop(),Qe=this.tokenStack.pop();if(Qe)Qe[0].type!==oe.type&&(fe?fe.call(this,oe,Qe[0]):(Qe[1]||OS).call(this,oe,Qe[0]));else throw new Error("Cannot close `"+oe.type+"` ("+ed({start:oe.start,end:oe.end})+"): its not open");Le.position.end=_o(oe.end)}function g(){return wv(this.stack.pop())}function y(){this.data.expectingFirstListItemValue=!0}function x(oe){if(this.data.expectingFirstListItemValue){const fe=this.stack[this.stack.length-2];fe.start=Number.parseInt(this.sliceSerialize(oe),10),this.data.expectingFirstListItemValue=void 0}}function w(){const oe=this.resume(),fe=this.stack[this.stack.length-1];fe.lang=oe}function E(){const oe=this.resume(),fe=this.stack[this.stack.length-1];fe.meta=oe}function S(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function A(){const oe=this.resume(),fe=this.stack[this.stack.length-1];fe.value=oe.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function N(){const oe=this.resume(),fe=this.stack[this.stack.length-1];fe.value=oe.replace(/(\r?\n|\r)$/g,"")}function z(oe){const fe=this.resume(),Le=this.stack[this.stack.length-1];Le.label=fe,Le.identifier=Os(this.sliceSerialize(oe)).toLowerCase()}function U(){const oe=this.resume(),fe=this.stack[this.stack.length-1];fe.title=oe}function W(){const oe=this.resume(),fe=this.stack[this.stack.length-1];fe.url=oe}function $(oe){const fe=this.stack[this.stack.length-1];if(!fe.depth){const Le=this.sliceSerialize(oe).length;fe.depth=Le}}function F(){this.data.setextHeadingSlurpLineEnding=!0}function R(oe){const fe=this.stack[this.stack.length-1];fe.depth=this.sliceSerialize(oe).codePointAt(0)===61?1:2}function k(){this.data.setextHeadingSlurpLineEnding=void 0}function P(oe){const Le=this.stack[this.stack.length-1].children;let Qe=Le[Le.length-1];(!Qe||Qe.type!=="text")&&(Qe=hr(),Qe.position={start:_o(oe.start),end:void 0},Le.push(Qe)),this.stack.push(Qe)}function T(oe){const fe=this.stack.pop();fe.value+=this.sliceSerialize(oe),fe.position.end=_o(oe.end)}function D(oe){const fe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Le=fe.children[fe.children.length-1];Le.position.end=_o(oe.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(fe.type)&&(P.call(this,oe),T.call(this,oe))}function L(){this.data.atHardBreak=!0}function C(){const oe=this.resume(),fe=this.stack[this.stack.length-1];fe.value=oe}function G(){const oe=this.resume(),fe=this.stack[this.stack.length-1];fe.value=oe}function K(){const oe=this.resume(),fe=this.stack[this.stack.length-1];fe.value=oe}function ce(){const oe=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";oe.type+="Reference",oe.referenceType=fe,delete oe.url,delete oe.title}else delete oe.identifier,delete oe.label;this.data.referenceType=void 0}function ue(){const oe=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";oe.type+="Reference",oe.referenceType=fe,delete oe.url,delete oe.title}else delete oe.identifier,delete oe.label;this.data.referenceType=void 0}function Q(oe){const fe=this.sliceSerialize(oe),Le=this.stack[this.stack.length-2];Le.label=KF(fe),Le.identifier=Os(fe).toLowerCase()}function Z(){const oe=this.stack[this.stack.length-1],fe=this.resume(),Le=this.stack[this.stack.length-1];if(this.data.inReference=!0,Le.type==="link"){const Qe=oe.children;Le.children=Qe}else Le.alt=fe}function M(){const oe=this.resume(),fe=this.stack[this.stack.length-1];fe.url=oe}function q(){const oe=this.resume(),fe=this.stack[this.stack.length-1];fe.title=oe}function ne(){this.data.inReference=void 0}function V(){this.data.referenceType="collapsed"}function de(oe){const fe=this.resume(),Le=this.stack[this.stack.length-1];Le.label=fe,Le.identifier=Os(this.sliceSerialize(oe)).toLowerCase(),this.data.referenceType="full"}function xe(oe){this.data.characterReferenceType=oe.type}function be(oe){const fe=this.sliceSerialize(oe),Le=this.data.characterReferenceType;let Qe;Le?(Qe=TA(fe,Le==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Qe=bv(fe);const Xe=this.stack[this.stack.length-1];Xe.value+=Qe}function Be(oe){const fe=this.stack.pop();fe.position.end=_o(oe.end)}function He(oe){T.call(this,oe);const fe=this.stack[this.stack.length-1];fe.url=this.sliceSerialize(oe)}function et(oe){T.call(this,oe);const fe=this.stack[this.stack.length-1];fe.url="mailto:"+this.sliceSerialize(oe)}function wt(){return{type:"blockquote",children:[]}}function Sn(){return{type:"code",lang:null,meta:null,value:""}}function Qn(){return{type:"inlineCode",value:""}}function Yn(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function In(){return{type:"emphasis",children:[]}}function Mr(){return{type:"heading",depth:0,children:[]}}function Jr(){return{type:"break"}}function Xn(){return{type:"html",value:""}}function ys(){return{type:"image",title:null,url:"",alt:null}}function ur(){return{type:"link",title:null,url:"",children:[]}}function Jn(oe){return{type:"list",ordered:oe.type==="listOrdered",start:null,spread:oe._spread,children:[]}}function dr(oe){return{type:"listItem",spread:oe._spread,checked:null,children:[]}}function ai(){return{type:"paragraph",children:[]}}function Zr(){return{type:"strong",children:[]}}function hr(){return{type:"text",value:""}}function fr(){return{type:"thematicBreak"}}}function _o(n){return{line:n.line,column:n.column,offset:n.offset}}function OA(n,e){let t=-1;for(;++t<e.length;){const r=e[t];Array.isArray(r)?OA(n,r):JF(n,r)}}function JF(n,e){let t;for(t in e)if(LA.call(e,t))switch(t){case"canContainEols":{const r=e[t];r&&n[t].push(...r);break}case"transforms":{const r=e[t];r&&n[t].push(...r);break}case"enter":case"exit":{const r=e[t];r&&Object.assign(n[t],r);break}}}function OS(n,e){throw n?new Error("Cannot close `"+n.type+"` ("+ed({start:n.start,end:n.end})+"): a different token (`"+e.type+"`, "+ed({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+ed({start:e.start,end:e.end})+") is still open")}function ZF(n){const e=this;e.parser=t;function t(r){return YF(r,{...e.data("settings"),...n,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function eV(n,e){const t={type:"element",tagName:"blockquote",properties:{},children:n.wrap(n.all(e),!0)};return n.patch(e,t),n.applyData(e,t)}function tV(n,e){const t={type:"element",tagName:"br",properties:{},children:[]};return n.patch(e,t),[n.applyData(e,t),{type:"text",value:`
`}]}function nV(n,e){const t=e.value?e.value+`
`:"",r={};e.lang&&(r.className=["language-"+e.lang]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return e.meta&&(s.data={meta:e.meta}),n.patch(e,s),s=n.applyData(e,s),s={type:"element",tagName:"pre",properties:{},children:[s]},n.patch(e,s),s}function rV(n,e){const t={type:"element",tagName:"del",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function sV(n,e){const t={type:"element",tagName:"em",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function iV(n,e){const t=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),s=Vc(r.toLowerCase()),o=n.footnoteOrder.indexOf(r);let a,u=n.footnoteCounts.get(r);u===void 0?(u=0,n.footnoteOrder.push(r),a=n.footnoteOrder.length):a=o+1,u+=1,n.footnoteCounts.set(r,u);const d={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+s,id:t+"fnref-"+s+(u>1?"-"+u:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};n.patch(e,d);const f={type:"element",tagName:"sup",properties:{},children:[d]};return n.patch(e,f),n.applyData(e,f)}function oV(n,e){const t={type:"element",tagName:"h"+e.depth,properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function aV(n,e){if(n.options.allowDangerousHtml){const t={type:"raw",value:e.value};return n.patch(e,t),n.applyData(e,t)}}function FA(n,e){const t=e.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const s=n.all(e),o=s[0];o&&o.type==="text"?o.value="["+o.value:s.unshift({type:"text",value:"["});const a=s[s.length-1];return a&&a.type==="text"?a.value+=r:s.push({type:"text",value:r}),s}function lV(n,e){const t=String(e.identifier).toUpperCase(),r=n.definitionById.get(t);if(!r)return FA(n,e);const s={src:Vc(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(s.title=r.title);const o={type:"element",tagName:"img",properties:s,children:[]};return n.patch(e,o),n.applyData(e,o)}function cV(n,e){const t={src:Vc(e.url)};e.alt!==null&&e.alt!==void 0&&(t.alt=e.alt),e.title!==null&&e.title!==void 0&&(t.title=e.title);const r={type:"element",tagName:"img",properties:t,children:[]};return n.patch(e,r),n.applyData(e,r)}function uV(n,e){const t={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};n.patch(e,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return n.patch(e,r),n.applyData(e,r)}function dV(n,e){const t=String(e.identifier).toUpperCase(),r=n.definitionById.get(t);if(!r)return FA(n,e);const s={href:Vc(r.url||"")};r.title!==null&&r.title!==void 0&&(s.title=r.title);const o={type:"element",tagName:"a",properties:s,children:n.all(e)};return n.patch(e,o),n.applyData(e,o)}function hV(n,e){const t={href:Vc(e.url)};e.title!==null&&e.title!==void 0&&(t.title=e.title);const r={type:"element",tagName:"a",properties:t,children:n.all(e)};return n.patch(e,r),n.applyData(e,r)}function fV(n,e,t){const r=n.all(e),s=t?mV(t):VA(e),o={},a=[];if(typeof e.checked=="boolean"){const g=r[0];let y;g&&g.type==="element"&&g.tagName==="p"?y=g:(y={type:"element",tagName:"p",properties:{},children:[]},r.unshift(y)),y.children.length>0&&y.children.unshift({type:"text",value:" "}),y.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let u=-1;for(;++u<r.length;){const g=r[u];(s||u!==0||g.type!=="element"||g.tagName!=="p")&&a.push({type:"text",value:`
`}),g.type==="element"&&g.tagName==="p"&&!s?a.push(...g.children):a.push(g)}const d=r[r.length-1];d&&(s||d.type!=="element"||d.tagName!=="p")&&a.push({type:"text",value:`
`});const f={type:"element",tagName:"li",properties:o,children:a};return n.patch(e,f),n.applyData(e,f)}function mV(n){let e=!1;if(n.type==="list"){e=n.spread||!1;const t=n.children;let r=-1;for(;!e&&++r<t.length;)e=VA(t[r])}return e}function VA(n){const e=n.spread;return e??n.children.length>1}function pV(n,e){const t={},r=n.all(e);let s=-1;for(typeof e.start=="number"&&e.start!==1&&(t.start=e.start);++s<r.length;){const a=r[s];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:e.ordered?"ol":"ul",properties:t,children:n.wrap(r,!0)};return n.patch(e,o),n.applyData(e,o)}function gV(n,e){const t={type:"element",tagName:"p",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function yV(n,e){const t={type:"root",children:n.wrap(n.all(e))};return n.patch(e,t),n.applyData(e,t)}function xV(n,e){const t={type:"element",tagName:"strong",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function vV(n,e){const t=n.all(e),r=t.shift(),s=[];if(r){const a={type:"element",tagName:"thead",properties:{},children:n.wrap([r],!0)};n.patch(e.children[0],a),s.push(a)}if(t.length>0){const a={type:"element",tagName:"tbody",properties:{},children:n.wrap(t,!0)},u=gv(e.children[1]),d=xA(e.children[e.children.length-1]);u&&d&&(a.position={start:u,end:d}),s.push(a)}const o={type:"element",tagName:"table",properties:{},children:n.wrap(s,!0)};return n.patch(e,o),n.applyData(e,o)}function wV(n,e,t){const r=t?t.children:void 0,o=(r?r.indexOf(e):1)===0?"th":"td",a=t&&t.type==="table"?t.align:void 0,u=a?a.length:e.children.length;let d=-1;const f=[];for(;++d<u;){const y=e.children[d],x={},w=a?a[d]:void 0;w&&(x.align=w);let E={type:"element",tagName:o,properties:x,children:[]};y&&(E.children=n.all(y),n.patch(y,E),E=n.applyData(y,E)),f.push(E)}const g={type:"element",tagName:"tr",properties:{},children:n.wrap(f,!0)};return n.patch(e,g),n.applyData(e,g)}function bV(n,e){const t={type:"element",tagName:"td",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}const FS=9,VS=32;function _V(n){const e=String(n),t=/\r?\n|\r/g;let r=t.exec(e),s=0;const o=[];for(;r;)o.push(zS(e.slice(s,r.index),s>0,!0),r[0]),s=r.index+r[0].length,r=t.exec(e);return o.push(zS(e.slice(s),s>0,!1)),o.join("")}function zS(n,e,t){let r=0,s=n.length;if(e){let o=n.codePointAt(r);for(;o===FS||o===VS;)r++,o=n.codePointAt(r)}if(t){let o=n.codePointAt(s-1);for(;o===FS||o===VS;)s--,o=n.codePointAt(s-1)}return s>r?n.slice(r,s):""}function SV(n,e){const t={type:"text",value:_V(String(e.value))};return n.patch(e,t),n.applyData(e,t)}function IV(n,e){const t={type:"element",tagName:"hr",properties:{},children:[]};return n.patch(e,t),n.applyData(e,t)}const EV={blockquote:eV,break:tV,code:nV,delete:rV,emphasis:sV,footnoteReference:iV,heading:oV,html:aV,imageReference:lV,image:cV,inlineCode:uV,linkReference:dV,link:hV,listItem:fV,list:pV,paragraph:gV,root:yV,strong:xV,table:vV,tableCell:bV,tableRow:wV,text:SV,thematicBreak:IV,toml:vf,yaml:vf,definition:vf,footnoteDefinition:vf};function vf(){}const zA=-1,pp=0,nd=1,Sm=2,Sv=3,Iv=4,Ev=5,Tv=6,UA=7,BA=8,US=typeof self=="object"?self:globalThis,TV=(n,e)=>{const t=(s,o)=>(n.set(o,s),s),r=s=>{if(n.has(s))return n.get(s);const[o,a]=e[s];switch(o){case pp:case zA:return t(a,s);case nd:{const u=t([],s);for(const d of a)u.push(r(d));return u}case Sm:{const u=t({},s);for(const[d,f]of a)u[r(d)]=r(f);return u}case Sv:return t(new Date(a),s);case Iv:{const{source:u,flags:d}=a;return t(new RegExp(u,d),s)}case Ev:{const u=t(new Map,s);for(const[d,f]of a)u.set(r(d),r(f));return u}case Tv:{const u=t(new Set,s);for(const d of a)u.add(r(d));return u}case UA:{const{name:u,message:d}=a;return t(new US[u](d),s)}case BA:return t(BigInt(a),s);case"BigInt":return t(Object(BigInt(a)),s);case"ArrayBuffer":return t(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:u}=new Uint8Array(a);return t(new DataView(u),a)}}return t(new US[o](a),s)};return r},BS=n=>TV(new Map,n)(0),Bl="",{toString:kV}={},{keys:AV}=Object,ju=n=>{const e=typeof n;if(e!=="object"||!n)return[pp,e];const t=kV.call(n).slice(8,-1);switch(t){case"Array":return[nd,Bl];case"Object":return[Sm,Bl];case"Date":return[Sv,Bl];case"RegExp":return[Iv,Bl];case"Map":return[Ev,Bl];case"Set":return[Tv,Bl];case"DataView":return[nd,t]}return t.includes("Array")?[nd,t]:t.includes("Error")?[UA,t]:[Sm,t]},wf=([n,e])=>n===pp&&(e==="function"||e==="symbol"),CV=(n,e,t,r)=>{const s=(a,u)=>{const d=r.push(a)-1;return t.set(u,d),d},o=a=>{if(t.has(a))return t.get(a);let[u,d]=ju(a);switch(u){case pp:{let g=a;switch(d){case"bigint":u=BA,g=a.toString();break;case"function":case"symbol":if(n)throw new TypeError("unable to serialize "+d);g=null;break;case"undefined":return s([zA],a)}return s([u,g],a)}case nd:{if(d){let x=a;return d==="DataView"?x=new Uint8Array(a.buffer):d==="ArrayBuffer"&&(x=new Uint8Array(a)),s([d,[...x]],a)}const g=[],y=s([u,g],a);for(const x of a)g.push(o(x));return y}case Sm:{if(d)switch(d){case"BigInt":return s([d,a.toString()],a);case"Boolean":case"Number":case"String":return s([d,a.valueOf()],a)}if(e&&"toJSON"in a)return o(a.toJSON());const g=[],y=s([u,g],a);for(const x of AV(a))(n||!wf(ju(a[x])))&&g.push([o(x),o(a[x])]);return y}case Sv:return s([u,a.toISOString()],a);case Iv:{const{source:g,flags:y}=a;return s([u,{source:g,flags:y}],a)}case Ev:{const g=[],y=s([u,g],a);for(const[x,w]of a)(n||!(wf(ju(x))||wf(ju(w))))&&g.push([o(x),o(w)]);return y}case Tv:{const g=[],y=s([u,g],a);for(const x of a)(n||!wf(ju(x)))&&g.push(o(x));return y}}const{message:f}=a;return s([u,{name:d,message:f}],a)};return o},$S=(n,{json:e,lossy:t}={})=>{const r=[];return CV(!(e||t),!!e,new Map,r)(n),r},Im=typeof structuredClone=="function"?(n,e)=>e&&("json"in e||"lossy"in e)?BS($S(n,e)):structuredClone(n):(n,e)=>BS($S(n,e));function NV(n,e){const t=[{type:"text",value:""}];return e>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),t}function RV(n,e){return"Back to reference "+(n+1)+(e>1?"-"+e:"")}function PV(n){const e=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",t=n.options.footnoteBackContent||NV,r=n.options.footnoteBackLabel||RV,s=n.options.footnoteLabel||"Footnotes",o=n.options.footnoteLabelTagName||"h2",a=n.options.footnoteLabelProperties||{className:["sr-only"]},u=[];let d=-1;for(;++d<n.footnoteOrder.length;){const f=n.footnoteById.get(n.footnoteOrder[d]);if(!f)continue;const g=n.all(f),y=String(f.identifier).toUpperCase(),x=Vc(y.toLowerCase());let w=0;const E=[],S=n.footnoteCounts.get(y);for(;S!==void 0&&++w<=S;){E.length>0&&E.push({type:"text",value:" "});let z=typeof t=="string"?t:t(d,w);typeof z=="string"&&(z={type:"text",value:z}),E.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+x+(w>1?"-"+w:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(d,w),className:["data-footnote-backref"]},children:Array.isArray(z)?z:[z]})}const A=g[g.length-1];if(A&&A.type==="element"&&A.tagName==="p"){const z=A.children[A.children.length-1];z&&z.type==="text"?z.value+=" ":A.children.push({type:"text",value:" "}),A.children.push(...E)}else g.push(...E);const N={type:"element",tagName:"li",properties:{id:e+"fn-"+x},children:n.wrap(g,!0)};n.patch(f,N),u.push(N)}if(u.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...Im(a),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:n.wrap(u,!0)},{type:"text",value:`
`}]}}const gp=function(n){if(n==null)return LV;if(typeof n=="function")return yp(n);if(typeof n=="object")return Array.isArray(n)?jV(n):DV(n);if(typeof n=="string")return MV(n);throw new Error("Expected function, string, or object as test")};function jV(n){const e=[];let t=-1;for(;++t<n.length;)e[t]=gp(n[t]);return yp(r);function r(...s){let o=-1;for(;++o<e.length;)if(e[o].apply(this,s))return!0;return!1}}function DV(n){const e=n;return yp(t);function t(r){const s=r;let o;for(o in n)if(s[o]!==e[o])return!1;return!0}}function MV(n){return yp(e);function e(t){return t&&t.type===n}}function yp(n){return e;function e(t,r,s){return!!(OV(t)&&n.call(this,t,typeof r=="number"?r:void 0,s||void 0))}}function LV(){return!0}function OV(n){return n!==null&&typeof n=="object"&&"type"in n}const $A=[],FV=!0,R0=!1,VV="skip";function qA(n,e,t,r){let s;typeof e=="function"&&typeof t!="function"?(r=t,t=e):s=e;const o=gp(s),a=r?-1:1;u(n,void 0,[])();function u(d,f,g){const y=d&&typeof d=="object"?d:{};if(typeof y.type=="string"){const w=typeof y.tagName=="string"?y.tagName:typeof y.name=="string"?y.name:void 0;Object.defineProperty(x,"name",{value:"node ("+(d.type+(w?"<"+w+">":""))+")"})}return x;function x(){let w=$A,E,S,A;if((!e||o(d,f,g[g.length-1]||void 0))&&(w=zV(t(d,g)),w[0]===R0))return w;if("children"in d&&d.children){const N=d;if(N.children&&w[0]!==VV)for(S=(r?N.children.length:-1)+a,A=g.concat(N);S>-1&&S<N.children.length;){const z=N.children[S];if(E=u(z,S,A)(),E[0]===R0)return E;S=typeof E[1]=="number"?E[1]:S+a}}return w}}}function zV(n){return Array.isArray(n)?n:typeof n=="number"?[FV,n]:n==null?$A:[n]}function kv(n,e,t,r){let s,o,a;typeof e=="function"&&typeof t!="function"?(o=void 0,a=e,s=t):(o=e,a=t,s=r),qA(n,o,u,s);function u(d,f){const g=f[f.length-1],y=g?g.children.indexOf(d):void 0;return a(d,y,g)}}const P0={}.hasOwnProperty,UV={};function BV(n,e){const t=e||UV,r=new Map,s=new Map,o=new Map,a={...EV,...t.handlers},u={all:f,applyData:qV,definitionById:r,footnoteById:s,footnoteCounts:o,footnoteOrder:[],handlers:a,one:d,options:t,patch:$V,wrap:WV};return kv(n,function(g){if(g.type==="definition"||g.type==="footnoteDefinition"){const y=g.type==="definition"?r:s,x=String(g.identifier).toUpperCase();y.has(x)||y.set(x,g)}}),u;function d(g,y){const x=g.type,w=u.handlers[x];if(P0.call(u.handlers,x)&&w)return w(u,g,y);if(u.options.passThrough&&u.options.passThrough.includes(x)){if("children"in g){const{children:S,...A}=g,N=Im(A);return N.children=u.all(g),N}return Im(g)}return(u.options.unknownHandler||HV)(u,g,y)}function f(g){const y=[];if("children"in g){const x=g.children;let w=-1;for(;++w<x.length;){const E=u.one(x[w],g);if(E){if(w&&x[w-1].type==="break"&&(!Array.isArray(E)&&E.type==="text"&&(E.value=qS(E.value)),!Array.isArray(E)&&E.type==="element")){const S=E.children[0];S&&S.type==="text"&&(S.value=qS(S.value))}Array.isArray(E)?y.push(...E):y.push(E)}}}return y}}function $V(n,e){n.position&&(e.position=R3(n))}function qV(n,e){let t=e;if(n&&n.data){const r=n.data.hName,s=n.data.hChildren,o=n.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const a="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:a}}t.type==="element"&&o&&Object.assign(t.properties,Im(o)),"children"in t&&t.children&&s!==null&&s!==void 0&&(t.children=s)}return t}function HV(n,e){const t=e.data||{},r="value"in e&&!(P0.call(t,"hProperties")||P0.call(t,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:n.all(e)};return n.patch(e,r),n.applyData(e,r)}function WV(n,e){const t=[];let r=-1;for(e&&t.push({type:"text",value:`
`});++r<n.length;)r&&t.push({type:"text",value:`
`}),t.push(n[r]);return e&&n.length>0&&t.push({type:"text",value:`
`}),t}function qS(n){let e=0,t=n.charCodeAt(e);for(;t===9||t===32;)e++,t=n.charCodeAt(e);return n.slice(e)}function HS(n,e){const t=BV(n,e),r=t.one(n,void 0),s=PV(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return s&&o.children.push({type:"text",value:`
`},s),o}function GV(n,e){return n&&"run"in n?async function(t,r){const s=HS(t,{file:r,...e});await n.run(s,r)}:function(t,r){return HS(t,{file:r,...n||e})}}function WS(n){if(n)throw n}var Ty,GS;function KV(){if(GS)return Ty;GS=1;var n=Object.prototype.hasOwnProperty,e=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,s=function(f){return typeof Array.isArray=="function"?Array.isArray(f):e.call(f)==="[object Array]"},o=function(f){if(!f||e.call(f)!=="[object Object]")return!1;var g=n.call(f,"constructor"),y=f.constructor&&f.constructor.prototype&&n.call(f.constructor.prototype,"isPrototypeOf");if(f.constructor&&!g&&!y)return!1;var x;for(x in f);return typeof x>"u"||n.call(f,x)},a=function(f,g){t&&g.name==="__proto__"?t(f,g.name,{enumerable:!0,configurable:!0,value:g.newValue,writable:!0}):f[g.name]=g.newValue},u=function(f,g){if(g==="__proto__")if(n.call(f,g)){if(r)return r(f,g).value}else return;return f[g]};return Ty=function d(){var f,g,y,x,w,E,S=arguments[0],A=1,N=arguments.length,z=!1;for(typeof S=="boolean"&&(z=S,S=arguments[1]||{},A=2),(S==null||typeof S!="object"&&typeof S!="function")&&(S={});A<N;++A)if(f=arguments[A],f!=null)for(g in f)y=u(S,g),x=u(f,g),S!==x&&(z&&x&&(o(x)||(w=s(x)))?(w?(w=!1,E=y&&s(y)?y:[]):E=y&&o(y)?y:{},a(S,{name:g,newValue:d(z,E,x)})):typeof x<"u"&&a(S,{name:g,newValue:x}));return S},Ty}var QV=KV();const ky=Tm(QV);function j0(n){if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)}function YV(){const n=[],e={run:t,use:r};return e;function t(...s){let o=-1;const a=s.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);u(null,...s);function u(d,...f){const g=n[++o];let y=-1;if(d){a(d);return}for(;++y<s.length;)(f[y]===null||f[y]===void 0)&&(f[y]=s[y]);s=f,g?XV(g,u)(...f):a(null,...f)}}function r(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return n.push(s),e}}function XV(n,e){let t;return r;function r(...a){const u=n.length>a.length;let d;u&&a.push(s);try{d=n.apply(this,a)}catch(f){const g=f;if(u&&t)throw g;return s(g)}u||(d&&d.then&&typeof d.then=="function"?d.then(o,s):d instanceof Error?s(d):o(d))}function s(a,...u){t||(t=!0,e(a,...u))}function o(a){s(null,a)}}const Qs={basename:JV,dirname:ZV,extname:ez,join:tz,sep:"/"};function JV(n,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');Yd(n);let t=0,r=-1,s=n.length,o;if(e===void 0||e.length===0||e.length>n.length){for(;s--;)if(n.codePointAt(s)===47){if(o){t=s+1;break}}else r<0&&(o=!0,r=s+1);return r<0?"":n.slice(t,r)}if(e===n)return"";let a=-1,u=e.length-1;for(;s--;)if(n.codePointAt(s)===47){if(o){t=s+1;break}}else a<0&&(o=!0,a=s+1),u>-1&&(n.codePointAt(s)===e.codePointAt(u--)?u<0&&(r=s):(u=-1,r=a));return t===r?r=a:r<0&&(r=n.length),n.slice(t,r)}function ZV(n){if(Yd(n),n.length===0)return".";let e=-1,t=n.length,r;for(;--t;)if(n.codePointAt(t)===47){if(r){e=t;break}}else r||(r=!0);return e<0?n.codePointAt(0)===47?"/":".":e===1&&n.codePointAt(0)===47?"//":n.slice(0,e)}function ez(n){Yd(n);let e=n.length,t=-1,r=0,s=-1,o=0,a;for(;e--;){const u=n.codePointAt(e);if(u===47){if(a){r=e+1;break}continue}t<0&&(a=!0,t=e+1),u===46?s<0?s=e:o!==1&&(o=1):s>-1&&(o=-1)}return s<0||t<0||o===0||o===1&&s===t-1&&s===r+1?"":n.slice(s,t)}function tz(...n){let e=-1,t;for(;++e<n.length;)Yd(n[e]),n[e]&&(t=t===void 0?n[e]:t+"/"+n[e]);return t===void 0?".":nz(t)}function nz(n){Yd(n);const e=n.codePointAt(0)===47;let t=rz(n,!e);return t.length===0&&!e&&(t="."),t.length>0&&n.codePointAt(n.length-1)===47&&(t+="/"),e?"/"+t:t}function rz(n,e){let t="",r=0,s=-1,o=0,a=-1,u,d;for(;++a<=n.length;){if(a<n.length)u=n.codePointAt(a);else{if(u===47)break;u=47}if(u===47){if(!(s===a-1||o===1))if(s!==a-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(d=t.lastIndexOf("/"),d!==t.length-1){d<0?(t="",r=0):(t=t.slice(0,d),r=t.length-1-t.lastIndexOf("/")),s=a,o=0;continue}}else if(t.length>0){t="",r=0,s=a,o=0;continue}}e&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+n.slice(s+1,a):t=n.slice(s+1,a),r=a-s-1;s=a,o=0}else u===46&&o>-1?o++:o=-1}return t}function Yd(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(n))}const sz={cwd:iz};function iz(){return"/"}function D0(n){return!!(n!==null&&typeof n=="object"&&"href"in n&&n.href&&"protocol"in n&&n.protocol&&n.auth===void 0)}function oz(n){if(typeof n=="string")n=new URL(n);else if(!D0(n)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+n+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(n.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return az(n)}function az(n){if(n.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=n.pathname;let t=-1;for(;++t<e.length;)if(e.codePointAt(t)===37&&e.codePointAt(t+1)===50){const r=e.codePointAt(t+2);if(r===70||r===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(e)}const Ay=["history","path","basename","stem","extname","dirname"];class HA{constructor(e){let t;e?D0(e)?t={path:e}:typeof e=="string"||lz(e)?t={value:e}:t=e:t={},this.cwd="cwd"in t?"":sz.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<Ay.length;){const o=Ay[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let s;for(s in t)Ay.includes(s)||(this[s]=t[s])}get basename(){return typeof this.path=="string"?Qs.basename(this.path):void 0}set basename(e){Ny(e,"basename"),Cy(e,"basename"),this.path=Qs.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?Qs.dirname(this.path):void 0}set dirname(e){KS(this.basename,"dirname"),this.path=Qs.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?Qs.extname(this.path):void 0}set extname(e){if(Cy(e,"extname"),KS(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Qs.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){D0(e)&&(e=oz(e)),Ny(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?Qs.basename(this.path,this.extname):void 0}set stem(e){Ny(e,"stem"),Cy(e,"stem"),this.path=Qs.join(this.dirname||"",e+(this.extname||""))}fail(e,t,r){const s=this.message(e,t,r);throw s.fatal=!0,s}info(e,t,r){const s=this.message(e,t,r);return s.fatal=void 0,s}message(e,t,r){const s=new Kn(e,t,r);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function Cy(n,e){if(n&&n.includes(Qs.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+Qs.sep+"`")}function Ny(n,e){if(!n)throw new Error("`"+e+"` cannot be empty")}function KS(n,e){if(!n)throw new Error("Setting `"+e+"` requires `path` to be set too")}function lz(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const cz=function(n){const r=this.constructor.prototype,s=r[n],o=function(){return s.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},uz={}.hasOwnProperty;class Av extends cz{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=YV()}copy(){const e=new Av;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];e.use(...r)}return e.data(ky(!0,{},this.namespace)),e}data(e,t){return typeof e=="string"?arguments.length===2?(jy("data",this.frozen),this.namespace[e]=t,this):uz.call(this.namespace,e)&&this.namespace[e]||void 0:e?(jy("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const s=t.call(e,...r);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const t=bf(e),r=this.parser||this.Parser;return Ry("parse",r),r(String(t),t)}process(e,t){const r=this;return this.freeze(),Ry("process",this.parser||this.Parser),Py("process",this.compiler||this.Compiler),t?s(void 0,t):new Promise(s);function s(o,a){const u=bf(e),d=r.parse(u);r.run(d,u,function(g,y,x){if(g||!y||!x)return f(g);const w=y,E=r.stringify(w,x);fz(E)?x.value=E:x.result=E,f(g,x)});function f(g,y){g||!y?a(g):o?o(y):t(void 0,y)}}}processSync(e){let t=!1,r;return this.freeze(),Ry("processSync",this.parser||this.Parser),Py("processSync",this.compiler||this.Compiler),this.process(e,s),YS("processSync","process",t),r;function s(o,a){t=!0,WS(o),r=a}}run(e,t,r){QS(e),this.freeze();const s=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(a,u){const d=bf(t);s.run(e,d,f);function f(g,y,x){const w=y||e;g?u(g):a?a(w):r(void 0,w,x)}}}runSync(e,t){let r=!1,s;return this.run(e,t,o),YS("runSync","run",r),s;function o(a,u){WS(a),s=u,r=!0}}stringify(e,t){this.freeze();const r=bf(t),s=this.compiler||this.Compiler;return Py("stringify",s),QS(e),s(e,r)}use(e,...t){const r=this.attachers,s=this.namespace;if(jy("use",this.frozen),e!=null)if(typeof e=="function")d(e,t);else if(typeof e=="object")Array.isArray(e)?u(e):a(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function o(f){if(typeof f=="function")d(f,[]);else if(typeof f=="object")if(Array.isArray(f)){const[g,...y]=f;d(g,y)}else a(f);else throw new TypeError("Expected usable value, not `"+f+"`")}function a(f){if(!("plugins"in f)&&!("settings"in f))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");u(f.plugins),f.settings&&(s.settings=ky(!0,s.settings,f.settings))}function u(f){let g=-1;if(f!=null)if(Array.isArray(f))for(;++g<f.length;){const y=f[g];o(y)}else throw new TypeError("Expected a list of plugins, not `"+f+"`")}function d(f,g){let y=-1,x=-1;for(;++y<r.length;)if(r[y][0]===f){x=y;break}if(x===-1)r.push([f,...g]);else if(g.length>0){let[w,...E]=g;const S=r[x][1];j0(S)&&j0(w)&&(w=ky(!0,S,w)),r[x]=[f,w,...E]}}}}const dz=new Av().freeze();function Ry(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `parser`")}function Py(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `compiler`")}function jy(n,e){if(e)throw new Error("Cannot call `"+n+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function QS(n){if(!j0(n)||typeof n.type!="string")throw new TypeError("Expected node, got `"+n+"`")}function YS(n,e,t){if(!t)throw new Error("`"+n+"` finished async. Use `"+e+"` instead")}function bf(n){return hz(n)?n:new HA(n)}function hz(n){return!!(n&&typeof n=="object"&&"message"in n&&"messages"in n)}function fz(n){return typeof n=="string"||mz(n)}function mz(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const pz="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",XS=[],JS={allowDangerousHtml:!0},gz=/^(https?|ircs?|mailto|xmpp)$/i,yz=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function xz(n){const e=vz(n),t=wz(n);return bz(e.runSync(e.parse(t),t),n)}function vz(n){const e=n.rehypePlugins||XS,t=n.remarkPlugins||XS,r=n.remarkRehypeOptions?{...n.remarkRehypeOptions,...JS}:JS;return dz().use(ZF).use(t).use(GV,r).use(e)}function wz(n){const e=n.children||"",t=new HA;return typeof e=="string"&&(t.value=e),t}function bz(n,e){const t=e.allowedElements,r=e.allowElement,s=e.components,o=e.disallowedElements,a=e.skipHtml,u=e.unwrapDisallowed,d=e.urlTransform||_z;for(const g of yz)Object.hasOwn(e,g.from)&&(""+g.from+(g.to?"use `"+g.to+"` instead":"remove it")+pz+g.id,void 0);return kv(n,f),L3(n,{Fragment:c.Fragment,components:s,ignoreInvalidStyle:!0,jsx:c.jsx,jsxs:c.jsxs,passKeys:!0,passNode:!0});function f(g,y,x){if(g.type==="raw"&&x&&typeof y=="number")return a?x.children.splice(y,1):x.children[y]={type:"text",value:g.value},y;if(g.type==="element"){let w;for(w in Sy)if(Object.hasOwn(Sy,w)&&Object.hasOwn(g.properties,w)){const E=g.properties[w],S=Sy[w];(S===null||S.includes(g.tagName))&&(g.properties[w]=d(String(E||""),w,g))}}if(g.type==="element"){let w=t?!t.includes(g.tagName):o?o.includes(g.tagName):!1;if(!w&&r&&typeof y=="number"&&(w=!r(g,y,x)),w&&x&&typeof y=="number")return u&&g.children?x.children.splice(y,1,...g.children):x.children.splice(y,1),y}}}function _z(n){const e=n.indexOf(":"),t=n.indexOf("?"),r=n.indexOf("#"),s=n.indexOf("/");return e===-1||s!==-1&&e>s||t!==-1&&e>t||r!==-1&&e>r||gz.test(n.slice(0,e))?n:""}function ZS(n,e){const t=String(n);if(typeof e!="string")throw new TypeError("Expected character");let r=0,s=t.indexOf(e);for(;s!==-1;)r++,s=t.indexOf(e,s+e.length);return r}function Sz(n){if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function Iz(n,e,t){const s=gp((t||{}).ignore||[]),o=Ez(e);let a=-1;for(;++a<o.length;)qA(n,"text",u);function u(f,g){let y=-1,x;for(;++y<g.length;){const w=g[y],E=x?x.children:void 0;if(s(w,E?E.indexOf(w):void 0,x))return;x=w}if(x)return d(f,g)}function d(f,g){const y=g[g.length-1],x=o[a][0],w=o[a][1];let E=0;const A=y.children.indexOf(f);let N=!1,z=[];x.lastIndex=0;let U=x.exec(f.value);for(;U;){const W=U.index,$={index:U.index,input:U.input,stack:[...g,f]};let F=w(...U,$);if(typeof F=="string"&&(F=F.length>0?{type:"text",value:F}:void 0),F===!1?x.lastIndex=W+1:(E!==W&&z.push({type:"text",value:f.value.slice(E,W)}),Array.isArray(F)?z.push(...F):F&&z.push(F),E=W+U[0].length,N=!0),!x.global)break;U=x.exec(f.value)}return N?(E<f.value.length&&z.push({type:"text",value:f.value.slice(E)}),y.children.splice(A,1,...z)):z=[f],A+z.length}}function Ez(n){const e=[];if(!Array.isArray(n))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!n[0]||Array.isArray(n[0])?n:[n];let r=-1;for(;++r<t.length;){const s=t[r];e.push([Tz(s[0]),kz(s[1])])}return e}function Tz(n){return typeof n=="string"?new RegExp(Sz(n),"g"):n}function kz(n){return typeof n=="function"?n:function(){return n}}const Dy="phrasing",My=["autolink","link","image","label"];function Az(){return{transforms:[Mz],enter:{literalAutolink:Nz,literalAutolinkEmail:Ly,literalAutolinkHttp:Ly,literalAutolinkWww:Ly},exit:{literalAutolink:Dz,literalAutolinkEmail:jz,literalAutolinkHttp:Rz,literalAutolinkWww:Pz}}}function Cz(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Dy,notInConstruct:My},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Dy,notInConstruct:My},{character:":",before:"[ps]",after:"\\/",inConstruct:Dy,notInConstruct:My}]}}function Nz(n){this.enter({type:"link",title:null,url:"",children:[]},n)}function Ly(n){this.config.enter.autolinkProtocol.call(this,n)}function Rz(n){this.config.exit.autolinkProtocol.call(this,n)}function Pz(n){this.config.exit.data.call(this,n);const e=this.stack[this.stack.length-1];e.type,e.url="http://"+this.sliceSerialize(n)}function jz(n){this.config.exit.autolinkEmail.call(this,n)}function Dz(n){this.exit(n)}function Mz(n){Iz(n,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,Lz],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),Oz]],{ignore:["link","linkReference"]})}function Lz(n,e,t,r,s){let o="";if(!WA(s)||(/^w/i.test(e)&&(t=e+t,e="",o="http://"),!Fz(t)))return!1;const a=Vz(t+r);if(!a[0])return!1;const u={type:"link",title:null,url:o+e+a[0],children:[{type:"text",value:e+a[0]}]};return a[1]?[u,{type:"text",value:a[1]}]:u}function Oz(n,e,t,r){return!WA(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+t,children:[{type:"text",value:e+"@"+t}]}}function Fz(n){const e=n.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function Vz(n){const e=/[!"&'),.:;<>?\]}]+$/.exec(n);if(!e)return[n,void 0];n=n.slice(0,e.index);let t=e[0],r=t.indexOf(")");const s=ZS(n,"(");let o=ZS(n,")");for(;r!==-1&&s>o;)n+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),o++;return[n,t]}function WA(n,e){const t=n.input.charCodeAt(n.index-1);return(n.index===0||Wa(t)||fp(t))&&(!e||t!==47)}GA.peek=Kz;function zz(){this.buffer()}function Uz(n){this.enter({type:"footnoteReference",identifier:"",label:""},n)}function Bz(){this.buffer()}function $z(n){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},n)}function qz(n){const e=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Os(this.sliceSerialize(n)).toLowerCase(),t.label=e}function Hz(n){this.exit(n)}function Wz(n){const e=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Os(this.sliceSerialize(n)).toLowerCase(),t.label=e}function Gz(n){this.exit(n)}function Kz(){return"["}function GA(n,e,t,r){const s=t.createTracker(r);let o=s.move("[^");const a=t.enter("footnoteReference"),u=t.enter("reference");return o+=s.move(t.safe(t.associationId(n),{after:"]",before:o})),u(),a(),o+=s.move("]"),o}function Qz(){return{enter:{gfmFootnoteCallString:zz,gfmFootnoteCall:Uz,gfmFootnoteDefinitionLabelString:Bz,gfmFootnoteDefinition:$z},exit:{gfmFootnoteCallString:qz,gfmFootnoteCall:Hz,gfmFootnoteDefinitionLabelString:Wz,gfmFootnoteDefinition:Gz}}}function Yz(n){let e=!1;return n&&n.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:t,footnoteReference:GA},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,s,o,a){const u=o.createTracker(a);let d=u.move("[^");const f=o.enter("footnoteDefinition"),g=o.enter("label");return d+=u.move(o.safe(o.associationId(r),{before:d,after:"]"})),g(),d+=u.move("]:"),r.children&&r.children.length>0&&(u.shift(4),d+=u.move((e?`
`:" ")+o.indentLines(o.containerFlow(r,u.current()),e?KA:Xz))),f(),d}}function Xz(n,e,t){return e===0?n:KA(n,e,t)}function KA(n,e,t){return(t?"":"    ")+n}const Jz=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];QA.peek=r9;function Zz(){return{canContainEols:["delete"],enter:{strikethrough:t9},exit:{strikethrough:n9}}}function e9(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:Jz}],handlers:{delete:QA}}}function t9(n){this.enter({type:"delete",children:[]},n)}function n9(n){this.exit(n)}function QA(n,e,t,r){const s=t.createTracker(r),o=t.enter("strikethrough");let a=s.move("~~");return a+=t.containerPhrasing(n,{...s.current(),before:a,after:"~"}),a+=s.move("~~"),o(),a}function r9(){return"~"}function s9(n){return n.length}function i9(n,e){const t=e||{},r=(t.align||[]).concat(),s=t.stringLength||s9,o=[],a=[],u=[],d=[];let f=0,g=-1;for(;++g<n.length;){const S=[],A=[];let N=-1;for(n[g].length>f&&(f=n[g].length);++N<n[g].length;){const z=o9(n[g][N]);if(t.alignDelimiters!==!1){const U=s(z);A[N]=U,(d[N]===void 0||U>d[N])&&(d[N]=U)}S.push(z)}a[g]=S,u[g]=A}let y=-1;if(typeof r=="object"&&"length"in r)for(;++y<f;)o[y]=eI(r[y]);else{const S=eI(r);for(;++y<f;)o[y]=S}y=-1;const x=[],w=[];for(;++y<f;){const S=o[y];let A="",N="";S===99?(A=":",N=":"):S===108?A=":":S===114&&(N=":");let z=t.alignDelimiters===!1?1:Math.max(1,d[y]-A.length-N.length);const U=A+"-".repeat(z)+N;t.alignDelimiters!==!1&&(z=A.length+z+N.length,z>d[y]&&(d[y]=z),w[y]=z),x[y]=U}a.splice(1,0,x),u.splice(1,0,w),g=-1;const E=[];for(;++g<a.length;){const S=a[g],A=u[g];y=-1;const N=[];for(;++y<f;){const z=S[y]||"";let U="",W="";if(t.alignDelimiters!==!1){const $=d[y]-(A[y]||0),F=o[y];F===114?U=" ".repeat($):F===99?$%2?(U=" ".repeat($/2+.5),W=" ".repeat($/2-.5)):(U=" ".repeat($/2),W=U):W=" ".repeat($)}t.delimiterStart!==!1&&!y&&N.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&z==="")&&(t.delimiterStart!==!1||y)&&N.push(" "),t.alignDelimiters!==!1&&N.push(U),N.push(z),t.alignDelimiters!==!1&&N.push(W),t.padding!==!1&&N.push(" "),(t.delimiterEnd!==!1||y!==f-1)&&N.push("|")}E.push(t.delimiterEnd===!1?N.join("").replace(/ +$/,""):N.join(""))}return E.join(`
`)}function o9(n){return n==null?"":String(n)}function eI(n){const e=typeof n=="string"?n.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}function a9(n,e,t,r){const s=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const a=t.indentLines(t.containerFlow(n,o.current()),l9);return s(),a}function l9(n,e,t){return">"+(t?"":" ")+n}function c9(n,e){return tI(n,e.inConstruct,!0)&&!tI(n,e.notInConstruct,!1)}function tI(n,e,t){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return t;let r=-1;for(;++r<e.length;)if(n.includes(e[r]))return!0;return!1}function nI(n,e,t,r){let s=-1;for(;++s<t.unsafe.length;)if(t.unsafe[s].character===`
`&&c9(t.stack,t.unsafe[s]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function u9(n,e){const t=String(n);let r=t.indexOf(e),s=r,o=0,a=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===s?++o>a&&(a=o):o=1,s=r+e.length,r=t.indexOf(e,s);return a}function d9(n,e){return!!(e.options.fences===!1&&n.value&&!n.lang&&/[^ \r\n]/.test(n.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(n.value))}function h9(n){const e=n.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function f9(n,e,t,r){const s=h9(t),o=n.value||"",a=s==="`"?"GraveAccent":"Tilde";if(d9(n,t)){const y=t.enter("codeIndented"),x=t.indentLines(o,m9);return y(),x}const u=t.createTracker(r),d=s.repeat(Math.max(u9(o,s)+1,3)),f=t.enter("codeFenced");let g=u.move(d);if(n.lang){const y=t.enter(`codeFencedLang${a}`);g+=u.move(t.safe(n.lang,{before:g,after:" ",encode:["`"],...u.current()})),y()}if(n.lang&&n.meta){const y=t.enter(`codeFencedMeta${a}`);g+=u.move(" "),g+=u.move(t.safe(n.meta,{before:g,after:`
`,encode:["`"],...u.current()})),y()}return g+=u.move(`
`),o&&(g+=u.move(o+`
`)),g+=u.move(d),f(),g}function m9(n,e,t){return(t?"":"    ")+n}function Cv(n){const e=n.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function p9(n,e,t,r){const s=Cv(t),o=s==='"'?"Quote":"Apostrophe",a=t.enter("definition");let u=t.enter("label");const d=t.createTracker(r);let f=d.move("[");return f+=d.move(t.safe(t.associationId(n),{before:f,after:"]",...d.current()})),f+=d.move("]: "),u(),!n.url||/[\0- \u007F]/.test(n.url)?(u=t.enter("destinationLiteral"),f+=d.move("<"),f+=d.move(t.safe(n.url,{before:f,after:">",...d.current()})),f+=d.move(">")):(u=t.enter("destinationRaw"),f+=d.move(t.safe(n.url,{before:f,after:n.title?" ":`
`,...d.current()}))),u(),n.title&&(u=t.enter(`title${o}`),f+=d.move(" "+s),f+=d.move(t.safe(n.title,{before:f,after:s,...d.current()})),f+=d.move(s),u()),a(),f}function g9(n){const e=n.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}function Td(n){return"&#x"+n.toString(16).toUpperCase()+";"}function Em(n,e,t){const r=Ec(n),s=Ec(e);return r===void 0?s===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}YA.peek=y9;function YA(n,e,t,r){const s=g9(t),o=t.enter("emphasis"),a=t.createTracker(r),u=a.move(s);let d=a.move(t.containerPhrasing(n,{after:s,before:u,...a.current()}));const f=d.charCodeAt(0),g=Em(r.before.charCodeAt(r.before.length-1),f,s);g.inside&&(d=Td(f)+d.slice(1));const y=d.charCodeAt(d.length-1),x=Em(r.after.charCodeAt(0),y,s);x.inside&&(d=d.slice(0,-1)+Td(y));const w=a.move(s);return o(),t.attentionEncodeSurroundingInfo={after:x.outside,before:g.outside},u+d+w}function y9(n,e,t){return t.options.emphasis||"*"}function x9(n,e){let t=!1;return kv(n,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,R0}),!!((!n.depth||n.depth<3)&&wv(n)&&(e.options.setext||t))}function v9(n,e,t,r){const s=Math.max(Math.min(6,n.depth||1),1),o=t.createTracker(r);if(x9(n,t)){const g=t.enter("headingSetext"),y=t.enter("phrasing"),x=t.containerPhrasing(n,{...o.current(),before:`
`,after:`
`});return y(),g(),x+`
`+(s===1?"=":"-").repeat(x.length-(Math.max(x.lastIndexOf("\r"),x.lastIndexOf(`
`))+1))}const a="#".repeat(s),u=t.enter("headingAtx"),d=t.enter("phrasing");o.move(a+" ");let f=t.containerPhrasing(n,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(f)&&(f=Td(f.charCodeAt(0))+f.slice(1)),f=f?a+" "+f:a,t.options.closeAtx&&(f+=" "+a),d(),u(),f}XA.peek=w9;function XA(n){return n.value||""}function w9(){return"<"}JA.peek=b9;function JA(n,e,t,r){const s=Cv(t),o=s==='"'?"Quote":"Apostrophe",a=t.enter("image");let u=t.enter("label");const d=t.createTracker(r);let f=d.move("![");return f+=d.move(t.safe(n.alt,{before:f,after:"]",...d.current()})),f+=d.move("]("),u(),!n.url&&n.title||/[\0- \u007F]/.test(n.url)?(u=t.enter("destinationLiteral"),f+=d.move("<"),f+=d.move(t.safe(n.url,{before:f,after:">",...d.current()})),f+=d.move(">")):(u=t.enter("destinationRaw"),f+=d.move(t.safe(n.url,{before:f,after:n.title?" ":")",...d.current()}))),u(),n.title&&(u=t.enter(`title${o}`),f+=d.move(" "+s),f+=d.move(t.safe(n.title,{before:f,after:s,...d.current()})),f+=d.move(s),u()),f+=d.move(")"),a(),f}function b9(){return"!"}ZA.peek=_9;function ZA(n,e,t,r){const s=n.referenceType,o=t.enter("imageReference");let a=t.enter("label");const u=t.createTracker(r);let d=u.move("![");const f=t.safe(n.alt,{before:d,after:"]",...u.current()});d+=u.move(f+"]["),a();const g=t.stack;t.stack=[],a=t.enter("reference");const y=t.safe(t.associationId(n),{before:d,after:"]",...u.current()});return a(),t.stack=g,o(),s==="full"||!f||f!==y?d+=u.move(y+"]"):s==="shortcut"?d=d.slice(0,-1):d+=u.move("]"),d}function _9(){return"!"}e2.peek=S9;function e2(n,e,t){let r=n.value||"",s="`",o=-1;for(;new RegExp("(^|[^`])"+s+"([^`]|$)").test(r);)s+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const a=t.unsafe[o],u=t.compilePattern(a);let d;if(a.atBreak)for(;d=u.exec(r);){let f=d.index;r.charCodeAt(f)===10&&r.charCodeAt(f-1)===13&&f--,r=r.slice(0,f)+" "+r.slice(d.index+1)}}return s+r+s}function S9(){return"`"}function t2(n,e){const t=wv(n);return!!(!e.options.resourceLink&&n.url&&!n.title&&n.children&&n.children.length===1&&n.children[0].type==="text"&&(t===n.url||"mailto:"+t===n.url)&&/^[a-z][a-z+.-]+:/i.test(n.url)&&!/[\0- <>\u007F]/.test(n.url))}n2.peek=I9;function n2(n,e,t,r){const s=Cv(t),o=s==='"'?"Quote":"Apostrophe",a=t.createTracker(r);let u,d;if(t2(n,t)){const g=t.stack;t.stack=[],u=t.enter("autolink");let y=a.move("<");return y+=a.move(t.containerPhrasing(n,{before:y,after:">",...a.current()})),y+=a.move(">"),u(),t.stack=g,y}u=t.enter("link"),d=t.enter("label");let f=a.move("[");return f+=a.move(t.containerPhrasing(n,{before:f,after:"](",...a.current()})),f+=a.move("]("),d(),!n.url&&n.title||/[\0- \u007F]/.test(n.url)?(d=t.enter("destinationLiteral"),f+=a.move("<"),f+=a.move(t.safe(n.url,{before:f,after:">",...a.current()})),f+=a.move(">")):(d=t.enter("destinationRaw"),f+=a.move(t.safe(n.url,{before:f,after:n.title?" ":")",...a.current()}))),d(),n.title&&(d=t.enter(`title${o}`),f+=a.move(" "+s),f+=a.move(t.safe(n.title,{before:f,after:s,...a.current()})),f+=a.move(s),d()),f+=a.move(")"),u(),f}function I9(n,e,t){return t2(n,t)?"<":"["}r2.peek=E9;function r2(n,e,t,r){const s=n.referenceType,o=t.enter("linkReference");let a=t.enter("label");const u=t.createTracker(r);let d=u.move("[");const f=t.containerPhrasing(n,{before:d,after:"]",...u.current()});d+=u.move(f+"]["),a();const g=t.stack;t.stack=[],a=t.enter("reference");const y=t.safe(t.associationId(n),{before:d,after:"]",...u.current()});return a(),t.stack=g,o(),s==="full"||!f||f!==y?d+=u.move(y+"]"):s==="shortcut"?d=d.slice(0,-1):d+=u.move("]"),d}function E9(){return"["}function Nv(n){const e=n.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function T9(n){const e=Nv(n),t=n.options.bulletOther;if(!t)return e==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+t+"`) to be different");return t}function k9(n){const e=n.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function s2(n){const e=n.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function A9(n,e,t,r){const s=t.enter("list"),o=t.bulletCurrent;let a=n.ordered?k9(t):Nv(t);const u=n.ordered?a==="."?")":".":T9(t);let d=e&&t.bulletLastUsed?a===t.bulletLastUsed:!1;if(!n.ordered){const g=n.children?n.children[0]:void 0;if((a==="*"||a==="-")&&g&&(!g.children||!g.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(d=!0),s2(t)===a&&g){let y=-1;for(;++y<n.children.length;){const x=n.children[y];if(x&&x.type==="listItem"&&x.children&&x.children[0]&&x.children[0].type==="thematicBreak"){d=!0;break}}}}d&&(a=u),t.bulletCurrent=a;const f=t.containerFlow(n,r);return t.bulletLastUsed=a,t.bulletCurrent=o,s(),f}function C9(n){const e=n.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function N9(n,e,t,r){const s=C9(t);let o=t.bulletCurrent||Nv(t);e&&e.type==="list"&&e.ordered&&(o=(typeof e.start=="number"&&e.start>-1?e.start:1)+(t.options.incrementListMarker===!1?0:e.children.indexOf(n))+o);let a=o.length+1;(s==="tab"||s==="mixed"&&(e&&e.type==="list"&&e.spread||n.spread))&&(a=Math.ceil(a/4)*4);const u=t.createTracker(r);u.move(o+" ".repeat(a-o.length)),u.shift(a);const d=t.enter("listItem"),f=t.indentLines(t.containerFlow(n,u.current()),g);return d(),f;function g(y,x,w){return x?(w?"":" ".repeat(a))+y:(w?o:o+" ".repeat(a-o.length))+y}}function R9(n,e,t,r){const s=t.enter("paragraph"),o=t.enter("phrasing"),a=t.containerPhrasing(n,r);return o(),s(),a}const P9=gp(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function j9(n,e,t,r){return(n.children.some(function(a){return P9(a)})?t.containerPhrasing:t.containerFlow).call(t,n,r)}function D9(n){const e=n.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}i2.peek=M9;function i2(n,e,t,r){const s=D9(t),o=t.enter("strong"),a=t.createTracker(r),u=a.move(s+s);let d=a.move(t.containerPhrasing(n,{after:s,before:u,...a.current()}));const f=d.charCodeAt(0),g=Em(r.before.charCodeAt(r.before.length-1),f,s);g.inside&&(d=Td(f)+d.slice(1));const y=d.charCodeAt(d.length-1),x=Em(r.after.charCodeAt(0),y,s);x.inside&&(d=d.slice(0,-1)+Td(y));const w=a.move(s+s);return o(),t.attentionEncodeSurroundingInfo={after:x.outside,before:g.outside},u+d+w}function M9(n,e,t){return t.options.strong||"*"}function L9(n,e,t,r){return t.safe(n.value,r)}function O9(n){const e=n.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function F9(n,e,t){const r=(s2(t)+(t.options.ruleSpaces?" ":"")).repeat(O9(t));return t.options.ruleSpaces?r.slice(0,-1):r}const o2={blockquote:a9,break:nI,code:f9,definition:p9,emphasis:YA,hardBreak:nI,heading:v9,html:XA,image:JA,imageReference:ZA,inlineCode:e2,link:n2,linkReference:r2,list:A9,listItem:N9,paragraph:R9,root:j9,strong:i2,text:L9,thematicBreak:F9};function V9(){return{enter:{table:z9,tableData:rI,tableHeader:rI,tableRow:B9},exit:{codeText:$9,table:U9,tableData:Oy,tableHeader:Oy,tableRow:Oy}}}function z9(n){const e=n._align;this.enter({type:"table",align:e.map(function(t){return t==="none"?null:t}),children:[]},n),this.data.inTable=!0}function U9(n){this.exit(n),this.data.inTable=void 0}function B9(n){this.enter({type:"tableRow",children:[]},n)}function Oy(n){this.exit(n)}function rI(n){this.enter({type:"tableCell",children:[]},n)}function $9(n){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,q9));const t=this.stack[this.stack.length-1];t.type,t.value=e,this.exit(n)}function q9(n,e){return e==="|"?e:n}function H9(n){const e=n||{},t=e.tableCellPadding,r=e.tablePipeAlign,s=e.stringLength,o=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:x,table:a,tableCell:d,tableRow:u}};function a(w,E,S,A){return f(g(w,S,A),w.align)}function u(w,E,S,A){const N=y(w,S,A),z=f([N]);return z.slice(0,z.indexOf(`
`))}function d(w,E,S,A){const N=S.enter("tableCell"),z=S.enter("phrasing"),U=S.containerPhrasing(w,{...A,before:o,after:o});return z(),N(),U}function f(w,E){return i9(w,{align:E,alignDelimiters:r,padding:t,stringLength:s})}function g(w,E,S){const A=w.children;let N=-1;const z=[],U=E.enter("table");for(;++N<A.length;)z[N]=y(A[N],E,S);return U(),z}function y(w,E,S){const A=w.children;let N=-1;const z=[],U=E.enter("tableRow");for(;++N<A.length;)z[N]=d(A[N],w,E,S);return U(),z}function x(w,E,S){let A=o2.inlineCode(w,E,S);return S.stack.includes("tableCell")&&(A=A.replace(/\|/g,"\\$&")),A}}function W9(){return{exit:{taskListCheckValueChecked:sI,taskListCheckValueUnchecked:sI,paragraph:K9}}}function G9(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:Q9}}}function sI(n){const e=this.stack[this.stack.length-2];e.type,e.checked=n.type==="taskListCheckValueChecked"}function K9(n){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const s=e.children;let o=-1,a;for(;++o<s.length;){const u=s[o];if(u.type==="paragraph"){a=u;break}}a===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(n)}function Q9(n,e,t,r){const s=n.children[0],o=typeof n.checked=="boolean"&&s&&s.type==="paragraph",a="["+(n.checked?"x":" ")+"] ",u=t.createTracker(r);o&&u.move(a);let d=o2.listItem(n,e,t,{...r,...u.current()});return o&&(d=d.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,f)),d;function f(g){return g+a}}function Y9(){return[Az(),Qz(),Zz(),V9(),W9()]}function X9(n){return{extensions:[Cz(),Yz(n),e9(),H9(n),G9()]}}const J9={tokenize:sU,partial:!0},a2={tokenize:iU,partial:!0},l2={tokenize:oU,partial:!0},c2={tokenize:aU,partial:!0},Z9={tokenize:lU,partial:!0},u2={name:"wwwAutolink",tokenize:nU,previous:h2},d2={name:"protocolAutolink",tokenize:rU,previous:f2},Gi={name:"emailAutolink",tokenize:tU,previous:m2},oi={};function eU(){return{text:oi}}let va=48;for(;va<123;)oi[va]=Gi,va++,va===58?va=65:va===91&&(va=97);oi[43]=Gi;oi[45]=Gi;oi[46]=Gi;oi[95]=Gi;oi[72]=[Gi,d2];oi[104]=[Gi,d2];oi[87]=[Gi,u2];oi[119]=[Gi,u2];function tU(n,e,t){const r=this;let s,o;return a;function a(y){return!M0(y)||!m2.call(r,r.previous)||Rv(r.events)?t(y):(n.enter("literalAutolink"),n.enter("literalAutolinkEmail"),u(y))}function u(y){return M0(y)?(n.consume(y),u):y===64?(n.consume(y),d):t(y)}function d(y){return y===46?n.check(Z9,g,f)(y):y===45||y===95||qn(y)?(o=!0,n.consume(y),d):g(y)}function f(y){return n.consume(y),s=!0,d}function g(y){return o&&s&&ir(r.previous)?(n.exit("literalAutolinkEmail"),n.exit("literalAutolink"),e(y)):t(y)}}function nU(n,e,t){const r=this;return s;function s(a){return a!==87&&a!==119||!h2.call(r,r.previous)||Rv(r.events)?t(a):(n.enter("literalAutolink"),n.enter("literalAutolinkWww"),n.check(J9,n.attempt(a2,n.attempt(l2,o),t),t)(a))}function o(a){return n.exit("literalAutolinkWww"),n.exit("literalAutolink"),e(a)}}function rU(n,e,t){const r=this;let s="",o=!1;return a;function a(y){return(y===72||y===104)&&f2.call(r,r.previous)&&!Rv(r.events)?(n.enter("literalAutolink"),n.enter("literalAutolinkHttp"),s+=String.fromCodePoint(y),n.consume(y),u):t(y)}function u(y){if(ir(y)&&s.length<5)return s+=String.fromCodePoint(y),n.consume(y),u;if(y===58){const x=s.toLowerCase();if(x==="http"||x==="https")return n.consume(y),d}return t(y)}function d(y){return y===47?(n.consume(y),o?f:(o=!0,d)):t(y)}function f(y){return y===null||_m(y)||It(y)||Wa(y)||fp(y)?t(y):n.attempt(a2,n.attempt(l2,g),t)(y)}function g(y){return n.exit("literalAutolinkHttp"),n.exit("literalAutolink"),e(y)}}function sU(n,e,t){let r=0;return s;function s(a){return(a===87||a===119)&&r<3?(r++,n.consume(a),s):a===46&&r===3?(n.consume(a),o):t(a)}function o(a){return a===null?t(a):e(a)}}function iU(n,e,t){let r,s,o;return a;function a(f){return f===46||f===95?n.check(c2,d,u)(f):f===null||It(f)||Wa(f)||f!==45&&fp(f)?d(f):(o=!0,n.consume(f),a)}function u(f){return f===95?r=!0:(s=r,r=void 0),n.consume(f),a}function d(f){return s||r||!o?t(f):e(f)}}function oU(n,e){let t=0,r=0;return s;function s(a){return a===40?(t++,n.consume(a),s):a===41&&r<t?o(a):a===33||a===34||a===38||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===60||a===63||a===93||a===95||a===126?n.check(c2,e,o)(a):a===null||It(a)||Wa(a)?e(a):(n.consume(a),s)}function o(a){return a===41&&r++,n.consume(a),s}}function aU(n,e,t){return r;function r(u){return u===33||u===34||u===39||u===41||u===42||u===44||u===46||u===58||u===59||u===63||u===95||u===126?(n.consume(u),r):u===38?(n.consume(u),o):u===93?(n.consume(u),s):u===60||u===null||It(u)||Wa(u)?e(u):t(u)}function s(u){return u===null||u===40||u===91||It(u)||Wa(u)?e(u):r(u)}function o(u){return ir(u)?a(u):t(u)}function a(u){return u===59?(n.consume(u),r):ir(u)?(n.consume(u),a):t(u)}}function lU(n,e,t){return r;function r(o){return n.consume(o),s}function s(o){return qn(o)?t(o):e(o)}}function h2(n){return n===null||n===40||n===42||n===95||n===91||n===93||n===126||It(n)}function f2(n){return!ir(n)}function m2(n){return!(n===47||M0(n))}function M0(n){return n===43||n===45||n===46||n===95||qn(n)}function Rv(n){let e=n.length,t=!1;for(;e--;){const r=n[e][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return n.length>0&&!t&&(n[n.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const cU={tokenize:yU,partial:!0};function uU(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:mU,continuation:{tokenize:pU},exit:gU}},text:{91:{name:"gfmFootnoteCall",tokenize:fU},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:dU,resolveTo:hU}}}}function dU(n,e,t){const r=this;let s=r.events.length;const o=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let a;for(;s--;){const d=r.events[s][1];if(d.type==="labelImage"){a=d;break}if(d.type==="gfmFootnoteCall"||d.type==="labelLink"||d.type==="label"||d.type==="image"||d.type==="link")break}return u;function u(d){if(!a||!a._balanced)return t(d);const f=Os(r.sliceSerialize({start:a.end,end:r.now()}));return f.codePointAt(0)!==94||!o.includes(f.slice(1))?t(d):(n.enter("gfmFootnoteCallLabelMarker"),n.consume(d),n.exit("gfmFootnoteCallLabelMarker"),e(d))}}function hU(n,e){let t=n.length;for(;t--;)if(n[t][1].type==="labelImage"&&n[t][0]==="enter"){n[t][1];break}n[t+1][1].type="data",n[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},n[t+3][1].start),end:Object.assign({},n[n.length-1][1].end)},s={type:"gfmFootnoteCallMarker",start:Object.assign({},n[t+3][1].end),end:Object.assign({},n[t+3][1].end)};s.end.column++,s.end.offset++,s.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},s.end),end:Object.assign({},n[n.length-1][1].start)},a={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},u=[n[t+1],n[t+2],["enter",r,e],n[t+3],n[t+4],["enter",s,e],["exit",s,e],["enter",o,e],["enter",a,e],["exit",a,e],["exit",o,e],n[n.length-2],n[n.length-1],["exit",r,e]];return n.splice(t,n.length-t+1,...u),n}function fU(n,e,t){const r=this,s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o=0,a;return u;function u(y){return n.enter("gfmFootnoteCall"),n.enter("gfmFootnoteCallLabelMarker"),n.consume(y),n.exit("gfmFootnoteCallLabelMarker"),d}function d(y){return y!==94?t(y):(n.enter("gfmFootnoteCallMarker"),n.consume(y),n.exit("gfmFootnoteCallMarker"),n.enter("gfmFootnoteCallString"),n.enter("chunkString").contentType="string",f)}function f(y){if(o>999||y===93&&!a||y===null||y===91||It(y))return t(y);if(y===93){n.exit("chunkString");const x=n.exit("gfmFootnoteCallString");return s.includes(Os(r.sliceSerialize(x)))?(n.enter("gfmFootnoteCallLabelMarker"),n.consume(y),n.exit("gfmFootnoteCallLabelMarker"),n.exit("gfmFootnoteCall"),e):t(y)}return It(y)||(a=!0),o++,n.consume(y),y===92?g:f}function g(y){return y===91||y===92||y===93?(n.consume(y),o++,f):f(y)}}function mU(n,e,t){const r=this,s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o,a=0,u;return d;function d(E){return n.enter("gfmFootnoteDefinition")._container=!0,n.enter("gfmFootnoteDefinitionLabel"),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(E),n.exit("gfmFootnoteDefinitionLabelMarker"),f}function f(E){return E===94?(n.enter("gfmFootnoteDefinitionMarker"),n.consume(E),n.exit("gfmFootnoteDefinitionMarker"),n.enter("gfmFootnoteDefinitionLabelString"),n.enter("chunkString").contentType="string",g):t(E)}function g(E){if(a>999||E===93&&!u||E===null||E===91||It(E))return t(E);if(E===93){n.exit("chunkString");const S=n.exit("gfmFootnoteDefinitionLabelString");return o=Os(r.sliceSerialize(S)),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(E),n.exit("gfmFootnoteDefinitionLabelMarker"),n.exit("gfmFootnoteDefinitionLabel"),x}return It(E)||(u=!0),a++,n.consume(E),E===92?y:g}function y(E){return E===91||E===92||E===93?(n.consume(E),a++,g):g(E)}function x(E){return E===58?(n.enter("definitionMarker"),n.consume(E),n.exit("definitionMarker"),s.includes(o)||s.push(o),ut(n,w,"gfmFootnoteDefinitionWhitespace")):t(E)}function w(E){return e(E)}}function pU(n,e,t){return n.check(Qd,e,n.attempt(cU,e,t))}function gU(n){n.exit("gfmFootnoteDefinition")}function yU(n,e,t){const r=this;return ut(n,s,"gfmFootnoteDefinitionIndent",5);function s(o){const a=r.events[r.events.length-1];return a&&a[1].type==="gfmFootnoteDefinitionIndent"&&a[2].sliceSerialize(a[1],!0).length===4?e(o):t(o)}}function xU(n){let t=(n||{}).singleTilde;const r={name:"strikethrough",tokenize:o,resolveAll:s};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function s(a,u){let d=-1;for(;++d<a.length;)if(a[d][0]==="enter"&&a[d][1].type==="strikethroughSequenceTemporary"&&a[d][1]._close){let f=d;for(;f--;)if(a[f][0]==="exit"&&a[f][1].type==="strikethroughSequenceTemporary"&&a[f][1]._open&&a[d][1].end.offset-a[d][1].start.offset===a[f][1].end.offset-a[f][1].start.offset){a[d][1].type="strikethroughSequence",a[f][1].type="strikethroughSequence";const g={type:"strikethrough",start:Object.assign({},a[f][1].start),end:Object.assign({},a[d][1].end)},y={type:"strikethroughText",start:Object.assign({},a[f][1].end),end:Object.assign({},a[d][1].start)},x=[["enter",g,u],["enter",a[f][1],u],["exit",a[f][1],u],["enter",y,u]],w=u.parser.constructs.insideSpan.null;w&&Qr(x,x.length,0,mp(w,a.slice(f+1,d),u)),Qr(x,x.length,0,[["exit",y,u],["enter",a[d][1],u],["exit",a[d][1],u],["exit",g,u]]),Qr(a,f-1,d-f+3,x),d=f+x.length-2;break}}for(d=-1;++d<a.length;)a[d][1].type==="strikethroughSequenceTemporary"&&(a[d][1].type="data");return a}function o(a,u,d){const f=this.previous,g=this.events;let y=0;return x;function x(E){return f===126&&g[g.length-1][1].type!=="characterEscape"?d(E):(a.enter("strikethroughSequenceTemporary"),w(E))}function w(E){const S=Ec(f);if(E===126)return y>1?d(E):(a.consume(E),y++,w);if(y<2&&!t)return d(E);const A=a.exit("strikethroughSequenceTemporary"),N=Ec(E);return A._open=!N||N===2&&!!S,A._close=!S||S===2&&!!N,u(E)}}}class vU{constructor(){this.map=[]}add(e,t,r){wU(this,e,t,r)}consume(e){if(this.map.sort(function(o,a){return o[0]-a[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(e.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),e.length=this.map[t][0];r.push(e.slice()),e.length=0;let s=r.pop();for(;s;){for(const o of s)e.push(o);s=r.pop()}this.map.length=0}}function wU(n,e,t,r){let s=0;if(!(t===0&&r.length===0)){for(;s<n.map.length;){if(n.map[s][0]===e){n.map[s][1]+=t,n.map[s][2].push(...r);return}s+=1}n.map.push([e,t,r])}}function bU(n,e){let t=!1;const r=[];for(;e<n.length;){const s=n[e];if(t){if(s[0]==="enter")s[1].type==="tableContent"&&r.push(n[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(s[1].type==="tableContent"){if(n[e-1][1].type==="tableDelimiterMarker"){const o=r.length-1;r[o]=r[o]==="left"?"center":"right"}}else if(s[1].type==="tableDelimiterRow")break}else s[0]==="enter"&&s[1].type==="tableDelimiterRow"&&(t=!0);e+=1}return r}function _U(){return{flow:{null:{name:"table",tokenize:SU,resolveAll:IU}}}}function SU(n,e,t){const r=this;let s=0,o=0,a;return u;function u(T){let D=r.events.length-1;for(;D>-1;){const G=r.events[D][1].type;if(G==="lineEnding"||G==="linePrefix")D--;else break}const L=D>-1?r.events[D][1].type:null,C=L==="tableHead"||L==="tableRow"?F:d;return C===F&&r.parser.lazy[r.now().line]?t(T):C(T)}function d(T){return n.enter("tableHead"),n.enter("tableRow"),f(T)}function f(T){return T===124||(a=!0,o+=1),g(T)}function g(T){return T===null?t(T):Ue(T)?o>1?(o=0,r.interrupt=!0,n.exit("tableRow"),n.enter("lineEnding"),n.consume(T),n.exit("lineEnding"),w):t(T):nt(T)?ut(n,g,"whitespace")(T):(o+=1,a&&(a=!1,s+=1),T===124?(n.enter("tableCellDivider"),n.consume(T),n.exit("tableCellDivider"),a=!0,g):(n.enter("data"),y(T)))}function y(T){return T===null||T===124||It(T)?(n.exit("data"),g(T)):(n.consume(T),T===92?x:y)}function x(T){return T===92||T===124?(n.consume(T),y):y(T)}function w(T){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(T):(n.enter("tableDelimiterRow"),a=!1,nt(T)?ut(n,E,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(T):E(T))}function E(T){return T===45||T===58?A(T):T===124?(a=!0,n.enter("tableCellDivider"),n.consume(T),n.exit("tableCellDivider"),S):$(T)}function S(T){return nt(T)?ut(n,A,"whitespace")(T):A(T)}function A(T){return T===58?(o+=1,a=!0,n.enter("tableDelimiterMarker"),n.consume(T),n.exit("tableDelimiterMarker"),N):T===45?(o+=1,N(T)):T===null||Ue(T)?W(T):$(T)}function N(T){return T===45?(n.enter("tableDelimiterFiller"),z(T)):$(T)}function z(T){return T===45?(n.consume(T),z):T===58?(a=!0,n.exit("tableDelimiterFiller"),n.enter("tableDelimiterMarker"),n.consume(T),n.exit("tableDelimiterMarker"),U):(n.exit("tableDelimiterFiller"),U(T))}function U(T){return nt(T)?ut(n,W,"whitespace")(T):W(T)}function W(T){return T===124?E(T):T===null||Ue(T)?!a||s!==o?$(T):(n.exit("tableDelimiterRow"),n.exit("tableHead"),e(T)):$(T)}function $(T){return t(T)}function F(T){return n.enter("tableRow"),R(T)}function R(T){return T===124?(n.enter("tableCellDivider"),n.consume(T),n.exit("tableCellDivider"),R):T===null||Ue(T)?(n.exit("tableRow"),e(T)):nt(T)?ut(n,R,"whitespace")(T):(n.enter("data"),k(T))}function k(T){return T===null||T===124||It(T)?(n.exit("data"),R(T)):(n.consume(T),T===92?P:k)}function P(T){return T===92||T===124?(n.consume(T),k):k(T)}}function IU(n,e){let t=-1,r=!0,s=0,o=[0,0,0,0],a=[0,0,0,0],u=!1,d=0,f,g,y;const x=new vU;for(;++t<n.length;){const w=n[t],E=w[1];w[0]==="enter"?E.type==="tableHead"?(u=!1,d!==0&&(iI(x,e,d,f,g),g=void 0,d=0),f={type:"table",start:Object.assign({},E.start),end:Object.assign({},E.end)},x.add(t,0,[["enter",f,e]])):E.type==="tableRow"||E.type==="tableDelimiterRow"?(r=!0,y=void 0,o=[0,0,0,0],a=[0,t+1,0,0],u&&(u=!1,g={type:"tableBody",start:Object.assign({},E.start),end:Object.assign({},E.end)},x.add(t,0,[["enter",g,e]])),s=E.type==="tableDelimiterRow"?2:g?3:1):s&&(E.type==="data"||E.type==="tableDelimiterMarker"||E.type==="tableDelimiterFiller")?(r=!1,a[2]===0&&(o[1]!==0&&(a[0]=a[1],y=_f(x,e,o,s,void 0,y),o=[0,0,0,0]),a[2]=t)):E.type==="tableCellDivider"&&(r?r=!1:(o[1]!==0&&(a[0]=a[1],y=_f(x,e,o,s,void 0,y)),o=a,a=[o[1],t,0,0])):E.type==="tableHead"?(u=!0,d=t):E.type==="tableRow"||E.type==="tableDelimiterRow"?(d=t,o[1]!==0?(a[0]=a[1],y=_f(x,e,o,s,t,y)):a[1]!==0&&(y=_f(x,e,a,s,t,y)),s=0):s&&(E.type==="data"||E.type==="tableDelimiterMarker"||E.type==="tableDelimiterFiller")&&(a[3]=t)}for(d!==0&&iI(x,e,d,f,g),x.consume(e.events),t=-1;++t<e.events.length;){const w=e.events[t];w[0]==="enter"&&w[1].type==="table"&&(w[1]._align=bU(e.events,t))}return n}function _f(n,e,t,r,s,o){const a=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",u="tableContent";t[0]!==0&&(o.end=Object.assign({},Kl(e.events,t[0])),n.add(t[0],0,[["exit",o,e]]));const d=Kl(e.events,t[1]);if(o={type:a,start:Object.assign({},d),end:Object.assign({},d)},n.add(t[1],0,[["enter",o,e]]),t[2]!==0){const f=Kl(e.events,t[2]),g=Kl(e.events,t[3]),y={type:u,start:Object.assign({},f),end:Object.assign({},g)};if(n.add(t[2],0,[["enter",y,e]]),r!==2){const x=e.events[t[2]],w=e.events[t[3]];if(x[1].end=Object.assign({},w[1].end),x[1].type="chunkText",x[1].contentType="text",t[3]>t[2]+1){const E=t[2]+1,S=t[3]-t[2]-1;n.add(E,S,[])}}n.add(t[3]+1,0,[["exit",y,e]])}return s!==void 0&&(o.end=Object.assign({},Kl(e.events,s)),n.add(s,0,[["exit",o,e]]),o=void 0),o}function iI(n,e,t,r,s){const o=[],a=Kl(e.events,t);s&&(s.end=Object.assign({},a),o.push(["exit",s,e])),r.end=Object.assign({},a),o.push(["exit",r,e]),n.add(t+1,0,o)}function Kl(n,e){const t=n[e],r=t[0]==="enter"?"start":"end";return t[1][r]}const EU={name:"tasklistCheck",tokenize:kU};function TU(){return{text:{91:EU}}}function kU(n,e,t){const r=this;return s;function s(d){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(d):(n.enter("taskListCheck"),n.enter("taskListCheckMarker"),n.consume(d),n.exit("taskListCheckMarker"),o)}function o(d){return It(d)?(n.enter("taskListCheckValueUnchecked"),n.consume(d),n.exit("taskListCheckValueUnchecked"),a):d===88||d===120?(n.enter("taskListCheckValueChecked"),n.consume(d),n.exit("taskListCheckValueChecked"),a):t(d)}function a(d){return d===93?(n.enter("taskListCheckMarker"),n.consume(d),n.exit("taskListCheckMarker"),n.exit("taskListCheck"),u):t(d)}function u(d){return Ue(d)?e(d):nt(d)?n.check({tokenize:AU},e,t)(d):t(d)}}function AU(n,e,t){return ut(n,r,"whitespace");function r(s){return s===null?t(s):e(s)}}function CU(n){return EA([eU(),uU(),xU(n),_U(),TU()])}const NU={};function RU(n){const e=this,t=n||NU,r=e.data(),s=r.micromarkExtensions||(r.micromarkExtensions=[]),o=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),a=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);s.push(CU(t)),o.push(Y9()),a.push(X9(t))}const PU=({announcements:n,onEdit:e,onDelete:t,onToggleStatus:r,actionLoadingId:s,viewOnly:o=!1})=>{const a=u=>{if(!u)return"N/A";let d;if(u.toDate&&typeof u.toDate=="function")d=u.toDate();else if(u instanceof Date)d=u;else return"Invalid Date";return d.toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})};return!n||n.length===0?c.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[c.jsx(on,{size:48,className:"mx-auto text-gray-400 mb-4"}),c.jsx("p",{className:"text-gray-600 text-lg",children:"No announcements found."}),!o&&c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create a new announcement to get started."})]}):c.jsx("div",{className:"space-y-4",children:n.map(u=>c.jsxs("div",{className:`p-4 rounded-lg shadow-md border-l-4 transition-opacity ${u.status==="active"?"border-green-500 bg-white":"border-gray-400 bg-gray-50 opacity-80"}`,children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"flex-grow pr-4",children:[c.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:u.title}),c.jsxs("div",{className:"flex items-center space-x-3 text-xs mt-1",children:[c.jsx("span",{className:`px-2 py-0.5 font-semibold uppercase tracking-wider rounded-full ${u.status==="active"?"bg-green-100 text-green-800":"bg-gray-200 text-gray-600"}`,children:u.status}),c.jsx("span",{className:`px-2 py-0.5 font-semibold uppercase tracking-wider rounded-full ${u.type==="critical"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:u.type})]})]}),!o&&c.jsx("div",{className:"flex space-x-2 items-center flex-shrink-0",children:s===u.id?c.jsx(Ge,{className:"animate-spin text-gray-500"}):c.jsxs(c.Fragment,{children:[r&&c.jsx("button",{onClick:()=>r(u),className:`p-1.5 rounded-md hover:bg-opacity-20 transition-colors ${u.status==="active"?"text-yellow-600 hover:bg-yellow-100":"text-green-600 hover:bg-green-100"}`,title:u.status==="active"?"Archive (Hide)":"Activate (Make Visible)",children:u.status==="active"?c.jsx(vm,{size:18}):c.jsx(qa,{size:18})}),e&&c.jsx("button",{onClick:()=>e(u),className:"text-blue-600 hover:text-blue-800 p-1.5 rounded-md hover:bg-blue-100 transition-colors",title:"Edit Announcement",children:c.jsx(UL,{size:18})}),t&&c.jsx("button",{onClick:()=>t(u.id),className:"text-red-600 hover:text-red-800 p-1.5 rounded-md hover:bg-red-100 transition-colors",title:"Delete Announcement",children:c.jsx(Oc,{size:18})})]})})]}),c.jsx("div",{className:"prose prose-sm max-w-none text-gray-700 mt-3 pt-3 border-t border-gray-200/80 leading-relaxed",children:c.jsx(xz,{remarkPlugins:[RU],children:u.content})}),c.jsxs("div",{className:"text-xs text-gray-500 mt-3 pt-2 border-t border-gray-200/80",children:[c.jsxs("p",{children:["Author: ",u.authorName||"Admin"]}),c.jsxs("p",{children:["Created: ",a(u.createdAt)]}),u.updatedAt&&c.jsxs("p",{children:["Last Updated: ",a(u.updatedAt)]}),c.jsxs("p",{children:["Display Period: ",a(u.startDate)," to ",u.endDate?a(u.endDate):"Ongoing"]})]})]},u.id))})},oI=({db:n,userData:e,showNotification:t,viewOnly:r=!1})=>{const[s,o]=B.useState([]),[a,u]=B.useState(!0),[d,f]=B.useState(!1),[g,y]=B.useState(null),[x,w]=B.useState(!1),[E,S]=B.useState(null),[A,N]=B.useState(!1),[z,U]=B.useState(null),W=B.useCallback(async()=>{u(!0);try{const D=await lL(n,r);if(D.success)o(D.data||[]);else throw new Error(D.error)}catch{t("Failed to load announcements.","error")}finally{u(!1)}},[n,t,r]);B.useEffect(()=>{W()},[W]);const $=()=>{y(null),f(!0)},F=D=>{y(D),f(!0)},R=async D=>{w(!0);const C=await(g?J_(n,g.id,{...D,updatedBy:e.uid}):aL(n,{...D,createdBy:e.uid,authorName:e.displayName}));C.success?(t(`Announcement ${g?"updated":"created"} successfully!`,"success"),W(),f(!1)):t(`Failed to save announcement: ${C.error}`,"error"),w(!1)},k=D=>{U(D),N(!0)},P=async()=>{if(!z)return;S(z);const D=await cL(n,z);D.success?(t("Announcement deleted successfully!","success"),W()):t(`Failed to delete announcement: ${D.error}`,"error"),N(!1),U(null),S(null)},T=async D=>{S(D.id);const L=D.status==="active"?"archived":"active",C=await J_(n,D.id,{status:L,updatedBy:e.uid});C.success?(t(`Announcement status changed to ${L}.`,"success"),W()):t("Failed to update status: "+C.error,"error"),S(null)};return c.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-xl",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[c.jsx("h3",{className:"text-2xl font-semibold",children:r?"Company Announcements":"Manage Announcements"}),!r&&c.jsxs("button",{onClick:$,className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center",children:[c.jsx(rv,{size:18,className:"mr-2"})," New Announcement"]})]}),a?c.jsx(Nt,{message:"Loading Announcements..."}):c.jsx(PU,{announcements:s,onEdit:r?void 0:F,onDelete:r?void 0:k,onToggleStatus:r?void 0:T,actionLoadingId:E,viewOnly:r}),!r&&d&&c.jsx(Xr,{isOpen:d,onClose:()=>f(!1),title:g?"Edit Announcement":"Create Announcement",size:"full",children:c.jsx(a3,{initialData:g,onSubmit:R,onCancel:()=>f(!1),isSaving:x,showNotification:t})}),!r&&A&&c.jsx(Ha,{isOpen:A,onClose:()=>N(!1),onConfirm:P,title:"Confirm Deletion",isConfirming:!!E,children:"Are you sure you want to delete this announcement? This action cannot be undone."})]})},Fy=({data:n,title:e,color:t="bg-blue-500"})=>{if(!n||Object.keys(n).length===0)return c.jsxs("p",{className:"text-sm text-gray-500 text-center py-4",children:["No data available for ",e,"."]});const r=Object.values(n).reduce((o,a)=>o+a,0);if(r===0)return c.jsxs("p",{className:"text-sm text-gray-500 text-center py-4",children:["No data available for ",e,"."]});const s=Object.entries(n).sort(([,o],[,a])=>a-o);return c.jsxs("div",{className:"space-y-2",children:[c.jsx("h4",{className:"text-md font-semibold text-gray-700",children:e}),s.map(([o,a])=>{const u=r>0?a/r*100:0;return c.jsxs("div",{className:"text-xs",children:[c.jsxs("div",{className:"flex justify-between mb-0.5",children:[c.jsx("span",{className:"font-medium text-gray-600 capitalize",children:o.replace("_"," ")}),c.jsxs("span",{children:[a.toLocaleString()," (",u.toFixed(1),"%)"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:c.jsx("div",{className:`${t} h-2.5 rounded-full`,style:{width:`${u}%`}})})]},o)})]})},jU=({showNotification:n=console.log,userData:e})=>{var w;const[t,r]=B.useState(null),[s,o]=B.useState(!0),[a,u]=B.useState(""),d=B.useCallback(async()=>{o(!0),u("");try{const E=await Promise.allSettled([Bk(Kt),$k(Kt),QM(Kt),YM(Kt)]),[S,A,N,z]=E,U={};S.status==="fulfilled"&&S.value.success&&(U.usersByRole=S.value.data.byRole,U.totalUsers=S.value.data.total),A.status==="fulfilled"&&A.value.success&&(U.ticketStats=A.value.data),N.status==="fulfilled"&&N.value.success&&(U.monthlyRevenue=N.value.data),z.status==="fulfilled"&&z.value.success&&(U.paymentDayStats=z.value.data),r(U)}catch{u("A critical error occurred while fetching statistics.")}finally{o(!1)}},[]);B.useEffect(()=>{d()},[d]);const f=()=>{const E=document.getElementById("stats-print-area").innerHTML,S=window.open("","","height=800,width=1000");S.document.write("<html><head><title>AGWA System Analytics Report</title>"),S.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),S.document.write("<style>body {font-family: sans-serif;-webkit-print-color-adjust: exact !important; print-color-adjust: exact !important;} @media print { .no-print { display: none !important; } .print-section { page-break-inside: avoid; margin-bottom: 2rem; } }</style>"),S.document.write('</head><body class="p-8">'),S.document.write(E),S.document.write("</body></html>"),S.document.close(),setTimeout(()=>S.print(),500)},g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],y=t!=null&&t.monthlyRevenue?Object.values(t.monthlyRevenue).reduce((E,S)=>E+S,0):0,x=y/(t!=null&&t.monthlyRevenue?Object.keys(t.monthlyRevenue).length:1);return s?c.jsx(Nt,{message:"Loading system analytics...",className:"mt-10 h-64"}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200 no-print",children:[c.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[c.jsx(nv,{size:30,className:"mr-3 text-orange-600"})," System Analytics & Reports"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:d,disabled:s,className:"flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300",children:[s?c.jsx(Ge,{size:16,className:"animate-spin mr-2"}):c.jsx(Ko,{size:16,className:"mr-2"}),"Refresh"]}),c.jsxs("button",{onClick:f,className:"flex items-center bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-3 rounded-lg",children:[c.jsx(cv,{size:16,className:"mr-2"})," Print Report"]})]})]}),a&&c.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-4 my-4 flex items-center",role:"alert",children:[c.jsx(on,{size:20,className:"mr-3"}),c.jsx("p",{children:a})]}),c.jsxs("div",{id:"stats-print-area",children:[c.jsxs("header",{className:"hidden print:block text-center mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-blue-700",children:"AGWA System Analytics Report"}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Generated on: ",new Date().toLocaleString()]})]}),c.jsxs("div",{className:"space-y-8",children:[c.jsxs("section",{className:"print-section",children:[c.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-2 flex items-center",children:[c.jsx("span",{className:"font-bold text-2xl mr-2 text-green-600",children:""}),"Revenue Analysis"]}),c.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Total collected revenue over the displayed period is ",c.jsxs("strong",{children:["",y.toLocaleString("en-US",{minimumFractionDigits:2})]}),", with a monthly average of ",c.jsxs("strong",{children:["",x.toLocaleString("en-US",{minimumFractionDigits:2})]}),"."]}),c.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[c.jsx("h4",{className:"text-md font-semibold text-gray-700 mb-3",children:"Monthly Collected Revenue (PHP)"}),c.jsx("div",{className:"flex justify-between items-end h-[180px] space-x-2",children:(t==null?void 0:t.monthlyRevenue)&&Object.entries(t.monthlyRevenue).map(([E,S])=>{const A=Math.max(...Object.values(t.monthlyRevenue),1),N=S/A*150,[z,U]=E.split("-");return c.jsxs("div",{className:"flex flex-col items-center flex-1 h-full justify-end group",children:[c.jsxs("div",{className:"text-xs font-bold text-gray-500 group-hover:text-gray-800 transition-colors",children:["",Math.round(S/1e3),"k"]}),c.jsx("div",{className:"w-full bg-green-500 hover:bg-green-600 transition-all duration-200 rounded-t-sm",style:{height:`${N}px`},title:`${S.toFixed(2)}`}),c.jsx("div",{className:"text-xs font-medium text-gray-500 mt-1 border-t border-gray-300 w-full text-center pt-1",children:`${g[U-1]} '${z.slice(-2)}`})]},E)})})]})]}),c.jsxs("section",{className:"print-section grid grid-cols-1 md:grid-cols-2 gap-6 pt-6 border-t",children:[c.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[c.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-3 flex items-center",children:[c.jsx(Sc,{size:22,className:"mr-2 text-blue-600"}),"User Analysis"]}),c.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["There are currently ",c.jsx("strong",{children:(t==null?void 0:t.totalUsers)||0})," registered users in the system."]}),c.jsx(Fy,{data:t==null?void 0:t.usersByRole,title:"Users by Role",color:"bg-blue-500"})]}),c.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[c.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-3 flex items-center",children:[c.jsx(Wi,{size:22,className:"mr-2 text-purple-600"}),"Support Ticket Analysis"]}),c.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["A total of ",c.jsx("strong",{children:((w=t==null?void 0:t.ticketStats)==null?void 0:w.total)||0})," tickets have been created."]}),c.jsx(Fy,{data:t==null?void 0:t.ticketStats,title:"Tickets by Status",color:"bg-purple-500"})]})]}),c.jsx("section",{className:"print-section pt-6 border-t",children:c.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[c.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-3 flex items-center",children:[c.jsx(bL,{size:22,className:"mr-2 text-teal-600"}),"Payment Day Analysis"]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"This chart shows which days of the week are most popular for making payments."}),c.jsx(Fy,{data:t==null?void 0:t.paymentDayStats,title:"Peak Payment Days",color:"bg-teal-500"})]})})]})]})]})},DU=({isOpen:n,onClose:e,onSave:t,reading:r,isSaving:s,accountNumber:o})=>{const[a,u]=B.useState({});B.useEffect(()=>{var f;if(r){const g=(f=r.readingDate)!=null&&f.toDate?r.readingDate.toDate():new Date(r.readingDate),y=g.getFullYear(),x=String(g.getMonth()+1).padStart(2,"0"),w=String(g.getDate()).padStart(2,"0");u({readingValue:r.readingValue||"",readingDate:`${y}-${x}-${w}`,readingType:r.readingType||"Actual",notes:r.notes||""})}else u({readingValue:"",readingDate:new Date().toISOString().split("T")[0],readingType:"Actual",notes:""})},[r]);const d=f=>{f.preventDefault(),t(r==null?void 0:r.id,a)};return n?c.jsx(Xr,{isOpen:n,onClose:e,title:r?`Edit Reading for ${r.accountNumber}`:`Create New Reading for ${o}`,children:c.jsxs("form",{onSubmit:d,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"readingValue",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[c.jsx(Bo,{size:14,className:"mr-1.5"}),"Reading Value (m)"]}),c.jsx("input",{type:"number",name:"readingValue",value:a.readingValue,onChange:f=>u({...a,readingValue:f.target.value}),className:Nr,step:"0.01",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"readingDate",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[c.jsx(wc,{size:14,className:"mr-1.5"}),"Reading Date"]}),c.jsx("input",{type:"date",name:"readingDate",value:a.readingDate,onChange:f=>u({...a,readingDate:f.target.value}),className:Nr,required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"readingType",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[c.jsx(TL,{size:14,className:"mr-1.5"}),"Reading Type"]}),c.jsxs("select",{name:"readingType",value:a.readingType,onChange:f=>u({...a,readingType:f.target.value}),className:Nr,children:[c.jsx("option",{value:"Actual",children:"Actual"}),c.jsx("option",{value:"Estimated",children:"Estimated"}),c.jsx("option",{value:"No Reading",children:"No Reading"})]})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"notes",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[c.jsx(GL,{size:14,className:"mr-1.5"}),"Notes"]}),c.jsx("textarea",{name:"notes",rows:"3",value:a.notes,onChange:f=>u({...a,notes:f.target.value}),className:Nr})]}),c.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg border",disabled:s,children:"Cancel"}),c.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg flex items-center",disabled:s,children:[s?c.jsx(Ge,{size:18,className:"animate-spin mr-2"}):c.jsx(Qo,{size:18,className:"mr-2"}),s?"Saving...":"Save Changes"]})]})]})}):null},MU=({showNotification:n,userData:e})=>{var ce,ue,Q;const[t,r]=B.useState(""),[s,o]=B.useState(null),[a,u]=B.useState(!1),[d,f]=B.useState(""),[g,y]=B.useState(!1),[x,w]=B.useState(null),[E,S]=B.useState(!1),[A,N]=B.useState(null),[z,U]=B.useState(!1),[W,$]=B.useState(!1),F=async Z=>{if(Z.preventDefault(),!t.trim()){f("Please enter an account number.");return}u(!0),f(""),y(!0),o(null);try{const M=at(Kt,jr()),q=ft(M,ot("accountNumber","==",t.trim().toUpperCase())),ne=await St(q);if(ne.empty){f("No user found with the provided account number."),u(!1);return}const V=ne.docs[0];await R({id:V.id,...V.data()})}catch(M){console.error("Error searching for user or readings:",M),f("An error occurred during the search. Check Firestore rules and indexes."),u(!1)}},R=async Z=>{const M=at(Kt,Go()),q=ft(M,ot("userId","==",Z.id),si("readingDate","desc")),V=(await St(q)).docs.map(de=>({id:de.id,...de.data()}));o({user:Z,readings:V}),u(!1)},k=Z=>{S(!1),w(Z)},P=()=>{if(!(s!=null&&s.user)){n("Please search for a user first before creating a reading.","warning");return}w(null),S(!0)},T=()=>{w(null),S(!1)},D=async(Z,M)=>{U(!0);const q=await dL(Kt,Z,M);q.success?(n("Meter reading updated successfully!","success"),await R(s.user),T()):n(q.error||"Failed to update reading.","error"),U(!1)},L=async(Z,M)=>{U(!0);const q={...M,userId:s.user.id,accountNumber:s.user.accountNumber,meterSerialNumber:s.user.meterSerialNumber||"N/A",readBy:e.displayName||"Admin",readerId:e.uid},ne=await zk(Kt,q);ne.success?(n("New meter reading created successfully!","success"),await R(s.user),T()):n(ne.error||"Failed to create reading.","error"),U(!1)},C=async()=>{if(!(s!=null&&s.user)){n("Please search for a user first.","error");return}$(!0);const Z=await Lk(Kt,s.user.id,s.user);Z.success?n(Z.message,"success"):n(Z.error,"error"),$(!1)},G=Z=>{N(Z)},K=async()=>{if(!A)return;U(!0);const Z=await hL(Kt,A);Z.success?(n("Meter reading deleted successfully!","success"),await R(s.user)):n(Z.error||"Failed to delete reading.","error"),N(null),U(!1)};return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[c.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Meter Reading & Billing"}),c.jsxs("form",{onSubmit:F,className:"mb-6 flex flex-col sm:flex-row gap-2 items-center bg-gray-50 p-4 rounded-lg shadow-sm",children:[c.jsx("input",{type:"text",value:t,onChange:Z=>r(Z.target.value),placeholder:"Enter user account number...",className:"w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500"}),c.jsxs("button",{type:"submit",disabled:a,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:bg-blue-400 flex items-center justify-center w-full sm:w-auto",children:[a?c.jsx(Ge,{className:"animate-spin mr-2"}):c.jsx(ps,{className:"mr-2",size:18}),a?"Searching...":"Search"]})]}),d&&c.jsx("p",{className:"text-red-500 text-center mb-4",children:d}),a&&c.jsx(Nt,{message:"Fetching data..."}),(s==null?void 0:s.user)&&c.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-md mt-6 border border-gray-200",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-3",children:[c.jsxs("h2",{className:"text-xl font-semibold",children:["Data for ",s.user.displayName," (",s.user.accountNumber,")"]}),c.jsxs("div",{className:"flex gap-2 flex-wrap",children:[c.jsxs("button",{onClick:P,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 flex items-center text-sm",children:[c.jsx(rv,{size:16,className:"mr-2"})," Create Reading"]}),c.jsxs("button",{onClick:C,className:"bg-cyan-600 text-white px-4 py-2 rounded-md hover:bg-cyan-700 flex items-center text-sm disabled:bg-gray-400",disabled:W||s.readings.length<2,title:s.readings.length<2?"At least 2 readings are required to generate a bill":"Generate bill from latest reading",children:[W?c.jsx(Ge,{size:16,className:"animate-spin mr-2"}):c.jsx(Uo,{size:16,className:"mr-2"}),W?"Generating...":"Generate Bill"]})]})]}),c.jsxs("div",{className:"overflow-x-auto",children:[c.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reading (m)"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reader"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),c.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(ce=s.readings)==null?void 0:ce.map(Z=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-4 whitespace-nowrap font-medium",children:Z.readingValue}),c.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:bt(Z.readingDate,{year:"numeric",month:"short",day:"numeric"})}),c.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:Z.readBy||"N/A"}),c.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:Z.readingType||"N/A"}),c.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-center space-x-2",children:[c.jsx("button",{onClick:()=>k(Z),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-md transition-colors",title:"Edit Reading",children:c.jsx(dv,{size:16})}),c.jsx("button",{onClick:()=>G(Z.id),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-100 rounded-md transition-colors",title:"Delete Reading",children:c.jsx(Oc,{size:16})})]})]},Z.id))})]}),((ue=s.readings)==null?void 0:ue.length)<2&&c.jsx("p",{className:"text-xs text-center text-yellow-600 bg-yellow-50 p-2 mt-2 rounded-md",children:"Note: At least two readings are needed before a bill can be generated."})]})]}),(x||E)&&c.jsx(DU,{isOpen:!0,onClose:T,onSave:E?L:D,reading:x,isSaving:z,accountNumber:(Q=s==null?void 0:s.user)==null?void 0:Q.accountNumber}),A&&c.jsx(Ha,{isOpen:!!A,onClose:()=>N(null),onConfirm:K,title:"Confirm Deletion",confirmText:"Yes, Delete",isConfirming:z,iconType:"danger",children:"Are you sure you want to permanently delete this meter reading? This action cannot be undone."})]})},$l="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition-150 text-sm",LU=({isOpen:n,onClose:e,onSave:t,route:r,readers:s,isSaving:o,db:a})=>{const[u,d]=B.useState({name:"",areaCode:"",description:"",assignedReaderId:"",district:"",barangay:""}),[f,g]=B.useState([]),[y,x]=B.useState([]),[w,E]=B.useState([]),[S,A]=B.useState(!1);B.useEffect(()=>{if(n)if(x(fv()),r){const R=r.district||"";d({name:r.name||"",areaCode:r.areaCode||"",description:r.description||"",assignedReaderId:r.assignedReaderId||"",district:R,barangay:r.barangay||""}),R&&E(Ic(R)),g(r.accountNumbers||[])}else d({name:"",areaCode:"",description:"",assignedReaderId:"",district:"",barangay:""}),g([]),E([])},[r,n]);const N=R=>{const k=R.target.value;d(P=>({...P,district:k,barangay:""})),E(Ic(k)),g([])},z=async R=>{const k=R.target.value;if(d(P=>({...P,barangay:k})),k){A(!0);const P=await qM(a,k);P.success&&g(P.data),A(!1)}else g([])},U=R=>R?R.split(" ").map(k=>k[0]).join("").toUpperCase():"",W=R=>{const k=R.target.value;d(P=>({...P,name:k,areaCode:U(k)}))},$=R=>{const{name:k,value:P}=R.target;d(T=>({...T,[k]:P}))},F=R=>{R.preventDefault(),t({name:u.name,areaCode:u.areaCode,description:u.description,assignedReaderId:u.assignedReaderId,district:u.district,barangay:u.barangay,accountNumbers:f})};return c.jsx(Xr,{isOpen:n,onClose:e,title:r?"Edit Meter Route":"Create New Meter Route",size:"2xl",children:c.jsxs("form",{onSubmit:F,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-1",children:"Route Name"}),c.jsx("input",{type:"text",name:"name",value:u.name,onChange:W,className:$l,required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"areaCode",className:"block text-sm font-medium mb-1",children:"Generated Area Code"}),c.jsx("input",{type:"text",name:"areaCode",value:u.areaCode,className:`${$l} bg-gray-200`,readOnly:!0})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"district",className:"block text-sm font-medium mb-1",children:"District"}),c.jsxs("select",{name:"district",value:u.district,onChange:N,className:$l,required:!0,children:[c.jsx("option",{value:"",children:"Select District"}),y.map(R=>c.jsx("option",{value:R,children:R},R))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"barangay",className:"block text-sm font-medium mb-1",children:"Barangay"}),c.jsxs("select",{name:"barangay",value:u.barangay,onChange:z,className:$l,required:!0,disabled:!u.district,children:[c.jsx("option",{value:"",children:"Select Barangay"}),w.map(R=>c.jsx("option",{value:R,children:R},R))]})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"assignedReaderId",className:"block text-sm font-medium mb-1",children:"Assign to Meter Reader"}),c.jsxs("select",{name:"assignedReaderId",value:u.assignedReaderId,onChange:$,className:$l,children:[c.jsx("option",{value:"",children:"Unassigned"}),s.map(R=>c.jsxs("option",{value:R.id,children:[R.displayName," (",R.email,")"]},R.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"description",className:"block text-sm font-medium mb-1",children:"Description"}),c.jsx("textarea",{name:"description",value:u.description,onChange:$,rows:"2",className:$l})]}),c.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[c.jsxs("p",{className:"text-sm font-medium text-blue-800 flex items-center",children:[c.jsx(OL,{size:16,className:"mr-2"}),"Auto-Assigned Accounts"]}),S?c.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[c.jsx(Ge,{className:"animate-spin h-4 w-4 mr-2"}),"Searching for accounts..."]}):u.barangay&&f.length>0?c.jsxs("p",{className:"text-sm text-gray-700",children:[f.length," accounts found for ",u.barangay," and will be assigned."]}):u.barangay&&f.length===0?c.jsxs("p",{className:"text-sm text-orange-700 bg-orange-100 p-2 rounded-md flex items-center",children:[c.jsx(on,{size:14,className:"mr-2"}),"No accounts found for this location. You cannot save an empty route."]}):c.jsx("p",{className:"text-xs text-gray-500",children:"Select a location to find and assign real accounts from your database."})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium bg-gray-200 rounded-lg",disabled:o,children:"Cancel"}),c.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg flex items-center disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:o||S||f.length===0,children:[o?c.jsx(Ge,{size:18,className:"animate-spin mr-2"}):c.jsx(Qo,{size:18,className:"mr-2"}),o?"Saving...":"Save Route"]})]})]})})},OU=({db:n,showNotification:e})=>{const[t,r]=B.useState([]),[s,o]=B.useState([]),[a,u]=B.useState(!0),[d,f]=B.useState(""),[g,y]=B.useState(!1),[x,w]=B.useState(null),[E,S]=B.useState(!1),[A,N]=B.useState(null),z=B.useCallback(async()=>{u(!0),f("");try{const[k,P]=await Promise.all([WM(n),KM(n)]);k.success?r(k.data):f(k.error||"Failed to load routes."),P.success?o(P.data):f(T=>T+(P.error||" Failed to load meter readers."))}catch{f("An unexpected error occurred while fetching data.")}u(!1)},[n]);B.useEffect(()=>{z()},[z]);const U=(k=null)=>{w(k),y(!0)},W=()=>{w(null),y(!1)},$=async k=>{S(!0);const P=await HM(n,k,x==null?void 0:x.id);P.success?(e(`Route ${x?"updated":"created"} successfully!`,"success"),z(),W()):e(P.error||"Failed to save route.","error"),S(!1)},F=async()=>{if(!A)return;S(!0);const k=await GM(n,A.id);k.success?(e("Route deleted successfully!","success"),N(null),z()):e(k.error||"Failed to delete route.","error"),S(!1)},R=k=>{var P;return((P=s.find(T=>T.id===k))==null?void 0:P.displayName)||"Unassigned"};return a?c.jsx(Nt,{message:"Loading route data..."}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[c.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[c.jsx(_d,{size:30,className:"mr-3 text-blue-600"})," Meter Route Management"]}),c.jsxs("button",{onClick:()=>U(),className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center",children:[c.jsx(rv,{size:18,className:"mr-2"})," Add New Route"]})]}),d&&c.jsx("p",{className:"text-red-500 mb-4",children:d}),c.jsx("div",{className:"space-y-3",children:t.length>0?t.map(k=>{var P;return c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsxs("p",{className:"font-bold text-gray-800",children:[k.name," ",c.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",k.areaCode,")"]})]}),c.jsxs("p",{className:"text-xs text-gray-600 flex items-center mt-1",children:[c.jsx(ZL,{size:12,className:"mr-1.5"}),"Assigned to: ",c.jsx("span",{className:"font-medium ml-1",children:R(k.assignedReaderId)})]}),c.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Accounts: ",((P=k.accountNumbers)==null?void 0:P.length)||0]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("button",{onClick:()=>U(k),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-full",children:c.jsx(dv,{size:18})}),c.jsx("button",{onClick:()=>N(k),className:"p-2 text-red-600 hover:bg-red-100 rounded-full",children:c.jsx(Oc,{size:18})})]})]},k.id)}):c.jsxs("div",{className:"text-center py-10",children:[c.jsx(on,{size:48,className:"mx-auto text-gray-400 mb-3"}),c.jsx("p",{className:"text-gray-500",children:"No routes found. Click 'Add New Route' to create one."})]})}),g&&c.jsx(LU,{isOpen:g,onClose:W,onSave:$,route:x,readers:s,isSaving:E,db:n}),A&&c.jsxs(Ha,{isOpen:!!A,onClose:()=>N(null),onConfirm:F,title:"Confirm Route Deletion",isConfirming:E,children:['Are you sure you want to delete the route "',A.name,'"? This action cannot be undone.']})]})},FU=({db:n,showNotification:e})=>{const[t,r]=B.useState([]),[s,o]=B.useState(""),[a,u]=B.useState([]),[d,f]=B.useState(!1),[g,y]=B.useState(!1),[x,w]=B.useState([]);B.useEffect(()=>{(async()=>{const N=await $M(n);N.success?r(N.data):e(N.error,"error")})()},[n,e]);const E=async A=>{if(o(A),!A){u([]);return}f(!0),u([]);const N=await eL(n,A);N.success?u(N.data):e(N.error,"error"),f(!1)},S=async()=>{if(a.length===0){e("No billable accounts in the selected area.","warning");return}y(!0),w([]);const A=await tL(n,a);w(A),y(!1),e("Batch billing process completed. Check logs for details.","success"),E(s)};return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[c.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center mb-4",children:[c.jsx(Uo,{size:30,className:"mr-3 text-green-600"})," Batch Bill Generation"]}),c.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Select a service area to find eligible accounts and generate bills in bulk. An account is eligible if it has a new reading that has not yet been billed."}),c.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[c.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Service Area (Barangay)"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[c.jsxs("select",{id:"location",value:s,onChange:A=>E(A.target.value),className:"w-full p-2 border rounded-md bg-white",children:[c.jsx("option",{value:"",children:"-- Select an Area --"}),t.map(A=>c.jsx("option",{value:A,children:A},A))]}),c.jsxs("button",{onClick:S,className:"bg-green-600 text-white px-5 py-2 rounded-md flex items-center justify-center whitespace-nowrap disabled:bg-gray-400",disabled:d||g||a.length===0,children:[g?c.jsx(Ge,{size:18,className:"animate-spin mr-2"}):c.jsx(IL,{size:18,className:"mr-2"}),g?"Processing...":`Generate ${a.length} Bills`]})]})]}),c.jsxs("div",{className:"mt-6",children:[c.jsxs("h3",{className:"font-semibold",children:["Eligible Accounts in ",s||"..."]}),d&&c.jsx(Nt,{message:"Finding billable accounts..."}),!d&&s&&a.length===0&&c.jsxs("div",{className:"text-center py-6 bg-gray-50 mt-2 rounded-md",children:[c.jsx(on,{size:32,className:"mx-auto text-gray-400 mb-2"}),c.jsx("p",{className:"text-gray-600",children:"No new readings eligible for billing in this area."})]}),!d&&a.length>0&&c.jsxs("p",{className:"text-green-700 font-medium my-2",children:[a.length," accounts ready for billing."]})]}),x.length>0&&c.jsxs("div",{className:"mt-6 pt-4 border-t",children:[c.jsx("h3",{className:"font-semibold mb-2",children:"Processing Log"}),c.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto bg-gray-900 text-white font-mono text-xs p-4 rounded-md",children:x.map((A,N)=>c.jsxs("div",{className:`flex items-start ${A.success?"text-green-400":"text-red-400"}`,children:[A.success?c.jsx(Li,{size:14,className:"mr-2 mt-0.5 flex-shrink-0"}):c.jsx(Yt,{size:14,className:"mr-2 mt-0.5 flex-shrink-0"}),c.jsx("span",{children:A.message})]},N))})]})]})},VU=({userData:n,db:e,showNotification:t,setActiveSection:r})=>{const[s,o]=B.useState({assignedRoutesCount:0,totalAccountsInRoutes:0,pendingReadingsInRoutes:0,readingsCompletedToday:0,issuesReportedByMe:0}),[a,u]=B.useState(!0),[d,f]=B.useState(""),g=B.useCallback(async()=>{if(!n||!n.uid){t("Meter reader data not available.","error"),u(!1);return}u(!0),f("");try{const x={};let w="";const E=await Uk(e,n.uid);E.success&&E.data?(x.assignedRoutesCount=E.data.length,x.totalAccountsInRoutes=E.data.reduce((z,U)=>{var W;return z+(U.accountCount||((W=U.accountNumbers)==null?void 0:W.length)||0)},0),x.pendingReadingsInRoutes=E.data.reduce((z,U)=>z+(U.pendingCount||0),0)):w+="Route data unavailable. ";const S=new Date().toISOString().split("T")[0],A=await XM(e,n.uid,S);A.success?x.readingsCompletedToday=A.data.count:w+="Today's readings data unavailable. ";const N=await Fk(e,n.uid);N.success&&(x.issuesReportedByMe=N.data.length),o(z=>({...z,...x})),w&&(f(w.trim()),t("Some dashboard statistics could not be loaded.","warning"))}catch{const w="Could not load meter reader dashboard statistics. Please try refreshing.";f(w),t(w,"error")}finally{u(!1)}},[e,n,t]);B.useEffect(()=>{g()},[g]);const y=[{title:"View Assigned Routes",icon:_d,section:"assignedRoutes",description:"Check your daily routes and assigned accounts for reading.",color:"blue"},{title:"Manual Reading Entry",icon:sv,section:"searchAndSubmitReading",description:"Submit a reading for an account not on your immediate list.",color:"green"},{title:"Search Customer Info",icon:ps,section:"searchCustomerMeterReader",description:"Look up customer or meter details for verification.",color:"teal"},{title:"Report Field Issue",icon:Yt,section:"reportIssue",description:"Log issues like meter damage, leaks, or access problems.",color:"orange"}];return a?c.jsx(Nt,{message:"Loading your dashboard...",className:"mt-10 h-48"}):c.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[c.jsx("div",{className:"p-6 bg-gradient-to-r from-sky-600 to-cyan-700 text-white rounded-xl shadow-xl",children:c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Meter Reader Dashboard"}),c.jsxs("p",{className:"mt-1 text-sky-100",children:["Welcome, ",n.displayName||"Meter Reader","! Your tasks and tools are below."]})]}),c.jsxs("button",{onClick:g,className:"mt-3 sm:mt-0 text-sm flex items-center bg-sky-500 hover:bg-sky-400 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70 self-start sm:self-center",disabled:a,title:"Refresh Statistics",children:[a?c.jsx(Ge,{size:16,className:"animate-spin"}):c.jsx(Ko,{size:16}),c.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),d&&c.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center my-4 flex items-center justify-center gap-2",children:[c.jsx(on,{size:16})," ",d]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5",children:[c.jsx(or,{title:"Assigned Routes",value:s.assignedRoutesCount,icon:_d,borderColor:"border-blue-500",iconColor:"text-blue-500",onClick:()=>r("assignedRoutes")}),c.jsx(or,{title:"Pending Readings",value:s.pendingReadingsInRoutes,icon:LL,borderColor:"border-orange-500",iconColor:"text-orange-500",subtext:`Across ${s.totalAccountsInRoutes} total accounts`,onClick:()=>r("assignedRoutes")}),c.jsx(or,{title:"Readings Done Today",value:s.readingsCompletedToday,icon:Li,borderColor:"border-green-500",iconColor:"text-green-500"}),c.jsx(or,{title:"My Reported Issues",value:s.issuesReportedByMe,icon:Yt,borderColor:"border-red-500",iconColor:"text-red-500",onClick:()=>r("myTickets")})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Your Tools & Actions"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:y.map(x=>c.jsxs("button",{onClick:()=>r(x.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${x.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[c.jsx("div",{className:`p-3 bg-${x.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:c.jsx(x.icon,{size:28,className:`text-${x.color}-600`})}),c.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${x.color}-700 transition-colors`,children:x.title}),c.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:x.description})]},x.section))})]}),c.jsxs("div",{className:"mt-8 p-5 bg-gray-50 rounded-xl shadow",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[c.jsx(Yt,{size:20,className:"mr-2 text-yellow-500"})," Important Notices / Route Highlights"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"No specific system notices for your routes today. Please ensure all readings are accurate and submitted on time. Report any discrepancies or issues immediately. Stay safe and hydrated!"})]})]})},Du="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",p2=({db:n,userData:e,showNotification:t,customerToRead:r,onReadingSubmitted:s,isModalMode:o=!1,onCloseModal:a})=>{const[u,d]=B.useState(""),[f,g]=B.useState(!1),[y,x]=B.useState(""),[w,E]=B.useState(r||null),[S,A]=B.useState(""),[N,z]=B.useState(new Date().toISOString().split("T")[0]),[U,W]=B.useState("Actual"),[$,F]=B.useState(""),[R,k]=B.useState(!1),P=async L=>{if(L.preventDefault(),!u.trim()){t("Please enter a search term.","warning");return}g(!0),x(""),E(null);const C=await cp(n,u);C.success&&C.data.length>0?E(C.data[0]):C.success?x(`No customer found matching "${u}".`):x(C.error||"Failed to execute user search."),g(!1)},T=async L=>{if(L.preventDefault(),!w){t("No customer selected. Please search for a customer first.","error");return}if(!S||isNaN(parseFloat(S))||parseFloat(S)<0){t("Meter reading must be a valid, non-negative number.","warning");return}k(!0);const C={userId:w.id,accountNumber:w.accountNumber,meterSerialNumber:w.meterSerialNumber||"N/A",readingValue:parseFloat(S),readingDate:N,readingDateString:N,readingType:U,notes:$.trim(),readBy:e.displayName||e.email,readerId:e.uid},G=await zk(n,C);G.success?o&&s?s(G.id,C):(t(`Reading for ${w.accountNumber} submitted successfully!`,"success"),d(""),E(null),A(""),F(""),W("Actual")):t(G.error||"Failed to submit meter reading.","error"),k(!1)},D=["Actual","Estimated","No Reading","Customer Refused","Unable to Access Meter"];return c.jsxs("div",{className:o?"":"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[!o&&c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(sv,{size:30,className:"mr-3 text-blue-600"})," Search & Submit Reading"]})}),!w&&!o&&c.jsxs("form",{onSubmit:P,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow-sm",children:[c.jsx("label",{htmlFor:"customerSearchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:"Find Customer to Read"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[c.jsxs("div",{className:"relative flex-grow",children:[c.jsx(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",id:"customerSearchTerm",value:u,onChange:L=>d(L.target.value),className:`${Du} pl-9`,placeholder:"Search by Account No, Name, or Meter No...",disabled:f})]}),c.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center",disabled:f,children:[f?c.jsx(Ge,{size:18,className:"animate-spin mr-2"}):c.jsx(ps,{size:18,className:"mr-2"}),"Find"]})]}),y&&c.jsx("p",{className:"text-red-500 text-xs mt-2",children:y})]}),f&&c.jsx(Nt,{message:"Searching..."}),w&&c.jsxs("form",{onSubmit:T,className:"space-y-5 p-4 border-t-4 border-blue-500 bg-blue-50 rounded-lg shadow-md animate-fadeIn",children:[c.jsxs("div",{className:"p-3 border border-blue-200 bg-white rounded-md text-sm space-y-1",children:[c.jsxs("p",{className:"font-semibold text-blue-800 flex items-center",children:[c.jsx(ms,{size:16,className:"mr-2"}),w.displayName]}),c.jsxs("p",{className:"text-gray-600 flex items-center",children:[c.jsx(Oi,{size:14,className:"mr-2"}),"Account No: ",w.accountNumber]}),c.jsxs("p",{className:"text-gray-600 flex items-center",children:[c.jsx(Bo,{size:14,className:"mr-2"}),"Meter No: ",w.meterSerialNumber||"N/A"]})]}),c.jsxs("fieldset",{disabled:R,className:"space-y-5",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"readingValue",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Meter Reading (m)*"}),c.jsx("input",{type:"number",id:"readingValue",value:S,onChange:L=>A(L.target.value),className:Du,step:"0.01",required:!0})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"readingDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reading Date*"}),c.jsx("input",{type:"date",id:"readingDate",value:N,onChange:L=>z(L.target.value),className:Du,required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"readingType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reading Type*"}),c.jsx("select",{id:"readingType",value:U,onChange:L=>W(L.target.value),className:Du,required:!0,children:D.map(L=>c.jsx("option",{value:L,children:L},L))})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes / Remarks"}),c.jsx("textarea",{id:"notes",value:$,onChange:L=>F(L.target.value),rows:"3",className:Du,placeholder:"e.g., Meter obstructed, Dog on premises..."})]})]}),c.jsxs("div",{className:"flex gap-3",children:[o&&c.jsx("button",{type:"button",onClick:a,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2.5 px-6 rounded-lg",disabled:R,children:"Cancel"}),c.jsxs("button",{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center disabled:opacity-60",disabled:R,children:[R?c.jsx(Ge,{size:20,className:"animate-spin mr-2"}):c.jsx(Qo,{size:20,className:"mr-2"}),R?"Submitting...":"Submit Reading"]})]})]})]})},zU="w-full px-3 py-2 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",UU=({db:n,userData:e,showNotification:t})=>{const[r,s]=B.useState([]),[o,a]=B.useState(null),[u,d]=B.useState([]),[f,g]=B.useState(!0),[y,x]=B.useState(!1),[w,E]=B.useState(""),[S,A]=B.useState(""),[N,z]=B.useState(null),[U,W]=B.useState(!1),[$,F]=B.useState(""),R=B.useCallback(async(G=!0)=>{if(!e||!e.uid){E("Meter reader ID not available. Cannot fetch routes."),g(!1);return}G&&g(!0),E("");const K=await Uk(n,e.uid);if(K.success){const ce=K.data.map(ue=>{var Q,Z,M;return{...ue,accountCount:ue.accountCount||((Q=ue.accountNumbers)==null?void 0:Q.length)||((Z=ue.accountIds)==null?void 0:Z.length)||0,completedCount:ue.completedReadingsToday||0,pendingCount:Math.max(0,(ue.accountCount||((M=ue.accountNumbers)==null?void 0:M.length)||0)-(ue.completedReadingsToday||0))}});s(ce.sort((ue,Q)=>(ue.name||"").localeCompare(Q.name||"")))}else{const ce=K.error||"Failed to fetch assigned routes.";E(ce),s([])}G&&g(!1)},[n,e]);B.useEffect(()=>{R()},[R]);const k=B.useCallback(async G=>{if(!G)return;x(!0),A("");const K=await JM(n,G);if(K.success){const ce=new Date().toISOString().split("T")[0],ue=await Promise.all(K.data.map(async Q=>{var ne;let Z={readingValue:"N/A",readingDate:null},M=!1;const q=await fL(n,Q.accountNumber);if(q.success&&q.data.length>0){const V=q.data[0];Z.readingValue=V.readingValue,Z.readingDate=(ne=V.readingDate)!=null&&ne.toDate?V.readingDate.toDate():new Date(V.readingDate),V.readingDate.toDate().toISOString().split("T")[0]===ce&&(M=!0)}return{...Q,lastReading:Z.readingValue,lastReadingDateDisplay:Z.readingDate?bt(Z.readingDate,{month:"short",day:"numeric"}):"N/A",readingStatus:M?"Completed Today":"Pending"}}));d(ue.sort((Q,Z)=>{var M,q;return(((M=Q.serviceAddress)==null?void 0:M.street)||"").localeCompare(((q=Z.serviceAddress)==null?void 0:q.street)||"")}))}else{const ce=K.error||`Failed to fetch accounts for route ${G.name}.`;A(ce),d([])}x(!1)},[n]),P=G=>{(o==null?void 0:o.id)!==(G==null?void 0:G.id)&&(a(G),F(""),d([]),G&&k(G))},T=G=>{z(G),W(!0)},D=(G,K)=>{if(t(`Reading for ${K.accountNumber} submitted successfully.`,"success"),d(ce=>ce.map(ue=>ue.accountNumber===K.accountNumber?{...ue,readingStatus:"Completed Today",lastReading:K.readingValue,lastReadingDateDisplay:bt(new Date,{month:"short",day:"numeric"})}:ue)),o){const ce=r.map(Q=>{if(Q.id===o.id){const Z=(Q.completedCount||0)+1;return{...Q,completedCount:Z,pendingCount:Math.max(0,Q.accountCount-Z)}}return Q});s(ce);const ue=ce.find(Q=>Q.id===o.id);ue&&a(ue)}W(!1),z(null)},L=G=>!G||typeof G!="object"?"N/A":[G.street,G.barangay,G.district].filter(ce=>ce&&ce.trim()).join(", "),C=u.filter(G=>{var ue,Q,Z;const K=$.toLowerCase(),ce=L(G.serviceAddress).toLowerCase();return((ue=G.displayName)==null?void 0:ue.toLowerCase().includes(K))||((Q=G.accountNumber)==null?void 0:Q.toLowerCase().includes(K))||ce.includes(K)||((Z=G.meterSerialNumber)==null?void 0:Z.toLowerCase().includes(K))});return f?c.jsx(Nt,{message:"Loading your assigned routes...",className:"mt-10 h-64"}):w&&r.length===0?c.jsxs("div",{className:"text-center py-10 bg-red-50 p-4 rounded-lg",children:[c.jsx(Yt,{size:48,className:"mx-auto text-red-400 mb-3"}),c.jsx("p",{className:"text-red-600 text-lg font-semibold",children:"Error Loading Routes"}),c.jsx("p",{className:"text-sm text-red-500 mt-1",children:w})]}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(_d,{size:30,className:"mr-3 text-blue-600"})," Assigned Routes & Meter Reading"]}),c.jsxs("button",{onClick:()=>R(!1),className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:f||y,title:"Refresh Route List",children:[c.jsx(Ko,{size:16,className:`mr-1.5 ${f?"animate-spin":""}`}),"Refresh Routes"]})]}),r.length===0&&!f&&!w&&c.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-lg p-4",children:[c.jsx(on,{size:48,className:"mx-auto text-gray-400 mb-3"}),c.jsx("p",{className:"text-gray-500 text-lg",children:"No routes are currently assigned to you."})]}),r.length>0&&c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[c.jsxs("div",{className:"lg:col-span-1 bg-slate-50 p-3.5 rounded-lg shadow-md max-h-[75vh] overflow-y-auto",children:[c.jsxs("h3",{className:"text-md font-semibold text-slate-700 mb-3 sticky top-0 bg-slate-50 py-2 z-10 border-b border-slate-200",children:["My Routes (",r.length,")"]}),c.jsx("div",{className:"space-y-2.5",children:r.map(G=>c.jsxs("button",{onClick:()=>P(G),className:`w-full text-left p-3 rounded-lg border-2 transition-all duration-200 transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-offset-1
                                        ${(o==null?void 0:o.id)===G.id?"bg-blue-600 text-white shadow-lg border-blue-700 ring-blue-500":"bg-white hover:bg-blue-50 border-gray-200 hover:border-blue-400"}`,children:[c.jsx("p",{className:`font-semibold text-sm ${(o==null?void 0:o.id)===G.id?"text-white":"text-blue-700"}`,children:G.name}),c.jsxs("p",{className:`text-xs mt-0.5 ${(o==null?void 0:o.id)===G.id?"text-blue-100":"text-gray-500"}`,children:["Area: ",G.areaCode||"N/A"]}),c.jsxs("div",{className:"mt-1.5 text-xs",children:[c.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-white text-[10px] ${(G.pendingCount||0)>0?"bg-orange-500":"bg-green-500"}`,children:(G.pendingCount||0)===0&&G.accountCount>0?"All Read":`${G.pendingCount} Pending`}),c.jsxs("span",{className:`ml-1.5 ${(o==null?void 0:o.id)===G.id?"text-blue-200":"text-gray-400"}`,children:["(",G.completedCount||0," / ",G.accountCount||0,")"]})]})]},G.id))})]}),c.jsxs("div",{className:"lg:col-span-3",children:[!o&&!y&&c.jsxs("div",{className:"p-6 text-center text-gray-400 bg-slate-50 rounded-lg shadow-inner h-full flex flex-col justify-center items-center min-h-[300px]",children:[c.jsx(Qk,{size:48,className:"mb-3 opacity-70"}),c.jsx("p",{className:"text-lg",children:"Please select a route to view accounts."})]}),o&&y&&c.jsx(Nt,{message:`Loading accounts for ${o.name}...`,className:"min-h-[300px]"}),o&&!y&&c.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg shadow-md",children:[c.jsxs("div",{className:"pb-2 mb-3 border-b border-slate-200",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-700",children:["Accounts in: ",o.name]}),c.jsx("p",{className:"text-xs text-slate-500",children:o.description||"No route description provided."})]}),c.jsxs("div",{className:"relative mb-4",children:[c.jsx(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"}),c.jsx("input",{type:"text",placeholder:"Search by Name, Account No, Address...",value:$,onChange:G=>F(G.target.value),className:`${zU} pl-9`})]}),S&&c.jsx("p",{className:"text-sm text-red-500 text-center py-3 bg-red-50 rounded-md",children:S}),c.jsx("div",{className:"space-y-3 max-h-[65vh] overflow-y-auto pr-1 pb-2",children:C.length>0?C.map(G=>c.jsxs("div",{className:`p-3.5 border rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center transition-shadow hover:shadow-md 
                                            ${G.readingStatus==="Completed Today"?"bg-green-50 border-green-300":"bg-white border-gray-200 hover:border-blue-400"}`,children:[c.jsxs("div",{className:"flex-grow mb-2 sm:mb-0",children:[c.jsxs("p",{className:"font-medium text-slate-800 text-sm",children:[G.displayName," ",c.jsxs("span",{className:"text-xs text-slate-500 font-mono",children:["(",G.accountNumber,")"]})]}),c.jsx("p",{className:"text-xs text-slate-600 mt-0.5",children:L(G.serviceAddress)}),c.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:["Meter: ",G.meterSerialNumber," | Last Reading: ",G.lastReading||"N/A"," on ",G.lastReadingDateDisplay]}),c.jsxs("p",{className:`text-xs font-semibold mt-1 ${G.readingStatus==="Completed Today"?"text-green-600":"text-orange-600"}`,children:["Status: ",G.readingStatus]})]}),c.jsxs("button",{onClick:()=>T(G),className:`text-xs font-medium py-1.5 px-3.5 rounded-md flex items-center transition-colors active:scale-95 whitespace-nowrap
                                                    ${G.readingStatus==="Completed Today"?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,title:G.readingStatus==="Completed Today"?"Review or Edit Reading":"Submit New Reading",children:[c.jsx(lv,{size:13,className:"mr-1.5"})," ",G.readingStatus==="Completed Today"?"Edit":"Enter Reading"]})]},G.id||G.accountNumber)):c.jsxs("div",{className:"py-6 text-center text-gray-500",children:[c.jsx(ms,{size:36,className:"mx-auto mb-2 text-gray-400"}),"No accounts ",$?"match your search.":"found for this route."]})})]})]})]}),U&&N&&c.jsx(Xr,{isOpen:U,onClose:()=>{W(!1),z(null)},title:`Meter Reading: ${N.displayName} (${N.accountNumber})`,size:"lg",children:c.jsx(p2,{db:n,userData:e,showNotification:t,customerToRead:N,onReadingSubmitted:D,isModalMode:!0,onCloseModal:()=>{W(!1),z(null)}})})]})},BU="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",$U=({db:n,showNotification:e})=>{const[t,r]=B.useState(""),[s,o]=B.useState(null),[a,u]=B.useState(!1),[d,f]=B.useState(""),g=async w=>{if(w.preventDefault(),!t.trim()){e("Please enter a search term (Account No., Name, or Meter No.).","warning");return}u(!0),f(""),o(null);try{const E=await cp(n,t);E.success&&E.data.length>0?o(E.data[0]):E.success?f(`No customer found matching "${t}".`):f(E.error||"Failed to search for users.")}catch{f("An error occurred during the search.")}u(!1)},y=w=>!w||typeof w!="object"?w||"N/A":[w.street,w.barangay,w.district,"Quezon City"].filter(S=>S&&S.trim()).join(", "),x=({label:w,value:E,icon:S})=>c.jsxs("div",{className:"flex items-start py-2 border-b border-gray-100",children:[S&&c.jsx(S,{size:16,className:"mr-2.5 text-blue-500 flex-shrink-0 mt-0.5"}),c.jsxs("span",{className:"text-xs font-medium text-gray-500 w-32 sm:w-40",children:[w,":"]}),c.jsx("span",{className:"text-sm text-gray-800 flex-1 break-words",children:E||"N/A"})]});return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(ps,{size:30,className:"mr-3 text-blue-600"})," Search Customer Profile"]})}),c.jsxs("form",{onSubmit:g,className:"mb-8 p-4 bg-gray-50 rounded-lg shadow",children:[c.jsx("label",{htmlFor:"customerSearchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:"Find Customer"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[c.jsxs("div",{className:"relative flex-grow",children:[c.jsx(ms,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",id:"customerSearchTerm",value:t,onChange:w=>r(w.target.value),className:`${BU} pl-9`,placeholder:"Account No, Name, or Meter No."})]}),c.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center sm:w-auto w-full",disabled:a,children:[a?c.jsx(Ge,{size:18,className:"animate-spin mr-2"}):c.jsx(ps,{size:18,className:"mr-2"}),"Search Customer"]})]}),d&&c.jsx("p",{className:"text-red-600 text-xs mt-2",children:d})]}),a&&c.jsx(Nt,{message:"Searching for customer..."}),!a&&s&&c.jsxs("div",{className:"mt-6 p-5 border border-blue-200 bg-blue-50 rounded-lg shadow-md animate-fadeIn",children:[c.jsx("h3",{className:"text-xl font-semibold text-blue-700 mb-4 border-b border-blue-200 pb-2",children:"Customer Details"}),c.jsxs("div",{className:"space-y-1",children:[c.jsx(x,{label:"Account Name",value:s.displayName,icon:ms}),c.jsx(x,{label:"Account Number",value:s.accountNumber,icon:Oi}),c.jsx(x,{label:"Email Address",value:s.email,icon:Fi}),c.jsx(x,{label:"Service Address",value:y(s.serviceAddress),icon:_c}),c.jsx(x,{label:"Meter Serial No.",value:s.meterSerialNumber,icon:Bo}),c.jsx(x,{label:"Meter Size",value:s.meterSize,icon:Bo}),c.jsx(x,{label:"Service Type",value:s.serviceType,icon:on}),c.jsx(x,{label:"Account Status",value:s.accountStatus,icon:s.accountStatus==="Active"?Li:Yt})]})]})]})},qU=({userData:n,showNotification:e,setActiveSection:t,db:r})=>{const[s,o]=B.useState({paymentsTodayCount:0,totalCollectedToday:0,avgPaymentAmount:0}),[a,u]=B.useState([]),[d,f]=B.useState(!0),[g,y]=B.useState(""),x=B.useCallback(async()=>{if(!n||!n.uid){f(!1),y("Clerk user data is not available.");return}f(!0),y("");try{const A=await gL(r,n.uid);if(A.success&&A.data){const{paymentsTodayCount:N,totalCollectedToday:z,transactions:U}=A.data,W=U.reduce(($,F)=>{const R=F.paymentMethod||"Other";return $[R]=($[R]||0)+(F.amountPaid||0),$},{});o({paymentsTodayCount:N,totalCollectedToday:z,avgPaymentAmount:N>0?z/N:0,paymentMethodSummary:W}),u(U)}else y(A.error||"Today's payment data unavailable.")}catch{y("Could not load clerk dashboard statistics. Please try refreshing.")}finally{f(!1)}},[n,r]);B.useEffect(()=>{x()},[x]);const w=()=>{const A=document.getElementById("eod-report-content").innerHTML,N=window.open("","","height=800,width=1000");N.document.write("<html><head><title>End-of-Day Report</title>"),N.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),N.document.write("<style>body {font-family: Arial, sans-serif;-webkit-print-color-adjust: exact !important; print-color-adjust: exact !important;} @media print {.no-print{display:none;} .printable-area { padding: 1rem; } }</style>"),N.document.write('</head><body><div class="printable-area">'),N.document.write(A),N.document.write("</div></body></html>"),N.document.close(),setTimeout(()=>N.print(),500)},E=[{title:"Process Walk-in Payment",icon:xm,section:"walkInPayments",description:"Record payments for customers paying in person at the counter.",color:"blue"},{title:"Search Account / Bill",icon:iv,section:"searchAccountOrBill",description:"Look up customer account details, outstanding bills, or payment history.",color:"teal"}],S=()=>c.jsx("span",{className:"font-bold",children:""});return d?c.jsx(Nt,{message:"Loading clerk dashboard...",className:"mt-10 h-48"}):c.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[c.jsx("div",{className:"p-6 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl shadow-xl no-print",children:c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Clerk / Cashier Dashboard"}),c.jsxs("p",{className:"mt-1 text-indigo-100",children:["Welcome, ",n.displayName||"Clerk","! Manage payments and customer inquiries."]})]}),c.jsxs("button",{onClick:x,className:"mt-3 sm:mt-0 text-sm flex items-center bg-indigo-400 hover:bg-indigo-300 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70 self-start sm:self-center",disabled:d,title:"Refresh Statistics",children:[d?c.jsx(Ge,{size:16,className:"animate-spin"}):c.jsx(Ko,{size:16}),c.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),g&&c.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center my-4 flex items-center justify-center gap-2 no-print",children:[c.jsx(on,{size:16})," ",g]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 no-print",children:[c.jsx(or,{title:"Payments Today",value:s.paymentsTodayCount,icon:xm,borderColor:"border-green-500",iconColor:"text-green-500",onClick:()=>{var A;return(A=document.getElementById("eod-report-wrapper"))==null?void 0:A.scrollIntoView({behavior:"smooth"})}}),c.jsx(or,{title:"Total Collected Today",value:`${s.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})}`,icon:S,borderColor:"border-emerald-500",iconColor:"text-emerald-500"}),c.jsx(or,{title:"Avg. Payment Today",value:`${s.avgPaymentAmount.toLocaleString("en-US",{minimumFractionDigits:2})}`,icon:S,borderColor:"border-teal-500",iconColor:"text-teal-500"})]}),c.jsxs("div",{className:"no-print",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Primary Tasks"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:E.map(A=>c.jsxs("button",{onClick:()=>t(A.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${A.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[c.jsx("div",{className:`p-3 bg-${A.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:c.jsx(A.icon,{size:28,className:`text-${A.color}-600`})}),c.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${A.color}-700 transition-colors`,children:A.title}),c.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:A.description})]},A.section))})]}),c.jsxs("div",{id:"eod-report-wrapper",className:"mt-8 p-5 bg-gray-50 rounded-xl shadow",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4 no-print",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-700 flex items-center",children:[c.jsx(bc,{size:20,className:"mr-2 text-gray-500"})," Shift Summary / End-of-Day Report"]}),c.jsxs("button",{onClick:w,className:"flex items-center bg-blue-500 text-white text-xs font-semibold px-3 py-1.5 rounded-lg hover:bg-blue-600 transition-colors",children:[c.jsx(cv,{size:14,className:"mr-1.5"})," Print Report"]})]}),c.jsxs("div",{id:"eod-report-content",className:"bg-white p-6 rounded-lg border text-gray-800",children:[c.jsxs("header",{className:"flex justify-between items-start pb-4 border-b-2 border-gray-700",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-blue-700",children:"AGWA"}),c.jsx("p",{className:"text-sm text-gray-500 italic",children:"End-of-Day Clerk Report"})]}),c.jsxs("div",{className:"text-right text-sm",children:[c.jsxs("p",{children:[c.jsx("span",{className:"font-semibold",children:"Cashier:"})," ",n.displayName]}),c.jsxs("p",{children:[c.jsx("span",{className:"font-semibold",children:"Date:"})," ",bt(new Date,{year:"numeric",month:"long",day:"numeric"})]}),c.jsxs("p",{children:[c.jsx("span",{className:"font-semibold",children:"Report Generated:"})," ",bt(new Date,{hour:"2-digit",minute:"2-digit"})]})]})]}),c.jsxs("section",{className:"my-6",children:[c.jsx("h2",{className:"text-lg font-semibold mb-3 text-center",children:"Shift Summary"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[c.jsx("p",{className:"text-sm text-blue-700 uppercase font-semibold",children:"Total Collected"}),c.jsxs("p",{className:"text-2xl font-bold text-blue-800",children:["",s.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),c.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg text-center",children:[c.jsx("p",{className:"text-sm text-gray-600 uppercase font-semibold",children:"Total Transactions"}),c.jsx("p",{className:"text-2xl font-bold",children:s.paymentsTodayCount})]}),c.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg text-center",children:[c.jsx("p",{className:"text-sm text-gray-600 uppercase font-semibold",children:"Average Transaction"}),c.jsxs("p",{className:"text-2xl font-bold",children:["",s.avgPaymentAmount.toLocaleString("en-US",{minimumFractionDigits:2})]})]})]}),s.paymentMethodSummary&&Object.keys(s.paymentMethodSummary).length>0&&c.jsxs("div",{className:"mt-4 p-4 border rounded-lg",children:[c.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Collection by Payment Method:"}),c.jsx("div",{className:"text-xs space-y-1",children:Object.entries(s.paymentMethodSummary).map(([A,N])=>c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{children:[A,":"]}),c.jsxs("span",{className:"font-medium",children:["",N.toLocaleString("en-US",{minimumFractionDigits:2})]})]},A))})]})]}),c.jsxs("section",{className:"mt-6",children:[c.jsx("h2",{className:"text-lg font-semibold mb-3 text-center",children:"Transaction Details"}),a.length>0?c.jsx("div",{className:"overflow-x-auto border rounded-lg",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Time"}),c.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Account #"}),c.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Ref #"}),c.jsx("th",{className:"px-4 py-2 text-right font-semibold text-gray-600",children:"Amount (PHP)"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(A=>{var N,z;return c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:bt((N=A.paymentTimestamp)==null?void 0:N.toDate(),{hour:"2-digit",minute:"2-digit",second:"2-digit"})}),c.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-mono",children:A.accountNumber}),c.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-mono text-xs",children:A.paymentReference}),c.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-right font-semibold",children:["",(z=A.amountPaid)==null?void 0:z.toFixed(2)]})]},A.id)})})]})}):c.jsx("p",{className:"text-sm text-gray-500 text-center py-6 bg-gray-50 rounded-md",children:"No payments have been processed yet today."})]}),c.jsx("footer",{className:"mt-12 pt-8",children:c.jsx("div",{className:"w-1/2 sm:w-1/3 border-t-2 border-gray-400 text-center mx-auto pt-2",children:c.jsx("p",{className:"text-xs text-gray-600",children:"Cashier's Signature"})})})]})]})]})},Mu="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",HU=({db:n,userData:e,showNotification:t,billingService:r})=>{const[s,o]=B.useState(""),[a,u]=B.useState(null),[d,f]=B.useState([]),[g,y]=B.useState(null),[x,w]=B.useState(""),[E,S]=B.useState("Cash"),[A,N]=B.useState(""),[z,U]=B.useState(!1),[W,$]=B.useState(!1),[F,R]=B.useState(!1),[k,P]=B.useState(null),[T,D]=B.useState(""),L=async Q=>{if(Q&&Q.preventDefault(),!s.trim()){t("Please enter an Account Number to search.","warning");return}U(!0),D(""),u(null),f([]),y(null),w(""),P(null);try{const Z=await cp(n,s.trim());if(Z.success&&Z.data.length>0){const M=Z.data.find(q=>q.accountNumber.toLowerCase()===s.trim().toLowerCase());M?(u(M),C(M.id,M.accountNumber)):D(`No customer found with Account Number: "${s}".`)}else D(`No customer found with Account Number: "${s}".`)}catch{D("An error occurred during customer search.")}U(!1)},C=async(Q,Z)=>{$(!0);const M=await up(n,Q);if(M.success){const q=M.data.filter(ne=>ne.status==="Unpaid").sort((ne,V)=>{var de,xe;return new Date(((de=ne.dueDate)==null?void 0:de.toDate())||0)-new Date(((xe=V.dueDate)==null?void 0:xe.toDate())||0)});f(q),q.length===0&&t(`No unpaid bills found for Account #${Z}.`,"info")}else t(M.error||"Failed to fetch customer bills.","error");$(!1)};B.useEffect(()=>{var Q;if(g)w(((Q=g.amount)==null?void 0:Q.toFixed(2))||"");else if(d.length===0)w("");else if(d.length>0&&!d.find(Z=>Z.id===(g==null?void 0:g.id))){const Z=d.reduce((M,q)=>M+(q.amount||0),0);w(Z>0?Z.toFixed(2):"")}},[g,d]);const G=async Q=>{if(Q.preventDefault(),!g&&d.length===0){t("No bill selected or available for payment.","warning");return}const Z=parseFloat(x);if(isNaN(Z)||Z<=0){t("Please enter a valid payment amount.","warning");return}if(E!=="Cash"&&!A.trim()){t("Reference number is required for this payment method.","warning");return}R(!0),P(null);const M=g||d.find(q=>q.status==="Unpaid");if(!M){t("Cannot determine which bill to pay. Please select a bill.","warning"),R(!1);return}try{const q=Gn(),ne=new Date,V=await Vk(n,M.id,{status:"Paid",paymentDate:ne,paymentTimestamp:q,amountPaid:Z,paymentMethod:E,paymentReference:A.trim()||`CASH-${Date.now().toString().slice(-8)}`,processedByClerkId:e.uid,processedByClerkName:e.displayName});if(!V.success)throw new Error(V.error||"Failed to update bill status.");const de={customerName:a.displayName,accountNumber:a.accountNumber,serviceAddress:a.serviceAddress,billId:M.id,billMonthYear:M.monthYear||M.billingPeriod,amountPaid:Z,paymentDate:ne,paymentMethod:E,referenceNumber:A.trim()||`CASH-${Date.now().toString().slice(-8)}`,processedBy:e.displayName,receiptId:`OR-${Date.now()}`};P(de),t(`Payment of ${Z.toFixed(2)} processed successfully!`,"success"),w(""),N(""),y(null),C(a.id,a.accountNumber)}catch(q){t(q.message||"An error occurred while processing the payment.","error")}R(!1)},K=()=>{const Q=document.getElementById("payment-receipt-content");if(Q){const Z=window.open("","_blank","height=800,width=1000");Z.document.write("<html><head><title>AGWA Payment Receipt</title>"),Z.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),Z.document.write(`
                <style>
                    body { font-family: 'Inter', sans-serif; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                    .paid-stamp {
                        position: absolute;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-30deg);
                        font-size: 4rem;
                        font-weight: bold;
                        color: rgba(0, 128, 0, 0.15);
                        z-index: -1;
                        letter-spacing: 0.1em;
                        border: 8px solid rgba(0, 128, 0, 0.15);
                        padding: 0.5em 1em;
                        border-radius: 10px;
                        text-transform: uppercase;
                    }
                    .no-print { display: none; }
                </style>
            `),Z.document.write('</head><body class="bg-gray-100 p-4">'),Z.document.write(Q.innerHTML),Z.document.write("</body></html>"),Z.document.close(),setTimeout(()=>Z.print(),700)}},ce=["Cash","Check","Card (Debit/Credit)","E-wallet (GCash/Maya)"],ue=({label:Q,value:Z})=>c.jsxs("div",{className:"flex justify-between py-1.5 text-sm border-b border-gray-200 last:border-b-0",children:[c.jsxs("span",{className:"text-gray-500",children:[Q,":"]}),c.jsx("span",{className:"font-medium text-gray-800 text-right",children:Z})]});return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[!k&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(xm,{size:30,className:"mr-3 text-green-600"})," Process Walk-in Payment"]})}),c.jsxs("form",{onSubmit:L,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow",children:[c.jsx("label",{htmlFor:"accountNumberSearch",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Customer by Account Number"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[c.jsxs("div",{className:"relative flex-grow",children:[c.jsx(Oi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",id:"accountNumberSearch",value:s,onChange:Q=>o(Q.target.value),className:`${Mu} pl-9`,placeholder:"Enter Account Number"})]}),c.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-5 rounded-lg flex items-center justify-center sm:w-auto w-full",disabled:z,children:[z?c.jsx(Ge,{size:18,className:"animate-spin mr-2"}):c.jsx(ps,{size:18,className:"mr-2"})," Find Customer"]})]}),T&&!z&&c.jsx("p",{className:"text-red-500 text-xs mt-2",children:T})]})]}),z&&c.jsx(Nt,{message:"Searching for customer..."}),a&&!k&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"mb-6 p-4 border border-blue-200 bg-blue-50 rounded-lg shadow",children:[c.jsxs("h3",{className:"text-lg font-semibold text-blue-700 mb-2 flex items-center",children:[c.jsx(ms,{size:20,className:"mr-2"})," ",a.displayName,c.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",a.accountNumber,")"]})]}),W&&c.jsx(Nt,{message:"Loading bills..."}),!W&&d.length===0&&c.jsx("p",{className:"text-sm text-green-600 mt-2",children:"No unpaid bills found for this customer."}),!W&&d.length>0&&c.jsxs("div",{className:"mt-3",children:[c.jsx("label",{htmlFor:"selectBill",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Bill to Pay (or pay total outstanding):"}),c.jsxs("select",{id:"selectBill",className:Mu,value:g?g.id:"",onChange:Q=>{const Z=d.find(M=>M.id===Q.target.value);y(Z||null)},children:[c.jsx("option",{value:"",children:"Pay Total Unpaid / Select Specific Bill"}),d.map(Q=>{var Z,M;return c.jsxs("option",{value:Q.id,children:[Q.monthYear||Q.billingPeriod," - ",(Z=Q.amount)==null?void 0:Z.toFixed(2)," (Due: ",bt((M=Q.dueDate)==null?void 0:M.toDate(),{month:"short",day:"numeric"}),")"]},Q.id)})]})]})]}),(d.length>0||g)&&c.jsxs("form",{onSubmit:G,className:"space-y-5 p-4 border border-gray-200 rounded-lg",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-1",children:"Payment Details"}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"paymentAmount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount to Pay (PHP) *"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:""}),c.jsx("input",{type:"number",id:"paymentAmount",value:x,onChange:Q=>w(Q.target.value),className:`${Mu} pl-7`,step:"0.01",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"paymentMethod",className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),c.jsx("select",{id:"paymentMethod",value:E,onChange:Q=>S(Q.target.value),className:Mu,required:!0,children:ce.map(Q=>c.jsx("option",{value:Q,children:Q},Q))})]}),E!=="Cash"&&c.jsxs("div",{children:[c.jsx("label",{htmlFor:"referenceNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference / Transaction No. *"}),c.jsx("input",{type:"text",id:"referenceNumber",value:A,onChange:Q=>N(Q.target.value),className:Mu,placeholder:"e.g., Check No., Card Approval Code",required:!0})]}),c.jsxs("button",{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-5 rounded-lg flex items-center justify-center transition-colors active:scale-95",disabled:F||!x||parseFloat(x)<=0,children:[F?c.jsx(Ge,{size:20,className:"animate-spin mr-2"}):c.jsx(Li,{size:20,className:"mr-2"}),F?"Processing...":"Process Payment"]})]})]}),k&&c.jsxs("div",{className:"mt-6 p-6 bg-green-50 rounded-lg",children:[c.jsxs("div",{className:"text-center mb-5",children:[c.jsx(Li,{size:48,className:"mx-auto text-green-500 mb-2"}),c.jsx("h3",{className:"text-2xl font-semibold text-green-800",children:"Payment Successful!"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Official Receipt has been generated."})]}),c.jsxs("div",{id:"payment-receipt-content",className:"p-6 bg-white rounded-lg shadow-lg max-w-2xl mx-auto font-sans relative overflow-hidden",children:[c.jsx("div",{className:"paid-stamp",children:"PAID"}),c.jsxs("div",{className:"flex justify-between items-start mb-5 pb-4 border-b-2 border-blue-700",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-3xl font-bold text-blue-700",children:"AGWA"}),c.jsx("div",{className:"text-xs text-blue-600 italic",children:"Ensuring Clarity, Sustaining Life."})]}),c.jsxs("div",{className:"text-right text-xs",children:[c.jsx("p",{className:"font-semibold",children:"AGWA Water Services, Inc."}),c.jsx("p",{children:"123 Aqua Drive, Hydro Business Park"}),c.jsx("p",{children:"Quezon City, Metro Manila, Philippines 1101"})]})]}),c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("h4",{className:"text-xl font-bold text-gray-800",children:"OFFICIAL RECEIPT"}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Receipt No: ",k.receiptId]})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx(ue,{label:"Received From",value:k.customerName}),c.jsx(ue,{label:"Account Number",value:k.accountNumber})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx(ue,{label:"Payment For",value:`Water Bill - ${k.billMonthYear}`}),c.jsx(ue,{label:"Payment Date",value:bt(k.paymentDate,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})}),c.jsx(ue,{label:"Payment Method",value:k.paymentMethod}),k.referenceNumber&&!k.referenceNumber.startsWith("CASH-")&&c.jsx(ue,{label:"Reference No.",value:k.referenceNumber})]}),c.jsxs("div",{className:"mt-4 p-3 bg-gray-100 rounded-lg flex justify-between items-center",children:[c.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"AMOUNT PAID"}),c.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["",k.amountPaid.toFixed(2)]})]}),c.jsx("div",{className:"mt-4 pt-4 border-t border-dashed",children:c.jsx(rA,{value:k.receiptId})}),c.jsxs("div",{className:"text-xs text-gray-500 mt-4",children:[c.jsxs("p",{children:["Cashier: ",k.processedBy]}),c.jsx("p",{children:"This is a system-generated receipt. Thank you for your payment."})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3 mt-6 no-print",children:[c.jsxs("button",{onClick:K,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center justify-center",children:[c.jsx(cv,{size:18,className:"mr-2"})," Print Receipt"]}),c.jsx("button",{onClick:()=>{P(null),o(""),u(null),f([]),y(null)},className:"bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-lg flex items-center justify-center",children:"Process Another Payment"})]})]})]})},WU=({db:n,showNotification:e,billingService:t})=>{var k;const[r,s]=B.useState("account"),[o,a]=B.useState(""),[u,d]=B.useState(null),[f,g]=B.useState([]),[y,x]=B.useState(!1),[w,E]=B.useState(""),[S,A]=B.useState(null),[N,z]=B.useState(null),U="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition-150 text-sm placeholder-gray-400",W=async P=>{if(P.preventDefault(),!o.trim()){e("Please enter a search term.","warning");return}x(!0),E(""),d(null),g([]),A(null),z(null);try{if(r==="account"){const T=await cp(n,o.trim());if(T.success&&T.data.length>0){const D=T.data[0];d(D);const L=await up(n,D.id);L.success?g(L.data.sort((C,G)=>{var K,ce;return(((K=G.billDate)==null?void 0:K.toDate())||0)-(((ce=C.billDate)==null?void 0:ce.toDate())||0)})):e("Could not fetch bills for the user.","warning")}else T.success?E(`No account found matching "${o}".`):E(T.error||"Failed to search accounts.")}else{const T=await mL(n,(void 0)(),[where("id","==",o.trim())]);if(T.success&&T.data.length>0){const D=T.data[0];if(d(D),D.userId){const L=await ZM(n,D.userId);L.success&&z(L.data)}}else T.success?E(`No bill found matching invoice/bill ID "${o}".`):E(T.error||"Failed to search bills.")}}catch{E("An error occurred during the search.")}x(!1)},$=(P,T)=>{A(P),z(T||(u&&r==="account"?u:null))},F=P=>!P||typeof P!="object"?P||"N/A":[P.street,P.barangay,P.district,"Quezon City"].filter(D=>D&&D.trim()).join(", "),R=({label:P,value:T,icon:D,valueClass:L="text-gray-800"})=>c.jsxs("div",{className:"flex items-start py-1.5",children:[D&&c.jsx(D,{size:16,className:"mr-2.5 text-blue-500 flex-shrink-0 mt-0.5"}),c.jsxs("span",{className:"text-xs font-medium text-gray-500 w-32 sm:w-40",children:[P,":"]}),c.jsx("span",{className:`text-sm ${L} flex-1 break-words`,children:T||"N/A"})]});return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(iv,{size:30,className:"mr-3 text-indigo-600"})," Search Account / Bill"]})}),c.jsxs("form",{onSubmit:W,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-end",children:[c.jsxs("div",{className:"flex-grow",children:[c.jsx("label",{htmlFor:"searchType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search For"}),c.jsxs("select",{id:"searchType",value:r,onChange:P=>{s(P.target.value),a(""),d(null),g([]),E("")},className:U,children:[c.jsx("option",{value:"account",children:"Customer Account"}),c.jsx("option",{value:"bill",children:"Specific Bill (Invoice #)"})]})]}),c.jsxs("div",{className:"flex-grow-[2]",children:[c.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:r==="account"?"Account No, Name, or Email":"Invoice Number or Bill ID"}),c.jsxs("div",{className:"relative",children:[c.jsx(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",id:"searchTerm",value:o,onChange:P=>a(P.target.value),className:`${U} pl-9`,placeholder:`Enter ${r==="account"?"details...":"invoice #..."}`})]})]}),c.jsxs("button",{type:"submit",className:"bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center sm:w-auto w-full transition-colors",disabled:y,children:[y?c.jsx(Ge,{size:18,className:"animate-spin mr-2"}):c.jsx(ps,{size:18,className:"mr-2"}),"Search"]})]}),w&&!y&&c.jsx("p",{className:"text-red-500 text-xs mt-2",children:w})]}),y&&c.jsx(Nt,{message:"Searching..."}),!y&&u&&c.jsxs("div",{className:"mt-6 p-5 border border-indigo-200 bg-indigo-50 rounded-lg shadow-md animate-fadeIn",children:[r==="account"&&c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:"text-xl font-semibold text-indigo-700 mb-3 border-b border-indigo-200 pb-2",children:"Account Details"}),c.jsxs("div",{className:"space-y-1 mb-4",children:[c.jsx(R,{label:"Name",value:u.displayName,icon:ms}),c.jsx(R,{label:"Account No",value:u.accountNumber,icon:Oi,valueClass:"font-mono"}),c.jsx(R,{label:"Email",value:u.email,icon:Fi}),c.jsx(R,{label:"Status",value:u.accountStatus,icon:on,valueClass:`font-semibold ${u.accountStatus==="Active"?"text-green-600":"text-red-600"}`}),c.jsx(R,{label:"Service Address",value:F(u.serviceAddress),icon:_c})]}),c.jsxs("h4",{className:"text-md font-semibold text-indigo-600 mt-4 mb-2",children:["Recent Bills (",f.length,")"]}),f.length>0?c.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 pr-2",children:f.map(P=>{var T;return c.jsxs("div",{className:`p-2.5 border rounded-md flex justify-between items-center text-xs ${P.status==="Paid"?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[c.jsxs("div",{children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Period:"})," ",P.monthYear||P.billingPeriod]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Amount:"})," ",(T=P.amount)==null?void 0:T.toFixed(2)]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Due:"})," ",bt(P.dueDate,{month:"short",day:"numeric",year:"numeric"})]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Status:"})," ",c.jsx("span",{className:`font-semibold ${P.status==="Paid"?"text-green-700":"text-red-700"}`,children:P.status})]})]}),c.jsxs("button",{onClick:()=>$(P,u),className:"text-indigo-600 hover:text-indigo-800 hover:bg-indigo-100 p-1.5 rounded-md text-xs",children:[c.jsx(Uo,{size:16,className:"inline mr-1"}),"View Invoice"]})]},P.id)})}):c.jsx("p",{className:"text-sm text-gray-500",children:"No bills found for this account."})]}),r==="bill"&&c.jsxs(c.Fragment,{children:[c.jsxs("h3",{className:"text-xl font-semibold text-indigo-700 mb-3 border-b border-indigo-200 pb-2",children:["Bill Details (Invoice: ",u.invoiceNumber||u.id,")"]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx(R,{label:"Account No",value:u.accountNumber,icon:Oi,valueClass:"font-mono"}),N&&c.jsx(R,{label:"Customer Name",value:N.displayName,icon:ms}),c.jsx(R,{label:"Bill Period",value:u.monthYear||u.billingPeriod,icon:wc}),c.jsx(R,{label:"Amount Due",value:`${(k=u.amount)==null?void 0:k.toFixed(2)}`,icon:AL,valueClass:"font-bold"}),c.jsx(R,{label:"Due Date",value:bt(u.dueDate,{month:"long",day:"numeric",year:"numeric"}),icon:wc}),c.jsx(R,{label:"Status",value:u.status,icon:on,valueClass:`font-semibold ${u.status==="Paid"?"text-green-600":"text-red-600"}`}),u.status==="Paid"&&c.jsx(R,{label:"Paid Date",value:bt(u.paymentDate),icon:Li})]}),c.jsxs("button",{onClick:()=>$(u,N),className:"mt-4 bg-indigo-500 hover:bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg flex items-center text-sm",children:[c.jsx(Uo,{size:16,className:"mr-2"})," View Full Invoice"]})]})]}),!y&&!u&&o&&!w&&c.jsxs("div",{className:"mt-6 p-5 text-center text-gray-500 bg-gray-50 rounded-lg",children:[c.jsx(on,{size:32,className:"mx-auto mb-2 text-gray-400"}),'No results found for "',o,'". Please refine your search.']}),S&&N&&c.jsx(cA,{isOpen:!!S,onClose:()=>{A(null)},bill:S,userData:N,calculateBillDetails:t})]})},GU=({db:n,user:e,userData:t,showNotification:r})=>{const[s,o]=B.useState([]),[a,u]=B.useState(!0),[d,f]=B.useState(""),[g,y]=B.useState({}),[x,w]=B.useState(null),[E,S]=B.useState(null),A=B.useCallback(async()=>{u(!0),f("");const $=await Fk(n,e.uid);$.success?o($.data):(f($.error||"Failed to fetch your support tickets."),r($.error||"Failed to fetch tickets.","error")),u(!1)},[n,e.uid,r]);B.useEffect(()=>{A()},[A]);const N=($,F)=>{y(R=>({...R,[$]:F}))},z=async $=>{const F=g[$];if(!F||!F.trim()){r("Reply cannot be empty.","warning");return}w($);const R={text:F,authorId:e.uid,authorName:t.displayName,authorRole:t.role,timestamp:mt.fromDate(new Date)},k=await Ok(n,$,R);k.success?(r("Reply sent successfully!","success"),y(P=>({...P,[$]:""})),A()):r(k.error||"Failed to send reply.","error"),w(null)},U=async $=>{const F=g[$]||"";if(!F.trim()){r("Please write a draft or some keywords for the AI to assist with.","warning");return}S($);try{const R=`You are helping a customer write a formal reply to a support ticket. Refine the following draft to be clear, polite, and concise. Do not add any extra commentary. Just provide the refined message.

My draft: "${F}"`,k=await Vi(R);N($,k),r("AI has refined your reply!","success")}catch(R){r(R.message||"AI assistance failed.","error")}finally{S(null)}},W=$=>{switch($){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"Resolved":case"Closed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-600"}};return a?c.jsx(Nt,{message:"Loading your support tickets..."}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Wi,{size:30,className:"mr-3 text-purple-600"})," My Support Tickets"]}),c.jsx("button",{onClick:A,disabled:a,className:"flex items-center text-sm p-2 bg-gray-100 rounded-lg hover:bg-gray-200",children:c.jsx(Ko,{size:16,className:a?"animate-spin":""})})]}),d&&c.jsx("div",{className:"text-red-500 bg-red-50 p-3 rounded-md text-center",children:d}),s.length===0&&!d&&c.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[c.jsx(on,{size:48,className:"mx-auto text-gray-400 mb-4"}),c.jsx("p",{className:"text-gray-600 text-lg",children:"You have not submitted any support tickets."}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"You can report an issue from your dashboard."})]}),c.jsx("div",{className:"space-y-4",children:s.map($=>c.jsxs("details",{className:"p-4 rounded-lg shadow-md border-l-4 bg-gray-50 border-purple-400 group",children:[c.jsxs("summary",{className:"flex flex-wrap justify-between items-center gap-2 cursor-pointer",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-md font-semibold text-gray-800",children:$.issueType}),c.jsxs("p",{className:"text-xs text-gray-500",children:["Submitted: ",bt($.submittedAt,{month:"long",day:"numeric"})]})]}),c.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${W($.status)}`,children:$.status})]}),c.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200 text-sm text-gray-700 space-y-3",children:[c.jsxs("div",{children:[c.jsx("strong",{className:"text-xs text-gray-500",children:"Your Initial Report:"}),c.jsx("p",{className:"p-2 bg-white border rounded-md whitespace-pre-line text-xs",children:$.description})]}),$.conversation&&$.conversation.length>0&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("strong",{className:"text-xs text-gray-500",children:"Conversation History:"}),c.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border bg-white p-2 rounded-md",children:$.conversation.map((F,R)=>c.jsxs("div",{className:`p-2 rounded-lg text-xs ${F.authorRole==="admin"?"bg-blue-50":"bg-green-50"}`,children:[c.jsxs("p",{className:"font-bold text-gray-800",children:[F.authorName,":"]}),c.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-line",children:F.text}),c.jsx("p",{className:"text-right text-gray-500 mt-1",children:bt(F.timestamp)})]},R))})]}),c.jsxs("div",{className:"pt-2",children:[c.jsx("label",{className:"text-xs font-semibold text-gray-600",children:"Send a Reply:"}),c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx("textarea",{value:g[$.id]||"",onChange:F=>N($.id,F.target.value),placeholder:"Type your reply...",className:"w-full p-2 border rounded-md text-sm flex-grow",rows:"3"}),c.jsx(bm,{text:"Type a draft first, then use AI to refine it.",children:c.jsx("button",{onClick:()=>U($.id),className:"p-2 bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:E===$.id||!(g[$.id]||"").trim(),title:"Refine reply with AI",children:E===$.id?c.jsx(Ge,{size:20,className:"animate-spin"}):c.jsx(Kr,{size:20})})})]}),c.jsxs("button",{onClick:()=>z($.id),className:"mt-2 w-full sm:w-auto flex items-center justify-center bg-blue-600 text-white font-semibold py-2 px-4 rounded-md text-xs hover:bg-blue-700 disabled:opacity-60",disabled:x===$.id||!(g[$.id]||"").trim(),children:[x===$.id?c.jsx(Ge,{size:14,className:"animate-spin mr-2"}):c.jsx(dp,{size:14,className:"mr-2"}),"Send Reply"]})]})]})]},$.id))})]})},Nn=({onNavigateHome:n})=>c.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 bg-gray-50 rounded-lg shadow-md m-4",children:[c.jsx(kL,{size:48,className:"text-yellow-500 mb-4"}),c.jsx("h1",{className:"text-2xl font-bold text-gray-700 mb-2",children:"404 - Page Not Found"}),c.jsx("p",{className:"text-gray-600 mb-4 max-w-md",children:"The page you are looking for does not exist or has been moved."}),n&&c.jsxs("button",{onClick:n,className:"flex items-center justify-center px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow hover:shadow-md transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",children:[c.jsx(ov,{size:16,className:"mr-2"}),"Go to Dashboard"]})]}),KU=({isOpen:n,onClose:e,userData:t,showNotification:r,setActiveDashboardSection:s})=>{const o={role:"assistant",text:`Hello, ${(t==null?void 0:t.displayName)||"Valued Customer"}! I am Agie, your AGWA Water Services virtual assistant. How can I help you today with your account (${(t==null?void 0:t.accountNumber)||"N/A"}) or other water service inquiries?`},[a,u]=B.useState([o]),[d,f]=B.useState(""),[g,y]=B.useState(!1),[x,w]=B.useState(!1),[E,S]=B.useState(""),A=B.useRef(null);B.useEffect(()=>{A.current&&(A.current.scrollTop=A.current.scrollHeight)},[a]),B.useEffect(()=>{n&&(u([o]),f(""),y(!1),w(!1),S(""))},[n,t]);const N=async $=>{if($.preventDefault(),!d.trim()||g)return;const F={role:"user",text:d};u(P=>[...P,F]);const R=d;f(""),y(!0),w(!1),S("");const k=a.map(P=>({role:P.role==="user"?"user":"model",parts:[{text:P.text}]}));k.push({role:"user",parts:[{text:R}]});try{const T=`${`You are Agie, the friendly and professional AI assistant for AGWA Water Services, a major water utility provider in the Philippines.
Current Customer Details:
- Name: ${t.displayName||"Valued Customer"}
- Account Number: ${t.accountNumber||"Not available"}
- Service Type: ${t.serviceType||"Not specified"}

Your primary goals are:
1.  Understand the customer's query accurately. Queries can be about billing, payments, account management, water quality, leaks, service interruptions, how to use the portal, etc.
2.  Provide clear, concise, helpful, and empathetic responses.
3.  If the query is straightforward and answerable with general knowledge or information commonly found in FAQs (e.g., "how to pay my bill?", "what is FCDA?"), provide the answer.
4.  If the query implies needing specific account data you don't have (e.g., "what was my last payment amount?", "is my meter reading correct for May?"), explain you cannot access real-time specific account details but can guide them to where they might find it in the portal (e.g., "You can check your detailed bill history under 'My Bills' section").
5.  If the customer expresses frustration, has a complex issue (like a persistent leak or no water for an extended time), or directly asks to speak to a human or create a ticket, ALWAYS offer to help them create a support ticket. In this specific scenario, and ONLY in this scenario, end your response with the exact phrase: "WOULD_YOU_LIKE_A_TICKET?".
6.  Do NOT use the phrase "WOULD_YOU_LIKE_A_TICKET?" if you are providing a direct answer or general guidance.
7.  Be polite, patient, and professional. Avoid overly technical jargon unless necessary and explain it if used.
8.  If the user's query is very vague, ask clarifying questions.
9.  Do not make up information or promise actions you cannot perform.
10. Keep responses relatively brief and to the point.

Respond to the customer's latest message based on the conversation history.`}

Conversation History:
${k.slice(0,-1).map(L=>`${L.role}: ${L.parts[0].text}`).join(`
`)}

New user message to respond to:
user: ${R}`,D=await Vi(T);if(D.includes("WOULD_YOU_LIKE_A_TICKET?")){const L=D.replace("WOULD_YOU_LIKE_A_TICKET?","").trim();u(C=>[...C,{role:"assistant",text:L}]),w(!0)}else u(L=>[...L,{role:"assistant",text:D}])}catch(P){console.error("Chatbot API error:",P);const T="I'm currently experiencing some technical difficulties and can't respond right now. Please try again in a few moments. If the issue persists, you might want to report an issue directly through the portal.";u(D=>[...D,{role:"assistant",text:T}]),S("Failed to get response from assistant.")}finally{y(!1)}},z=()=>{var R;const F=a.slice(-5).map(k=>`${k.role==="user"?t.displayName||"You":"Agie"}: ${k.text}`).join(`

`);localStorage.setItem("chatbotIssueDescription",`Issue raised via Chatbot Agie:

${F}

Initial User Query (if available):
${((R=a.find(k=>k.role==="user"))==null?void 0:R.text)||"User initiated ticket creation from chat."}`),localStorage.setItem("chatbotIssueTypeSuggestion","Chatbot Assistance Follow-up"),e(),s&&s("reportIssue"),r("Please review and submit the support ticket drafted from your chat.","success")},U=["How to pay my bill?","Report a water leak.","My water pressure is low.","What are current announcements?"],W=$=>{f($)};return c.jsxs(Xr,{isOpen:n,onClose:e,title:"Chat with Agie - Your AGWA Assistant",size:"lg",children:[c.jsx("style",{jsx:!0,global:!0,children:`
                .animate-message-appear {
                    animation: message-appear 0.3s ease-out forwards;
                }
                @keyframes message-appear {
                    from { opacity: 0; transform: translateY(10px) scale(0.98); }
                    to { opacity: 1; transform: translateY(0) scale(1); }
                }
                .chatbot-input-shadow {
                    box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
                }
            `}),c.jsxs("div",{className:"flex flex-col h-[65vh] sm:h-[70vh] bg-gray-50",children:[c.jsxs("div",{ref:A,className:"flex-grow p-4 space-y-4 overflow-y-auto",children:[a.map(($,F)=>{var R;return c.jsxs("div",{className:`flex items-end animate-message-appear ${$.role==="user"?"justify-end":"justify-start"}`,children:[$.role==="assistant"&&c.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-2",children:c.jsx(Kr,{size:18})}),c.jsx("div",{className:`max-w-[75%] p-3 rounded-2xl shadow-sm ${$.role==="user"?"bg-blue-600 text-white rounded-br-none":"bg-white text-gray-800 border border-gray-200 rounded-bl-none"}`,children:c.jsx("p",{className:"text-sm whitespace-pre-wrap",children:$.text})}),$.role==="user"&&c.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-gray-300 text-gray-600 flex items-center justify-center ml-2 uppercase",children:((R=t==null?void 0:t.displayName)==null?void 0:R.charAt(0))||"U"})]},F)}),g&&c.jsxs("div",{className:"flex items-end justify-start animate-message-appear",children:[c.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-2",children:c.jsx(Kr,{size:18})}),c.jsx("div",{className:"max-w-[75%] p-3 rounded-2xl shadow-sm bg-white text-gray-800 border border-gray-200 rounded-bl-none",children:c.jsx(Nt,{size:"h-5 w-5",color:"text-blue-500",message:""})})]}),E&&c.jsxs("div",{className:"flex items-center justify-center p-3 bg-red-50 text-red-700 rounded-lg animate-message-appear",children:[c.jsx(Yt,{size:20,className:"mr-2"}),c.jsx("p",{className:"text-sm",children:E})]})]}),x&&c.jsx("div",{className:"p-3 border-t border-gray-200 bg-white",children:c.jsxs("button",{onClick:z,className:"w-full flex items-center justify-center bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-4 rounded-lg transition-all duration-150 active:scale-95 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50",children:[c.jsx(RL,{size:20,className:"mr-2"})," Create Support Ticket from this Chat"]})}),!x&&a.length<=1&&c.jsx("div",{className:"p-2 border-t border-gray-200 bg-white flex flex-wrap gap-2 justify-center",children:U.map($=>c.jsx("button",{onClick:()=>W($),className:"text-xs bg-blue-100 text-blue-700 hover:bg-blue-200 px-3 py-1.5 rounded-full transition-colors",disabled:g,children:$},$))}),c.jsxs("form",{onSubmit:N,className:"p-3 border-t border-gray-200 flex items-center space-x-3 bg-white chatbot-input-shadow",children:[c.jsx("input",{type:"text",value:d,onChange:$=>f($.target.value),placeholder:"Type your message to Agie...",className:"flex-grow px-4 py-2.5 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-shadow focus:shadow-md text-sm",disabled:g,"aria-label":"Chat input"}),c.jsx("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-xl disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-150 active:scale-90 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",disabled:g||!d.trim(),"aria-label":"Send message",children:c.jsx(dp,{size:20})})]})]})]})},QU=({isOpen:n,onLink:e,isLinking:t,error:r})=>{const[s,o]=B.useState(""),a=u=>{u.preventDefault(),e(s)};return c.jsx(Xr,{isOpen:n,onClose:()=>{},title:"Link Your AGWA Account",hideCloseButton:!0,size:"md",children:c.jsxs("form",{onSubmit:a,className:"space-y-5",children:[c.jsx("p",{className:"text-sm text-center text-gray-600",children:"To access your bills and other services, please link your AGWA account by providing your account number below."}),r&&c.jsx("div",{className:"text-center p-2 bg-red-100 text-red-700 rounded-md text-sm",children:r}),c.jsxs("div",{className:"relative",children:[c.jsx(Oi,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"AGWA Account Number (e.g., RES-12345)",value:s,onChange:u=>o(u.target.value),className:`${Nr} pl-11`,required:!0,disabled:t,"aria-label":"AGWA Account Number"})]}),c.jsxs("button",{type:"submit",className:Id(t||!s.trim()),disabled:t||!s.trim(),children:[t?c.jsx(Ge,{className:"animate-spin inline mr-2",size:18}):c.jsx(av,{className:"inline mr-2",size:18}),t?"Linking Account...":"Link My Account"]})]})})},YU=({user:n,userData:e,setUserData:t,handleLogout:r,showNotification:s,auth:o,db:a})=>{const[u,d]=B.useState("mainDashboard"),[f,g]=B.useState(!1),[y,x]=B.useState(!1),[w,E]=B.useState(!1),[S,A]=B.useState(!1),[N,z]=B.useState(""),[U,W]=B.useState(null);B.useEffect(()=>{e&&!e.accountNumber?E(!0):E(!1)},[e]),B.useEffect(()=>{if(!a)return;const T=Ot(a,ap()),D=Ck(T,L=>{if(L.exists()){const C=L.data();C.isBannerEnabled&&C.portalAnnouncement?W({text:C.portalAnnouncement}):W(null)}else W(null)});return()=>D()},[a]);const $=T=>{d(T),f&&g(!1)},F=async T=>{A(!0),z("");const D=await BM(a,n.uid,T);if(D.success){const{role:L,serviceType:C}=gm(T);t(G=>({...G,accountNumber:T.toUpperCase(),role:L,serviceType:C})),E(!1),s("Account linked successfully!","success")}else z(D.error||"Failed to link account. Please check the account number and try again.");A(!1)},k=[{name:"Dashboard",iconName:"Home",section:"mainDashboard",roles:["customer","meter_reader","admin","clerk_cashier"]},{name:"My Profile",iconName:"UserCog",section:"myProfile",roles:["customer","meter_reader","admin","clerk_cashier"]},{name:"My Bills & Payments",iconName:"FileText",section:"myBills",roles:["customer"]},{name:"Assigned Routes",iconName:"Map",section:"assignedRoutes",roles:["meter_reader"]},{name:"Submit Reading",iconName:"ClipboardEdit",section:"searchAndSubmitReading",roles:["meter_reader"]},{name:"Search Customer",iconName:"Search",section:"searchCustomerMeterReader",roles:["meter_reader"]},{name:"Process Walk-in Payment",iconName:"Banknote",section:"walkInPayments",roles:["clerk_cashier"]},{name:"Search Account / Bill",iconName:"FileSearch",section:"searchAccountOrBill",roles:["clerk_cashier"]},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",roles:["customer","clerk_cashier","meter_reader"]},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",roles:["customer","meter_reader","clerk_cashier"]},{name:"User Management",iconName:"Users",section:"userManagement",roles:["admin"]},{name:"Support Tickets",iconName:"MessageSquare",section:"supportTickets",roles:["admin"]},{name:"Manage Announcements",iconName:"Edit",section:"manageAnnouncements",roles:["admin"]},{name:"Meter Reading Mgt.",iconName:"Gauge",section:"editMeterReadingsAdmin",roles:["admin"]},{name:"Batch Billing",iconName:"FileText",section:"batchBilling",roles:["admin"]},{name:"Route Management",iconName:"Map",section:"routeManagement",roles:["admin"]},{name:"System Analytics",iconName:"BarChart3",section:"systemAnalytics",roles:["admin"]},{name:"System Settings",iconName:"Settings",section:"systemSettings",roles:["admin"]},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",roles:["customer","meter_reader","admin","clerk_cashier"]},{name:"FAQs",iconName:"HelpCircle",section:"faqs",roles:["customer","meter_reader","admin","clerk_cashier"]},{name:"About Us",iconName:"Info",section:"aboutUs",roles:["customer","meter_reader","admin","clerk_cashier"]},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",roles:["customer","meter_reader","admin","clerk_cashier"]}].filter(T=>(e==null?void 0:e.role)&&T.roles.includes(e.role)),P=()=>{const T={user:n,userData:e,setUserData:t,auth:o,db:a,showNotification:s,billingService:Mk,determineServiceTypeAndRole:gm,setActiveSection:$};switch(u){case"mainDashboard":return e.role==="customer"?c.jsx(dO,{...T}):e.role==="admin"?c.jsx(qO,{...T}):e.role==="meter_reader"?c.jsx(VU,{...T}):e.role==="clerk_cashier"?c.jsx(qU,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"myProfile":return c.jsx(LO,{...T});case"reportIssue":return c.jsx(FO,{...T});case"faqs":return c.jsx(zO,{...T});case"aboutUs":return c.jsx(UO,{...T});case"contactUs":return c.jsx($O,{...T});case"viewAnnouncements":return c.jsx(oI,{...T,viewOnly:!0});case"myBills":return e.role==="customer"?c.jsx(MO,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"myTickets":return["customer","clerk_cashier","meter_reader"].includes(e.role)?c.jsx(GU,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"userManagement":return e.role==="admin"?c.jsx(n3,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"batchBilling":return e.role==="admin"?c.jsx(FU,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"routeManagement":return e.role==="admin"?c.jsx(OU,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"supportTickets":return e.role==="admin"?c.jsx(s3,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"manageAnnouncements":return e.role==="admin"?c.jsx(oI,{...T,viewOnly:!1}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"systemAnalytics":return e.role==="admin"?c.jsx(jU,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"editMeterReadingsAdmin":return e.role==="admin"?c.jsx(MU,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"systemSettings":return e.role==="admin"?c.jsx(o3,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"assignedRoutes":return e.role==="meter_reader"?c.jsx(UU,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"searchAndSubmitReading":return e.role==="meter_reader"?c.jsx(p2,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"searchCustomerMeterReader":return e.role==="meter_reader"?c.jsx($U,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"walkInPayments":return e.role==="clerk_cashier"?c.jsx(HU,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});case"searchAccountOrBill":return e.role==="clerk_cashier"?c.jsx(WU,{...T}):c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")});default:return c.jsx(Nn,{onNavigateHome:()=>$("mainDashboard")})}};return c.jsxs("div",{className:"bg-gray-100 font-sans",children:[c.jsx(oO,{userData:e,navItems:k,activeSection:u,onNavigate:$,onLogout:r,isMobileOpen:f,setMobileOpen:g}),c.jsxs("div",{className:"lg:pl-64",children:[c.jsxs("header",{className:"sticky top-0 z-30 flex items-center justify-between bg-white/80 backdrop-blur-lg shadow-sm p-3 lg:hidden",children:[c.jsx("button",{onClick:()=>g(!0),className:"text-gray-600 hover:text-gray-900",children:c.jsx(FL,{size:28})}),c.jsx("h1",{className:"text-lg font-semibold text-blue-700",children:"AGWA"})]}),U&&c.jsx("div",{className:"bg-yellow-400 text-center p-2 text-yellow-900 font-semibold shadow-md text-sm",children:U.text}),c.jsx("main",{className:"p-4 sm:p-6 lg:p-8",children:P()})]}),e&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>x(!0),className:"fixed bottom-6 right-6 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-4 shadow-lg transform hover:scale-110 transition-all duration-200 ease-in-out z-40","aria-label":"Open Chatbot",children:c.jsx(Wi,{size:28})}),y&&c.jsx(KU,{isOpen:y,onClose:()=>x(!1),userData:e,showNotification:s,setActiveDashboardSection:$}),c.jsx(QU,{isOpen:w,onLink:F,isLinking:S,error:N})]})]})},XU=()=>c.jsxs("div",{className:"min-h-screen bg-gray-900 text-white flex flex-col justify-center items-center p-4 text-center",children:[c.jsx(jL,{size:64,className:"text-yellow-400 mb-4 animate-bounce"}),c.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Under Maintenance"}),c.jsx("p",{className:"text-gray-400",children:"The AGWA portal is currently undergoing scheduled maintenance to improve our services."}),c.jsx("p",{className:"text-gray-400",children:"We apologize for any inconvenience and expect to be back online shortly."})]}),JU=()=>{const[n,e]=B.useState(!0),[t,r]=B.useState(null),[s,o]=B.useState(null),[a,u]=B.useState(null),[d,f]=B.useState({maintenanceMode:!1}),[g,y]=B.useState(!1),[x,w]=B.useState(""),[E,S]=B.useState("login"),[A,N]=B.useState({message:"",type:""}),z=B.useCallback((C,G="error")=>{N({message:C,type:G}),setTimeout(()=>N({message:"",type:""}),5e3)},[]),U=B.useCallback(()=>N({message:"",type:""}),[]);B.useEffect(()=>{const C=Ot(Kt,ap()),G=Ck(C,ce=>{ce.exists()&&f(ce.data())},ce=>{console.error("Error fetching system settings:",ce)}),K=yP(Su,async ce=>{e(!0),u(null);try{if(ce){const ue=Ot(Kt,ip(ce.uid));let Q=await ev(ue),Z=null;if(Q.exists())Z={uid:ce.uid,...Q.data()};else{const M=localStorage.getItem("signupDisplayName")||ce.displayName||ce.email||"New User",q=localStorage.getItem("signupAccountNumber")||"",{role:ne,serviceType:V}=gm(q),de={email:ce.email||"",phoneNumber:ce.phoneNumber||"",displayName:M,accountNumber:q,role:ne,serviceType:V,accountStatus:"Active",photoURL:ce.photoURL||""},xe=await nL(Kt,ce.uid,de);if(!xe.success)throw new Error(xe.error||"Failed to create user profile in the database.");Z={uid:ce.uid,...de},localStorage.removeItem("signupDisplayName"),localStorage.removeItem("signupAccountNumber")}r(ce),o(Z)}else r(null),o(null)}catch(ue){console.error("Authentication state change error:",ue),u(ue.message),r(ce),o(null)}finally{e(!1)}});return()=>{K(),G()}},[z]);const W=B.useCallback(C=>{w(""),S(C)},[]),$=async(C,...G)=>{y(!0),w("");try{const K=await C(Su,...G);return K.success||w(K.error),K}catch{return w("An unexpected error occurred."),{success:!1,error:"An unexpected error occurred."}}finally{y(!1)}},F=(C,G)=>$(CM,C,G),R=()=>$(NM),k=()=>$(DM),P=async(C,G,K,ce)=>{y(!0),w(""),localStorage.setItem("signupDisplayName",K),localStorage.setItem("signupAccountNumber",ce);const ue=await AM(Su,C,G);ue.success||(w(ue.error),localStorage.removeItem("signupDisplayName"),localStorage.removeItem("signupAccountNumber")),y(!1)},T=async C=>{const G=await $(jM,C);return G.success&&z(G.message,"success"),G.success},D=async C=>{const G={url:window.location.href,handleCodeInApp:!0},K=await $(RM,C,G);return K.success&&z(K.message,"success"),K};if(B.useEffect(()=>{(async()=>{if(KI(Su,window.location.href)){let G=window.localStorage.getItem("emailForSignIn");G||(G=window.prompt("Please provide your email for confirmation")),G?await $(PM,G,window.location.href):z("Email is required to complete sign-in.","error")}})()},[z]),n)return c.jsx(Z_,{loadingMessage:"Verifying session..."});if(t)return s?d.maintenanceMode&&s.role!=="admin"?c.jsx(XU,{}):c.jsxs(c.Fragment,{children:[c.jsx(YU,{user:t,userData:s,setUserData:o,handleLogout:k,showNotification:z,auth:Su,db:Kt,systemSettings:d}),c.jsx(w0,{message:A.message,type:A.type,onClose:U})]}):c.jsx(Z_,{loadingMessage:"Finalizing Account Setup...",error:a});const L={login:c.jsx(tO,{handleLoginExternal:F,handleGoogleSignIn:R,navigateTo:W,authActionLoading:g,setAuthError:w}),signup:c.jsx(nO,{handleSignupExternal:P,handleGoogleSignIn:R,navigateTo:W,authActionLoading:g,setAuthError:w,showNotification:z}),forgotPassword:c.jsx(rO,{handleForgotPasswordExternal:T,navigateTo:W,authActionLoading:g}),passwordlessLogin:c.jsx(sO,{handlePasswordlessSignInExternal:D,navigateTo:W,authActionLoading:g})};return c.jsxs(c.Fragment,{children:[c.jsx(Zk,{authError:x||a,systemSettings:d,children:L[E]||L.login}),c.jsx(w0,{message:A.message,type:A.type,onClose:U})]})};class ZU extends Do.Component{constructor(t){super(t);Fb(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorId:Date.now()}),this.props.onRetry?this.props.onRetry():window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null,errorId:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Uncaught error:",t,r),this.setState({errorInfo:r,errorId:Date.now()})}render(){var t,r;if(this.state.hasError){const{fallback:s}=this.props;return s&&typeof s=="function"?s({error:this.state.error,errorInfo:this.state.errorInfo,retry:this.handleRetry}):Do.isValidElement(s)?s:c.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-center p-6 bg-red-50",role:"alert",children:[c.jsx(zL,{size:48,className:"text-red-500 mb-4"}),c.jsx("h1",{className:"text-2xl font-bold text-red-700 mb-2",children:"Oops! Something went wrong."}),c.jsx("p",{className:"text-gray-700 mb-4 max-w-md",children:"We encountered an unexpected issue. Please try again. If the problem persists, contact support."}),c.jsxs("details",{className:"mb-4 p-3 bg-red-100 text-left text-xs text-red-800 rounded-md w-full max-w-2xl overflow-auto",children:[c.jsx("summary",{className:"font-semibold cursor-pointer",children:"Error Details"}),c.jsxs("pre",{className:"mt-2 whitespace-pre-wrap",children:[(t=this.state.error)==null?void 0:t.toString(),((r=this.state.errorInfo)==null?void 0:r.componentStack)&&`

Component Stack:
${this.state.errorInfo.componentStack}`]})]}),c.jsxs("button",{onClick:this.handleRetry,className:"flex items-center justify-center px-5 py-2.5 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow hover:shadow-md transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50",children:[c.jsx($L,{size:16,className:"mr-2"}),"Try Again"]}),this.props.showSupportInfo&&c.jsxs("p",{className:"text-xs text-gray-500 mt-6",children:["Error ID: ",this.state.errorId||"N/A",". Please include this ID if you contact support."]})]})}return this.props.children}}NC.createRoot(document.getElementById("root")).render(c.jsx(Do.StrictMode,{children:c.jsx(ZU,{children:c.jsx(JU,{})})}));
